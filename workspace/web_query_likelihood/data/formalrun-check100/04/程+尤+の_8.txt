
Next: 文献目録
Up: 「計画数理II」講義ノート
Previous: 確率と確率変数
Subsections
KL情報量
対数尤度
最尤法
定義
正規分布
多項式回帰モデル
AIC
AICとは
AICの導出
AICの使用例
硬貨の真偽
正規分布モデルのAIC
多項式回帰モデルのAIC
ARモデルのAIC
尤度とAIC
KL情報量
データの当てはまりのよさを数値で表すことを考える.
これを実現するために Kullbuck と Leibler が提案した量を
Kullbuck-Leibler 情報量または KL 情報量と呼ぶ.
離散型確率変数の場合, 
を
真の確率分布,
をモデルの確率分布とおくと,
(51)
ここで, は確率変数の数であり,  は自然対数を表す.
連続型確率変数の場合は,真の分布を  モデルの分布を  とすると,
(52)
である.
KL情報量は以下のような性質を持っている.
KL情報量は常に0以上である.
モデルの分布が真の分布と一致するときにKL情報量はゼロとなる.
この性質はKL情報量をモデルの当てはまりのよさを与えるひとつのものさしとす
ることを支持している.また,KL情報量が(負の)エントロピーに符号を逆にし
たものであることも,ものさしとすることを支持するものである.
上の性質から明らかなように,このものさしはあてはまりが良いほど小さい値を
持つ.
以下では,このものさしを用いてモデルの当てはまりのよさを比較する方法につ
いて考えてゆく.
対数尤度
KL情報量は,離散的な場合,
(53)
(54)
連続的な場合,
(55)
と変形できる.どちらの式も,第一項は真の分布から得られる定数であり,
モデルの当てはまりのよさを決めるのは第二項であることがわかる.
この第二項の符号を逆転した式  の近似値をデータから得ることを
考える.
観測データを 
とする.
離散型確率変数の場合で  が出現する確率を  ,
連続型確率変数の場合で  についての確率密度関数をやはり  と
書くと,上記の  の近似値は,
(56)
と表せそうである.
これを平均対数尤度と呼ぶ.これをデータ数  倍した
(57)
を対数尤度(log likelihood)と呼ぶ.また,対数をとる前の
(58)
を尤度(likelihood)と呼ぶ.Likelihood(もっともらしさの度合い)というの
は,この式が,考えている確率モデルにおけるそれぞれの観測データの積事象が
観測される確率になっていることからも理解できる.
対数尤度や尤度は確率モデルのよさを測るものさしとなる.
対数尤度とKL情報量を比較してみると符号が逆転しているので,KL情報量とは逆に,
モデルの対数尤度が大きいほど,当てはまりがよくなることに注意する.
最尤法
定義
考えているモデルの尤度が最大になるように
パラメータの値を決めることによって,モデルが真の分布に
最も近くなるように調整することを最尤法という.
また,最尤法によって得られたパラメータの値を最尤推定量と呼び,
変数名の上にハット(＾)をつけて表す.
正規分布
個のデータ 
が正規分布する,すなわち
の確率密度関数が,
(59)
で表される仮定できるとする.
このときにデータから得られる最尤推定量  および 
についての式を求めることを考える.
このとき,対数尤度は,
(60)
となる.この量が最大となるのは,
(61)
のとき.この方程式の解  と 
は,
(62)
(63)
となる.すなわち,あるデータセットについて,それが正規分布すると
仮定して最尤法によって推定されたパラメータの値は,平均の推定値が平均値,
分散の推定値が標本分散になることを示している.
後のために必要になるので,このときの対数尤度 
を求めておくと,
(64)
となることがわかる.
多項式回帰モデル
データのペア 
を
考える.
これらのデータが,
(65)
に従うと仮定し,このときの AIC を求めることを考える.
そのために,実際に得られたデータは平均ゼロ・分散  の
誤差を伴うとしたした確率モデルを考える.
このようなモデルを次多項式回帰モデルという.
このモデルの対数尤度は,誤差が正規分布に従うという
確率モデルであることから,
(66)
と表されることにより,
(67)
(68)
このとき,最尤推定量(, , , 
, 
)は
(69)
の解である.この方程式は最初の  個について以下のように書き換えられる.
(70)
であり,この解は最小自乗法によって得られるものと同じである.
また,最後の方程式は,
(71)
の解であって,
(72)
である.
後のために必要になるので,このときの対数尤度を求めておくと,
(73)
AIC
AICとは
次回帰モデルの最尤法の結果について改めて考えてみると,
ある問題点に気が付く.
それは次数が大きいほど残差平方和は小さくなることである.
つまり,残差平方和が小さいことが正義だとすると,次数を
大きくとることが正しいモデル選択の方法になってしまう.
極論を言うと  組のデータを用いて  次回帰モデルを
作ることが一番よいモデルであるということになる.
しかし,この考え方はどうみてもおかしい.
赤池の情報量規準(Akaike's Information Criterion: AIC)は,
このような問題点を回避するためのものさしとなるものである.
AICの導出
AICの導出については参考図書を見てほしい.ここでは,
何をもとにしてどんな仮定を行うことで導出されるのかを
見るに留めておく.
基本となるのは KL 情報量である.これを以下の条件(仮定)の
もとで評価してみる.
最尤モデルの平均対数尤度を真のパラメータで Taylor 展開したときに2
次の項まで考慮すれば十分である.
最尤推定量はデータの個数が無限大になるときに,真のパラメータとなる.
これらを仮定すると,パラメータ数  の期待対数尤度
(平均対数尤度のデータ 
に関する期待値)
つまり,KL情報量
(74)
の第2項が,
(75)
で近似されることがわかる( はデータ数).
そこで,(歴史的な経緯から)分子に (-2) を
乗じたものを 
と呼び,この数値によって
モデルのあてはまりの良さを評価する.
すなわち,モデルのパラメータ数を  としたとき,
(76)
が小さいモデルほど良いモデルであるとして評価を行う.
AICの使用例
硬貨の真偽
回の試行で  回が表であった.このとき,この硬貨の真偽を判断してみ
る.ふたつのモデルが考えられる.ひとつは硬貨が本物であると考えるモデルで
ある.これをモデルAと呼ぶことにする.モデルAでは表がでる確率は 0.5 と
みなされる.もうひとつは硬貨が偽物であると考えるモデルである.
これをモデルBと呼ぶことにする.モデルBでは表がでる確率  が不明なので,
最尤法を用いて  の値を求める.
表がでる確率が  であるとき,その対数尤度  は,
(77)
が最大になるように最尤推定量  を設定するには,
(78)
を解いて,
(79)
このとき,最大対数尤度は,
(80)
である.
この結果,モデルAの AIC は,
(81)
モデルBの AIC は,
(82)
考え方は逆になってしまうが,  を固定して,各試行回数に
おける AIC を計算した結果を下の表に示した.
100回コインを投げて60回表になったら偽物と思った方がよさそうである.
0.55
0.6
n
AIC(0)
AIC(1)
n
AIC(0)
AIC(1)
50
69.3
70.8
50
69.3
69.3
100
138.6
139.6
100
138.6
136.6
200
277.3
277.3
200
277.3
271.2
300
415.9
414.9
300
415.9
405.8
400
554.5
552.5
400
554.5
540.4
正規分布モデルのAIC
正規分布に関する確率モデルとしては以下の4つが考えられる.
データはもともと与えられた  と  に従う.
平均は最尤推定量  が正しい.
分散は最尤推定量 
が正しい.
平均,分散ともに最尤推定量  , 
が正し
い.
これら4つのモデルをそれぞれ,モデルA,モデルB,モデルC,そしてモデル
Dとする.これらの AIC を 
,
, 
, 
とし,
3.3.2節の結果を用いて求めることにする.
モデルAの AIC は,
対数尤度の式(61)を用いて,
(83)
となる.モデルB,モデルCの結果は一部に最尤推定量を使うので,それぞれ,
(84)
(85)
となる.モデルDはすべて最尤推定量で構成されるので,最大対数尤度の式であ
る式(65) を用いて,
(86)
となる.例えば機械の故障の判定などは,これらの4つのモデルを比較すること
によって結論を得ることができる.
多項式回帰モデルのAIC
3.3.3節の結果より,
データのペア 
を
次回帰モデル
(87)
に当てはめたときの AIC は,
(88)
となる.
例えば,
1
2
3
4
5
6
7
8
9
10
11
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
0.012
0.121
-0.0194
-0.0183
-0.032
-0.037
0.196
0.077
0.343
0.448
0.434
というデータの組について,多項式回帰モデルを当てはめる.
下の表に各次数における最尤推定量とそのときの最大対数尤度およびAICをま
とめた.パラメータの数を多くすれば多くするほど分散の最尤推定量
(残差平方和/データ数)が小さくなるので,対数尤度が大きくなり
モデルを比較するのが困難であること.そして,AICを用いると
その比較ができ,今回の場合,2次モデルが最良のモデルであると
予想できることがわかる.
実際にグラフに書いてみると2次と3次では曲線の形にほとんど違いがなく,
パラメータの数を多くしてまで3次曲線で近似する必要がみられないことがわか
る.
モデル
最大対数尤度
AIC
0次
0.138573
3.23417
-2.46835
1次
-0.0852364
0.447618
8.50008
-11.00017
2次
0.0602566
-0.522335
0.969953
13.37498
-18.74997
3次
0.078849
-0.817746
1.74463
-0.516453
13.53748
-17.07496
ARモデルのAIC
AR モデルとは,自己回帰モデルとも呼ばれ,等時間間隔で
計測された時系列に対して,現在の自分を過去の自分の線形和と
して表すものである.
これは過去に得られたデータ 
をもとにして,
現在の自分の値を
(89)
(90)
と近似して表そうというものである.
このモデルには平均ゼロ,分散  である
誤差が伴うという確率モデルについて検討する.
知りたいのは最適な  の値とそのときの最尤推定量
の値である.
最初にしなければならないのはデータの番号付けのやり直しである.
もとのデータ 
を
と
置きなおす.このときの  とは,比較検討する  の
値の最大値である.
というデータは
観測データの個数には入れない.すなわち, 
を観測データとする.これは  の推定値を計算するのに,
それよりも過去のデータが必要なためである.以下ではデータの個数として,
を用いて議論する.
誤差が正規分布すると仮定しているので,このモデルの対数尤度は,
(91)
この式はデータとして  までを参照する.前述のようにデータの番号
付けを変更する意味がここでわかる筈である.
最尤推定量を求める方程式は,
(92)
となり,最後の方程式以外は,
(93)
とまとめられる.ここで  とは,
(94)
である.また最後の方程式を解くと,最尤推定量 
を
求めることができ,その結果は,
(95)
となる.
Next: 文献目録
Up: 「計画数理II」講義ノート
Previous: 確率と確率変数
Takashi Yoshino 
平成17年4月8日
尤度とAIC
