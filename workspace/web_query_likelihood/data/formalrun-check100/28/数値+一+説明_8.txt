
項目詳細
書式
MATCH(検査値, 検査範囲, 照合の型)
検査値(必須)
検索する値またはセル参照を指定します。
検査範囲(必須)
検索するセルの範囲を指定します。
照合の型(省略可)
検索方法を 1、0、-1の数値で指定します。省略すると 1 として処理されます。
1 の場合検査値以下の最大の値で検索。検査範囲 を、昇順に並べ替えておく必要があります。
0 の場合検査値に一致する値のみが検索の対象。データの並べ替えは必要なく、検査値が文字列の場合、ワイルドカード文字を使用することができます。
-1 の場合検査値以上の最小の値で検索。検査範囲 を、降順に並べ替えておく必要があります。
MATCH関数の使用例(その1)
式
=MATCH(70, A2:A6, 1)
結果
2     
説明
照合の型が 1 の場合
点数が予め昇順になっているため、「70」点を超えない最大値「61」点が上から何番目かが返されます。
式
=MATCH(70, A2:A6, 0)
結果
#N/A     
説明
照合の型が 0 の場合
「70」点と完全に一致する数値が無いため、エラー値が返されます。
式
=MATCH(70, A2:A6, -1)
結果
#N/A     
説明
照合の型が -1 の場合
「70」点以上の最大値「72」点の相対的な位置を求めますが、点数が降順になっていないため正しい結果が得られません。
(その2)「上記表を降順にした場合」
式
=MATCH(70, A2:A6, 1)
結果
#N/A     
説明
照合の型が 1 の場合
「70」点を超えない最大値「61」点の相対的な位置を求めますが、点数が昇順になっていないため正しい結果が得られません。
式
=MATCH(70, A2:A6, 0)
結果
#N/A     
説明
照合の型が 0 の場合
「70」点と完全に一致する数値が無いため、エラー値が返されます。
式
=MATCH(70, A2:A6, -1)
結果
3     
説明
照合の型が -1 の場合
点数が予め降順になっているため、「70」点以上の最大値「72」点が上から何番目かが返されます。
ExcelのMATCH関数の使い方
