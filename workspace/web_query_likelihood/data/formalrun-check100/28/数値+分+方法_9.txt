 
数学の式で作ったモデルを
シミュレーション
につなげるのが、
「数値計算(Numerical Calculation)」という分野です。
「数値計算」という名前は、初めて聞く方には漠然とした響きがあるかもしれません。
「数値的に解く」という言い方もします。
ちなみに、紙の上で方程式の変形のようなことをする計算は、
「解析的に解く」と言います。
優先順位としては、解析的に解く方が先で、ダメなら数値計算するのが基本です。
「法則」のようなものは、解析的に解いた方がすっきりしたものを見つけられます。
数値計算は、シミュレーションの方法であると同時に、
解析的に解けない難解な式の性質を調べるための方法でもあります。
尚、数値計算は、シミュレーション以外でも使われますが、
規模の大きな使い方をするのがシミュレーションの分野だと思うので、ここに分類してあります。
数値計算を学ぶと、
プログラミング
もセットで学ぶことになります。
微分・積分の数値計算
微分・積分を学ぶと、「無限小の極限を考えます」という意味の説明が、登場します。
ところが、コンピュータで無限小という数値は扱えないので、
「無限小とみなしても良い位小さな数値」を使います。
これによって、小さな数値を使う近似式を作ります。
この近似が、数値計算の考え方のポイントです。
数値計算では、微分方程式の近似式として、差分方程式を使います。
微分方程式
システムダイナミクス
のような微分方程式を扱う場合は、小さな数値になるのは、時間です。
イメージ的には、1時間の推移のシミュレーションを、
1秒刻みで行うような感じです。
実際にやってみる時に問題になるのが、上記の例で言えば、
「0.1秒・1秒・10秒・1分の、どの刻みが良いのだろうか?」
という疑問です。
基本的には、刻みを細かくすれば計算精度は上がります。
しかし、ある程度細かくすれば、精度の上昇度は微々たるものになります。
また、刻みを10分の1にすれば、
計算時間は10倍になることを覚悟しなければなりません。
さらに厄介なのが、有効数字の問題で、
刻みとして小さな数値を扱いたいのに、コンピュータにとっては小さ過ぎて、扱えない場合があります。
そのため、有効数字を考慮しつつ、刻みの幅を決めることになります。
積分
教科書等で積分を学ぶと、
積分のイメージとして、「計算したい領域を、細長い短冊の集まりとみなし、短冊の面積をひとつずつ計算して、
それらの面積を足し合わせる。」と教わると思います。
数値積分では、イメージではなく、実際に短冊の面積を計算します。
数値積分の場合は、短冊の細さが「小さな数値」になります。
有限要素法
有限要素法は、偏微分方程式の解法として使われます。
使い道は、構造力学、熱伝導、流体力学、等、かなり広いです。
空間を扱う数値計算の分野では、
計算したい領域を細かな領域に分けて解いていきますが、有限要素法もこの点は同じです。
有限要素法は、単純に微分方程式を差分方程式にして、離散空間を計算するのではなく、
変分法を使った式を作ってから離散化していきます。
モンテカルロ法
「モンテカルロ」という、カジノで有名な町があるそうで、
確率論を使って、全体を計算する方法を「モンテカルロ法」と呼ぶのは、そこから来ているそうです。
モンテカルロ法は、乱数を使った数値計算の方法です。
乱数を使って領域をサンプリングして、サンプリングの結果に確率論を使って、全体を推定します。
短冊の面積を使う数値積分を上で書きましたが、
モンテカルロ法による数値積分もあります。
例えば、10(cm)×10(cm)の正方形の紙に図形を描きます。
紙の上に、ランダムにババっと点を打ちます。(「ランダムに」というのは、乱数を使うのでも良いです。)
紙の上に100点できて、そのうち77点が図形の中に入っているとします。
そうすると、その図形の面積は、
10(cm)×10(cm)×77(点)/100(点) = 77(cm2)
と計算できます。
点の数が多いほど、計算の精度が上がります。
モンテカルロ法を使うと、複雑な図形の面積でも簡単に求められます。
参考文献
全般
「数値計算」 川上一郎 著 岩波書店 1989
入門書です。
筆者が物理学の学生だった時に、物理学者の書いたこの本を選びました。
入門書は他にもたくさんあります。
有限要素法
「非構造分野における有限要素法の基礎」 原武久 著 昭晃堂 1981
一、二、三次元と、段階を追って丁寧に解説しています。補間関数が詳しいです。
・有限要素法では、微分方程式の汎関数を求め、汎関数の極値を取る。
・汎関数を求められない時は、ガラーキン法
・Yを補間関数の和で近似する。
「図解入門よくわかる 最新 有限要素法の基本と仕組み」 岸正彦 著 秀和システム 2010
有限要素法とは何かと言った、数学的な話がないです。
シミュレーションをする時の実際的な話が中心になっています。
「偏微分方程式の数値シミュレーション」 登坂宣好・大西和榮 著 東京大学出版会 1991
「有限要素法へのいざない」水元久夫・原平八郎 著 培風館 1995
モンテカルロ法
モンテカルロ法は、統計力学(物理学のひとつ)でもともと考えられたものだそうです。
物理出身の筆者は、最初に統計力学の勉強の中でモンテカルロ法を知りました。
現在、モンテカルロ法はいろいろな分野で使われていて、
データサイエンス
、
ベイズ統計
、
原子・分子のシミュレーション
、
意思決定論
の分野の本でも登場しています。
以下は、一番最近に見つけた本です。
「道具としてのベイズ統計」 涌井良幸 著 日本実業出版社 2009
ベイズ統計
の本です。
MCMC法の章があるのですが、MCMC法というのはマルコフチェーン・モンテカルロ法のことです。
簡単なモンテカルロ法では、乱数を次々に発生させて、探索していくのですが、
ランダムなだけだと効率が悪いので、ひとつ前のステップの情報も使って、次のステップを決めるのがMCMC法です。
この本では、MCMC法として、ギブス法とメトロポリス法が出て来ます。
順路
次は
原子・分子の世界
Tweet
数値計算
