特許請求の範囲
【請求項1】入力される音声信号のピッチ周期およびピッチゲインの少なくとも一方の時間的な変化を検出し、この変化に基づいて前記音声信号に対するピッチ強調の度合いを変化させることを特徴とするピッチ強調方法。【請求項2】入力される音声信号のピッチ周期およびピッチゲインの少なくとも一方の時間的な変化を検出し、この変化が所定のしきい値以上となったとき、前記音声信号に対するピッチ強調の度合いを低下させることを特徴とするピッチ強調方法。【請求項3】入力される音声信号のピッチを強調するピッチ強調手段と、前記音声信号のピッチ周期およびピッチゲインの少なくとも一方の時間的な変化を検出し、この変化に基づいて前記ピッチ強調手段におけるピッチ強調の度合いを制御する制御手段とを有することを特徴とするピッチ強調装置。【請求項4】音声信号の符号化データから音声信号のピッチ周期およびピッチゲインの少なくとも一方を含むパラメータを復号するパラメータ復号手段と、このパラメータ復号手段により復号されたパラメータを用いて音声信号を再生する音声再生手段と、この音声再生手段により再生された音声信号のピッチを強調するピッチ強調手段と、前記パラメータ復号手段により復号されたピッチ周期およびピッチゲインの少なくとも一方の時間的な変化を検出し、この変化に基づいて前記ピッチ強調手段におけるピッチ強調の度合いを制御する制御手段とを有することを特徴とするピッチ強調装置。【請求項5】入力される音声信号のピッチ周期およびピッチゲインの少なくとも一方を含むパラメータを抽出するパラメータ抽出手段と、前記音声信号のピッチを強調するピッチ強調手段と、前記パラメータ抽出手段により抽出されたピッチ周期およびピッチゲインの少なくとも一方の時間的な変化を検出し、この変化に基づいて前記ピッチ強調手段におけるピッチ強調の度合いを制御する制御手段とを有することを特徴とするピッチ強調装置。
発明の詳細な説明
【0001】【発明の属する技術分野】本発明は、符号化音声や背景雑音を含む音声の主観品質を向上させるためのピッチ強調方法および装置に関する。【0002】【従来の技術】音声信号を高能率に符号化する技術は、利用できる電波帯域が限られている移動体通信や、メモリの有効利用が求められるボイスメールなどの蓄積媒体において今や不可欠の技術になっている。この音声信号の符号化では、ビットレートをより低くする方向へ向かっている。【0003】符号化のビットレートが低くなってくると、符号化・復号化の過程で生じる符号化歪が増加し、再生される音声の品質が悪化してしまう。このため、再生される音声の主観品質を向上させる目的でポストフィルタが一般的に用いられる。このポストフィルタは復号化装置の最終段で用いられ、音声信号のスペクトルの形状に合わせて、山の部分を強調し、谷の部分を減衰することにより、符号化に伴う雑音を音声のスペクトルでマスクし、音質を向上させる効果を持つ。【0004】現在、種々の符号化方式で最も広く用いられ、特性の優れたポストフィルタが特開昭64−13200で開示されている。図6は、この従来のポストフィルタのブロック図であり、ピッチ強調フィルタ1、ホルマント強調フィルタ2、高域強調フィルタ3、ゲイン調整部4および乗算器5からなる。【0005】ピッチ強調フィルタ1は、ピッチ調和周波数間の周波数成分を減衰するために用いられるものであり、復号されたピッチパラメータに基づいて設定された次式(1)の伝達関数を持つ。【0006】【数1】【0007】ここで、pはピッチ周期であり、γとλはピッチゲインに基づいて次式(2)(3)により計算される。    γ=Cz f(x)                                      (2)    λ=Cp f(x)                                      (3)Cz ,Cp はピッチの強調の度合いを制御するための定数であり、経験的に決められる。また、f(x)は処理する信号が周期性を含まない無声音のときに不要なピッチ強調を避けるため用いられる制御因子である。xはピッチゲインに対応し、xがあるしきい値(典型的には0.6)より小さいときは、無声音と判定してf(x)=0とする。xがしきい値以上の時は、f(x)=xとする。xが1を越えると、安定性を保つためにf(x)=1とする。Cgは無声音と有声音とでピッチ強調フィルタ1のゲインが変動するのを吸収するためのもので、次式(4)で計算される。【0008】    Cg=(1−λ/x)/(1+γ/x)                  (4)ホルマント強調フィルタ2は、ホルマントの山を強調し谷を減衰させるために用いられ、次式(5)の伝達関数を持つ。【0009】【数2】【0010】この式の分母はLPC合成フィルタの伝達関数1/(1−P(z))に対応しており、全極型のポストフィルタのスペクトル傾斜を補正して音のこもり感を改善するために用いられる。α,βは雑音の抑圧とこもり感の兼ね合いから経験的に決められる定数であり、α=0.8,β=0.5が典型的な値である。高域強調フィルタ3は、式(5)の分子だけで補正できないこもり感を改善するために用いられる。また、ゲイン調整部4はポストフィルタの入出力間で信号のパワーが変化しないように、ポストフィルタ全体のゲインを乗算器5を介して補正するためのものである。【0011】このポストフィルタは、音声信号の符号化に伴って生じた雑音感を抑圧でき、再生音声の音質向上に効果を持つ。しかし、有声音の区間でピッチ周期が大きく変化した場合や、倍ピッチや半ピッチのようにピッチ周期が正しく検出されなかった場合には、復号化された音声のピッチのハーモニクスが図7から図8のように大きく変動して乱れてしまい、この乱れがピッチ強調フィルタ1で増長され、再生音声の音質を大きく劣化させるという問題がある。【0012】特に、CELP符号化方式にみられるように、ピッチの情報を適応符号長を用いて分析合成的に求める場合には、必ずしも正しいピッチ周期を求める構成となっておらず、本来ピッチ周期が緩やかに変化している場合でも求められたピッチ周期が大きく変動したり、倍ピッチや半ピッチになることが少ないため、このようなピッチ強調フィルタ1による音質の劣化が問題となる。【0013】【発明が解決しようとする課題】上述したように、従来のポストフィルタでは、音声音の区間でピッチ周期が大きく変化した場合や、倍ピッチや半ピッチのようにピッチ周期が正しく検出されなかった場合のように復号化された音声のピッチのハーモニクスが乱れたとき、この乱れをピッチ強調フィルタが増長させてしまい、音質を大きく劣化させるという問題があった。【0014】本発明の目的は、ピッチ周期が大きく変化したり正しく検出されない場合でもハーモニクスの乱れを抑えて主観品質を向上させることができるピッチ強調方法および装置を提供することにある。【0015】【課題を解決するための手段】本発明は、上記の課題を解決するため、入力音声信号のピッチ周期およびピッチゲインの少なくとも一方の時間的な変化を検出し、この変化に基づいて音声信号に対するピッチ強調の度合いを変化させることを有することを特徴とする。【0016】さらに具体的には、入力される音声信号のピッチ周期およびピッチゲインの少なくとも一方の時間的な変化が所定のしきい値以上となったとき、音声信号に対するピッチ強調の度合いを低下させるものである。【0017】ピッチの情報を適応符号長を用いて分析合成的に求めるCELP符号化方式などで得られた符号化データから復号再生される音声信号は、符号化側でピッチ周期が大きく変化した場合や、ピッチ周期が正しく検出されなかった場合には、ピッチのハーモニクスが乱れたものとなる。このような乱れが生じた場合、ピッチ強調フィルタはこれをさらに増長する性質がある。人間の聴覚は、ハーモニクスの乱れに敏感であるから、音質が大きく劣化して聞こえることになる。本発明によれば、ピッチ周期の変化を監視し、それがある程度以上になった場合、ピッチ強調フィルタの係数を変化させることによって強調の度合いを低下させるか、または強調そのものを止めることによって、このようなハーモニクスの乱れが抑えられ、音質が向上する。【0018】言い換えれば、従来のポストフィルタでは、人間の聴覚のマスキング効果のうち静的な性質を利用している。すなわち、信号のスペクトルで雑音のスペクトルをマスクすることによって雑音が知覚されにくくしている。このため、従来のポストフィルタでは音声を再生しようとするフレームのスペクトルを如何に整形するかということに焦点があてられ、スペクトルの時間的な変動には感心が払われていなかった。これに対し、本発明は人間の聴覚がスペクトルの変化に敏感であることに注目し、特にピッチ周期の時間的変化、つまりハーモニクスが大きく変動した場合にポストフィルタの強調の度合いを小さくすることによって、音声の主観品質を向上させたものである。【0019】【発明の実施の形態】以下、図面を参照して本発明の実施形態を説明する。図1は、本発明を音声復号化装置に適用した一実施形態を示すブロック図である。同図において、波線で囲まれた部分がポストフィルタ130であり、パラメータ符号部110、音声再生部120と共に音声復号化装置を構成する。【0020】入力端子100には、図示しない音声符号化装置から伝送された符号化データが入力され、パラメータ復号部110に送られる。このパラメータ復号部110においては、音声再生部120で用いられるパラメータが復号される。音声再生部120は、入力されたパラメータを用いて音声信号を再生する。パラメータ復号部110および音声再生部120は符号化方式装置の構成に依存し、様々な構成をとることができる。本発明に係るポストフィルタはパラメータ復号部110や音声再生部120の構成に拘束されず、種々の音声復号化装置に広く適用することができる。従って、ここではパラメータ復号部110および音声再生部120についての詳細な説明は省略する。【0021】ポストフィルタ130はピッチ強調フィルタ131、ピッチ制御部132、ホルマント強調フィルタ133、高域強調フィルタ134、ゲイン調整部135および乗算器136からなる。【0022】図2は、本実施形態における主要な処理の概略的な手順を示したフローチャートである。まず、符号化データが入力されると(ステップS1)、パラメータ復号部110でLPC係数、フレームゲイン、ピッチ周期、ピッチゲイン、雑音ベクトルおよび駆動ゲインなどのパラメータが復号され(ステップS2)、これらのパラメータに基づいて音声再生部120で元の音声信号が再生される(ステップS3)。【0023】次に、これらのパラメータ復号部110で復号されたパラメータうちのピッチパラメータであるピッチ周期およびピッチゲインに基づき、ピッチ制御部132によってピッチ強調フィルタ131の伝達関数が設定され(ステップS4)、次いでピッチ強調フィルタ131によってピッチ強調処理が行われる(ステップS5)。ここで、ピッチ制御部132では後述するようにピッチ周期の時間的な変化に基づいてピッチ強調の度合いが変化するように、具体的にはピッチ周期の時間的な変化が大きいほどピッチ強調の度合いが低下するようにピッチ強調フィルタ131の伝達関数を制御することが特徴である。【0024】ピッチ強調フィルタ131によりピッチ強調処理が施された音声信号は、ホルマント強調フィルタ133、高域強調フィルタ134、ゲイン調整部135および乗算器136によってさらに処理される。ホルマント強調フィルタ133は、ホルマントの山を強調し谷を減衰させるために用いられるフィルタであって、公知の種々の構成を用いることができる。また、高域強調フィルタ134はポストフィルタの導入に伴う音声のこもり感を改善するために設けられたものである。さらに、ゲイン調整部135はポストフィルタの入出力間で信号のパワーが変化しないようにポストフィルタ全体のゲインを乗算器135を介して補正するためのものである。これら高域強調フィルタ134およびゲイン調整部135のいずれも、ホルマント強調フィルタ133と同様に種々の公知技術を利用して構成することができる。【0025】ピッチ強調フィルタ131の構成としては、種々のものが考えられる。全極型の場合、ピッチ強調フィルタ131は式(6)に示す伝達関数H(z)で規定することができる。【0026】    H(z)=1/(1−εαz-T)                        (6)ここで、Tはピッチ周期であり、ε,αはピッチ制御部132で決められるフィルタ係数である。【0027】この場合、ピッチ制御部132は図3に示す手順でピッチ強調フィルタ131の伝達関数を設定する。すなわち、ピッチ制御部135ではまず式(7)のようにピッチゲインbを判定して、それに基づきフィルタ係数αを計算し、さらにピッチ周期Tの時間的な変化を判定して、それに基づき式(8)のようにフィルタ係数εを計算する。【0028】【数3】【0029】ただし、bは復号されたピッチゲイン、bthは有声/無声判定のためのしきい値、ε1 とε2 はピッチ強調の度合いを制御するパラメータ、Tp は前フレームのピッチ周期、Tthはピッチ周期Tの時間的な変化｜T−Tp ｜を判定するためのしきい値である。しきい値bthとして0.6、パラメータε1 として0.8、パラメータとしてε2 として0.4または0.0、しきい値Tthとして10を典型的な値として用いることができる。このようにしてフィルタ係数ε,αが設定され、式(6)に示した伝達関数H(z)が設定される。一方、ピッチ強調フィルタ131を極零型の伝達関数で規定する場合、その伝達関数H(z)は式(9)で表される。【0030】【数4】【0031】この場合、ピッチ制御部132は図4に示す手順でピッチ強調フィルタ131の伝達関数を設定する。すなわち、ピッチ制御部135ではまず式(10)のようにピッチゲインbを判定して、それに基づきパラメータαを計算し、さらにピッチ周期Tの時間的な変化を判定して、それに基づき式(11)(12)のようにパラメータC1 ,C2 を計算する。【0032】【数5】【0033】そして、これらのパラメータα,C1 ,C2 に基づいて、式(13)(14)によりピッチ強調フィルタ131のフィルタ係数γ,λを計算する。    γ=C1 α                                            (13)    λ=C2 α                                            (14)ここで、c11,c12,c21,c22は    0≦c11,c12,c21,c22<1                        (15)    c11>c12                                            (16)    c21>c22                                            (17)の制約の下で、経験的に決めることができる。典型的な値としてc11=0.4、c12=0.0、c21=0.8、c22=0.0を用いることができる。【0034】また、Cgは有声音と有声音でピッチ強調フィルタ131のゲインが変動するのを吸収するためのもので、式(18)により計算される。    Cg=(1−λ/b)/(1+γ/b)                  (18)以上から明らかなように、ピッチ強調フィルタ131はいずれの構成の場合においても、ピッチ周期Tの時間的な変化である｜T−Tp ｜がしきい値Tth以上となったとき、入力の音声信号に対するピッチ強調の度合いが低下するようにピッチ制御部132によってそのフィルタ係数が制御される。【0035】なお、上記の説明では｜T−Tp ｜がしきい値Tth以上となったとき、ピッチ強調処理そのものは行い、その強調度合いを小さくしたが、ピッチ強調処理そのものを行わない構成とすることも可能である。【0036】また、上記の説明ではピッチ周期の時間的な変化がしきい値以上となったときピッチ強調の度合いを低下させるようにしたが、ピッチゲインの周期の時間的な変化がしきい値以上となったときピッチ強調の度合いを低下させるようにしても同様の効果が得られる。【0037】さらに、上記実施形態では本発明を音声復号化装置に適用した例について説明したが、主観品質の向上を目的に種々の雑音を含む音声信号に適用されるエンハンスト処理と呼ばれる技術に適用することもできる。このような実施形態を図5に示す。【0038】図5において、図1と同一部分に同一符号を付して先の実施形態との相違点のみを説明すると、本実施形態では入力端子200に音声信号が入力される。この入力音声信号は、例えば図1の音声再生部120で再生された音声信号、あるいは音声合成装置によって合成された音声信号であり、先の実施形態と同様の構成のピッチ強調フィルタ131、ホルマント強調フィルタ133、高域強調フィルタ134、ゲイン調整部135および乗算器136によってエンハンスト処理される。【0039】但し、本実施形態では入力信号が音声信号であり、図1の実施形態のように入力信号にピッチゲインのようなパラメータが含まれてないため、入力音声信号をLPC分析部210およびピッチ分析部220を通すことによって、ピッチ制御部132でピッチ強調フィルタ131の伝達関数を設定するのに必要なピッチ周期およびピッチゲインの情報を生成している。その他の点は先の実施形態と同様であるため、説明を省略する。【0040】なお、本発明は人間の発生した音声信号に限らず、楽音信号など様々なオーディオ信号にも適用することもできる。本発明でいう音声信号は、これらの信号を総称するものとする。【0041】【発明の効果】以上説明したように、本発明によればピッチ周期の変化を監視し、それがある程度以上になった場合、ピッチ強調の度合い、すなわちピッチ強調フィルタの係数を変化させることによって強調の度合いを低下させ、場合によっては強調そのものを止めることによってハーモニクスの乱れを抑え、再生音声信号や合成音声信号の音質を効果的に向上させることができる。
ピッチ強調方法および装置 - 株式会社東芝
