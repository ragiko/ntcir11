画像(や選択範囲)のコントラストを増大させて細部を強調するが、ノイズも強調されるおそれがある。このフィルターは下に示した重みづけの因子に従い、各ピクセルを周囲 3x3 の重み付けした平均値で置き換える。
-1 -1 -1
-1 12 -1
-1 -1 -1
Sobel edge detector(ゾーベル・オペレーター;ゾーベルの輪郭検出器)を用いて、アクティブな画像(または選択範囲)内にある急激な輝度変化を強調する。下に示した2つの 3x3 convolution kernel(コンボリューション・カーネル;畳み込みフィルタ)を用いて、垂直および水平導関数(輝度の変化率)を生成する。最終的な画像は、2つの導関数から、その平方和の平方根で作成される。
1  2  1  1  0 -1
0  0  0  2  0 -2
-1 -2 -1  1  0 -1
画像中の局所的な濃度のピーク(=極大値)を決定する。結果の画像は、もとの画像と同サイズのバイナリー画像(マスク画像のような画像)を作成して、そこに極大値をマークする(または、各極大値を「セグメント化された粒子(segmented particle)」としてマークする)。RGB 画像では、明るさの極大値が選ばれる際の輝度値として、色の重みづけを加味した平均を用いるか、重みづけなしの平均を用いるかを、 Editメニュー>Options>Conversions で設定する。このコマンドは Michael Schmid の貢献により作製されたプラグインに基づいている。
ダイアログボックスには下のオプションが表示される:
"Noise Tolerance"(ノイズ耐量) - 極大値が周囲よりもこの値の分以上高くない場合、極大値は無視される(キャリブレーションされた画像では、数値をキャリブレーション単位で指定する)。別の言い方では、「(極大値)−(ノイズ耐量)」に閾値が設定されており、極大の周囲に隣接する部位でこの値が閾値よりも大きい場合に分析対象となる。極大値として認定されるには、このエリア内に極大値よりも高い値を示す点があってはならず、またこのエリア内には極大値はひとつだけが認められる。
"Output Type"(出力形式)は:
"Single Points"(1点) - 極大値ごとに1点のみを結果として出力する
"Maxima Within Tolerance" (ノイズ耐量範囲内の極大値)- それぞれの極大値ごとに "Noise Tolerance"(ノイズ耐量)を超える点をすべて結果として出力する
"Segmented Particles"(セグメント化された粒子) - それぞれの極大部が「粒子」に区分されると仮定し、画像をエリアに区分する。このときの方法は、画像内の輝度値に watershed(分水嶺)アルゴリズムを適用する(一方、Processメニュー>Binary>Watershed では、 Euclidian distance map(ユークリッド・ディスタンス・マップ)を使用する)。
"Display Point selection"(点を選択して表示) - 各極大部ごとに1つの点をプロットし、全体として多数の点の選択範囲を表示する。
"Count"(計数) - Results ウィンドウ内の極大部の数を表示する。
"Exclude Edge Maxima"(境界の極大を除外) - 極大部を取り囲むノイズ耐量エリアが画像の縁(選択範囲の縁は含まない)に接している場合、その極大値を除外する。
"Light Background"(明るい背景) - 画像のバックグラウンドがそれと区別したい対象よりも明るい画像の場合にこれをチェックする。上に挙げた細胞のコロニー(Cell Colony)の画像など。
"Above Lower Threshold"(低い側の閾値以上の場合のみ) - (このオプションは閾値設定した画像のときだけ表示される。) 低い側の閾値を越える極大部のみを検出する。画像の高い側の閾値は無視される。"Output Type" として "Segmented Particles" が選択されているときは、低い側の閾値未満の領域はバックグラウンドとみなされる。
出力される画像は二値化(バイナリ)画像で、対象(前面)の輝度値が255、バックグラウンドが0である。Process メニュー>Binary>Options で "Black Background"(バックグラウンドが黒)オプションを使っているかによって、反転された LUT か通常の LUT が用いられる。出力ウィンドウの粒子の数は、"Analyze Particles"(粒子解析)で得られる粒子数と同様に、"Output Type" の選択には依存しない。注意点は、"Exclude Edge Maxima" が選択されていると、通常 "Segmented Particles" で得られる「粒子」は境界に接することになること。"Exclude Edge Maxima" は極大部に対して適用され、粒子に対しては適用されない。
Find Maxima はスタックでは動作しないが、FindStackMaxima マクロはスタック内の全画像で動作し、出力された画像を含む、もうひとつ新たなスタックが生成される。FindMaximaRoiManager マクロでは、 Find Maxima により検出された粒子がどのように ROI Manager に加えられるかがわかるようになっている。
画像のコントラストを強調する。方法はヒストグラムの伸張(histogram stretching)か、ヒストグラムの均等化(histogram equalization)である。どちらの方法も Hypermedia Image Processing Reference に詳細が記されている。目次で "enhancement" (強調)を検索すること。このコマンドでは、Normalize(標準化)か、または Histogram Equalize(ヒストグラムの均等化)がチェックされていない限りはピクセル値は変更されない。
Saturated Pixels (飽和ピクセル)の値は、画像中で飽和するのを許容するピクセル数を決める。この値を増やすとコントラストが増大する。この値はゼロよりも大きい値にする;これは画像中に、かけ離れた値を占めるピクセルが少しでもあった際に、コントラスト伸張が思ったような結果にならないのを防ぐためである。
Normalize (標準化)がチェックされていると、ImageJ は画像のピクセル値を再計算し、ピクセル値の分布幅がそのデータ型の最大幅になるように、あるいは浮動小数点の画像では 0〜1.0 になるようにする。8ビット画像の最大幅は 0〜255で、16ビット画像では 0〜65535 である。注意点は、RGB画像の標準化はサポートされていないこと。
Equalize Histogram (ヒストグラムを均等化する)をチェックすると、ヒストグラム均等化によって画像を強調する。選択範囲があると、選択範囲のヒストグラムをもとに均等化が行われる。均等化には、ヒストグラム値の平方根を用いる修正されたアルゴリズムが使われる。[ALT]キーを押しながらコマンドを選ぶと、標準的なヒストグラム均等化を用いる。Equalize Histogram がチェックされると、"Saturated Pixels"(飽和ピクセル)と "Normalize" (標準化)パラメータがチェックされていても無視される。均等化のプログラムは Richard Kirk により提供された。
ImageJマニュアル:Process(処理)メニュー - ImageJ日本語情報
