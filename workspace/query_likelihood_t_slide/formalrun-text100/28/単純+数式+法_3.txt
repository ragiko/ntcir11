QlikView(クリックビュー)では単純移動平均法のグラフを見ることができます。
今回はデータ自体を編集し、グラフを作っていきます。
CSVファイルの編集
1.データの元となるCSVファイルを開きます。
2.現在あるデータの右側のセルに『=IF(ROW()>4,AVERAGE(OFFSET(B2,-1,0,-3,1)),NA())』と入力します。
※今回は3期分の移動平均を計算します。
3.セルを選択して出てきた緑色の枠の右下を押し、データのある一番下までドラッグします。
4.保存してCSVファイルを閉じます。
チャートの作成
1.チャートの追加ウィンドウを開きます。
基本設定
1.【チャートの種類】から【折れ線グラフ】を選択します。
2.【次へボタン】を押します。
軸
1.【項目/グループ】から『期』を選択し【追加ボタン】を押します。
2.【軸項目】に『期』が表示されたことを確認して【次へボタン】を押します。
数式の編集
1.入力欄に『sum({<期=>}売上)』と入力します。
2.【OKボタン】を押します。
数式
1.【追加ボタン】を押します。
数式の編集
1.入力欄に『sum({<期=>}移動平均)』と入力します。
2.【OKボタン】を押します。
数式
1.ここで一度【完了ボタン】を押します。
ここからチャートを編集し、グラフを見やすくします。
チャートの編集
1.チャートのプロパティを開きます。
目盛線
1.【数式の目盛線】と【軸の目盛線】の【グリッドの表示】のチェックボックスをオンにします。
2.同様に二つのフォントの色を背景色とは対照の色にします。
色
1.【背景】の【色】の【透過性】を『100%』にします。
プレゼンテーション
1.【チャートのテキスト】の【追加ボタン】を押します。
2.【テキスト】に『=num( 移動平均, ‘000000.’ )』と入力します。
3.【フォント】を適切なサイズ、色に変更します。
4.【OKボタン】を押します。
数式
1.『sum({<期=>}売上)』のラベルを『売上』にします。
2.『sum({<期=>}移動平均のラベルを『移動平均』にします。
3.【OKボタン】を押します。
リストボックスの編集
1.シートに『期』のリストボックスを追加します。
2.『期』のリストボックスのプロパティを開きます。
基本設定
1.【常に一つの選択値】のチェックボックスをオンにします。
2.【OKボタン】を押します。
以上の作業を通して完成した移動平均のシートは下記です。
単純移動平均法｜QlikView(クリックビュー)ナレッジ
