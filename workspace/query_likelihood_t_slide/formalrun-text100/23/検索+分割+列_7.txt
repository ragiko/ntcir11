一つのセルに入力してある「部課名」を、別々のセルに「部名」と「課名」に分けて表示するには、LEFT関数やMID関数などの文字列関数を使う。
LEFT(レフト)関数
=LEFT(文字列,文字数)
文字列の左端から、指定した数の文字を取り出す
SUBSTITUTE(サブスティテュート)関数
=SUBSTITUTE(文字列,検索文字列,置換文字列)
文字列中の、指定した文字を他の文字に置き換える
FIND(ファインド)関数
=FIND(検索文字,文字列)
文字列で検索文字を探し、先頭から何文字目か調べる
MID(ミッド)関数
=MID(文字列,開始位置,文字数)
文字列内の指定した位置から、指定した数の文字を取り出す。文字列の中の何文字目から取り出すかを、開始位置として数値で指定する
例えば、部名がすべて3文字なら、E3セルに「=LEFT(D3,3)」と式を立てれば、D3セルの部課名から部名だけを取り出すことができる(下図)。
部名がすべて3文字の場合
部名がすべて3文字なら、E3セルに「=LEFT(D3,3)」という式を立てれば、D3セルの部課名から部名だけを切り出せる。課名の切り出しは、文字列の置換ができるSUBSTITUTE関数を使う
課名は、文字列の置換ができるSUBSTITUTE関数を使い、F3セルに「=SUBSTITUTE(D3,E3,"")」という式を立てる。これで、D3セルの部課名を調べて、E3セルに取り出した部名を空白(「""」)に置換し、残った課名だけを表示できる。
部名の文字数がまちまちの場合は、特定の文字列が何文字目にあるかを調べるFIND関数と、文字を切り出すLEFT関数を組み合わせて、「部」という文字を基準に切り分ける(下図)。
部名の文字数が揃っていない場合
部名の文字数がまちまちの場合は、FIND関数で「部」が部課名の何文字目にあるかを調べ、LEFT関数で左端から「部」の文字までを切り出す
住所データを、都道府県と市区町村以降のデータに切り分けたい場合は、MID関数で住所の4文字目を切り出し、それが「県」かどうかを調べる。これが真なら「神奈川県」「和歌山県」「鹿児島県」のいずれかなので、LEFT関数で左から4文字取り出す。偽の場合は3文字の都道府県なので、LEFT関数で左から3文字取り出せばよい(下図)。
都道府県だけを取り出すには?
住所から都道府県を切り出す。それには、「MID関数で取り出した住所の4文字目が『県』である」という式を作り、これをIF関数の「条件式」とする。これが真なら「神奈川県」「和歌山県」「鹿児島県」のいずれかなので、LEFT関数で左から4文字取り出す式を、IF関数の「値1」とする。偽の場合は3文字の都道府県なので、LEFT関数で左から3文字取り出す式を、「値2」とする。市区町村以降は「=SUBSTITUTE(E3,F3,"")」という式で取り出せる(G3セル)
日経PC21 / 文字列を分割する
