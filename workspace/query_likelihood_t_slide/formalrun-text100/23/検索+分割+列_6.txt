
注 以下の画像で強調表示されている氏名の部分は、対応する SEARCH 式によって検索される文字列を示します。
名
名は、左端の先頭の文字 (E) から始まり、5 文字目 (最初のスペース) で終わります。次の式は、A2 の左から最初の 5 文字を抽出します。
SEARCH 関数を使用して、"文字数" 引数に渡す値を取得します。
A2 に含まれる最初のスペースの位置を左から検索します (5)。
ミドル ネーム
ミドル ネームは 6 文字目 (S) から始まり、8 文字目 (2 つ目のスペース) で終わります。この式では、2 つ目のスペースを検索するために SEARCH 関数がネストされています。
次の式は、6 文字目の位置から始まる 3 文字を抽出します。
SEARCH 関数を使用して、"開始位置" 引数に渡す値を取得します。
A2 に含まれる最初のスペースの位置を、左端の先頭の文字から検索します (5)。
1 を加算して、最初のスペースの次の文字 (S) の位置を取得します。この位置がミドル ネームの開始位置です (5 + 1 = 6)。
ネストされた SEARCH 関数を使用して、"文字数" 引数に渡す値を取得します。
A2 に含まれる最初のスペースの位置を、左端の先頭の文字から検索します (5)。
1 を加算して、最初のスペースの次の文字 (S) の位置を取得します。この結果は、2 つ目のスペースを検索するときの開始位置になります (5 + 1 = 6)。
A2 に含まれる 2 つ目のスペースを、手順 4. で取得した 6 文字目 (S) から検索します。この文字位置がミドル ネームの終了位置です (8)。
A2 に含まれるスペースの位置を、左端の先頭の文字から検索します (5)。
手順 5. で取得した 2 つ目のスペースの文字位置から、手順 6. で取得した最初のスペースの文字位置を減算します。この結果は、手順 2. で取得した 6 文字目を開始位置として、MID 関数で抽出する文字数を示します (8 - 5 = 3)。
姓
姓は、右から 6 文字目 (K) から始まり、右端の文字 (n) で終わります。この式では、2 つ目と 3 つ目のスペース (左から 5 文字目および 8 文字目) を検索するために、SEARCH 関数がネストされています。
次の式は、A2 の右から 6 文字を抽出します。 
LEN 関数およびネストされた SEARCH 関数を使用して、"文字数" 引数に渡す値を取得します。
A2 に含まれるスペースの位置を、左端の先頭の文字から検索します (5)。
1 を加算して、最初のスペースの次の文字 (S) の位置を取得します。この結果は、2 つ目のスペースを検索するときの開始位置になります (5 + 1 = 6)。
A2 に含まれる 2 つ目のスペースを、手順 2. で取得した 6 文字目 (S) から検索します。この文字位置がミドル ネームの終了位置です (8)。
A2 に含まれる文字列全体の長さを取得し、その文字数と、手順 3. で検索した 2 つ目のスペースまでの左からの文字数との差を求めます。この結果は、氏名から抽出する右からの文字数になります (14 - 8 = 6)。
ページの先頭へ
使用例 3: Janaina B. G. Bueno
この例には、2 つのミドル ネームが含まれています。名前の構成要素は、最初と 3 つ目のスペースによって区切られます。
関数を使用してテキストを列単位で分割する
