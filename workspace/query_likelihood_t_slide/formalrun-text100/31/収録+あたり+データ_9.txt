エムエスツデー 2007年5月号
バッチ機能を搭載した2048点対応 PCレコーダソフトウェア
MSRpro(形式:MSR2K-V5)
(株)エム・システム技研 開発部
は じ め に
近年、環境問題のクローズアップとともに省エネルギー対策への取り組みが進み、エネルギーコストの削減は重要な課題になっています。工場全体の消費エネルギーを削減するため、単位ロットあたりの消費エネルギーを計測・監視して対策をとる場合が増えています。
エム・システム技研では、すでに2048点対応 PCレコーダソフトウェア MSRpro(エムエスアールプロ、形式:MSR2K)注1)を発売し、お客様からご好評をいただいています。この MSRpro に、単位ロットあたりのデータ収録を簡単に実現できるバッチ処理機能を追加することによって、製品の製造工程におけるデータ収録を条件や設備毎に行う場合、あるいは製品1ロット分の作業単価を算出する場合など様々な用途でご使用いただけると考えました。
今回は、MSRpro バージョン5(MSR2K-V5)に追加したバッチ処理機能を中心にご紹介します。
1.バッチ収録機能
MSRpro は、サーバ/クライアント方式を採用しており、サーバソフトウェア(以下 Server と記述)にてデータ収録し、クライアントソフトウェア(以下 Client と記述)にてデータ表示・解析を行うパソコン記録計です。
今回、指定条件の下に Server からデータを取得し、CSV形式ファイルで保存する機能を Client に追加しました。この機能を「バッチ機能」と呼びます。詳細仕様は、別途仕様書にてご確認ください。 
(1)MSRproに追加したバッチ機能     
Server で収録中のデータから、1グループ(最大32ペン)毎に、指定開始条件から指定終了条件までのデータを1ファイルとして取得し、任意のフォルダにCSV形式ファイルにて保存します。 
(2)ファイル名    
バッチ機能にて収録する場合、収録毎にファイル名を設定できます。具体的には、「固定ファイル名+収録開始時刻」あるいは「固定ファイル名+毎回キー入力するファイル名」を設定します。キー入力の代わりにバーコードリーダーの入力文字をファイル名として設定することもできます。 
たとえば、「固定ファイル名+収録開始時刻」設定を利用して、タンク内温度を計測する場合、固定ファイル名をグループごとに「タンクA」、「タンクB」…と設定して収録を行うと、各タンクの収録開始時刻をファイル名として各ファイルが作成されます(図1参照)。
(3)収録状況の表示    
現在の収録状況を一覧表示します。
図1に示すように、収録中枠が赤色表示の場合は収録中であることを表します。収録状況のほか、収録開始時刻、収録条件なども表示します。
(4)バッチ収録中の表示    
バッチ機能にて収録するデータの波形は、既存のトレンドグラフ画面に表示します。標準の収録データと区別するため、バッチ収録時間帯は、設定した背景色でトレンドグラフ画面に表示されます(図2参照)。 
(5)比較表示     
バッチ機能を使用して過去に収録した値と、現在の収録値との波形比較表示を行います。バッチ収録開始の時間軸より、指定した比較元波形を同時に表示します。比較元ファイルの内容を理想値に編集することで、理想値と現在値の比較が可能です(図3参照)。
また、比較データは2ファイルまで設定可能であるため、比較元ファイルを上下限理想値に編集し、図4に示すように表示できます。
(6)収録の条件    
収録の開始条件・終了条件としては、ボタンクリックをトリガとする「手動」、外部機器からの立ち上がり/立ち下がり信号あるいは積算カウンタカードからの出力(変化信号)注2)をトリガとする「入力」、時刻を設定する「時間」などがあります。また、各条件の組み合わせは自由に設定できます。たとえば、収録開始後30分で終了する場合、開始条件を「手動」、終了条件を「時間」に設定します。
このようなバッチ機能を利用することによって、簡単にグループ単位での集計が可能になりました。
たとえば、製造工程における熱処理時の品質管理用データとしてファイル保存する場合があります。複数台の炉のデータを収録する場合、図5に示すように、炉内温度など各種必要データをリモートI/O R3シリーズにて収録し、バッチ機能を利用して、炉の区別およびロット番号をファイル名に設定し、各データを保存します。
2.その他の新機能
バッチ機能以外にも、入力点数の多いシステムを構築する場合を視野に入れ、以下に列挙する新しい機能を追加しました。
(1)一括設定Excelツール     
ペン一括設定、アラーム一括設定をExcel上で編集できるマクロ機能を利用したツールを用意しました。MSRpro 用設定ファイルを Excel 上に展開し、編集後、MSRpro 用設定ファイルに変換します(図6参照)。通常の Excel 操作と同様に、セル単位でのコピー/ペーストや編集作業が簡単に行えます。編集後は、エラーチェックを実施し、チェック結果を別シートに表示します。 
(2)クライアント接続数の表示     
Server に、現在の Client 接続数を表示します。Server PC 1台に対し、Client PC を複数台接続する場合に便利です。 
(3)Server自動切換    
複数台の Server PC を、1台の Client PC で切り換えてデータ表示する場合、ワンタッチで接続先 Server PC を自動的に切り換えます。 
お わ り に
今後も、電力マルチメータや各種リモートI/O のデータに対応するなど、記録計として様々な用途でご利用いただけるソフトウェアをご提供したいと考えています。どうぞご期待ください。
注1)「MSRpro」については、『エムエスツ デー』誌2005年3月号および4月号、2006年2月号および3月号でもご紹介しています。 
注2)幅が狭い(1s未満の)パルス信号はトリ ガ入力として使用できません。このような場合、パルス信号を積算カウンタ用 I/Oカード(たとえば形式R3-PA4A)に入力し、得られる出力変化信号をトリガ信号として使うことができます。
エムエスツデー｜バッチ機能を搭載した2048点対応 PCレコーダソフトウェア MSRpro(形式:MSR2K-V5)
