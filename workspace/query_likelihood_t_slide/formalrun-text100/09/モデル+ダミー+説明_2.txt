パネルモデルの直感的説明
社会学, 社会調査
こちらでは24時間ぶっつづけでハイチ地震のニュース。他のニュースはもうほったらかしです。CNNのクーパーさんも(例によって)現地に入ってレポートしています。
本題。マルチレベルデータが徐々に社会学でも使われるようになってきてますが、マルチレベル・モデルを含めてその分析手法についてはまだちょっと浸透していない段階だと思います。
とある科研で「研究会(教育?)担当」になっていることもあり(外国にいて現状全く貢献できてませんが)、手法についての分かりやすい(数式を使わない)解説を試みます。さしあたりランダム効果モデルと固定効果モデル、いわゆるパネル・モデル。直感を優先しているので必ずしも正確ではない記述もあります。
モデル選択の概要
ここに典型的なマルチレベルデータがあります。横軸が所得、縦軸は、なんでもいいのですが、パネルデータっぽくするために消費にしてみます。(単位は適当に想像して下さい。)
個人ごとのOLS回帰直線が実線。全体(pooled data)の回帰直線は点線です。一見同じに見えますが、個々の傾きの平均よりも少しだけ傾きがきつくなっています。
所得と消費には個々人を通じてほぼ同じ程度のプラスの関係がありますが、消費のレベル(切片)が個人によって異なることがわかります。これらを何らかの他の(観測された)変数によって説明できる可能性もありますが、その場合でも観測不可能な変数の影響が残ると考えられます。パネル分析ではこれらの影響をまとめて「個別効果」と呼びます。個別効果は、すべての個人の個人ダミー変数による効果だと考えます。「個別効果を取り除いて本来の正しい回帰係数を推定するにはどうしたらいいか?」というのが、パネルデータ分析の発想の出発点にあります。
ある説明変数のOLS推定量が不偏性(推定量の期待値が真の値=母数に一致していること、要するにズレていないこと)をもつ前提にはいくつかありますが、次の2つは重要です。
攪乱項がすべて同じ分散をもっており、かつ互いに相関していない(共分散成分がゼロである)こと。
説明変数がランダムではないこと。あるいは説明変数と攪乱項の相関がないこと。
1の違反としては、攪乱項の分散が均一ではない状態(分散不均一)、攪乱項どうしの相関がゼロではない状態(自己相関)があります。2の「説明変数がランダムではない」というのは、実際のデータでは実現が難しいので、たいていは緩められて「説明変数がランダムでもいいが、攪乱項と相関を持たないこと」という条件に代えられるわけです。
パネルデータに普通にOLSを適用すると、これらの理由からちゃんとした値を返さない可能性があります。まず1についてみると、パネルデータでは個対内での誤差相関が無視できない可能性が高いため、これを調整してやることが必要になります。上の例でも個人ごとのまとまりが顕著にありそうですね。これを行うには、通常の攪乱項を「個体間」のものと「個体内」のものに分割してやる方法があります。上の例で言えば、まず個人の消費がランダムに決定され、さらに個人内でみたとき、所得で説明できない消費の攪乱項が生じる、と考えるわけです。これをランダム効果モデルといいます。
しかしこれだけだと、2の問題に対処できません。つまり、説明変数と攪乱項に相関があると考えられる場合、ランダム効果モデルは適切な回帰係数を返してくれません。
そこで、いっそのこと個別効果を一挙に除去してしまおう、というモデルが必要になります。これが固定効果モデルです。固定効果モデルとは、被説明変数、説明変数、残差のそれぞれの個人ごとの平均を回帰式から引き算した式を推定したものです。個人効果を取り除くには(すべての)個人ダミーを投入してもいいです。こちらはLSDV(Least Squares Dummy Variable)モデルと呼ばれています。どちらのやり方でも、回帰係数の値と誤差の大きさは同じになります。
「固定効果モデルは1と2の両方に対処できるのだから、常に固定効果モデルを使う、でいいんじゃないの?」という疑問が出てきます。しかし固定効果モデルには次の二つの欠点があります。
自由度が減るので、誤差が大きくなる(効率性が悪くなる)。特に固体(まとまり、ここでは個人)の数が多いときには、自由度が極端に小さくなります*1。これはN-1個のダミーを投入するLSDVでも、個々の平均を引く固定効果モデルでも同じです。
固体に共通した効果(ここでは個人属性、たとえば性別や学歴など、観察期間中に変わりにくい属性の効果)が個人ダミーに吸収されてしまう。特に平均を引くモデルだと、推定から完全に除外されてしまう。
これらの理由から、「説明変数と攪乱項の相関が認められないなら、ランダム効果を使いましょう」という処方箋になるわけです。
以上が簡単な説明ですが、統計学の教科書だけの知識だけだと、前の記事で触れたとおり、「攪乱項の相関ってなんやねん」「説明変数と攪乱項が相関しているってどういうことやねん」という疑問が湧いても不思議ではありません。ちゃんと説明するとややこしいし、そんな能力もないので、 少々極端な例を使って直感的に説明してみます。
下の図の左側は、色が一つの個人を表しており、それぞれ一人の個人についての4時点でのデータを表しているとします。みればわかるようにバラバラで、個人ごとのまとまりは認められません。こういうときには、データを個人ごとにまとめて考える必要はないわけです。誤差は個人と時点のそれぞれでランダムに生じており、OLSを使って普通に推定しても問題ありません。
他方右側を見ると、今度は個人ごとのデータのまとまりが強いことが分かります。こういう場合にOLSを使うと何が問題なのかというと、誤差を過小に見積もってしまうということです。例えばクロスセクションの調査で、調査員が対象者の消費支出を尋ねていったん家を後にします。ふと引き返して、同じ質問を聞かれたら、その人はおそらく同じ答えをするでしょう。にもかかわらず、「サンプルが一つ増えた」と喜ぶわけにもいきません。一回目の値と二回目の値は、二つの独立したデータではなく同じデータ、少なくともまとまりを持ったデータとしてとらえる必要があります。このまとまりを「偶然」だとみなすのは、ちょっと不自然ですね。
要するに、パネルデータをプールしてOLSを使うと、繰り返し調査や「似たもの」調査によってサンプルを不当に増やす可能性があり、その場合には(特に切片の)誤差を過小評価してしまいます。というわけで、ランダム効果モデルによって攪乱項の相関を統制してやる必要が出てくるわけです。
ところが、すでに述べたようにランダム効果モデルは「説明変数と攪乱項に相関がない」という前提でしか、適切な推定値を返しません。この「説明変数と攪乱項のあいだの相関」があるとかないとかいうのは、どういう状態なのでしょうか。次の二つの図を見て下さい。
左の図では、消費(Y軸)のレベル(切片)の変動は所得(X軸)には影響されず、単に個人の特性(個別効果)に左右されるだけです。しかし右の図では、所得の大きさと消費のレベルが関係していることが分かります。X軸の右に位置している個人ほど消費のレベルも高いわけです。このときランダム効果モデルを使うと、個別効果(切片)は個人レベルの攪乱項に吸収されますが、この攪乱項が説明変数と関係していることになります。ここでは所得が高いほど、攪乱項はプラスになります。説明変数と攪乱項が相関している、とは簡単に言えばこういうことです。
固定効果モデルであればこの個別効果をすべてダミーに吸収させ、攪乱項は純粋に個人内の攪乱項になりますから、推定には問題はありません。(当たり前ですが、固定効果で取り除けない個体内変動については話は別ですよ。)
ちょっと乱暴な言い方をすると、個人ごとにまとめて散布図を描いたとき、説明変数に個人間のばらつきがあるようにみえるときは、たいていランダム効果モデルは使えないといっていいでしょう。このときは固定効果モデルを使うか、思い切って説明変数を個人ごとに中心化してしまうという手があります。(上の例の場合、個人ごとに中心化すると右図は左図のようになります。)			マルチレベル分析ではしばしば「グループ中心化」が推奨されますが、特に説明変数にグループごとのばらつきがあるときは有効かもしれません*2。
ちょっと走り書きですので、厳密には間違っている箇所もあるかもしれません。きちんとした説明は北村先生の本などをごらんになって下さい。
*1:「自由度」というのは「推定に利用できる値の数」のことです。Y=α+βX+eという回帰式では、最低2個の観察値が必要になりますが、このときの自由度は0です。このとき、決定係数は1になって一見幸せな状態に見えますが、誤差の計算に必要になる分散が無限大ということになり、推定値は全く当てになりません。他方で10個の観察値を準備できたとしても、9個の説明変数を投入してしまうとやっぱり自由度は0になり、誤差が無限大になります。LSDVモデルで個人ダミーを投入するということはかなりの数の説明変数を投入することになりますから、モデルの説明力は上がるのですが、自由度が個人数マイナス1分だけ小さくなり、その分回帰係数の精度が下がってしまうわけです。
*2:ちなみに全体中心化はランダム係数を導入するときのみ意味があります。
パネルモデルの直感的説明 - 社会学者の研究メモ
