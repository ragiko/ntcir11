
オートフィルタを操作した時に、フィルタで抽出された条件の合計を常に表示させる
SUBTOTAL関数を使う。
(画像をクリックすると、実際にExcelが開きます)
この例の表は、上の「小中大計」のサンプルで使ったものの中間計とグループを全て削除したもので、明細内容は全く同じです。「合計」に入っている式は上の表の「総合計」と全く同じです。
オートフィルタを各分類列に設定して、「部門1」「分類1」「分類C」で抽出すると、合計の値も変化し、フィルタ抽出された分だけの合計となります。これもSUBTOTAL関数の特徴です。
※R1C1参照形式の場合は
計算式(オートフィルタで抽出された分だけの合計)
