前回、VBA から Excel のシートにアクセスする方法を学んだ。
この機能を用いると、様々な数学的な操作を Excel 上で行うことができるようになる。
ここでは「微分方程式の数値解法」を取り上げ、VBA (および Excel) 学習の総仕上げとする。
微分方程式の数値的に解くのは、「Excel のみを使う方法」と「VBA と Excel を組み合わせて使う方法」のどちらでもできる。
ここではその両方を取り上げ、その違いを体感してもらう。
準備
Euler 法で数値解を求めてみる
数値解と解析解を比較してみる
準備
本日取り扱う微分方程式は以下のものである。
この微分方程式は、ばね系に周期的な外力が加わっている系の運動方程式
において、質量 m、ばね定数 k、外力の大きさ F、外力の振動数 &omega; に対し、
以下の制限を設けたものである。
この微分方程式 (運動方程式) は 2 階微分を含むが、これを数値的に解くためには
1 階微分のみの微分方程式に変換する必要がある。
そこで、以下の 2 変数 x1、 x2 を導入する。
(それぞれ、ばねの変位、速度を表す)
これらについて、以下の 1 階微分方程式が成り立つ (確認してみるとよい)。
(微分の階数が 2 階から 1 階に落ちている変わりに、変数が一つ増えている)
この形の微分方程式を一般化して以下のように書くことができる。
ここで、微分係数に対して以下の近似式を代入すると、
以下の式が得られる。これは、時刻 t における系の状態 (x1(t), x2(t)) から、時刻 t +&Delta;t における系の状態
(x1(t+&Delta;t), x2(t+&Delta;t)) を求める式である。
この手法を Euler (オイラー) 法と呼ぶ。
この手続きを繰り返すことで、任意の時刻の系の状態を知ることができる。
また、このように微分方程式を数値的に解くことを数値積分する、などと言う。
なお、上記の議論は本日の内容の背景の解説としてつけたのものであり、本講義では覚える必要はない。
Euler 法で数値解を求めてみる
では、実際に Euler 法で数値解を求めてみよう。
冒頭で述べたように、ここでは Visual Basic によるプログラミングを使わず、
Excel の機能のみを使って実現してみよう。
Excel の操作法としては新しいことは学ばないので、これはExcel 利用法の復習と思って欲しい。
(詳細は
Office 2003 の基礎
参照)
まず、準備として、第 1 列に以下のように「t」、「x1」、「x2」、「f1」、「f2」、「dt」と記述しよう。
この位置を合わせないと、以下の式も各自変更する必要があるので、図と同じ位置のセルを利用すること。
次に、時間 t、位置 x1、速度 x2 に初期値として 0 を記述し、数値積分の時間刻み dtに 0.01 を記述しよう。
次に、f1(x1, x2, t) = x2 を実現するため、セル D2 に
微分方程式の数値的解法 (1) Excel のみの方法
