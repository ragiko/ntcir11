Query AS/400 用 Query のリストの処理
リスト (この場合には Query のリスト) を処理する場合に、Query は、ユーザーにとって役立ついくつかの機能を提供します。その一部を以下に示します。 
別のライブラリーまたはライブラリー・グループのすべての Query を表示するには、
ライブラリー ・プロンプトの値を変更し、
サブセット ・プロンプトにブランクまたはアスタリスク (*) をタイプして、実行キーを押します。そのライブラリーまたはライブラリー・グループに存在する Query で、ユーザーが使用権限を持っているすべての Query が表示されます。
(調べたいライブラリーを指示するには、ライブラリー・ プロンプトにライブラリー名、特殊なライブラリー名 [*LIBL など]、または総称ライブラリー名 [ABC*の形の] を指定します。)
Query 名の特定のサブセット (より小さいグループ) を表示するには、
サブセット ・プロンプトに総称名 (ABC* など) をタイプし、実行キーを押します。見つけたい名前の最初のいくつかの文字がわかっている場合には、探索に必要な時間をこの機能によって節約することができます。
複数のライブラリーに特定の名前の Query が入っているかどうかを調べたい場合には、
サブセット・ プロンプトにその名前をタイプし、
ライブラリー・ プロンプトに *ALL をタイプして、実行キーを押します。その名前の Query で、ユーザーが使用権限を持っているすべての Query が表示されます。
リストを特定の名前で位置指定したい場合には、
位置指定 プロンプトにその名前 (またはその名前の開始文字) をタイプします。この機能も、名前の探索に必要な時間を節減します。
さらに、これらの機能を組み合わせて、同時に使用することもできます。たとえば、ライブラリー・ プロンプトに別のライブラリー名、総称ライブラリー名、または特殊なライブラリー名を指定し、
サブセット・ プロンプトにサブセット値 (Query 名の) を指定し、
位置指定 プロンプトに特定の Query 名または名前の開始文字を指定して実行キーを押し、必要な Query 名のサブセットのリストを表示することができます。
以上の機能について、次の各項で説明します。
リストからの Query AS/400 用 Query 名の選択
Query のリストを処理する場合に、次のいずれかの方法で Query を選択することができます。
リストの先頭の欄を使用して、作成または使用したい Query の名前 (およびライブラリー 欄が表示されている場合はライブラリー名) をタイプすることができます。
(既存の Query を選択するには、それが使用可能でなければなりません。
特定の Query AS/400 用 Query を探して使用する場合のその他の考慮事項の項を参照してください。)
Query の作成時には、新しい名前をタイプする前に、このリストを調べて、どのような名前がすでに使用されているかを確認することができます。その後で、最初のリスト位置 (入力フィールド) に新しい名前をタイプし、その前の OPT 欄に 1 をタイプします。
Query ( 1 つまたは複数) の前の OPT 欄にオプションをタイプして、リストの 1 つまたは複数の Query を処理することができます。
(Query を選択するには、そのプログラムが使用可能でなければなりません。
特定の Query AS/400 用 Query を探して使用する場合のその他の考慮事項の項を参照してください。)
Query AS/400 用リストのサブセットの使用
サブセット・ プロンプトを使用して、
Query 名のより小さいグループ (サブセット) を調べることができます。これを行うには、調べたい Query のグループを識別する開始文字 (ABC* など) をタイプして、実行キーを押します。指定したライブラリーまたはライブラリー・グループ内の、指定した文字で始まる名前を持つすべての Query が表示されます。たとえば、サブセット・ プロンプトに IN* をタイプすると、
INTEREST、INTFEB、INTMARCH、INVENTORY、INVFEB、INVMARCH などの Query 名が表示されます。
(Query は、各ライブラリーごとにアルファベット順で表示されます。)
サブセット・ プロンプトには、完全な名前 (* を使用していない名前) を指定することもできます。前の例に続いて、INVENTORY という名前の Query が入っているライブラリーを調べたい場合には、
サブセット ・プロンプトに完全 Query 名として INVENTORY をタイプします。
前に表示されていたリストに戻りたい場合には、サブセットの値をブランクにして (あるいはサブセットの値として * をタイプして)、再度実行キーを押します。
Query AS/400 用 Query のリストの位置指定
Query 名のリストが表示される場合には、その名前は各ライブラリーの中でアルファベット順に表示されます。
リストの位置を先頭または終わりに位置指定するには、特殊値 *TOP または *BOT を使用します。長いリストの場合には、特定の Query 名からリストが始まるように、リストを移動 (位置変更) することができます。これを行うには、位置指定 プロンプトに次のいずれかをタイプします。
既存の Query の完全名。
名前の最初の 1 字または複数の文字。
実行キーを押すと、Query は、指定した完全名 (または特定のライブラリー・リスト内で指定した開始文字を持つ最初の名前) がリストの先頭として表示されます。
ライブラリー 欄がなく、指定した文字で始まる Query 名がリストにない場合、Query は、もしその名前があれば表示されるはずの位置の直前にリストを移動します。ただし、ライブラリー 欄が存在し、
位置指定 プロンプトの値と完全に一致する Query 名がない場合には、リストは位置変更されません。
Query の長いリストを移動するために、次の 2 つの方法を使用することもできます。
前ページ・キーおよび次ページ・キーを使用して、リストを正方向または逆方向に送ることができます。
F19 (次のグループ) キーを使用して、次のライブラリーの Query 名リストの始めに進むことができます。
F11 の使用による Query AS/400 用 Query に関する追加情報の表示
リストが表示されている場合、F11 (テキストの表示) キーを使用して、項目名だけ (Query、フィールドなど) のリストと、項目名と各項目を記述するテキストのリストを、交互に表示することができます。
F11 キーを押すと、テキスト (項目の作成時または変更時にテキストが指定されている場合) が、リストの各項目名の後に表示されます。他の追加情報が表示される場合もあります。たとえば、Query のリストでテキストを表示すると、各 Query の作成日または最後の変更日も表示されます。
F11 キーを押したときに、「Query 処理」画面がどのように表示されるかの例を次に示します。
Query 処理                                       
ライブラリー . . . . .    QGPL         名前、 *LIBL、リストは F4               
サブセット . . . . . .    __________   名前、総称 *                            
位置指定 . . . . . . .    __________   開始文字                                
オプション (および Query 定義) を入力して、実行キーを押してください。          
1= 作成   2= 変更   3= コピー   4= 削除   5= 表示   6= 定義の印刷             
8= バッチでの処理   9= 実行                                                   
OPT  Query           テキスト                                      変更        
_   __________                                                                
_   ACCTPAYFEB      買掛管理 − 2月度                             88/02/29    
_   ACCTPAYMAR      買掛管理 − 3月度                             88/03/31    
_   ACCTRECFEB      売掛管理 − 2月度                             88/02/29    
_   ACCTRECMAR      売掛管理 − 3月度                             88/03/31    
_   INTFEB          得意先別利益計算累計 − 2月度                 88/02/29    
_   INTMAR          得意先別利益計算累計 − 3月度                 88/03/31    
_   INVFEB          月末在庫  −  2月度                           88/02/29    
_   INVMAR          月末在庫  −  3月度                           88/03/31    
_   PAYROLLFEB      給与合計 (日ごと)  −  2月度                  88/02/29    
続く ...   
F3= 終了      F4= プロンプト   F5= 再表示    F11= 名前のみの表示               
F12= 取り消し   F19= 次のグループ                                              
Query/400 ご使用の手引き
