ファイルのバックアップなど定期的に繰り返し実行しなければならない作業は、Windows OSの標準機能「タスクスケジューラ」で自動化しよう。ウィザードを利用すれば、簡単にプログラム起動のスケジュールを組むことができる。
解説
コンピューターを使って業務をこなしていると、毎日ほとんど同じことを繰り返している作業も少なくない。代表例としてはファイルのバックアップが挙げられるだろう。こうした作業を手動で繰り返すのは非効率かつ面倒なので、できる限りコンピューターに自動実行させたいところだ。
定例の作業を自動化できる機能として、Windows OSには「タスクスケジューラ」が標準で装備されている。本稿ではWindows 7/8/8.1とWindows Server 2008 R2/2012/2012 R2を対象に、このタスクスケジューラを利用して定期的にプログラム起動を繰り返すための基本的な設定手順を説明する。
Windows XP/Windows Server 2003におけるタスクスケジューラの基本的な設定手順については、TIPS「タスクスケジューラとWSHで定例処理を実現する」を参照していただきたい。
操作方法
本稿では、Windows 7/8/8.1やWindows Server 2008 R2/2012/2012 R2のタスクスケジューラを利用して、毎日決まった時刻に特定フォルダーをファイルサーバーへバックアップするタスクの作成手順を紹介する。プログラムを差し替えれば、バックアップ以外のタスクも同様の手順で作成できる。
以下の画面はWindows 7のものだが、特記しない限りWindows 8.1など他のWindows OSと操作方法は共通だ。
タスクスケジューラの設定画面を開く
タスクスケジューラの設定をするには、まずコントロールパネルから［システムとセキュリティ］−［管理ツール］をクリックし、［タスク スケジューラ］をダブルクリックしてタスクスケジューラの設定画面を開く。Windows 8/8.1/Windows Server 2012/2012 R2の場合は画面左下隅にカーソルを移動して右クリックするとクイックアクセスメニューが表示されるので、［コントロール パネル］を選択してから、同じようにして［タスク スケジューラ］を開く。コントロールパネルのアプレットがアイコン別に表示されている場合(［表示方法］が「大きいアイコン」か「小さいアイコン」の場合)、［管理ツール］−［タスク スケジューラ］とクリックすればよい。
Windows XP/Windows Server 2003では、タスクスケジューラのUIはWindowsエクスプローラーの特殊なフォルダーだったが、Windows Vista以降ではこのようにMMC(Microsoft管理コンソール)ベースの管理ツールとして実装されている。ただし、「管理ツール」といっても、管理者権限の無い一般ユーザーのアカウントでもタスクが作成できることは共通だ(一部の機能は管理者権限が必要)。
新たにタスクを作成する
新しくタスクを作成するには、タスクスケジューラの左ペインのツリーで［タスク スケジューラ (ローカル)］フォルダーを選択してから、右側の操作ペインで［基本タスクの作成］をクリックする。これでタスク作成ウィザードが起動する。なお、これで作成されるタスクはログオン中のユーザーアカウントの権限で起動されるように設定されるので、これから登録するプログラムが正しく実行できる権限を持ったユーザーアカウントであらかじめWindowsにログオンし、以下の作業を進めること。
Windows TIPS:タスクスケジューラの基本的な使い方(Windows 7/8/8.1編) - @IT
