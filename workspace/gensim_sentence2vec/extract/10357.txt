
1.ダウンロードとCVSファイルのエクセルへのファイル変換
1-1. CSVファイルのダウンロード
(NetScape Navigatorを使った場合の操作例ですが、Windows、Internet Explorerでも操作に大きな違いはありません)
・[CSVファイル(guuzen.txt)] 
のところを右クリック(Macではcontrolを押しながらクリック)。
・ダイヤローグボックスが出てきたら、「対象をファイルに保存(リンクを別名で…)」を選択し、ハードディスクディスク(デスクトップ上)またはフロッピィに「guuzen.txt」のままで保存する。
1-2. CSVファイルをエクセルのファイルにする
・CSV(Comma Separated Value)は、以下のような形式となっている。
対話者対,行#,発#,*?,分,TB,C1,C2,発言者,発言内容
1.中男-日男,1,1,*,0,1,PO,RI,COM1,お名前?。
1.中男-日男,2,2,*,0,1,PO,,JYM1,あっ、JYM1です。
1.中男-日男,3,3,*,0,1,PO,,COM1,あっ、ヤッ[姓の初めの音節]、COM1です。
1.中男-日男,4,4,*,0,1,PO,,JYM1,##します。
1.中男-日男,5,5,*,0,1,PO,,COM1,##します。
1.中男-日男,6,6,*,0,1,PO,RI,COM1,/沈黙23秒/国文ですか?。
1.中男-日男,7,7,*,0,1,?,,JYM1,いや、僕は理学部地理学科。
1.中男-日男,8,8,*,0,1,PO,,COM1,あっ、地理なんですか。
1.中男-日男,9,9,*,0,1,PO,RI,COM1,/沈黙4秒/何年生ですか?。
・これをエクセル形式にする
(CSVファイルはエクセルでもアクセスでもファイルメーカーでも開けるが、ここではエクセルを使用する)
([エクセルデータ(guuzen.xls)]をダウンロードするとエクセルでのみ使用可能)
a. エクセルを起動する。
b. 「ファイル」から「開く」を選び、「guuzen.txt」を選択する。
c. テキスト ファイル ウィザード1/3が現れるので、「元のデータ形式」で「カンマやタブなどの・・・」を選択。「次へ」
d. 同2/3で、「区切り文字」を「カンマ」に設定。
e. 「完了」を選択すると、行列の幅がデフォールトに設定されたままのエクセルファイルが現れる。
1-3. エクセルファイルの整形
1-3-1.フォントとフォントサイズ
行列を表示している左上の空白のボタン(Select All)を押す。
メニューバーの「フォント」を「MS明朝」、「フォント・サイズ」を「10」にする(何でもいいのだが・・・)。
1-3-2.列幅・縦位置調整
A〜J列の列表示セルの左端にカーソルを置き、ダブルクリックすれば列幅を自動調整してくれる。
J列については全体の印刷時の便宜を考え次の手順を踏む。
1.プルダウンの「ファイル」から「用紙設定」を選び「印刷向き」を「横」にして「OK」。するとワークシートに点線が現れるが、これが紙1枚の大きさ。
J列についてはページ区切りのぎりぎりまで横に伸ばしておく。
2.折り返し:53行目等を見ると点線の範囲を越えている。「J列」を選び、プルダウンの「書式」から「セル」を選択。「配置」の中の「文字の制御」から「折り返して全体を表示する」を選択して「OK」。これでJ列は折り返し表示となった。
3.縦位置調整:53行目等の折り返した行は下詰めになっていて見にくい。「Select All」を選び、プルダウンの「書式」から「セル」を選択。「配置」の中の「縦位置」を「中央揃え」とする。以上終わったら「OK」。これで縦も見やすくなった。
1-3-3.枠
さらに見やすくするため格子をつける。「Select All」にして、メニューバーの2段目右から3番目の「罫線」の中から格子状のアイコンを選択。
1-3-4.色づけ
列ごとに好きな色にする。メニューバー2段目の右端。
1-3-5.検索・抽出作業のための空白行の挿入
今後行っていく各種の検索・抽出作業では、2行目が空白になっていないと(=列のタイトルとデータが分かれていないと)エクセルはうまく作動しない。2行目の「2」をクリックしてプルダウンの「挿入」から「行」を選ぶ。
以上全てが終わったらプルダウンの「ファイル」から「保存」を選びハードディスクやフロッピィなどにエクセルのブック形式で保存する。
2.ファイルの構造
2-1.「偶然初対面」の構造
「偶然初対面」は1枚のシートからなるファイル(ブック)である。今回扱う8対の自然会話全体のデータが入っているのは1枚目のシートで、10列(A〜J)、1428行からなる。8対の自然会話が行分けされて含まれている。
各列の意味は次の通りである。
A: 対話者対
B: 行# 行番号C: 発# 発話文番号D: *?  (発話終了)E: 分 (経過分)F: TB  (Time Block)G:
C1  (コーディング1:スタイル)H: C2  (コーディング2:機能)I: 発言者J: 発言内容
2-2.コーディング内容について
2-2-1. G: C1  (コーディング1:スタイル) 
PH:相手に対する尊敬語、謙譲語が含まれる発話。(Polite Honorific/Humble)
PO:敬体(です、ます)、改まったことばを含む発話。「はい」など(「うん」や「ええ」  など、ぞんざいで一般的な同義語があるのに)改まったことばを使用している発話文もこの範疇とする。(POlite)
NP:常体(だ、である)、くだけたことば等を含む発話。(Non-Polite)
?:上記のような文体を示すマーカーがない発話。
2-2-2. H: C2  (コーディング2:機能)
GI:自発的情報提示。質問されてもいないのに自分から進んで自分に関すること、その場の状況に関すること等について情報を提示している発話文。Giving 
Information
RI:情報要求。相手からの情報を要求する発話で、多くの場合質問の形をとる。Requesting Information
空白:上記のどちらでもない発話。
3.オートフィルタによる簡易検索
コーディング内容が選択肢的なものの場合、「オートフィルタ」機能を用いれば簡単に各選択肢に相当するデータ(行)を抽出し、度数を調べることができる。また、この抽出は重ねて行うことができる。
課題1:8組の会話全体で、序盤・中盤・終盤の行数と発話文数を調べる。(結果はメモする。)
2行目(空白行)の「2」をクリック。プルダウンの「フィルタ」から「オートフィルタ」を選択する。シートの2行目に選択肢表示ボタンが現れる。その中の適当な項目を選ぶと度数がシートの左下に現れる。
4.発話に含まれる語句の簡易検索
課題2:最近「ていうか」という表現が、逆接的な文脈でなくとも使われているといういう。データの中から「ていうか」を検索・閲覧していき、大まかな傾向を見る。
4-1.シートの分割
1行目のデータのタイトルは常に見えていた方が分かりやすい。「guuzen.xls」のシートの3行目をクリックし「ウィンドウ」の中から「ウィンドウ枠の固定」を選択する。するとシートが二つに分割され、タイトル行が常に表示される(既習の「オートフィルタ」についてもシートを分割しておいた方が分かりやすい)。
4-2.語句の検索
発言内容が始まるJ列3行目(「お名前?。」)をクリックしておく。「編集」の中から「検索」を選択すると検索用のウィザードが現れる。「検索する文字列」の中に「ていうか」と入力する(この検索機能では「ていうか」の前後にどんな文字列が入っていても検索してくれる)。以上の準備が整ったら「次を検索」をクリックする。すると、327行目のデータがアクティブ(色枠で囲まれる)になる(もし、検索ウィザードと重なって見にくい場合にはウィザードをずらす)。もう一度「次を検索」をクリックすると332行目がアクティブになる。332行目は「自分からっていうか」の「ていうか」が検索されており、課題1とは合わない。この項で紹介している検索機能は1セル全文中の部分一致に限られている。
5.「オートフィルタ・オプション」による二重検索
パソコンに十分な処理能力がある場合、オートフィルタのオプション機能による処理をくり返せばで効率的な処理を行うことができる(ファイルサイズが非常に大きいものであったり、パソコンのRAM容量が小さい場合には、この機能は不具合を起こすことがある。その際には下記6を利用する。また、Excel
5.0以前のものを使用している場合は、操作法が多少異なるので下記6を参照すること)。
課題3:4.終助詞「ね」の頻度を見る。
終助詞「ね」は、BTSJの規則では、必ず句読点「。」「、」の前に現れる従ってエクセルの検索では「ね。」または「ね、」がフィルタ検索の条件になる。
ワークシート左端の2行目をクリックしておき、プルダウン・メニューの「データ」「フィルタ」「オートフィルタ」を選択する。2行目J列にフィルタのマークが現れるので、そこをクリックして「(オプション_)」を選ぶ。「オートフィルタ・オプション」が出てくるので、「ね。」「を含む」「OR」「ね、」「を含む」と設定して、「OK」ボタンを押す。
6.「フィルタ・オプション」による様々な検索
〜部分一致のデータを全て探し、別のシートに保存する〜
課題4:母語話者で年長者が会話をリードしていくようになるかを、発話文数をもとに考える。日本人の年長者の序盤・中盤・終盤での発話文数の推移を調べる。
検索・抽出の条件は
・発言者の列(I列)で1番目と2番目の文字が「JO×」であること
・「*?」の列(D列)で「*」とマークされている行
・「TB」の列(F列)で「1(2、3)」とマークされている行
フィルターオプションを使ってやってみよう。
7.「マクロ」による複雑作業の自動化
課題5:沈黙を破る発話がどのようなものであるかを調べる。中国人の沈黙を破る発話を取り出して新しいシートにコピー・ペーストする。その作業を「マクロ」で記録し、 VBA上で中国人を日本人の先輩に変えて自動処理を行う。
[ツール][マクロ][新しいマクロの記録][OK] で記録スタート
・前回の作業と同様にオートフィルタオプションを用いて、上記の作業を行う
・記録ストップボタンを押して終了。
・>[ツール][マクロ]マクロ1を出して「編集」。別表のように編集する。
DownLoad+Excel
