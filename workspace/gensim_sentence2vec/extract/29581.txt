 2要因分散分析の事前の分析
多要因の分散分析とは、複数の要因があり、それぞれの要因に複数のグループ(水準・群)があるとき、各グループ毎の平均値が有意に異なっているかどうかについて、それぞれの要因ごとに分析するものです。
説明のために例えば「要因A:年代1,2,3,4,5」と「要因B:地域1,2,3」で不安耐性について調べたとします。不安耐性の平均値が五つの年代のグループ(5水準、自由度df=(5-1)=4)と、三つの地域のグループ(3水準、自由度df=(3-1)=2)の要因によって異なるのかどうか、ということがこの「2要因分散分析」の目的となります。
このとき、事前の検定力分析は、「要因Aの分析に必要とされるデータ数」と「要因Bの分析に必要とされるデータ数」、そして「要因Aと要因Bとの相互作用の分析に必要されるデータ数」の三つの数字を別々に調べていくことになります。
検定力の事前の分析では、必要なデータ数Nを調べるために、[有意水準α、 効果量ES、 検定力(1-β)]の三つの数値を設定する必要があります。ここでは、これまでの経緯からとりあえず有意水準αは0.05 (5%)と設定します。検定力Powerは、J.Cohenによる慣例で(1-β)=0.8 と設定しておきます。そうすると、最後に残るのが「効果量 ES: Effect size」となります。この効果量を求めて三つの数値が出揃うことで、「必要とされるデータ数」を事前に割り出すわけです。
J.Cohen(1992)では分散分析における効果量ES(Effect Size)をfで表示して、効果量小(Small) f=0.1、 効果量中(Medium) f=0.25、 効果量大(Large) f=0.4」を慣例(convention)としています。なお、この効果量の数値は一元配置の分散分析の場合と同じものです。
* 効果量の式(母集団における効果量)は以下のように示されています。
f=σm/σ
(σmは要因の標準偏差。σは母集団の標準偏差)
実際のデータを用いて算出する標本効果量の式では、偏相関比(partial correlation ratio)を用います。
f =√ [(偏相関比の二乗)/(1−(偏相関比の二乗))]
このあたりの数値の意味や実際の計算方法については豊田秀樹『検定力分析入門』に詳しく説明されているのでそちらを参照してください。
多要因の分散分析で必要なデータ数を事前に割り出すために、G*Powerを用いて算出するとき、次の数値が必要となります。すでに示した三つの数値を含めて書いておきます。すなわち—
効果量 Effect Size f= 0.1 (効果量小)、または f=0.25 (効果量中)、または f=0.40 (効果量大)
有意水準 α err prob(α過誤) α=0.05 または0.01など
検定力 Power (1−β err prob)  power=0.80 (J.Cohenが提唱する数値)
要因の自由度 (Numerator df)
上の例の要因Aの分析に必要なデータ数を割り出すときは Numerator df = (5-1)=4 とする。
上の例の要因Bの分析に必要なデータ数を割り出すときは Numerator df = (3-1)=2 とする。
要因Aと要因Bの交互作用の分析に必要なデータ数を割り出すときは Numerator df = (5-1)x(3-1)=8 とする。
* Numeratorは「分子」の意味で、F検定において分子に「要因の平均平方和」を入れることから来ている。
グループの数 Number of groups 
上の例では、5水準×3水準=15となり、全部で15個のグループがあるので 15 とする。
要因の自由度を「Numerator df=4 」として要因Aの分析に必要なデータ数を事前に算出した場合のG*Powerの画面を以下に示します。
なお、要因Aの効果はあまり大きくないと推測されたとして、効果量f (effect siz) = 0.1 と設定しています。
要因A(5水準)と要因B(3水準)の2要因分散分析ですが、要因Aの検定力がPower=0.8となるために必要なデータ数は「Total sample size 1199」(緑色の下線)と算出されました。
全部で5x3=15個のグループがあるので、「1199÷15=79.9」。すなわちそれぞれのグループのデータ数は「80」以上必要だということになります。
なお、効果量f=.25 と中程度の効果が推測されたとしてあらためて計算すると、Denominator df = 182、Total sample size = 197 となります。197÷15= 13.13 なので、15個それぞれのグループのデータ数は「14」以上あれば良いことが分かります。
効果量「中」(f=0.25) とは、要因Aについてみると、5個のカテゴリーの平均値が相互にある程度異なっているという状態を意味します。したがって、データ数がそんなに多くなくとも良いということが示されているわけです。ちなみに,効果量大 (f= 0.4 )のときに必要なデータ数(Total sample size) = 81 と表示されるので、15個のグループ毎ではそれぞれ「5.4 」(81÷15)、すなわち6個程度のデータ数が良いというわけです。5個のカテゴリーの平均値が相互に極めて大きく異なっているためです。 
続いて、要因Bについての検定力を分析してみます。
効果量f=0.1 と小さいとして、要因Bの自由度「Numerator df = 2」と入れて[Calculate]をクリックすると「Total sample size= 967」となります。967÷15=64.4なので、1グループ当たり65人以上必要と分かります。
最後に、要因Aと要因Bの交互作用について検定力を分析してみます。
要因Aと要因Bの相互作用については、「Numerator df」の欄に「 8 」と入れて[Calculate]をクリックすると「Total smaple size = 1511」となるので、1グループ当たりに必要なデータ数は「101」人以上必要となります(1511÷15=100.73)。
このように要因A、要因B、要因Ax要因Bの交互作用の三つについてそれぞれ「事前の検定力分析」を行います。この例でも分かるように、要因A、要因B、要因Ax要因Bの交互作用の三つの効果を知るためには、必要なデータ数がそれぞれに異なることがほとんどです。ここでは効果量f= 0.1 と小さくしているため、必要なデータ数がかなり多くなっているにしても、交互作用の分析においてもPower=0.8 と高い検定力を確保するためには、合計で1511人以上の被験者を用いて研究を進めることになります。
なお、要因Bに最も関心があって要因Aや交互作用はあまり気にならないような事情があれば、少なくとも要因BのF検定の結果についての検定力が高ければ良いわけです。その場合は合計で965名以上と、少し少なめの被験者数に設定するという研究設計が考えられます。(要因AとAxBの交互作用の検定力は0.8 よりも下回ってしまうことが予想される)
G*Powerソフトによる「必要なデータ数」の傾向について
豊田秀樹『検定力分析入門』(2009)にある例を参考にしつつ、J.Cohen(1988)の数表や解説を読んでいるのですが、算出される数値には若干のズレがあります。「必要なデータ数」を各グループ毎に見てみると、たかだか1〜2程度のズレですが、G*Powerソフトでは、「各グループ毎の必要データ数」は豊田が示している例よりもだいたい「−1」程度、少し小さな数値になる傾向があります。
これは小数点以下の計算誤差や四捨五入、切り捨てなどによる処理の違いと思われますが、G*Powerでは「Total sample size」合計のデータ数として表示されるため、「各グループ毎のデータ数」を表示するJ.Cohenの数値や豊田(2009)の数値との食い違いが大きく見えるためかなり気になります (G*Power3.1.2版のソフトでは、検出力の数値について小数以下四桁の精度を保つため近似計算を行わないとされています)。
見た目ほどの大きな食い違いはないようなので特に問題ないと思いますが、豊田(2009, p.193)の例を取り上げて、要因A(6水準)×要因B(2水準)の場合に、「データ数」の数値のズレについて比較を示しておきます。
* 豊田(2009: p192)では、多要因分散分析について「本章では数値の繰り下げによって、任意の検定力を満たさない標本数を返す可能性を考慮して、数値の繰り上げ処理を一貫して利用する」と書かれています。
検定力分析 by 葛西俊治2011
