3倍早くなるためのDTP講座
DTPの作業を早くするためのテクニックを綴っていこうと思っています。
デザイン・アート
InDesignで辞典を作る3
InDesign
次はいよいよ実作業です(500ページでやるとさすがに重いので、120ページくらいまで削りました)。テキストは、まとめて本文のスタイルをあててしまえば後は大見出し、項目、分野の3つをあてるだけです。スタイル置換のルールは、1. 項目:前に1行空いている。前の空行ごとスタイルを置換。2. 分野:先頭に分野があるので、段落先頭=分野としてスタイル置換。3. 大見出し:最初の検索置換で項目のスタイルが当たっているので、項目スタイル、段落内1文字、後ろに改行が2回あるものを置換。4. 最後に空行はトルここは手動でもいいですが、せうぞーさんの「regex_continuous_substitution.jsx」で一撃にしてしまいましょう。う～ん、戦艦並み。^^設定ファイル1変換が終わったらリフロー分を自動流し込みします。これで120ページ分の流し込みとスタイル適用は終わりです。次にツメですが、見出しにスタイル適用されるとランニングヘッドにより自動的に文字が入ります。マスターページからツメ用のフレームを選択し、またもやせうぞーさんのスクリプト、「override_selection.jsx」で全部オーバーライドします。次に、ツメのテキスト変数をテキスト化します。テキスト変数のテキスト化は、選択してテキスト化しなければなりません。500ページあれば500箇所を手動でやるのはちょっとツライ。そこで、P先生にスクリプトを書いていただきました。doc = app.activeDocument;pg = doc.pages;for ( i = 0; i 	tx = pg[ i ].textFrames;	for ( j = 0; j 		if ( tx[ j ] .label == "tsume" && tx[ j ].characters[ 0 ].textVariableInstances.length != 0 ){			h = tx[ j ].characters[0].textVariableInstances[0].resultText;			tx[ j ].characters[ 0 ].remove( );			tx[ j ].contents = h;			break;		}	}}ブログだとタブ消えちゃうのね…。隠し味のスクリプトラベルはこのためでした。^^よ～し、これを実行すれば一発だぜ。心の声-----------------------------------------------------しかし、ドキュメント内一括で変換できないのはなぜだ?テキスト変数定義のダイアログに、いかにもできそうなコマンドがあるのに、グレーアウトして選べないし～。テキストに変換させてよ～って、あれ?グレーアウトしてない!試しにポチッ。ええっ!? イケてる!テキストをアクティブにした状態で定義ダイアログを出すとコマンドが効くようになってる。ドキュメント内一括なのに選択する必要あんのか? そもそもテキスト変数とか全然関係ないとこにカーソル立ててるのに～。先生、貴重なお時間を割いていただいたのに、ごめんなさい。m( _ _ )mただ、標準の一括コマンドの場合は、ロックしようがレイヤー非表示だろうが全てテキスト化してしまいますから、このスクリプトはスクリプトラベルを付けたものだけを限定してテキスト化できるので、これはこれで使えます。ダブルクリック(もしくはショートカット)だけで済みますし。また、大いにスクリプトのお勉強になりましたので無駄ではありませんよ(汗)。-----------------------------------------------------心の声おわりそして、またもや「regex_continuous_substitution.jsx」による連続置換。設定ファイル2これでツメの位置が自動的に変更されます。さあ、イッツ、ショータイム!まだ続く。^^
InDesign｜3倍早くなるためのDTP講座 -3ページ目
