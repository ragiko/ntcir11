
COBOL85 言語
1.2.2 GUI連携
<この項の構成>
(1) COBOL GUIオプションによるGUI構築(32ビット版PC COBOL85で有効)
(2) UIBTによる対話画面送受信機能(ワークステーションCOBOL85で有効)
(3) XMAP3による対話画面送受信機能(32ビット版PC COBOL85,及びワークステーションCOBOL85で有効)
(1) COBOL GUIオプションによるGUI構築(32ビット版PC COBOL85で有効)
COBOL GUIオプションの開発環境では,GUIを使ったアプリケーションを作成できる。
(a) COBOL GUIオプションを使ったアプリケーション作成の流れ
(b) GUI定義
対話用の画面は,COBOL GUIオプションが用意している部品パレットから部品を選び,フォーム上に移すことで定義できる。GUI部品はすべてOLEオブジェクトであり,OLE2インタフェース機能を使って利用できる。詳細は「第3編 33. OLE2オートメーションインタフェース機能」を参照のこと。
(c) 手続きの記述
プッシュボタンの押下,リストの選択など,フォーム上に配置したGUI部品にイベントが発生したときに実行する処理をCOBOL言語で記述できる。
(d) コーディング例
COBOL GUIオプションで作成するアプリケーションのコーディング例を次に示す。
GUIオブジェクト操作の記述例
*プロパティからの値の取得
SET COBOLの変数 TO 'プロパティ名' WITH GUIオブジェクト名
*プロパティへの値の設定
SET 'プロパティ名' WITH GUIオブジェクト名 TO COBOLの変数
メソッドの実行
INVOKE GUIオブジェクト名 'メソッド名' USING 引数1 引数2 …
なお,詳細については,マニュアル「COBOL GUIオプション ユーザーズガイド」を参照のこと。
図1-2 COBOL GUIオプションの対話画面
(2) UIBTによる対話画面送受信機能(ワークステーションCOBOL85で有効)
利用者は,CALL文でUIBTのライブラリを呼び出すことによって,GUIを構築できる。
詳細については,マニュアル「ユーザインタフェース構築ツール UIBT リファレンス1」又は「ユーザインタフェース構築ツール UIBT リファレンス2」を参照のこと。
図1-3 UIBTによる対話画面
(3) XMAP3による対話画面送受信機能(32ビット版PC COBOL85,及びワークステーションCOBOL85で有効)
利用者は,ワークステーションの全画面に対して,画面データを送受信し,計算機と対話しながら業務処理を進めることができる。
(a) 画面や帳票の定義
ワークステーションCOBOL85の場合,画面や帳票は,SEWB3/XMAPDRAWを使用して,対話形式で定義できる。画面・帳票定義の詳細については,マニュアル「SEWB3 システム設計支援(フォーム設計) 使用の手引」を参照のこと。
定義後,XMAP3が提供するバッチコマンドで物理マップ,論理マップを生成する。
32ビット版PC COBOL85の場合,画面や帳票はXMAP3を使って定義する。詳細はマニュアル「画面・帳票サポートシステム XMAP3 プログラミングガイド 画面編」又は「画面・帳票サポートシステム XMAP3 プログラミングガイド 帳票編」を参照のこと。画面や帳票の定義後,物理マップと論理マップが生成される。
(b) 通信節での対話端末の定義
形 式
FOR句は,通信種別を指定する。
OUTPUT WS
送信先がプリンタであることを示す。
I-O WS
送受信先がワークステーション(全画面ファイル)であることを示す。
MAP NAME句のデータ名1は,物理データ名を設定する項目である。
MAPPING MODE句のデータ名2は,論理マップと物理マップの使用形態を指定する項目である。
(c) この機能で用いる文
通信節による画面/帳票の送受信機能では,次の四つの文が使用できる。
文
機 能
SEND
メッセージ送信
RECEIVE
メッセージ受信
TRANSCEIVE
メッセージ送受信
DISABLE
画面消去
SEND文及びRECEIVE文でメッセージの送信,受信を行うと,応答待ちの間にほかの処理ができる。これによって,対話処理の性能が向上する。
図1-4 ワークステーション送受信機能(全画面)
[目次][前へ][次へ]
[他社商品名称に関する表示]All Rights Reserved. Copyright (C) 1997, 2004, Hitachi, Ltd.
GUI連携
