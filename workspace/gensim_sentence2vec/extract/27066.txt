【課題】音響信号などの分析に用いられる、最大エントロピー法を用いた周波数分析方法において、分析幅の細分化と処理速度の維持との両立を、実現すること。【解決手段】入力端子1を通して入力された、時系列に基づいた信号データを切り出したものに、窓乗算器9において帯域の折り返しを抑制する窓を乗算し、離散フーリエ変換器10においてフーリエ変換を施して帯域を制限した周波数ビンを生成し、MEM係数予測器6において係数予測を行い、この係数予測によって求められた係数から、周波数スペクトル算出器7において所望の分析幅の周波数スペクトルを算出する。
【特許請求の範囲】
【請求項1】  最大エントロピー法を用いて音響信号などの周波数分析を行う方法であって、時系列に基づいてデータ化された信号データを切り出し、該切り出された信号データに、帯域の折り返しを抑制する窓を乗算し、窓を乗算された信号データに対してフーリエ変換を施して、周波数分析に必要な帯域に制限された周波数ビンを生成し、該周波数ビンに対して、MEMアルゴリズムにより係数予測を行い、該係数予測によって求められた係数から、所望の分析幅の周波数スペクトルを算出することを特徴とする、周波数分析方法。【請求項2】  請求項1に記載の周波数分析方法であって、前記信号データの切り出しを行う際に、信号をオーバーラップさせながら切り出すとともに、前記周波数ビンを求めたのちに、前記オーバーラップの際に発生する周波数シフトを補償する補償処理を行うことを特徴とする、周波数分析方法。【請求項3】  最大エントロピー法を用いて音響信号などの周波数分析を行う方法であって、時系列に基づいてデータ化された信号データを切り出し、該切り出された信号データに、帯域の折り返しを抑制する、所定の次数より高い次数の窓を乗算し、該窓を乗算された信号データを、前記所定の次数ごとに分割し、窓を乗算された信号データに対してフーリエ変換を施して、周波数分析に必要な帯域に制限された周波数ビンを生成し、該周波数ビンに対して、MEMアルゴリズムにより係数予測を行い、該係数予測によって求められた係数から、所望の分析幅の周波数スペクトルを算出することを特徴とする、周波数分析方法。
【発明の詳細な説明】【0001】【発明の属する技術分野】本発明は、音響信号の周波数分析を、最大エントロピー法を用いて行う方法に関するもので、特にソナーによる過渡音や探信音の分析などに用いて好適なものである。なお、上記最大エントロピー法を、以下MEM法と略記する。【0002】【従来の技術】音響信号の周波数分析にMEM法を用いることの利点は、高速フーリエ変換(FFT)を用いる場合に比べて、入力される音響信号データの観測時間が短くても、最終的な周波数スペクトルの分析幅を、より細かく得られる点にある。【0003】図1に、MEM法を用いた従来の周波数分析方法の一例を示す。まず、この分析方法の概要を、以下に説明する。この分析方法は、3つの部分に大別される。すなわち、周波数シフト、前置フィルタ、MEM分析の各部分である。【0004】周波数シフトは、入力された音響信号データに対して、どの周波数を中心として分析するかを、制御する部分である。ここで。分析の中心となる周波数を、中心周波数と呼ぶ。前置フィルタ部分は、入力された音響信号データに対して、MEM分析部分へ入力する周波数帯域幅の制限とサンプリング周波数レートの制御とを行う部分で、この周波数帯域幅を狭く、サンプリング周波数レートを低くすることによって、最終的な周波数スペクトルの分析幅を細かくすることが、可能になる。MEM分析部分は、周波数分析の本体であり、周波数スペクトルの算出次数に応じた周波数スペクトルを算出する部分である。この算出次数に関しては、後述する。【0005】図1において、1は入力端子、2は直交変換器、3−1ないし3−Nはローパスフィルタ、4−1ないし4−Nは1/2間引き処理器、5は入力データ選択処理器、6はMEM係数予測器、7は周波数スペクトル算出器、8は出力端子である。【0006】音響信号をディジタル信号化された時系列データが、サンプリング周波数fsのレートで、入力端子1を通して直交変換器2に入力される。直交変換器2では、分析しようとする中心周波数fcをもとに、【0007】y(k)=x(k)e-j2π・fc/fs・k    ・・・(1)ここに、k=1、2、3、・・・ただし、x(k):k番目のディジタル信号化された入力時系列データ【0008】により、このディジタル信号化された入力時系列データの所有周波数帯域を周波数シフト(変調)する。【0009】この直交変換出力が入力される前置フィルタ部分は、ひとつのローパスフィルタとひとつの1/2間引き処理器の組が、N段分用意された構成となっている。このフィルタの段数Nは、必要とされる分析幅に依存して定まる。直交変換出力は、最初に1段目のローパスフィルタ3−1に、サンプリング周波数fsのレートで入力される。ローパスフィルタ3−1では、このサンプリング周波数fsを、後段の1/2間引き処理器によって出力レートを1/2にダウンさせたときに周波数の折り返しが起きることを防ぐ目的で、fs/4のカットオフ周波数(fcl)でフィルタリングして、1/2間引き処理器4−1に出力する。【0010】1/2間引き処理器4−1では、このローパスフィルタ出力データをひとつおきに間引くことによって、サンプリング周波数をfs/2にレートダウンして、これを入力データ選択処理器5に出力すると同時に、2段目のローパスフィルタ3−2にも出力する。ローパスフィルタ3−2および1/2間引き処理器4−2では、上述の1段目と同様の処理を行うことによって、カットオフ周波数fs/8でのサンプリング、ならびにサンプリング周波数fs/4へのレートダウンを行い、入力データ選択処理器5と次段のローパスフィルタに出力する。以降、この処理をN段にわたって繰り返す。【0011】各段の出力を受けた入力データ選択処理器5では、これらN段の各出力の中から、必要な分析幅に応じたひとつのデータを選択し、MEM係数予測器6に出力する。【0012】MEM係数予測器6では、MEMによる予測アルゴリズムによって、m点予測誤差フィルタの係数γ1、γ2、・・・、γmと、このフィルタからの平均出力Pmとを求め、周波数スペクトル算出器7に出力する。【0013】周波数スペクトル算出器7では、これら係数γ1、γ2、・・・、γmと平均出力Pmとをもとに、【0014】【数1】【0015】ただし、g    :周波数スペクトルの算出次数        fs:入力データ選択処理器によって選択されたデータのサンプリング周波数        Δf  :周波数スペクトルの分析幅        γk  :γ1、γ2、・・・、γm(k≦mのとき)                  0                    (k>mのとき)    ・・・(2)【0016】により、周波数スペクトルを算出して、出力端子8に出力する。ここで、MEM分析における周波数スペクトルの分析幅Δfは、高速フーリエ変換FFT分析での分析幅が、入力データのサンプリング周波数ならびにFFT次数に依存して定まるのと同様に、【0017】【数2】【0018】ただし、g    :周波数スペクトルの算出次数fs:入力データ選択処理器によって選択されたデータのサンプリング周波数・・・(3)【0019】によって求められる。【0020】この式から明らかなように、周波数スペクトルの分析幅Δfは、周波数スペクトルの算出次数と、入力データ選択処理器によって選択されたデータのサンプリング周波数とによって、定められる。【0021】そこで、この従来方式のMEMを用いた周波数分析方式では、一般的には、周波数スペクトルの算出次数gを予め固定し、前置フィルタ部分で、MEM分析部分への入力データのサンプリング周波数を変えることによって、必要な分析幅の周波数スペクトルを得ていた。【0022】【発明が解決しようとする課題】ここまでに説明した従来方式のMEMを用いた周波数分析方式では、次に述べるような問題点があった。【0023】従来の方式で必要な分析幅を得るためには、前置フィルタ部分で入力された音響信号データのサンプリング周波数をレートダウンすることが、上記の説明にも示したように、不可欠である。しかしこの方式では、分析できる分析幅をいくつか持ち、さらにその分析幅を細かくしようとすれば、それに比例して必要なフィルタの段数が、増加してしまう。この増加するフィルタの処理量は、たとえば分析幅を基本的な分析幅から1/16にする場合には、ローパスフィルタと1/2間引き処理の総処理量をSとすれば、S16もの量に達する。【0024】すなわち、分析幅を基本的な幅の1/2nにするためには、Snの総処理量が必要というように、総処理量がべき乗のレベルで増加してしまう。このような問題点を解決することが、本発明の狙いとするところである。【0025】【課題を解決するための手段】このような問題点を解決するために、本件出願の第1の発明においては、時系列に基づいた信号データを切り出したものに対して、帯域の折り返しを抑制する窓を乗算し、窓を乗算された信号データに対してフーリエ変換を施して、周波数分析に必要な帯域に制限された周波数ビンを生成し、この周波数ビンに対して、MEMアルゴリズムにより係数予測を行い、この係数予測によって求められた係数から、所望の分析幅の周波数スペクトルを算出するようにしたものである。【0026】また、本件出願の第2の発明においては、前記信号データの切り出しを行う際に、信号をオーバーラップさせながら切り出すとともに、前記周波数ビンを求めたのちに、前記オーバーラップの際に発生する周波数シフトを補償する補償処理を行うようにしたものである。【0027】さらに、本件出願の第3の発明においては、時系列に基づいた信号データを切り出したものに対して、帯域の折り返しを抑制する、所定の次数より高い次数の窓を乗算し、この窓を乗算された信号データを、前記所定の次数ごとに分割し、窓を乗算された信号データに対してフーリエ変換を施して、周波数分析に必要な帯域に制限された周波数ビンを生成し、この周波数ビンに対して、MEMアルゴリズムにより係数予測を行い、この係数予測によって求められた係数から、所望の分析幅の周波数スペクトルを算出するようにしたものである。【0028】【発明の実施の形態】以下、本発明の実施形態の一例について、図面を適宜参照しつつ、説明を試みる。【0029】図2に、本発明の周波数分析方法の第1の実施例を示す。第1の実施例の分析方法においては、上述の従来の方法と比較して、周波数シフト機能が前置フィルタ部分の中に取り込まれている点が、異なる。この部分で、分析する中心周波数、周波数帯域幅、ならびにMEM分析への入力サンプリング周波数レートを制御している。【0030】図2において、1は入力端子、9は窓乗算器、10は離散フーリエ変換器(DFT)、11は位相補償器、6はMEM係数予測器、7は周波数スペクトル算出器、8は出力端子である。【0031】窓乗算器2には、入力端子1を通して、音響信号をディジタル信号化された時系列データが、サンプリング周波数fsのレートで入力される。窓乗算器9では、このディジタル信号化された時系列データを、必要に応じてオーバーラップ処理させながら、後段の離散フーリエ変換器で必要とする次数Nと同じ次数で切り出し、必要とする周波数分析帯域への隣接する帯域からの折り返しを低減するためのこの次数Nと同次数の窓を、この切り出されたデータに乗算して、離散フーリエ変換器10に出力する。【0032】ここで、この窓の係数は、たとえばカイザベッセル窓の式を用いて、必要な折り返しの低減量と帯域のリップル特性とから窓パラメータのαを決定して計算したものである。離散フーリエ変換器10では、切り出されて窓を乗算されたデータに対して、分析に必要とする中心周波数fcについてN次のフーリエ変換を行うことで、周波数ビンを作成して、位相補償器11に出力する。【0033】ここで、次数Nは、分析に必要な周波数帯域幅と分析幅Δfに応じて設定されるもので、この次数Nを変化させると、作成された周波数ビンの位相補償器11以降への出力サンプリング周波数レートfsが変化する。位相補償器11では、窓乗算器9でディジタル信号化された時系列データをオーバーラップ処理したときに、MEMによる周波数分析結果に起きる周波数シフトに対して、たとえば【0034】Y(k)=X(k)e−j2π(1−Ovp)fc/fs・k・N【0035】k=1、2、・・・、Nただし、X(k) :DFTから出力された周波数ビンのk番目の時系列データ        fc  :分析する中心周波数        fs  :音響信号をディジタル信号化した時系列データのサンプリング周波数        Ovp:窓乗算器9でのオーバーラップ率    ・・・(4)【0036】のように中心周波数で決まる補償量を周波数ビンの時系列方向に乗算することで補償し、MEM係数予測器6に出力する。なお、オーバーラップ処理を行わない場合には、この位相補償器11は不要である。【0037】MEM係数予測器6では、位相補償器11からの補償された周波数ビンを、生成された順に時系列に並べてバッファリングし、MEMによる予測アルゴリズムによって、m点予測誤差フィルタの係数γ1、γ2、・・・、γmと、このフィルタからの平均出力Pmとを求め、周波数スペクトル算出器7に出力する。周波数スペクトル算出器7では、この係数γ1、γ2、・・・、γmと平均出力Pmとをもとに、たとえば前述の【0038】【数3】【0039】などにより、周波数スペクトルを算出したのちに、出力端子8を通して外部に出力する。【0040】ただし、この式におけるサンプリング周波数fsは、ここに述べる第1の実施例においては、MEM係数予測器6への補償された周波数ビンの時系列方向への入力サンプリング周波数レートになる。【0041】また、MEM分析における周波数スペクトルの分析幅Δfは、前述の【0042】【数4】【0043】・・(3)によって求められるが、この式(3)上のサンプリング周波数fsも、この第1実施例では、同様にMEM係数予測器6への補償された周波数ビンの、時系列方向への入力サンプリング周波数レートになる。この式から明らかなように、周波数スペクトルの分析幅Δfは、周波数スペクトルの算出次数と、この補償された周波数ビンの時系列方向への入力サンプリング周波数レートによって、決定可能となる。【0044】そこで、この第1実施例の周波数分析方式では、通常周波数スペクトルの算出次数gを予め固定しておき、離散フーリエ変換器10での次数Nを変化させることで、必要な分析幅Δfを求めるためのMEM係数予測器6への入力サンプリング周波数レートを得る。また、通常周波数スペクトルの算出次数gと離散フーリエ変換器10での次数Nの両方を可変とすることも、あるいは通常周波数スペクトルの算出次数gだけを可変とすることも、当然に可能であり、それぞれの場合に、必要な分析幅Δfを得ることができる。【0045】次に、上述の第1の実施例とは異なる、第2の実施例について、以下に説明を試みる。第2の実施例においては、窓乗算器と離散フーリエ変換器との間に加算処理器を設けて、特殊な離散フーリエ変換を行う点が、第1の実施例と異なる。一方、前置フィルタ部分で、分析する中心周波数、周波数帯域幅、ならびにMEM分析への入力サンプリング周波数レートを各々制御している点は、第1の実施例と同様である。【0046】図3に、この第2の実施例の周波数分析方法を示す。図において、1は入力端子、6はMEM係数予測器、7は周波数スペクトル算出器、8は出力端子、9は窓乗算器、10は離散フーリエ変換器、11は位相補償器、12は加算処理器である。【0047】窓乗算器9には、入力端子1を通して、音響信号をディジタル信号化した時系列データが、サンプリング周波数fsのレートで入力される。窓乗算器9では、第1の実施例と同様に、この時系列データを、必要に応じてオーバーラップ処理させながら切り出し、この切り出されたデータに、必要とする周波数分析帯域への隣接する帯域からの折り返しを低減するための窓を、乗算する。ただし、ここでのオーバーラップ処理で切り出されるデータ数と窓の次数とは、後段の加算処理器12での加算回数Qと離散フーリエ変換器10での次数Nによって定まり、そのデータ数および次数は、【0048】N×(Q+1)    ・・・(4)【0049】となる。たとえば、加算処理器12における加算回数が1回ならば、このオーバーラップ処理で切り出されるデータ数と窓の次数とは、2Nとなる。この窓を乗算した時系列データを、加算処理器3に出力する。加算処理器12では、この窓を乗算した時系列データをx(1)、x(2)、x(3)、x(N×(Q+1))とすると、次式に示すような加算処理を行い、離散フーリエ変換器10に、出力する。【0050】【数5】【0051】ただし、Q:加算処理器12での加算回数N:離散フーリエ変換器10での次数【0052】離散フーリエ変換器10では、この加算されたデータを、分析に必要とする中心周波数fcについて、N次のフーリエ変換を行うことによって周波数ビンを作成し、位相補償器11に出力する。この位相補償器11以降の動作は、第1の実施例における相当部分の動作と同一である。【0053】さらに、上述の第1の実施例ならびに第2の実施例に対する変形として、以下に述べるような内容も、考えられる。すなわち、上述の各実施例においては、MEM係数予測器で平均出力Pmを求めたが、周波数スペクトルの相対的なパワーだけを必要とするときには、平均出力Pmを求めず、適切な定数をもってこれに代えることも可能である。【0054】また、周波数スペクトル算出器で、スペクトルの計算に【0055】【数6】【0056】を用いると説明したが、これに代えて処理を高速化する方法として、たとえば上式(2)の分母の括弧内の計算を、周波数スペクトル算出次数gと同次数の逆FFTによって行ってもよい。【0057】さらに、これまでに述べた方法におけるデータ形式ならびにデータ処理形式は、アナログ形式とディジタル形式とを問わず、どちらを採用してもよい。また、回路構成に関しても、集積回路などの組み合わせによる構成でも、あるいはディジタル・シグナル・プロセッサなどの演算プロセッサを用いてソフトウェアによって構成するものであってもよい。これらの変形例は、本発明の本旨の範囲に含まれるものである。【0058】【発明の効果】以上に説明した方法により、本発明においては、分析に必要な分析幅が細かくなった場合にも、処理量の増加はほとんど無く、処理速度の低下を効果的に回避できる。【0059】特に第2の実施例の方法においては、加算処理器12で、窓を乗算した時系列データを1回加算している。このために、周波数分析帯域への隣接帯域からの折り返し低減効果を、窓の次数が2Nのときと同様に得られ、しかもフーリエ変換の次数はNでよい。したがって、第1の実施例と比較しても、フーリエ変換の処理量を抑制できる分だけ、全体の処理量を大幅に削減できる。【0060】あるいは、第2の実施例においてフーリエ変換の次数を大きくとれば、窓の次数を増加させることができ、折り返し低減効果の増強を期待できる。その結果、第2の実施例においては、第1の実施例と比較しても、大幅な性能の向上を見込める。
最大エントロピー法による周波数分析方法 - 特開2003−232820 | j-tokkyo
