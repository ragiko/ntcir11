第2世代のHOG特徴量
ここで,第2世代のHOG特徴量を紹介します。ここでは人を検出するという問題を考えてみたいと思います。顔検出によく使われるHaar-like特徴では,ある領域とある領域の明暗差を特徴量としています。しかし,残念ながら人の検出では,服や背景の色がいつも同じではないので,Haar-like特徴を使えません。また,人の形状は,手足の動きや姿勢などの見えの変化が激しいという問題もあります。このような局所的な変化を吸収するように,できるだけ共通した情報を抽出する特徴量としてHOGというアプローチが提案されました。
HOGは,2006年にフランスの研究所INRIAで提案されました。画像をセルという領域に区切り,このセルの中における勾配方向ヒストグラムを算出する方法です。局所的な形状変化や照明変動に頑健な特徴量になります。
学習では,まず学習画像として人が写っている画像を切り出して用意します［図7(a)］。人以外の画像もネガティブデータとして用意しておきます。これらの画像からHOG特徴量を算出して,ある局所領域における特徴量から,「人らしいか人らしくないか」を評価します。すべての領域に対してこの評価を行い,一番評価値がよかったものをアダブーストの最初の弱識別器として採用します。次に,うまくいかなかった学習サンプルをうまく識別できるように特徴量を再度評価し,選択されたものが2 つ目の弱識別器の特徴量になります。これを十分な識別精度が得られるまで繰り返します。
検出時は,検出ウィンドウにおける画像のHOG特徴量を算出して,学習で選択された領域のHOG 特徴量を各弱識別器に入力します。各弱識別器の出力を総和して,最終的には閾値判定で「人か人でないか」を判定します。このアプローチが第2世代のHOG 特徴量とアダブーストによる人検出になります。
人の特徴を捉える
ここでもう一度,「人の特徴」を考えてみたいと思います。人の形状特徴として頭のところから肩にかけた「Ω」型や,下半身の連続的なエッジ,頭・肩・胴体それぞれの左右対称性などが挙げられます。
残念ながら第2世代のHOG特徴量は,局所領域であるセルにおいて単一のHOG特徴量だけで識別しているので,こういった人の形状特徴を捉えきれていません。そこで自動的に対称性のある領域を捉えたり,連続性を持つ領域を捉えたりすることが,第3世代のアプローチとなります。
ロボットに使える最新画像処理技術 ～物体認識のための画像局所特微量～ | 画像センシング展2014
