Windows 
TIPS 
［User Interface］
Windows 
TIPS TOPへ
Windows 
TIPS全リストへ
内容別分類一覧へ
これだけは覚えておきたい、コマンド・プロンプトの使い方
デジタルアドバンテージ
2002/06/22                 
対象OS
Windows 2000 Professional
Windows 
XP Professional
Windows XP Home Edition
Windows 
2000 Server
Windows 2000 Advanced 
Server
システム管理やネットワークのトラブルシューティングなどでは、まだまだコマンド・プロンプト上で手動でコマンドを実行しなければならない場面が多い。
コマンド・プロンプトを使いやすくするために、フォント・サイズやウィンドウ・サイズを調整して、なるべく画面を広くしておくとよい。
コマンドの再入力や編集・再実行には、マウスによるドラッグ&ドロップや補完機能を活用する。
最低限覚えるべきコマンドとしては、cdとdirによるファイル名の表示、検索、moreによる内容確認、メモ帳による編集などがある。
解説
GUIが主流のこの時代でも、コマンド・プロンプト(「DOS窓」などとも呼ばれる)が活躍する場面は多い。システム管理などでは各種の設定ファイルの内容をチェックしたり、簡単な編集作業を行ったりする必要があるが、いちいちエクスプローラやメモ帳などを使って編集するよりは、コマンド・プロンプト上で操作した方が手っ取り早いことが多い。またネットワーク関連のトラブルシューティングでは、コマンド・プロンプト上でネットワーク・ツールを使う場面が多いので、コマンド・プロンプトを避けて通るわけにはいかないだろう。ここでは、非常に簡単なコマンド・プロンプトの使い方について解説する。詳細については、「連載—Windows 
2000 コマンドライン徹底活用」や、コマンド・プロンプトのヘルプファイルなどを参照していただきたい。
コマンド・プロンプトの設定
コマンド・プロンプトを起動するには、［スタート］の［プログラム］(Windows XPでは［すべてのプログラム］)−［アクセサリ］−［コマンドプロンプト］を選択する。だがデフォルトのままではやや使いにくいのと、なるべく文字が多く表示される方が便利なので、以下のような設定を行っておくとよい。
簡易編集モード/挿入モードの選択
コマンド・プロンプトのメニュー(ウィンドウの左上のアイコンをクリックすると表示される)から［プロパティ］を選び(［Alt］+［Space］+［P］の方が早いので、これも覚えておいて欲しい)、［オプション］タブ画面で［簡易編集モード］と［挿入モード］を選択しておく。
［簡易編集モード］を選択すると、文字列のコピーと貼り付けがマウスを使って簡単に行えるようになる。クリップボードへコピーしたい範囲をマウスで選択し(領域の左上でマウスをクリックし、そのまま選択範囲の右下までドラッグして、マウス・ボタンを離す)、そこでさらに右クリックすると、選択された範囲がコピーされる。「貼り付け」は(何も選択されていない状態で)マウスを右クリックするだけでよい。
［挿入モード］はデフォルトの編集モードを「上書き」ではなく「挿入」にするためのオプションである。以前入力したコマンドの一部を変えて再実行するということはよくあるので、このモードでないととても不便である。
フォントの設定
プロパティの［フォント］タブでは、表示するためのフォントを選択する。デフォルトでは「8×16」の「ラスタ フォント」が選択されているはずだが、より多くの情報が表示できるように、もう少し小さいフォントにしておくと便利である。「6×13」の「ラスタ 
フォント」か、「12〜14」ポイントの「MS ゴシック」フォントがよいだろう。
レイアウトの設定
コマンド・プロンプトでは、通常のWindowsアプリケーションと違って、ユーザーが自由に画面サイズ(画面幅)を変えることはできない。もともと画面幅が固定のコンソール画面(DOS画面)をエミューレートしているので、使用中に自由に画面サイズが変更されることを想定していないためだ。また使いやすくするためにも、最初からなるべく画面を広くしておくのがよいだろう。デフォルトでは80桁×25行となっているが、フォントを小さくすれば、100桁×40〜50行程度にはできるはずだ(「画面バッファのサイズ」ではなく、「ウィンドウのサイズ」を変更すること)。
以上の設定変更が終了したら、［OK］をクリックして、設定を保存する。このとき2つのオプションが表示されるが、デフォルトの「現在のウィンドウだけに適用する」ではなく、「このウィンドウを起動したショートカットを変更する」を選択すると、以後、同じ設定でコマンド・プロンプトが実行されるので便利である。
さらに、この［プログラム］−［アクセサリ］−［コマンドプロンプト］メニューを、クイック起動バー上にコピーしておくと、素早く起動できる。
コマンドラインの編集
コマンド・プロンプトでは、以前実行したプログラムを再度実行したり、少しパラメータを変えて実行したりすることがよくある。こういう場合にはいくつか便利な方法があるので覚えておくとよい。
［］キーを押すと1つずつ順番に前へさかのぼることができる(［］キーで逆順)。また、例えば「net」まで入力してから［F8］キーを押すと、「net」で始まるコマンド履歴が順番に表示されるので、目的のコマンドラインが表示されるまで、繰り返し押せばよい。また［F7］キーを押すと履歴の一覧が表示されるので、そこから選んで［Enter］キーを押してもよい。
目的のコマンドが表示されたら、［］［］キーを使ってカーソル位置を動かし、コマンド名やパラメータを変更して、最後に［Enter］キーを押すと、それが実行される。
ファイル/フォルダ名の入力
コマンドを実行する場合には、そのパラメータとしてファイル名やフォルダ名を指定する必要がある。だが古い時代の8.3形式のファイル名ならともかく、空白や記号、漢字などを含むロング・ファイル名をコマンド・プロンプト上でいちいち指定するのは非常にわずらわしい。そこでこういう場合は、ファイル名やフォルダ名の「補完機能」を活用したい。補完とは、ファイル名の先頭の数文字を入力しただけで、残りの部分のファイル名が自動的に補われるという機能である。この機能はWindows 
XPではデフォルトで有効になっているが、Windows 2000の場合は「TIPS:コマンド 
プロンプトで入力補完機能を使う方法」や「TIPS:Tweak 
UIを使ってWindows 2000をカスタマイズする」などを参考にして補完機能を有効にしておく必要がある。
補完機能が有効になっている場合、補完キー(例えば［Tab］キーなどに設定できる)を押すと、カレント・ディレクトリ内にある該当するファイル名やフォルダ名が自動的に選択され、入力される。候補が複数ある場合は、目的のものが表示されるまで補完キーを繰り返し押せばよい。何も入力せずに補完キーを押すと、すべてのファイルやフォルダが順番に表示されることになる(ファイル名に空白が含まれる場合は、自動的に「"」で囲まれる)。フォルダ名の場合は、最後に「\」を手動で入力して、さらに補完キーを押せば、今度はそのフォルダ内の候補が順番に表示される。このようにして、深いフォルダにあるファイルでも簡単に指定することができる。
ファイル名を指定するには、エクスプローラによるドラッグ&ドロップという方法もある。エクスプローラでファイルやフォルダを選択、ドラッグして、それをコマンド・プロンプト上へドロップすると、それらがフルパス名として貼り付けられる。この方法は、各ユーザーの「マイ 
ドキュメント」内のファイルなどを指定するときに便利である。このフォルダは環境(ユーザー・プロファイル)によって、置かれる位置が変わることがあるし、そのパスもたいていの場合は、かなり複雑だからだ(深い位置にある)。
dirコマンド
dirコマンドは最も多く使われるコマンドであろう。単に「dir」と入力すると、カレント・ディレクトリにあるファイルやフォルダの一覧が表示される(カレント・ドライブの変更は「C:」や「D:」などと入力し、カレント・フォルダの変更はcdコマンドを使う)。
覚えておきたいオプションとしては、1画面ごとに停止する「/p」、時間順にソートして表示する「/od(新しいファイルが下の方に表示される。逆にするには 
/o-d とする)」、サイズ順にソートする「/os」(逆順は「/o-s」)、隠しファイルやシステムファイルを表示する「/ah」や「/as」、属性に関わらずすべてを表示させる「/a」、フォルダ名だけを表示する「/ad(ファイルだけなら/a-d)」などがある。これらは複数組み合わせてもよいし、ワイルドカード文字を使って、例えば「dir 
/p *.txt」とすると、ファイル拡張子が「.txt」であるすべてのファイル名を1画面ごとに止めて表示することができる。この場合、次の1画面を表示するには［Space］キーを、途中で中断するには［Ctrl］+［C］をそれぞれ押す。
もう1つ有用なオプションとしては、フォルダを再帰的にすべて検索して表示する「/s」がある。「dir /s」とすると、カレント・フォルダの下にあるフォルダをすべて順番に表示する。また「dir 
/s *.cnf」とすると、*.cnfにマッチするファイルをカレント・フォルダ以下からすべて検索して表示するという、ファイル検索コマンドとして使用できる。さらに「/b」を付けると、ファイルのフルパス名のみが表示されるので、これをファイルにリダイレクトすれば該当するファイル名の一覧テキストができる(「dir 
/s *.cnf /b > file.txt」とする)。
cdコマンドについて
補完機能を使ってcdコマンドの引数を選択することもできるが、cdでは特別にワイルドカード文字列が指定できるので、例えば「cd win*」などとする方が簡単でよいだろう(これは補完機能が無効でも利用できる)。ただし複数マッチする場合は、最初のフォルダになる。
type/moreコマンド
ファイルの内容を確認するには、typeコマンドかmoreコマンドを使用する。typeは指定されたファイル(1つだけ指定可能)の内容を表示するコマンドであるが、長いファイルだとあっという間にスクロールして見えなくなってしまうので、通常はmoreを使うとよい。moreでは、指定されたファイル(ワイルドカードなどを使って複数指定可能)の内容を1ページずつ表示する。［Space］キーを押すたびに1画面ずつスクロールし、［Enter］キーだと1行ずつスクロールする。ファイルが複数ある場合は、［F］キーを押すと次のファイルへと進む。途中でやめるには［Q］キーか［Ctrl］+［C］を押す。
ファイルの編集/プログラムの起動
ファイルの内容を編集するには、そのためのプログラムを起動する。例えばテキスト・ファイルならメモ帳を起動し、ビットマップ・ファイルならペイント・プログラムなどを起動する。だが、通常はどのアプリケーションを起動するかを気にせずに、単にコマンドライン上で「text.txt」などと入力すればよい(ファイルの拡張子まで省略せずに入力すること)。すると、「.txt」のオープン用に割り当てられているプログラム(通常はメモ帳)が自動的に起動する。これはちょうどエクスプローラでファイル名をダブルクリックした場合と同様である(Windows 
9x/Meでは、「start test.txt」などとする必要があったが、Windows 2000/XPでは「start」は不要)。直接特定のプログラムを使って起動したければ、「wordpad 
test.txt」とする。なお、startコマンドを使った実行方法は、［スタート］メニューの［ファイル名を指定して実行］でコマンド名やファイル名などを入力して実行させた場合と同じなので、WebサイトのURLなどを指定して実行させることもできる(例:「start 
www.microsoft.com」とすると、IEを使ってマイクロソフト社のWebサイト画面が表示される)。
ところで、Windows XPのメモ帳プログラムでは、［書式］メニューの［右端で折り返す］をオフにしておくと、［表示］メニューの［ステータス 
バー］が有効になる。するとカーソルのある行の行番号と桁位置がステータス・バー上に表示されるようになる。このため例えば、スクリプト・ファイルやHTMLファイルで「〜行目でエラーが発生しました」と表示された場合に、どこでエラーが起こっているかを簡単に知ることができる。Windows 
2000のメモ帳では行番号が分からなかったので、少し便利になっている。
そのほかのコマンド
コマンド・プロンプトではさまざまなコマンドが利用できるが、それらをすべて列挙するわけにもいかないので、いくつかまとめておく。詳細については各コマンドのヘルプなどを参照していただきたい。ほとんどのコマンドでは、例えば「copy 
/?」のように入力すると、その簡単な説明と書式が表示されるようになっている。
フォルダの作成
新しいフォルダを作成するには、md(mkdir)を使用する。
ファイル/フォルダの削除
ファイルを削除するにはdel(erase)コマンドを利用する。フォルダを削除する場合はrd(rmdir)を使用するが、このコマンドでは、ワイルドカードでは指定できず、一度に1つのフォルダしか削除できない。
フォルダ・ツリーを再帰的にすべて削除するには、rdに/sオプションを併用する(Windows 9x/Meではdeltreeという別のコマンドになる)。
ファイルの複写
copyコマンドかxcopyコマンドを使用する。通常は前者のcopyで足りるはずである。後者はサブフォルダを含むツリーをそのままコピーすることができるし、例えば新しいファイルだけ(ファイルの更新日付で比較する)をコピーしたり、ファイルの所有権やアクセス権などを維持したままコピーしたりする機能もある。
ファイルの名前変更/移動
ファイル/フォルダ名を変更するにはren(rename)を使用する。(コピーではなく)移動するには、moveコマンドを使う。
文字列の検索
ファイルの中に特定の文字列が含まれているかどうかを調べるには、findコマンドを使用する。ただしこのコマンドでは固定的な文字列しか検索できないので、正規表現を使って検索したければfindstrという別のコマンドを使用する。
ソート
テキスト・ファイルの内容を、その文字コード順にソートするにはsortコマンドを使用する。
ディスクのチェック
ボリューム全体のファイル・システムが正しいかどうかを検査するには、chkdskコマンドを使用する。
ネットワーク関係のコマンド
ネットワーク関係のコマンドも多数あるので、すべて列挙することはできないが、簡単に述べると次のようなものがある。
コマンド
説明
ping
ネットワーク的に到達できるかを調べる
ipconfig
アダプタごとのTCP/IPの設定状態などを調べる
netstat
TCP/IPのプロトコル・スタックの状態を調べる
nbtstat
NBTの状態を調べる
tracert
各ルータまでのルータの状態などを調べる
nslookup
DNSの状態を調べる
route
ルーティング・テーブルの状態を調べる
arp
ARPテーブルの状態を調べる
ftp
ftpのクライアント・プログラム
telnet
telnetのクライアント・プログラム
@IT:Windows TIPS -- Knowledge:これだけは覚えておきたい、コマンド・プロンプトの使い方
