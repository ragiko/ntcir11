【課題】デジタル画像を処理するための方法および装置を提供すること。【解決手段】一実施形態による方法は、複数のデジタル画像に属する複数の要素を表す要素データにアクセスするステップと、前記複数の要素中の前記要素間の類似性分析を実施して、前記要素に関係する相関データ結果を取得するステップと、前記複数の要素のクラスタリングを実施するステップとを含み、前記クラスタリングを実施するステップは、前記複数の要素中の要素に関係する少なくとも1つのハード制約条件を前記相関データ結果に組み込んで、制約条件付き相関データ結果を取得するステップと、前記制約条件付き相関データ結果から固有ベクトル結果を取得するためのスペクトル分析を実施するステップと、前記少なくとも1つのハード制約条件を強制する基準を用いた制約条件付きクラスタリングを使用し、前記固有ベクトル結果の離散化を実施してクラスタを取得するステップとを含む。
【発明の詳細な説明】【技術分野】【0001】  この本出願の基礎となるUS出願は、当該US出願と同時に出願された「Method  and  Apparatus  for  Context−Aided  Human  Identification」および「Method  and  Apparatus  for  Adaptive  Context−Aided  Human  Classification」と題する同時係属本出願の関連出願であり、各本出願は参照によりその内容全体が本明細書に組み込まれる。【0002】  本発明は、グループ化技法に関し、より詳細には、人々などのオブジェクトのデジタル画像をクラスタリングするための方法および装置に関する。【背景技術】【0003】  画像内のオブジェクトの識別および分類は、多くの分野で役立つ重要な応用分野である。例えば、画像内の人々の識別および分類は、写真アルバム内の画像の自動編成および検索、セキュリティの応用例などに重要かつ有用なものである。写真内およびデジタル画像データ内の人々を識別するために、顔認識が使用されている。しかしながら、信頼性のある顔認識および分類は、照明の変動や姿勢の変化などを含めた画像状態および人間画像の変動の故に、実現が困難である。【0004】  画像内の人々の同一性に基づく画像分類技法は、L.Zhang、L.Chen、M.Li、およびH.Zhangの「Automated  Annotation  of  Human  Faces  in  Family  Albums」Proc.ACM  Multimedia、MM03、Berkeley、CA、USA、Nov.2−8(2003年)(非特許文献1)で研究がなされている。この刊行物では、画像内の人々を特徴付けする上で、顔の特徴および文脈的特徴が使用されている。しかしながら、この刊行物では、人々の同一性に基づく画像のグループ化は、自動的に行うことができず、画像探索しか利用可能でない。【0005】  オブジェクトを複数のクラスにグループ化するために、K平均クラスタリング・アルゴリズムおよびスペクトル・クラスタリング・アルゴリズムが使用されている。スペクトル・クラスタリング・アルゴリズムは、J.ShiおよびJ.Malikの「Normalized  cuts  and  image  segmentation」Proc.CVPR(1997年6月)731〜737頁(非特許文献2)、Y.Weissの「Segmentation  using  eigenvectors:a  Unifying  View」Proc.ICCV(1999年)(非特許文献3)、ならびに、A.Y.Ng、M.I.Jordan、およびY.Weissの「On  spectral  clustering:Analysis  and  an  algorithm」NIPS  14(2002年)(非特許文献4)に記載されている。しかしながら、K平均クラスタリングは、照明の変動や姿勢の変化などの変動に起因して画像状態が変化する人間のクラスタリング(human  clustering)の場合と同様に、オブジェクトのクラスタが凸領域に対応しないときは失敗しやすい。スペクトル・クラスタリング方法にはこのような制限がないものの、スペクトル・クラスタリング・アルゴリズムでは、ハード制約条件(hard  constraint)などの状況情報を強制(enforce)することが非常に困難である。2つのオブジェクトが同じクラスタに属するか否かに関する情報を提供するハード制約条件は、オブジェクトのクラスタリングを行う上で重要かつ有用な手掛り(cue)を提供する。【非特許文献1】Automated  Annotation  of  Human  Faces  in  Family  Albums」Proc.ACM  Multimedia、MM03、Berkeley、CA、USA、Nov.2−8(2003年)【非特許文献2】J.ShiおよびJ.Malikの「Normalized  cuts  and  image  segmentation」Proc.CVPR(1997年6月)731〜737頁【非特許文献3】Y.Weissの「Segmentation  using  eigenvectors:a  Unifying  View」Proc.ICCV(1999年)【非特許文献4】A.Y.Ng、M.I.Jordan、およびY.Weissの「On  spectral  clustering:Analysis  and  an  algorithm」NIPS  14(2002年)【発明の開示】【発明が解決しようとする課題】【0006】  本願に開示の諸実施形態は、ハード制約条件が強制できる制約条件付きスペクトル・クラスタリング方法および装置を使用することによって、人間の認識および分類に関連する問題に対処する。この方法および装置は、新しい服装認識アルゴリズム(clothes  recognition  algorithm)を使用し、顔と服装の認識データの原理的統合を実施する。制約条件付きスペクトル・クラスタリング方法および装置は、文脈的手掛り(context  cue)およびユーザ・フィードバックに由来する論理ベース制約条件などのハード制約条件を強制することができる。【課題を解決するための手段】【0007】  本発明は、デジタル画像を処理するための方法および装置を対象とする。本発明の第1の態様によれば、デジタル画像処理方法は、複数のデジタル画像に属する複数の要素を表す要素データにアクセスするステップと、前記複数の要素中の前記要素間の類似性分析を実施して、前記要素に関係する相関データ結果(inter−relational  data  result)を取得するステップと、前記複数の要素のクラスタリングを実施するステップとを含み、前記クラスタリングを実施するステップは、前記複数の要素中の要素に関係する少なくとも1つのハード制約条件を前記相関データ結果に組み込んで、制約条件付き相関データ結果を取得するステップと、前記制約条件付き相関データ結果から固有ベクトル結果を取得するためのスペクトル分析を実施するステップと、前記少なくとも1つのハード制約条件を強制する基準を用いた制約条件付きクラスタリングを使用し、前記固有ベクトル結果の離散化を実施してクラスタを取得するステップとを含む。【0008】  本発明の第2の態様によれば、デジタル画像処理方法は、複数のデジタル画像に属する複数の要素を表す要素データにアクセスするステップと、前記複数の要素中の前記要素間の類似性分析を実施して、前記要素に関係する相関データ結果を取得するステップと、前記複数の要素のクラスタリングを実施するステップとを含み、前記クラスタリングを実施するステップは、前記要素間の非類似性に関係する少なくとも1つのハード・ネガティブ制約条件(hard  negative  constraint)を前記相関データ結果に組み込んで、制約条件付き相関データ結果を取得するステップと、前記制約条件付き相関データ結果から固有ベクトル結果を取得するためのスペクトル分析を実施するステップと、前記固有ベクトル結果をクラスタリングすることによる前記固有ベクトル結果の離散化を実施して、クラスタを取得するステップとを含む。【0009】  本発明の第3の態様によれば、デジタル画像処理装置は、複数のデジタル画像に属する複数の要素を表す要素データを提供する画像データ・ユニットと、前記複数の要素中の前記要素間の類似性分析を実施して、前記要素に関係する相関データ結果を取得する類似性分析ユニットと、前記複数の要素のクラスタリングを実施するクラスタリング・ユニットとを備え、前記クラスタリングを実施するクラスタリング・ユニットは、前記複数の要素中の要素に関係する少なくとも1つのハード制約条件を前記相関データ結果に組み込んで、制約条件付き相関データ結果を取得し、前記制約条件付き相関データ結果から固有ベクトル結果を取得するためのスペクトル分析を実施し、前記少なくとも1つのハード制約条件を強制する基準を用いた制約条件付きクラスタリングを使用し、前記固有ベクトル結果の離散化を実施してクラスタを取得することによって、クラスタリングを実施する。【0010】  本発明の第4の態様によれば、デジタル画像処理装置は、複数のデジタル画像に属する複数の要素を表す要素データを提供する画像データ・ユニットと、前記複数の要素中の前記要素間の類似性分析を実施して、前記要素に関係する相関データ結果を取得する類似性分析ユニットと、前記複数の要素のクラスタリングを実施するクラスタリング・ユニットとを備え、前記クラスタリングを実施するクラスタリング・ユニットは、前記要素間の非類似性に関係する少なくとも1つのハード・ネガティブ制約条件を前記相関データ結果に組み込んで、制約条件付き相関データ結果を取得し、前記制約条件付き相関データ結果から固有ベクトル結果を取得するためのスペクトル分析を実施し、前記固有ベクトル結果をクラスタリングすることによる前記固有ベクトル結果の離散化を実施してクラスタを取得することによって、クラスタリングを実施する。【0011】  本発明の別の諸態様および利点は、以下の詳細な説明を添付の図面と併せて読めば明らかとなるであろう。【発明を実施するための最良の形態】【0012】  以下の説明では、添付の図面を参照しながら本発明の諸態様をより具体的に記載する。図1は、本発明の一実施形態によるデジタル画像データの制約条件付きスペクトル・クラスタリングを実施する画像処理ユニットを含むシステムを概略的に示すブロック図である。図1に示されるシステム108は、次の構成要素、すなわち、画像入力デバイス28と、画像処理ユニット38と、表示装置68と、ユーザ入力ユニット58と、画像出力ユニット66と、印刷ユニット48とを含む。図1のシステム108の動作は、以下の論述を読めば明らかとなるであろう。【0013】  画像入力デバイス28は、画像処理ユニット38に画像データを提供する。画像データは、デジタル画像であることもある。画像入力デバイス28から入力できるデジタル画像の例は、人々の日常活動の写真や、セキュリティまたは身分証明のために撮影される人々の写真などである。画像入力デバイス28は、デジタル画像データを提供する任意の数のデバイスの1つまたは複数とすることができる。画像入力デバイス28は、画像データベースやデジタル・システムなどから取り出されるデジタル画像データを提供することもできる。画像入力デバイス28は、フィルム上に記録された白黒またはカラー画像を走査するスキャナ、デジタル・カメラ、例えばCD−R、フロッピー・ディスク、USBドライブなどの記録媒体、画像を記憶するデータベース・システム、ネットワーク接続、画像を処理するコンピュータ・アプリケーションのようなデジタル・データを出力する画像処理システムなどであってよい。【0014】  画像処理ユニット38は、画像入力デバイス28から画像データを受け取り、後段で詳細に論じる様式でデジタル画像データの制約条件付きスペクトル・クラスタリングを実施する。ユーザは、表示装置68を介して、デジタル画像データの制約条件付きスペクトル・クラスタリングにおける中間結果を含めた画像処理ユニット38の出力を閲覧することができ、ユーザ入力ユニット58を介して、画像処理ユニット38に対するコマンドを入力することができる。図1に示される実施形態では、ユーザ入力ユニット58は、キーボード60と、マウス61とを含んでいるが、他の従来の入力デバイスを使用することもできる。【0015】  本発明の諸実施形態によるデジタル画像データの制約条件付きスペクトル・クラスタリングを実施することに加え、画像処理ユニット38は、ユーザ入力ユニット58から受け取ったコマンドに従って、知られている色/密度補正機能だけでなく画像の切り取り(cropping)や圧縮など、追加的な画像処理機能を実施することもできる。印刷ユニット48は、画像処理ユニット38の出力を受け取り、処理済みの画像データのハード・コピーを生成する。印刷ユニット48は、画像処理ユニット38から出力された画像データに従って感光材料を露光させて、その感光材料に画像を記録することができる。印刷ユニット48は、カラー・レーザ・プリンタなど他の形をとることもできる。画像処理ユニット38の出力のハード・コピーを生成することに加えてまたはその代わりに、処理済みの画像データは、例えば携帯型記録媒体やネットワーク(図示せず)を介してファイルとしてユーザに返却することもできる。表示装置68は、画像処理ユニット38の出力を受け取り、画像データと共に当該画像データのクラスタリング結果を表示する。画像処理ユニット38の出力は、画像出力ユニット66にも送ることができる。画像出力ユニット66は、画像処理ユニット38から受け取られた画像のクラスタリング結果を記憶するデータベースとすることができる。【0016】  図2は、本発明の一実施形態によるデジタル画像データの制約条件付きスペクトル・クラスタリングを実施する画像処理ユニット38の諸態様をより詳細に示すブロック図である。図2に示されるように、この実施形態による画像処理ユニット38は、画像データ・ユニット125と、服装認識モジュール135と、顔認識モジュール145と、組合せモジュール155と、クラスタリング・モジュール165と、任意選択の顔検出モジュール144と、任意選択の頭部検出モジュール142とを含む。図2の様々な構成要素は離散的な要素として示されているが、かかる表現は説明を分かりやすくするためのものであり、様々な構成要素のある種の動作は、同じ物理デバイスによって、例えば1つまたは複数のマイクロプロセッサによって実施されてもよいことが理解されるべきである。【0017】  一般に、図2に示される画像処理ユニット38の各要素からなる構成は、画像入力デバイス28から画像セットを入力し、画像セット中の画像内の服装および顔の認識を実施し、画像セットに関する服装と顔の認識結果を組み合わせ、制約条件付きスペクトル・クラスタリングを使用して、画像内に示される人々の同一性に従って画像をクラスタリングする。クラスタリング・モジュール165は、画像内に示される人々の同一性に基づいて、画像の分類および識別結果を出力する。かかる分類および識別結果は、印刷ユニット48、表示装置68、および/または画像出力ユニット66に出力される可能性がある。画像データ・ユニット125は、服装認識モジュール135、顔認識モジュール145、任意選択の顔検出モジュール144、および任意選択の頭部検出モジュール142に画像を送る前に、それらの画像に対する前処理操作および作成処理を実施することもできる。画像に対して実施される前処理操作および作成処理としては、画像のサイズ、色、外観などを変更する、サイズ変更、切り取り、圧縮、色補正などを挙げることができる。【0018】  顔検出は、画像セット内の顔の位置およびサイズを判定する。顔認識は、検出された顔の同一性を既知の位置およびサイズを用いて判定する。したがって、顔認識は典型的には、顔検出の後に実施される。顔検出は、任意選択の顔検出モジュール144が存在する場合には、当該モジュールによって実施される。顔検出は、顔認識モジュール145が顔検出用のサブ・モジュールを含む場合には、顔認識モジュール145によって実施されてもよい。したがって、この場合、顔認識の実施には、顔検出の実施が含まれる。服装認識モジュール135は、顔認識モジュール145または任意選択の顔検出モジュール144と通信して、顔検出結果を取得することができる。別法として、服装認識モジュール135は、任意選択の頭部検出モジュール142から頭部検出結果を取得することもできる。【0019】  服装認識モジュール135、顔認識モジュール145、組合せモジュール155、クラスタリング・モジュール165、顔検出モジュール144、および頭部検出モジュール142は、例示的な一実装形態ではソフトウェア・システム/アプリケーションである。次に、図2に示される画像処理ユニット38内に含まれる構成要素の処理を、図3〜8を参照しながら説明する。【0020】  写真の自動編成は、写真アルバムの編成やセキュリティの応用例など、多くの潜在的な用途が存在する重要な応用分野である。現在の応用分野では、顔情報、服装情報、写真記録データ、および他の文脈的手掛りを使用することにより1人または複数の人物の同一性に従って写真が編成できる人間のクラスタリング技法が、実装されている。写真内の人物は、クラスタリング・アルゴリズムを使用し、その人物の同一性に基づいて複数のグループ(クラスタ)に配置される。したがって、同じ個人の画像は全て1つのクラスタ内に所在し、別の個人に由来する画像は他のクラスタ内に所在する。【0021】  人々の同一性に基づいて画像をクラスタリングするクラスタリング方法および装置は、顔認識ならびに画像内の他の手掛りを使用することができる。顔以外の情報(本願では「文脈」情報とも呼ばれる)が、人々を認識する上で豊富な手掛りを提供する可能性もある。これらのタイプの文脈情報は典型的には、画像内に所在する。第1のタイプの文脈情報は、ある人物が身に付けている服装などの外観ベース(appearance−based)の情報であり、第2のタイプの文脈情報は、例えば1枚の写真内の異なる顔は異なる人物に属するという事実や、一部の人々(例えば夫婦)は一緒に写真に写る可能性が高いという事実によって表現できる論理ベース(logic−based)の情報であり、第3のタイプの文脈情報は、写真の撮影された時間など写真のメタデータ(meta−data  of  pictures)である。これらの3つのタイプの文脈情報はしばしば、人間の観察者が写真内の人々を意識的にまたは無意識的に区別するのに使用される。文脈情報を有効に利用することができるクラスタリング方法は、人間の認識精度を向上させることができる。【0022】  本願に提示される方法および装置は、顔だけでなく可能な限り多くの文脈情報も使用することにより、人物の同一性に従って写真を自動的に編成する。本願に記載の方法を使用すると、文脈情報を使用した顔認識エンジンの結果が改善される。【0023】  本願では、「人物の画像(person  image)」、「人々の画像(people  images)」、または「複数の人物の画像(person  images)」という表現は、画像内の人々の画像を指すために相互に置換え可能に使用される。したがって、3人の人を示す画像は、3人の人物の画像を含み、1人の人物を示す画像は、1人の人物の画像を含む。【0024】  図3は、図2に示される本発明の一実施形態によるデジタル画像データの制約条件付きスペクトル・クラスタリングを行う画像処理ユニット38によって実施される処理を示す流れ図である。画像データ・ユニット125は、画像入力デバイス28から受け取った画像セットを入力する(S203)。これらの画像は、様々な姿勢で、様々な時間帯および様々な日にちに、様々な環境で撮影された人々の写真である可能性がある。【0025】  顔認識モジュール145は、画像セットを受け取り、当該画像セット(image  set)に含まれる画像内の顔の顔認識を実施する(S206)。顔認識は、顔の同一性に関連する顔情報を取得するために使用される。顔認識モジュール145は、顔の同一性に関係するスコア・セットを導出することができる。かかるスコアは、同じ画像または異なる画像中の2つの顔の相関を指示(indicate)することができる。異なる画像中の2つの顔が同じ人物に属する場合には、それらの2つの顔は、高い相関を示すことになる。一方、異なる画像中の2つの顔が異なる人に属する場合には、それらの2つの顔は、低い相関を示すことになる。顔認識モジュール145は、参照により本明細書に組み込まれる刊行物であるT.Leungの「Texton  Correlation  for  Recognition」Proc.European  Conference  Computer  Vision、ECCV(2004年)203〜214頁に記載の方法を使用して顔認識を実施し、顔認識スコアを取得することができる。「Texton  Correlation  for  Recognition」では、顔は、テクストン(texton)と呼ばれる局所的な特性特徴(local  characteristic  feature)を使用して、状況の変化による顔の外観の変動がテクストン間の相関で符号化されるように表現される。テクストンの相関をモデル化するには、2つの方法を使用することができる。1つの方法は、条件付きテクストン分散モデル(conditional  texton  distribution  model)であり、位置的独立性を仮定するものである。第2の方法は、フィッシャー線形識別分析を使用して各位置間の2次変動(second  order  variation)を取得するものである。テクストン・モデルは、長時間に及ぶ様々な照明および姿勢の画像内の顔認識に使用することができる。顔認識モジュール145は、顔対における顔間の類似性を測定する顔認識スコアを導出する(S206)。次いで、顔認識モジュール145は、顔認識スコアを組合せモジュール155に出力する(S207)。顔認識モジュール145によって他の顔認識技法が使用されてもよい。【0026】  服装認識モジュール135も、画像データ・ユニット125から画像セットを受け取り、服装認識を実施し、画像セットに含まれる画像内の人々の服装に関して、服装認識の類似性スコアを取得する(S209)。本発明で言及される服装は、実際の服装だけでなく、画像内の人々に関連する他の外部オブジェクトも含む。本願では、「服装」という用語は、様々な人々を区別する際に次の全てのオブジェクトが役立つ可能性があることから、実際の服装だけでなく、帽子、靴、腕時計、眼鏡なども指す。服装認識モジュール135は、服装認識スコアを組合せモジュール155に出力する(S210)。【0027】  服装認識スコアは、様々な人々の服装間の類似の程度を測定する。例えば、同じ服装をした人物が2つの画像に登場するときは、2つの異なる画像中の当該人物の服装に関連するスコアは、それらの服装が類似することを指示する。服装認識モジュール135は、参照によりその内容全体が本明細書に組み込まれる「Method  and  Apparatus  for  Context−Aided  Human  Identification」と題する相互参照の関連米国出願に記載の方法を使用し、服装認識を実施して服装認識スコアを取得することができる。【0028】  組合せモジュール155は、顔認識スコアを顔認識モジュール145から受け取り、服装認識スコアを服装認識モジュール135から受け取る。次いで、組合せモジュール155は、顔認識スコアと服装認識スコアとを統合して、画像内に存在する人々の間の複合的な類似性測定値(combined  similarity  measures)を取得する(S213)。顔のスコアと服装のスコアの両方を統合する複合的な類似性測定値は、様々な画像中の2人の人が同じ人物か否かを判定するより頑健な方法を実現する。線形ロジスティック回帰、フィッシャー線形識別分析、またはエキスパートの混合(mixture  of  experts)を使用して顔と服装の認識結果を組み合わせ、複合的な類似性測定値を取得することができる。顔と服装の認識結果を組み合わせて複合的な類似性測定値を取得する線形ロジスティック回帰法は、参照によりその内容全体が本明細書に組み込まれる「Method  and  Apparatus  for  Adaptive  Context−Aided  Human  Classification」と題する相互参照の関連米国出願に記載される技法を使用することができる。【0029】  クラスタリング・モジュール165は、組合せモジュール155から複合的な類似性測定値を受け取る。クラスタリング・モジュール165はこの複合的な類似性測定値に基づいて、画像内に存在する人々の同一性に従って画像を複数のクラスタにグループ化する(S217)。クラスタリング・モジュール165は、制約条件付きスペクトル・クラスタリングを使用して画像のクラスタリングを実施する。クラスタリング・モジュール165は、クラスタリング結果を出力する(S219)。かかる画像のクラスタリング結果は、印刷ユニット48、表示装置68、および/または画像出力ユニット66に出力される可能性がある。【0030】  図4は、本発明の一実施形態による服装認識を実施してデジタル画像データ内の服装に関する服装認識スコアを取得する技法を示す流れ図である。図4に記載の技法を使用して、服装認識モジュール135は、図3のステップS209の画像内の服装に関する類似性スコアを取得することができる。【0031】  服装認識は、画像内の服装の断片を識別し、服装の断片が互いにどの程度類似しているかを判定し、したがって、2人の人物の画像中の2着の服装の断片が実際に同じ個人に属する可能性がどの程度あるかを指示するものである。服装認識には3つの主要なステップが含まれ、すなわち、服装の検出およびセグメント化、特徴抽出による服装表現、ならびに抽出された特徴に基づく類似性計算が含まれる。【0032】  服装認識モジュール135は、画像データ・ユニット125から画像セットを受け取る(S244)。次いで、服装認識モジュール135は、画像内に存在する服装の検出およびセグメント化を実施する(S248)。服装の検出およびセグメント化は、初期の服装領域を検出する服装位置の初期推定と、洗練された(refined)服装領域を取得する画像内の初期の服装領域のセグメント化と、洗練された服装領域からのクラッタ除去とを含む。服装位置の初期推定値は、顔認識モジュール145からの顔検出結果、またはそれが存在する場合は任意選択の顔検出モジュール144からの顔検出結果を使用することによって、顔検出から取得される。顔認識モジュール145および任意選択の顔検出モジュール144は、参照により本明細書に組み込まれる次の各刊行物、すなわち、S.Ioffeの「Red  Eye  Detection  with  Machine  Learning」Proc.ICIP(2003年)、H.SchneidermanおよびT.Kanadeの「A  Statistical  Method  for  3D  Object  Detection  Applied  to  Faces  and  Cars」Proc.CVPR(2000年)、ならびにP.ViolaおよびM.Jonesの「Rapid  Object  Detection  Using  a  Boosted  Cascade  of  Simple  Features」Proc.CVPR(2001年)に記載の方法の1つまたは複数を使用して顔検出を実施することができる。服装位置の初期推定値は、任意選択の頭部検出モジュール142からの頭部検出結果から取得することもできる。頭部検出は、上記の各刊行物に記載の方法と同様の方法を使用して実施することができる。頭部検出を実施する他の方法が使用されてもよい。【0033】  クラッタは、実際には服装領域の一部ではないが服装領域と混合されまたはそれと混ざり合う画像領域である。クラッタとしては、服装を身に付けている人々の皮膚などの皮膚領域と、人物の前にある物体や人々の服装を遮る部分などの遮蔽物とが挙げられる。【0034】  次に、服装認識モジュール135は特徴を抽出し、服装領域の数値表現を取得するために、抽出された特徴を使用して服装領域を表現する(S252)。服装認識モジュール135によって生成される服装領域の数値表現は、さらなる分析のための服装領域の操作を可能にする。服装領域の代表的な領域またはコード・ワードが抽出され、服装領域に現れるコード・ワードの周波数から特徴ベクトルが生成される。特徴ベクトルは、服装領域の数値表現を提供する。【0035】  最後に、服装認識モジュール135は、類似性計算を実施して服装領域間の類似性スコアを判定する(S256)。2着の服装の断片の類似性スコアは、2着の服装の断片に関して重み付けされたコード・ワードの周波数ベクトルを正規化したスカラ積として計算される。次いで、服装認識モジュール135は、複数対の服装の断片に関する類似性スコアを組合せモジュール155に出力する(S210)。ステップS248、S252、およびS256がどのように実施されるかに関するさらなる詳細は、参照によりその内容全体が本明細書に組み込まれる「Method  and  Apparatus  for  Context−Aided  Human  Identification」と題する相互参照の関連米国出願で確認することができる。【0036】  図5Aは、顔と服装の認識結果を組み合わせて本発明の一実施形態による人物の画像に関する複合的な類似性測定値を取得する技法を示す図である。図5Aに記載の技法を使用して、組合せモジュール155は、図3のステップS213を実施する間に、人物の画像に関する複合的な類似性測定値を取得することができる。線形ロジスティック回帰、フィッシャー線形識別分析、またはエキスパートの混合を使用して顔と服装の認識結果を組み合わせ、複合的な類似性測定値を取得することができる。【0037】  服装情報は、顔情報を補完するものであり、プロフィールの顔の場合によくあるように、顔の位置および角度が変化する場合、顔の画像品質が悪い場合、または画像内の顔の表情が変動する場合は、非常に有益な情報となる。顔と服装の手掛りを統合したときは、顔の手掛りだけを使用したときよりも強力な画像内の人々の同一性認識の結果が達成される。組合せモジュール155は、服装の文脈を顔の文脈と統合して、類似性測定値を確率測定値の形で取得する。【0038】  手掛りの組合せの問題は、数学的には以下のように記述することができる。任意の対の画像に関しては、x1を顔認識に由来する顔認識スコアとし、x2を服装認識に由来する服装認識スコアとし、画像内に現れる2人の人の間の類似性を測定するものとする。ランダム変数Yは、当該対の人物が同じ人物であるか否かを示すものとする。したがって、Y=1は、2人の人物が同じ人物であることを意味し、Y=0は、そうでないことを意味する。手掛りの組合せの問題は、確率P(Y｜x1,x2)=f(x1,x2)      (1)から、当該対の人物の画像が同じ人物を表すものであるか否かが適切な形で指示されるような関数f(x1,x2)を発見することによって解決することができる。【0039】  線形ロジスティック回帰法では、関数fは、【0040】【数1】【0041】となり、上式で、【0042】【数2】【0043】であり、w=［w1,w2,w0］は、訓練画像セット(a  training  set  of  images)を学習することによってパラメータが決定される(S283)3次元ベクトルである。訓練画像セットは、同じ人物または異なる人物に由来する複数対の人物の画像を含む。複数対の訓練画像に関する顔認識スコアおよび服装認識スコアが、抽出される。パラメータwは、公式(2)の確率から、訓練対(training  pair)に由来する2人の人が同じ人物である場合と、訓練対に由来する2人の人が同じ人物でない場合とが正しく記述される可能性を最大化することができるパラメータとして決定される。訓練画像からw=［w1,w2,w0］がどのように決定されるかについての詳細は、参照によりその内容全体が本明細書に組み込まれる「Method  and  Apparatus  for  Adaptive  Context−Aided  Human  Classification」と題する相互参照の関連米国出願で確認することができる。【0044】  パラメータwは、学習プロセスの後に決定され、新しい画像に由来する顔認識スコアと服装認識スコアとを使用して新しい画像内の人々の間の複合的な類似性測定値を取得する、画像処理ユニット38の実際の動作に関する線形ロジスティック回帰で使用される(S279)。画像内の1対の人々に関しては、当該対の人物の画像に由来する顔認識スコアと服装認識スコアとを公式(2)に導入することによって、複合的な類似性測定値P(Y=1)が得られる(S285)。P(Y=1)は、1対の人物が実際に同じ人物となる確率である。したがって、顔認識スコアと服装認識スコアのいずれかが使用可能でない、または1対の人物の画像について欠落している場合も、確率P(Y=1)を計算する公式を採用することができる(S287、S289)。線形ロジスティック回帰法および公式選択/採用方法に関する詳細な説明は、参照によりその内容全体が本明細書に組み込まれる「Method  and  Apparatus  for  Adaptive  Context−Aided  Human  Classification」と題する相互参照の関連米国出願で確認することができる。【0045】  フィッシャー線形識別分析は、組合せモジュール155が顔と服装の認識結果を組み合わせ、複合的な類似性測定値を取得するために使用することもできる(S275)。フィッシャーの識別分析は、正の例(同じ人物に由来する画像対)と負の例(異なる人物に由来する画像対)とを最もよく区別できる係数を発見する基準を提供する。フィッシャー線形識別分析を使用して学習された線形係数を使用して、顔認識と服装認識に由来するスコアを線形的に組み合わせることができる。【0046】  エキスパートの混合は、組合せモジュール155がそれを使用して顔と服装の認識結果を組み合わせ、複合的な類似性測定値を取得することができる第3の方法である(S277)。線形ロジスティック回帰法およびフィッシャー線形識別分析法は、本質的に線形的であり、組合せの係数は、空間全体で同じになる。エキスパートの混合は、空間全体を分割することによって類似性測定値を組み合わせる手法を提供する。エキスパートの混合法は、それぞれロジスティック回帰単位となるいくつかのエキスパートを組み合わせるものである。組合せモジュール155は、参照により本明細書に組み込まれるM.I.JordanおよびR.A.Jacobsの「Hierarchical  Mixtures  of  Experts  and  the  EM  Algorithm」Neural  Computation,6(1994年)181〜214頁に記載のエキスパートの混合法を使用することもできる。【0047】  図5Bは、本発明の一実施形態による顔および服装の類似性スコアの利用可能性に基づいて人物の画像の類似性測定値を判定する技法を示す流れ図である。図5Bの技法は、組合せモジュール155が画像内の人々の間の類似性スコアを判定するために使用することができる。【0048】  組合せモジュール155は、服装認識モジュール135および顔認識モジュール145から顔および服装の認識スコアを受け取るものと仮定する(S501)。画像セット内に存在する人物の画像に関する顔および服装の認識スコアが、抽出される。組合せモジュール155は、写真の撮影された時間、または他の暗黙的な時間、あるいは画像セット中の画像の位置情報を検証することによって、画像セット中の画像が同じイベント(同じ日)に由来するものであるか否かを判定する(S502)。服装は、服装が変更されない同じイベントにおいて(または同じ日に)人々を認識する重要な手掛りを提供する。画像セット中の画像が同じイベントと同じ日に由来しない場合には、組合せモジュール155は、顔認識スコアだけを使用して、本明細書では総類似性スコア(overall  similarity  score)とも呼ばれる人々の間の複合的な類似性測定値を計算する(S503)。次いで、組合せモジュール155は、総類似性スコアをクラスタリング・モジュール165に送る。【0049】  画像セット中の画像が同じ日/イベントに由来するものである場合には、組合せモジュール155は、服装認識スコアと顔認識スコアがどちらも利用可能かつ使用可能であれば、これらのスコアを組み合わせることによって人々の間の総類似性スコアを計算する(S511)。顔がプロフィールの顔である場合または顔を遮るものが存在する場合によくあるように、いくつかの対の人物の画像に関する顔認識スコアが利用可能でない場合には、組合せモジュール155は、服装認識スコアだけを使用して人々の間の総類似性スコアを計算する(S513)。画像内の服装を遮るものが存在する場合によくあるように、いくつかの対の人物の画像に関する服装認識スコアが利用可能でない場合には、組合せモジュール155は、顔認識スコアだけを使用して人々の間の総類似性スコアを計算する(S515)。組合せモジュール155は、総類似性スコアをクラスタリング・モジュール165に送る。【0050】  画像内の2人の人が同じ(または同様の)服装をしているときは、特別な場合が発生する。人々が同じ(または同様の)服装をしている場合は、服装情報を組み込むことが困難となる。1枚の写真内の2人の人は通常、同じ個人ではない。したがって、1枚の写真内の2人の人物siおよびsjが同じ(または同様の)服装をしている場合は(S517)、服装情報を破棄する必要がある。したがって、同じ画像に由来するsiおよびsjが高い服装類似性スコアを有するときは、組合せモジュール155は、服装類似性スコアを欠落として扱い、顔類似性スコアだけを使用してsiとsjの間の総類似性スコアを計算する(S519)。【0051】  さらに、siと第3の人物sk(sk≠sj)の間の服装類似性スコアが高い場合(S521)、すなわちskの服装がsiの服装に(したがってsjの服装にも)非常に似ている場合には、総類似性スコアを計算する際に、siとskに関する服装類似性スコアも欠落として扱われる(S523)。同じように、sjと第3の人物sk(sk≠si)の間の服装類似性スコアが高い場合、すなわちskの服装がsjの服装に(したがってsiの服装にも)非常に似ている場合には、総類似性スコアを計算する際に、sjとskに関する服装類似性スコアも欠落として扱われる。【0052】  一方、画像セット中の任意の画像内に存在するsiと別の人物sk(sk≠sj)の画像間の1対の服装類似性が高くない場合には、総類似性スコアを計算する際に、siとskの間の服装認識スコアと共に、それが利用可能であれば顔認識スコアも使用することができる(S525)。同様に、画像セット中の任意の画像内に存在するsjと別の人物sk(sk≠si)の画像間の1対の服装類似性が高くない場合には、総類似性スコアを計算する際に、sjとskの間の服装認識スコアと共に、それが利用可能であれば顔認識スコアも使用することができる。【0053】  クラスタリング・モジュール165は、全ての総類似性スコアを受け取り、それらのスコアを使用して、画像内の人々の同一性に基づいて画像をクラスタリングする(S507)。【0054】  図6は、本発明の一実施形態による人物の画像のスペクトル・クラスタリングを実施する技法を示す流れ図である。図6の技法は、クラスタリング・モジュール165が画像内の人々の同一性に基づいて画像をクラスタリングするために使用することができる。組合せモジュール155によって取得される1対の確率類似性測定値(総類似性スコア)は、画像中の人々を各自の同一性に基づいてクラスタリングする基礎を提供し、したがって、各画像に示される人々の同一性に従って画像をクラスタリングする基礎を提供する。【0055】  J.ShiおよびJ.Malikの「Normalized  cuts  and  image  segmentation」Proc.CVPR(1997年6月)731〜737頁、Y.Weissの「Segmentation  using  eigenvectors:a  Unifying  View」Proc.ICCV(1999年)、A.Y.Ng、M.I.Jordan、およびY.Weissの「On  spectral  clustering:Analysis  and  an  algorithm」NIPS  14(2002年)、ならびにStella  X.Yuの博士論文「Computational  Models  of  Perceptual  Organization」Carnegie  Mellon  University(2003年:CMU−RI−TR−03−14)に記載されるように、従来のK平均法から現行のスペクトル・クラスタリング法にいたるまで、多くのクラスタリング・アルゴリズムが開発されている。K平均法を凌ぐスペクトル・クラスタリング法の主要な利点の1つは、クラスタが凸領域に対応しないとき、K平均法は失敗しやすい可能性があることである。各クラスタの密度がしばしばガウス型と仮定されるEMを使用してモデルを混合する場合にも同じことがいえる。人間のクラスタリングを行う際は、画像状態の様々な側面が変化する可能性もあることから、クラスタは、必ずしも凸領域を形成しない。したがって本願では、人間のクラスタリングにはスペクトル・クラスタリング・アルゴリズムの方が好都合である。【0056】  スペクトル・クラスタリング法は、ポイント間の1対の類似性から導出される行列の固有値および固有ベクトルによって各ポイントをクラスタリングする。スペクトル・クラスタリング法ではグローバル構造が想定されておらず、したがって、非凸クラスタを扱うことができる。スペクトル・クラスタリングは、例えば各ポイントがグラフ内のノードとなり、2つのポイント間の類似性が各ポイント間のエッジの重みを与える、グラフ・パーティショニングと同様のものである。人間のクラスタリングを行う際は、各ポイントは、人物の画像であり、類似性測定値は、顔および/または服装の認識スコアから同じ同一性が導出される確率である。【0057】  コンピュータ・ビジョンで使用される1つの効果的なスペクトル・クラスタリング法は、参照により本明細書に組み込まれるJ.ShiおよびJ.Malikの「Normalized  Cuts  and  Image  Segmentation」Proc.CVPR(1997年6月)731〜737頁に記載の正規化カット(normalized  cuts)方法である。上記の刊行物の正規化カット方法は、参照により本明細書に組み込まれるStella  X.Yuの博士論文「Computational  Models  of  Perceptual  Organization」Carnegie  Mellon  University(2003年:CMU−RI−TR−03−14)において一般化されている。【0058】  正規化カットの基準は、各クラスタ内のリンク(類似性)を最大化し、クラスタ間のリンクを最小化する。ポイント・セットS=｛s1,...,sN｝は、K個のクラスタにクラスタリングされるものとする。Wを、項Wijがポイントsiとsjの間の類似性となるN×Nの重み行列とする。Dは、i番目の対角要素がWのi番目の行の合計となる対角行列を表すものとする。クラスタリング結果は、N×Kの区画行列Xで表すことができ、ここでポイントsiがk番目のクラスタに属するとき、かつそのときに限り、Xik=1となる。Xlは、Xのl番目の列ベクトルを表すものとし、1≦l≦Kとする。Xlは、l番目のクラスタのメンバシップ・インジケータ・ベクトルである。これらの表記法を使用して、正規化カットの基準は、【0059】【数3】【0060】を最大化することができる最良の区画行列X*を発見する。【0061】  Xに対するバイナリ区画行列の制約条件を緩和し、レイリー・リッツ法を使用すれば、連続領域の最適解がD−1/2WD−1/2におけるK個の最大固有ベクトルから導出されることを示すことができる。viを、D−1/2WD−1/2におけるi番目の最大固有ベクトルとし、VK=［v1,v2,...,vK］とする。したがって、ε(X)の連続最適解(continuous  optimum)は、【0062】【数4】【0063】によって、すなわち、VKの行が正規化されたバージョン(【0064】【数5】【0065】の各行は単位長さとなる)によって達成することができる。最適解は実際には一意でなく、上記の最適解は、正規直交変換:【0066】【数6】【0067】までの行列セットであり、上式で、IkはK×Kの同一性行列である。【0068】  したがって、画像処理ユニット38の動作に関して、ポイント・セットS=｛s1,...,sN｝は、クラスタリング・モジュール165に入力されるものとし、ここで1≦i≦Nとする各ポイントsiは、画像セット中の画像に由来する人物の画像(顔または服装あるいはその両方を含む可能性がある)となる(S301)。したがって、画像I1が3人の人を示す場合には、画像I1は、組Sのs1,s2,s3に寄与する。画像I2が2人の人を示す場合には、画像I2は、組Sのs4,s5に寄与し、以下もまた同様である。ポイントs1,s2,...,sNは、画像内で発見される人々のK個の同一性の内の1つにそれぞれ対応するK個のクラスタにクラスタリングされることになる。【0069】  顔認識結果および/または服装認識結果から、2つのポイント間の類似性を組合せモジュール155によって計算することができる。次に、参照により本明細書に組み込まれるA.Y.Ng、M.I.Jordan、およびY.Weissの「On  spectral  clustering:Analysis  and  an  Algorithm」NIPS  14(2002年)に記載のスペクトル・クラスタリング法を説明する。ポイント(人物の画像)間の類似性測定値を使用して、i≠jのときは各項Aijがsiとsjの間の類似性スコアとなり、対角項についてAij=0となる、N×Nの親和性行列(affinity  matrix)Aが形成される(S303)。次いで、クラスタリング・モジュール165は、Dを、それ自体のi番目の対角要素がAのi番目の行の合計となる対角行列として定義する(S305)。次いで、クラスタリング・モジュール165は、行列L=D−1/2AD−1/2を構築し(S307)、LにおけるK個の最大固有ベクトルを発見し、それらの固有ベクトルを列にスタックすることによって行列Xを形成する(S309)。【0070】  画像セット内の異なる人の数Kは、クラスタリング・モジュール165がK個の最大固有ベクトルを選択する前にクラスタリング・モジュール165に入力される(S308)。画像セット内の異なる人の数は、発見されるクラスタの数である。画像内の異なる人またはクラスタの数は、複数の手法で判定することができる。画像セット内の異なる人の数は、ユーザがユーザ入力ユニット58を使用して、クラスタリング・モジュール165に手動で入力することができる。画像セット内の異なる人の数は、L行列の固有値を使用して発見することもできる。Lの最大固有値は1であり、全ての固有値は非負である。固有値は、1=λ1≧λ2≧...≧λN≧0となるように降順にソートされる。λiからλi+1への値の変化が大きい場合は、iをクラスタの数Kに適するように選択することができる。K平均クラスタリングでは、各ポイントからそれらの中心までの距離の合計に従ってクラスタの数を選択することにより、画像セット内の異なる人(クラスタ)の数を発見することもできる。クラスタの数Kに関していくつかの値を検査することができる。Kは、距離の計算の際に考慮する様々な次元の正規化が実施された後に、各ポイントからそれらの中心までの距離の合計が最小となるクラスタの数として選出される。【0071】  次いで、クラスタリング・モジュール165は、Xの各行を単位長さに再び正規化することによって行列Yを形成する(S311)。Yの各行をポイントとして扱うことにより、クラスタリング・モジュール165は、K平均アルゴリズムまたは他のアルゴリズムを使用してYの各行をクラスタリングする(S313)。最後に、クラスタリング・モジュール165は、Yのi番目の行をクラスタjに割り当てる場合は、各ポイントsiをクラスタjに割り当てる(S315)。【0072】  行列の固有値セットは、行列のスペクトルと呼ばれる。図6に示されるアルゴリズムは、データの親和性行列における固有値と固有ベクトルとを利用するものであり、したがって、スペクトル・クラスタリング・アルゴリズムに該当する。このアルゴリズムは本質的に、新しい空間においてデータがより良い形でクラスタリングされるように、データを新しい空間に変換する。【0073】  図7は、本発明の一実施形態によるハード制約条件を伴う相反性行列(repulsion  matrix)を使用して人物の画像のスペクトル・クラスタリングを実施する技法を示す流れ図である。図7の技法は、クラスタリング・モジュール165が画像内の人々の同一性に基づいて画像をクラスタリングするために使用することができる。【0074】  参照により本明細書に組み込まれる刊行物であるStella  X.Yuの博士論文「Computational  Models  of  Perceptual  Organization」Carnegie  Mellon  University(2003年:CMU−RI−TR−03−14)には、ポイント間の非類似性をモデル化するための相反性行列が紹介されている。クラスタリングの目標は、クラスタ内の類似性とクラスタ間の非類似性とを最大化する一方で、それぞれの補数を最小化することとされている。ポイント・セットS=｛s1,...,sN｝は、K個のクラスタにクラスタリングする必要があるものとし、ここで各ポイントskは、人物の画像である。Aを、類似性を定量化する行列(親和性行列)とし、Rを、非類似性を表す行列(相反性行列)とし、DAおよびDRをそれぞれ、AおよびRの行の合計に対応する対角行列とする。【0075】【数7】【0076】かつ【0077】【数8】【0078】と定義する。次いで、目標は、【0079】【数9】【0080】を最大化することができる区画行列Xを発見することとなる。連続最適解は、相反性行列が存在しない場合と同様の形式で、【0081】【数10】【0082】のK個の最大固有ベクトルを使用して発見することができる。【0083】  連続解は固有システムを解くことによって発見できるので、親和性行列と相反性行列とを使用する上記の方法は高速であり、連続領域のグローバル最適解を達成することができる。しかしながら、クラスタリングに関しては、連続解を離散化する必要がある。Stella  X.Yuの博士論文「Computational  Models  of  Perceptual  Organization」Carnegie  Mellon  University(2003年:CMU−RI−TR−03−14)では、離散化は、【0084】【数12】【0085】を最小化することができるバイナリ区画行列【0086】【数11】【0087】を発見するまで繰り返され、上式で、｜｜M｜｜は行列Mのフロベニウス・ノルム【0088】【数13】【0089】であり、Oは任意の正規直交行列であり、【0090】【数14】【0091】は、連続最適解である。【0092】  クラスタリング・モジュール165の目標は、可能な限り多くの文脈情報を利用して、各人物の同一性に従って写真をクラスタリングすることである。2つのポイント(2人の人物の画像)間の類似性計算は、クラスタリング・プロセスで重要なものである。画像内の顔と服装に加えて、その手掛りを組み込み人間の認識力を高めるのに利用できる追加的な手掛りが存在する可能性もある。論理ベース制約条件は、人々を同一性に基づいてクラスタリングする際に役立つ可能性がある追加的な手掛りである。かかる手掛りは、ハード制約条件とすることもできる。論理ベースの文脈および制約条件は、1枚の写真内の異なる顔は異なる個人に属するという制約条件や、夫婦は一緒に写真に写る可能性が高いという制約条件など、一般的な論理から得ることが可能な知識である。一部の論理ベース制約条件は、ハード制約条件である。例えば、1枚の写真内の異なる顔は異なる個人に属するという制約条件は、ネガティブ型のハード制約条件である。他の論理ベース制約条件は、夫婦は一緒に写真に写る可能性が高いという制約条件などのソフト制約条件である。別の有用なポジティブ型のソフト制約条件は、ある人物が一群の画像内に存在するという事前知識である。【0093】  したがって、ある顔が人物Aに属するはずであるという制約条件は、ハード制約条件である。一方、ある顔が人物Aに属する確率が80%であるという事実は、ソフト制約条件である。クラスタリング・モジュール165は、ハード制約条件として表現できる論理ベースの文脈をクラスタリング方法に組み込み、より多くの文脈的手掛りを使用することによって、人間のクラスタリング結果を改善することができる。論理制約条件を利用するために、図6に示されるクラスタリング手法は、相反性行列を使用することによって変更される。【0094】  人間のクラスタリングを行う際は、かかるハード制約条件を強制できることが望ましい。しかしながら、プライアーズ(priors)(ハード制約条件など)を組み込んだ場合は、スペクトル・クラスタリング・アルゴリズムに支障が生じる。Stella  X.Yuの博士論文「Computational  Models  of  Perceptual  Organization」Carnegie  Mellon  University(2003年:CMU−RI−TR−03−14)、ならびにS.X.YuおよびJ.Shiの「Grouping  with  Bias」NIPS(2001年)では、ポジティブ制約条件を課す方法が提案されているが、離散化ステップで制約条件の違反が起きる可能性がある故に、ポジティブ制約条件が尊重される保証はない。【0095】  本願の図7における人間のクラスタリングは、ネガティブ型ならびにポジティブ型のハード制約条件を強制しようと試みるものである。【0096】  公式(4)、(5)、および(6)で記述されるクラスタリング方法で導入した表記法を使用して、S=｛s1,...,sN｝を、画像セット中の全ての画像に由来する人物の画像に関連するポイント・セットとする(S325)。ポイントs1,s2,...,sNは、画像内で発見される人々の合計K個の同一性の内の1つにそれぞれ対応するK個のクラスタにクラスタリングされることになる。2つのポイントsiとsjの間の1対の類似性は、顔および/または服装の認識スコアならびに他の文脈的手掛りから取得される。複数対の人々の画像に関する類似性の値は、組合せモジュール155によって、複数対の人々が同じ人物となる確率として計算された。クラスタリング・モジュール165は、複数対の人物の画像に関連する類似性測定値を使用して、i≠jのときは各項Aijがsiとsjの間の確率類似性スコアとなり、i=jのときはAij=0となる、すなわち行列Aの対角項についてAij=0となる、N×Nの親和性行列Aを形成する(S327)。【0097】  siおよびsjは、同じ写真内で発見される2人の人物の画像とする。この場合、2人の人物は典型的には、異なる人物であり(異なる同一性を有し)、したがって、クラスタリング・モジュール165は、siおよびsjを異なるクラスタ内に配置することになる。この制約条件を埋め込むために、siとsjの間の類似性に対応する親和性行列A内の項Aijは、ゼロにセットされ、Aij=0となる(S329)。【0098】  ハード・ネガティブ制約条件を強化するために、2つのポイントsiとsjの非類似性の程度を記述する相反性行列Rが生成される(S331)。siおよびsjが同じ写真内で発見される2人の人物の画像であり、したがって異なる人を表す場合は、項Rijは、1にセットされる。より一般的にいえば、項Rijは、siおよびsjが同じクラスタ内に所在する可能性がない場合に1にセットされることになる(S333)。ポイントsiとsjの間の既知の制約条件が存在しない場合は、対応する項Rijは、ゼロにセットされる。【0099】  DRを、それ自体のi番目の対角要素がRのi番目の行の合計となる対角行列とし(S335)、DAを、それ自体のi番目の対角要素がAのi番目の行の合計となる対角行列とする(S337)。行列【0100】【数15】【0101】および【0102】【数16】【0103】は、公式(4)および(5)の場合と同様に、【0104】【数17】【0105】および【0106】【数18】【0107】によって定義される(S339)。次いで、L行列が、【0108】【数19】【0109】として定義される(S341)。次いで、クラスタリング・モジュール165は、LにおけるK個の最大固有ベクトルを発見し、それらの固有ベクトルを列にスタックすることによって行列Xを形成する(S343)。【0110】  画像セット内の異なる人の数Kは、クラスタリング・モジュール165がK個の最大固有ベクトルを選択する前にクラスタリング・モジュール165に入力される(S360)。画像セット内の異なる人の数は、発見されるクラスタの数である。画像内の異なる人またはクラスタの数は、複数の手法で判定することができる。画像セット内の異なる人の数は、ユーザがユーザ入力ユニット58を使用して、クラスタリング・モジュール165に手動で入力することができる。画像セット内の異なる人の数は、図6の場合と同様に構築される行列L0=D−1/2AD−1/2の固有値を使用して、図6で説明したような形で発見することもできる。画像セット内の異なる人(クラスタ)の数は、図6で説明したようなK平均クラスタリングにおいて、各ポイントからそれらの中心までの距離の合計に従ってクラスタの数を選択することによって発見することもできる。【0111】  次いで、クラスタリング・モジュール165は、Xの各行を単位長さに再び正規化することによって行列Yを形成する(S345)。Yの各行をポイントとして扱うことにより、クラスタリング・モジュール165は、K平均アルゴリズムまたは他のアルゴリズムを使用してYの各行をクラスタリングする(S347)。最後に、クラスタリング・モジュール165は、Yのi番目の行をクラスタjに割り当てる場合は、各ポイントsiをクラスタjに割り当てる(S350)。【0112】  図8は、本発明の一実施形態によるハード制約条件を強制する、人物の画像の制約条件付きK平均クラスタリング(constrained  K−means  clustering)を用いたスペクトル・クラスタリングを実施する技法を示す流れ図である。図8の技法は、クラスタリング・モジュール165が画像内の人々の同一性に基づいて画像をクラスタリングするハード制約条件を強制するために使用することができる。【0113】  スペクトル・クラスタリング法は、クラスタが凸領域に対応しないとき、K平均法が失敗しやすい可能性がある故にK平均法よりも有利であるが、スペクトル・クラスタリング法では、ハード制約条件を強制することが困難である。親和性行列Aおよび相反性行列Rにハード制約条件を導入した場合も、離散化ステップの間にハード制約条件が満足される保証がない故に、これらの制約条件を強制するには十分でない可能性がある。制約条件付きK平均クラスタリングは、ハード制約条件が満足されることを保証するために実施される。【0114】  K平均クラスタリングにハード制約条件を統合する制約条件付きK平均アルゴリズムは、参照により本明細書に組み込まれるK.Wagstaff、C.Cardie、S.Rogers、およびS.Schroedlの「Constrained  K−Means  Clustering  with  Background  Knowledge」Proc.18th  International  Conference  on  Machine  Learning  ICML(2001年)577〜584頁に提示されている。参照により本明細書に組み込まれるA.Y.Ng、M.I.Jordan、およびY.Weissの刊行物「On  Spectral  Clustering:Analysis  and  an  Algorithm」NIPS  14(2002年)では、離散化ステップにおいてK平均法が使用されている。しかしながら、この刊行物では、相反性行列が使用されず、相反性行列を用いたK平均法の使用も正当化されず、制約条件付きK平均法の代わりに通常のK平均法が使用されており、したがって制約条件が何ら課されていない。【0115】  本願では、離散化ステップにおいて、画像内の人間のクラスタリングを行うハード制約条件を強制する制約条件付きK平均アルゴリズムが実施される。制約条件付きK平均アルゴリズムは、参照により本明細書に組み込まれる刊行物であるK.Wagstaff、C.Cardie、S.Rogers、およびS.Schroedlの「Constrained  K−Means  Clustering  with  Background  Knowledge」Proc.18th  International  Conference  on  Machine  Learning  ICML(2001年)577〜584頁に記載の方法を使用することができる。【0116】  S=｛s1,...,sN｝は、画像セット中の全ての画像に由来する人物の画像に関連するポイント・セットとする(S425)。ポイントs1,s2,...,sNは、画像内で発見される人々の合計K個の同一性の内の1つにそれぞれ対応するK個のクラスタにクラスタリングされることになる。先述のように、2つのポイントsiとsjの間の1対の類似性は、顔および/または服装の認識スコアならびに他の文脈的手掛りから取得される。複数対の人々の画像に関する類似性の値は、組合せモジュール155によって、複数対の人々が同じ人物となる確率として計算された。クラスタリング・モジュール165は、複数対の人物の画像に関連する類似性測定値を使用して、i≠jのときは各項Aijがsiとsjの間の確率類似性スコアとなり、i=jのときはAij=0となる、すなわち行列Aの対角項についてAij=0となる、N×Nの親和性行列Aを形成する(S427)。【0117】  次に、クラスタリング・モジュール165は、siとsjが異なるクラスタに属する(異なる人となる)ことが分かったときにAij=0とすることにより、親和性行列Aにハード・ネガティブ制約条件を埋め込む(S429)。クラスタリング・モジュール165はまた、siとsjの間にハード・ポジティブ制約条件が存在するときにAij=1とすることにより、親和性行列Aにハード・ポジティブ制約条件も埋め込む(S429、S471)。ポジティブ制約条件の一例は、ある人物が連続する写真に現れるという制約条件である。例えば、2つの画像内の2人の人物の画像siとsjが同じ個人に属する場合は、上記のアルゴリズムは、親和性行列Aにおいて項Aij=1とセットし、ステップS431で生成された相反性行列Rにおいて項Rij=0とセットすることにより、かかるポジティブ制約条件を強制することができる。かかるハード・ポジティブ制約条件は、ある人物の現れる画像がアプリケーションで正確に示された旨の指示がユーザから受け取られるユーザ・フィードバックから利用可能になる可能性がある。【0118】  クラスタリング・モジュール165は、2つのポイントsiとsjの非類似性の程度を記述する相反性行列Rも生成する(S431)。siとsjが同じクラスタ内に所在する可能性がない(異なる人を表す)場合は、ハード・ネガティブ制約条件を埋め込むために、項Rijは、1にセットされる(S433)。クラスタリング・モジュール165は、ポジティブ制約条件が利用可能であれば、相反性行列Rにハード・ポジティブ制約条件を埋め込むこともできる(S471)。【0119】  次いで、クラスタリング・モジュール165は、それ自体のi番目の対角要素がRのi番目の行の合計となる対角行列DRを生成し(S435)、それ自体のi番目の対角要素がAのi番目の行の合計となる対角行列DAを生成する(S437)。行列【0120】【数20】【0121】および【0122】【数21】【0123】は、公式(4)および(5)の場合と同様に、【0124】【数22】【0125】および【0126】【数23】【0127】によって定義される(S439)。次いで、L行列が、【0128】【数24】【0129】として定義される(S441)。【0130】  次いで、クラスタリング・モジュール165は、LのK個の最大固有ベクトルを発見し、それらの固有ベクトルを列にスタックすることによって行列Xを形成する(S443)。画像セット内の異なる人の数Kは、クラスタリング・モジュール165がK個の最大固有ベクトルを選択する前にクラスタリング・モジュール165に入力される(S473)。画像セット内の異なる人の数は、発見されるクラスタの数である。画像内の異なる人またはクラスタの数は、複数の手法で判定することができる。画像セット内の異なる人の数は、ユーザがユーザ入力ユニット58を使用して、クラスタリング・モジュール165に手動で入力することができる。画像セット内の異なる人の数は、図6の場合と同様に構築される行列L0=D−1/2AD−1/2の固有値を使用して、図6で説明したような形で発見することもできる。画像セット内の異なる人(クラスタ)の数は、図6で説明したようなK平均クラスタリングにおいて、各ポイントからそれらの中心までの距離の合計に従ってクラスタの数を選択することによって発見することもできる。【0131】  次いで、クラスタリング・モジュール165は、Xの各行を単位長さに再び正規化することによって行列Yを形成する(S445)。Yの各行をポイントとして扱うことにより、クラスタリング・モジュール165は、制約条件付きK平均クラスタリングを使用してYの各行をクラスタリングする(S447)。ユーザ入力58からの追加のポジティブ制約条件および/またはネガティブ制約条件が、クラスタリング・モジュール165によって受け取られることもある(S481)。制約条件付きK平均クラスタリングは、ハード制約条件を強制する。制約条件付きK平均アルゴリズムが繰り返される度に、ポイントがクラスタに割り当てられるときは、(1)クラスタの中心までの距離、および(2)ハード制約条件が満足されたかどうか、という2つの基準が使用される。ポイントは、ハード制約条件が違反されないときに限りクラスタに割り当てることができる。したがって、各ポイントは、ハード制約条件に違反しない最も近くにあるクラスタに割り当てられる。したがって、制約条件付きK平均法は、ハード制約条件が満足されることを保証する。クラスタリング・モジュール165はステップS447で、制約条件付きK平均法の代わりに、制約条件を使用し尊重する他の制約条件付きクラスタリング方法を使用することもできる。【0132】  クラスタリング・モジュール165は、Yのi番目の行をクラスタjに割り当てる場合は、各ポイントsiをクラスタjに割り当てる(S450)。次いで、クラスタリング・モジュール165は、画像内の人々の同一性に基づいて、画像セット内の画像に関するK個のクラスタを出力する(S483)。ユーザは、クラスタリング結果を閲覧し、ある人物が画像内に現れるか否かに関することなど、追加の新しいポジティブ制約条件および/またはネガティブ制約条件を入力することができる(S481)。追加の新しいポジティブ制約条件および/またはネガティブ制約条件の入力は、ステップS429およびS433で、親和性行列Aおよび相反性行列Rに埋め込まれる。次いで、クラスタリング・モジュール165は、制約条件付きK平均クラスタリングを再び実行し、それによって新たに受け取られた制約条件を強制することができる。図8のステップ・シーケンスは、クラスタリング結果を洗練するためにユーザが望む所望の回数だけ実施することができる。【0133】  次に、(相反性行列および制約条件の使用の有無を問わず)K平均法の使用が正当化され、したがって制約条件付きK平均法の使用が正当化される理由を提示する。【0134】【数25】【0135】は、図8のステップS445または図7のステップ345または図6のステップS311で取得される行列Yである。【0136】【数26】【0137】の各行は、人物の画像srに対応しており、したがって、【0138】【数27】【0139】の各行は、ポイントとして解釈され、それらのポイントに対してK平均クラスタリングまたは制約条件付きK平均クラスタリングが実施される。離散化ステップでは、K平均クラスタリングは、元のポイント・セットS=｛s1,...,sN｝に対してではなく、【0140】【数28】【0141】の各行に対して実施するのが有利である。というのも、K平均クラスタリングは、【0142】【数30】【0143】を取得するために実施されるスペクトル・クラスタリングの各ステップが場合により(元のポイント・セットS=｛s1,...,sN｝が非凸クラスタを形成している場合に)非凸クラスタを凸クラスタに変換したときに、【0144】【数29】【0145】の各行に対して作用することができるからである。【0146】  K平均クラスタリングまたは制約条件付きK平均クラスタリング方法は、【0147】【数32】【0148】を最小化する最良の区画行列【0149】【数31】【0150】と同等の良好な結果を達成することができ、上式で、Oは正規直交行列である。K平均クラスタリングが【0151】【数34】【0152】を最小化する最良の区画行列【0153】【数33】【0154】と同等の良好な結果が達成できることを証明するために、命題1および2が使用される。命題1は、任意の正規直交行列Oについて、【0155】【数35】【0156】および【0157】【数36】【0158】の行ベクトルが、次の条件の下に、例えば【0159】【数37】【0160】に関しては、clが初期のl番目の中心となり、次いで【0161】【数38】【0162】に関しては、clOが初期のl番目の中心となる場合に、同じK平均クラスタリング結果を有することを表明する。【0163】  命題2は、【0164】【数39】【0165】と仮定し、O*が【0166】【数40】【0167】を最小化する離散的な区画行列および回転行列となることを表明する。K×Kの同一性行列IKの各行がクラスタの中心として解釈される場合は、【0168】【数41】【0169】の行ベクトルに対してK平均クラスタリングを1回繰り返すことにより、区画行列【0170】【数42】【0171】で表されるクラスタリング結果と同じクラスタリング結果が達成される。さらに、【0172】【数43】【0173】が小さい場合は、クラスタの中心は、IKの各行から遠く離れることはなく、したがって、【0174】【数44】【0175】の各行に対するK平均クラスタリングは、【0176】【数45】【0177】と同じクラスタリング結果に収束することになる。命題1および2から、【0178】【数46】【0179】が小さく、(O*)−1の各行が初期のクラスタの中心として解釈される場合は、【0180】【数47】【0181】に対するK平均クラスタリングは、【0182】【数48】【0183】と同じ結果を達成する。【0184】【数49】【0185】が小さいということは、各ポイントが実際に良好なクラスタに由来することを意味し、そうでない場合には、クラスタリング・アルゴリズムは十分な働きをすることができない。(O*)−1の良好な近似値は、【0186】【数50】【0187】の各行の直交ベクトルを発見することによって見出すことができる。したがって、制約条件付きK平均法によってハード制約条件が強制できることから、K平均法は、ハード制約条件を組み込むのにより適した離散化方法といえる。【0188】  本願では、制約条件付きスペクトル・クラスタリングを使用するための方法および装置が説明されている。この方法および装置は、顔情報と、服装情報と、他の利用可能な文脈情報(1枚の写真内の人々が異なる個人となる事実など)とを使用して認識および分類を実施するものである。本願に提示される方法および装置は、複数の結果を達成する。本願に提示される方法および装置は、1枚の写真に由来する複数の人物が異なるクラスタ内に存在する事実などの文脈情報を利用して、スペクトル・クラスタリング・アルゴリズムを発展させるものである。この方法および装置は、従来のクラスタリング・アルゴリズムよりも優れた結果をもたらす。本願に提示される方法および装置は、顔および服装の情報が欠落している場合にも、適切な周辺確率を計算することによってこれに対処することができる。本願の方法および装置は、相反性行列および制約条件付きK平均法を使用することによって、顔情報および服装情報だけでなくより多くの文脈的手掛りも組み込むことができる。例えば、この方法および装置は、1枚の写真に由来する複数の人物が異なるクラスタ内に所在するという制約条件などのハード・ネガティブ制約条件を強制することができる。本願の方法および装置は、同じ画像内で発見される異なる人が同じ(または同様の)服装をしている場合にも対処することができる。【0189】  本願に詳細に記載される諸実施形態は、人間の認識および分類に関するものであるが、本発明の諸原理は、デジタル画像内に現れる他のタイプのオブジェクトに適用することもできる。【0190】  以上、本発明の詳細な諸実施形態および諸実装形態を説明してきたが、本発明の趣旨および範囲を逸脱しない様々な修正形態が可能であることは明らかなはずである。【図面の簡単な説明】【0191】【図1】本発明の一実施形態によるデジタル画像データの制約条件付きスペクトル・クラスタリングを実施する画像処理ユニットを含むシステムを概略的に示すブロック図である。【図2】本発明の一実施形態によるデジタル画像データの制約条件付きスペクトル・クラスタリングを実施する画像処理ユニットの諸態様をより詳細に示すブロック図である。【図3】図2に示される本発明の一実施形態によるデジタル画像データの制約条件付きスペクトル・クラスタリングを行う画像処理ユニットによって実施される処理を示す流れ図である。【図4】本発明の一実施形態による服装認識を実施してデジタル画像データ内の服装に関する服装認識スコアを取得する技法を示す流れ図である。【図5A】顔と服装の認識結果を組み合わせて本発明の一実施形態による人物の画像の複合的な類似性測定値を取得する技法を示す図である。【図5B】本発明の一実施形態による顔および服装の類似性スコアの利用可能性に基づいて人物の画像の類似性測定値を判定する技法を示す流れ図である。【図6】本発明の一実施形態による人物の画像のスペクトル・クラスタリングを実施する技法を示す流れ図である。【図7】本発明の一実施形態によるハード制約条件を伴う相反性行列を使用して人物の画像のスペクトル・クラスタリングを実施する技法を示す流れ図である。【図8】本発明の一実施形態によるハード制約条件を強制する、人物の画像の制約条件付きK平均クラスタリングを用いたスペクトル・クラスタリングを実施する技法を示す流れ図である。【符号の説明】【0192】  28  画像入力デバイス  38  画像処理ユニット  48  印刷ユニット  58  ユーザ入力ユニット  60  キーボード  61  マウス  66  画像出力ユニット  68  表示装置  125  画像データ・ユニット  135  服装認識モジュール  142  頭部検出モジュール  144  顔検出モジュール  145  顔認識モジュール  155  組合せモジュール  165  クラスタリング・モジュール
【特許請求の範囲】【請求項1】  デジタル画像処理方法であって、  複数のデジタル画像に属する複数の要素を表す要素データにアクセスするステップと、  前記複数の要素中の前記要素間の類似性分析を実施して、前記要素に関係する相関データ結果を取得するステップと、  前記複数の要素のクラスタリングを実施するステップとを含み、クラスタリングを実施する前記ステップは、    前記複数の要素中の要素に関係する少なくとも1つのハード制約条件を前記相関データ結果に組み込んで、制約条件付き相関データ結果を取得するステップと、    前記制約条件付き相関データ結果から固有ベクトル結果を取得するためのスペクトル分析を実施するステップと、    前記少なくとも1つのハード制約条件を強制する基準を用いた制約条件付きクラスタリングを使用し、前記固有ベクトル結果の離散化を実施してクラスタを取得するステップとを含む、  デジタル画像処理方法。【請求項2】  離散化を実施する前記サブ・ステップは、制約条件付きK平均クラスタリングを使用する、請求項1に記載のデジタル画像処理方法。【請求項3】  前記要素は、前記複数のデジタル画像内で発見される人々である、請求項1に記載のデジタル画像処理方法。【請求項4】  前記少なくとも1つのハード制約条件は、前記複数のデジタル画像中の同じ画像内で発見される2人の人が異なる同一性を有するハード・ネガティブ制約条件を含む、請求項3に記載のデジタル画像処理方法。【請求項5】  前記少なくとも1つのハード制約条件は、前記複数のデジタル画像中の異なる画像内で発見される2人の人が同じ人物となる所定の知識に基づくハード・ポジティブ制約条件を含む、請求項3に記載のデジタル画像処理方法。【請求項6】  前記要素間の類似性分析を実施する前記ステップは、  前記人々の顔間の顔類似性分析を実施して、前記人々の顔間の顔類似性測定値を取得するステップと、  前記人々の服装間の服装類似性分析を実施して、前記人々の服装間の服装類似性測定値を取得するステップと、  前記顔類似性測定値と前記服装類似性測定値との利用可能性に基づいて、同じ人物を表す前記複数のデジタル画像中の複数対の人々に関する類似性測定値を推定する複数の公式を提供するステップとを含む、  請求項3に記載のデジタル画像処理方法。【請求項7】  前記要素間の類似性分析を実施する前記ステップは、  前記複数のデジタル画像中の画像が撮影された時間に基づいて、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択し、  前記複数のデジタル画像中の画像が撮影された場所に基づいて、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択し、  単一の画像内で2人以上の人物が同じ服装をしているかどうかに基づいて、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択し、  前記顔類似性測定値に由来する顔類似性測定値だけが利用可能であり、前記服装類似性測定値に由来する服装類似性測定値は利用可能でない場合に、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択し、  前記服装類似性測定値に由来する服装類似性測定値だけが利用可能であり、前記顔類似性測定値に由来する顔類似性測定値は利用可能でない場合に、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択し、  前記顔類似性測定値に由来する顔類似性測定値と、前記服装類似性測定値に由来する服装類似性測定値とが利用可能である場合に、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択する、  請求項6に記載のデジタル画像処理方法。【請求項8】  服装をセグメント化し、隣接する服装間の差を最大化することにより、前記複数のデジタル画像内の服装領域を判定するステップと、  類似性分析を実施する前記ステップの前に、前記服装領域からクラッタを除去するステップと  をさらに含む、請求項6に記載のデジタル画像処理方法。【請求項9】  前記複数のデジタル画像内の服装は、衣服、靴、腕時計、および眼鏡の内の少なくとも1つを含む、請求項8に記載のデジタル画像処理方法。【請求項10】  クラッタを除去する前記ステップの後でかつ類似性分析を実施する前記ステップの前に、服装の特徴抽出を実施するステップをさらに含み、服装の特徴抽出を実施する前記ステップは、    前記服装領域から代表的な画像パッチを抽出するステップと、    前記要素間の類似性分析を実施する前記ステップで使用される前記服装領域の数値表現を取得するために、前記服装領域内に現れる前記代表的な画像パッチの周波数から特徴ベクトルを生成するステップとを含む、  請求項8に記載のデジタル画像処理方法。【請求項11】  前記クラスタの数は、前記複数の要素のクラスタリングを実施する前記ステップの前に予め決定される、請求項1に記載のデジタル画像処理方法。【請求項12】  前記固有ベクトル結果は、数値要素セットであり、  前記複数の要素中の要素と前記数値要素の間に1対1の対応関係が存在し、  複数の要素中の各要素は、前記クラスタ中、離散化を実施する前記サブ・ステップで前記数値要素の対応する数値要素がクラスタリングされたクラスタに割り当てられる、  請求項1に記載のデジタル画像処理方法。【請求項13】  類似性分析を実施する前記ステップは、    前記要素間の類似性スコアを取得するステップと、    前記類似性スコアを使用して親和性行列Aを取得するステップとを含み、  組み込みを行う前記サブ・ステップは、    前記親和性行列Aに前記少なくとも1つのハード制約条件を組み込むステップと、    前記親和性行列Aを使用して、前記制約条件付き相関データ結果を相関データ行列Lの形で取得するステップとを含み、  スペクトル分析を実施する前記サブ・ステップは、    前記相関データ行列Lにおける所定の数の最大固有ベクトルを選択するステップと、    選択された固有ベクトルを列にスタックして行列Xを取得するステップと、    前記行列Xの各行を単位長さに正規化して前記固有ベクトル結果を行列Yの形で取得するステップとを含み、  離散化を実施する前記サブ・ステップは、    前記少なくとも1つのハード制約条件を強制する基準を使用した制約条件付きK平均クラスタリングを使用し、前記行列Yの各行をクラスタリングして、前記クラスタを取得するステップと、    前記複数の要素中の要素を、前記要素に関連する前記行列Yの各行が割り当てられているクラスタに割り当てるステップとを含む、  請求項1に記載のデジタル画像処理方法。【請求項14】  前記要素は、前記複数のデジタル画像内で発見される人々であり、  前記少なくとも1つのハード制約条件は、前記複数のデジタル画像中の同じ画像内で発見される2人の人が異なる同一性を有するネガティブ制約条件を含み、  前記要素間の類似性分析を実施する前記ステップは、    前記人々の顔間の類似性分析を実施して、前記人々の顔間の顔類似性スコアを取得するステップと、    前記人々の服装間の類似性分析を実施して、前記人々の服装間の服装類似性スコアを取得するステップと、    複数対の人々に関する前記顔類似性スコアと前記服装類似性スコアとを組み合わせて、前記類似性スコアを取得するステップと、    前記複数対の人々に関する前記類似性スコアを使用して前記親和性行列Aを取得するステップとを含む、  請求項13に記載のデジタル画像処理方法。【請求項15】  デジタル画像処理方法であって、  複数のデジタル画像に属する複数の要素を表す要素データにアクセスするステップと、  前記複数の要素中の前記要素間の類似性分析を実施して、前記要素に関係する相関データ結果を取得するステップと、  前記複数の要素のクラスタリングを実施するステップとを含み、前記クラスタリングを実施するステップは、    前記要素間の非類似性に関係する少なくとも1つのハード・ネガティブ制約条件を前記相関データ結果に組み込んで、制約条件付き相関データ結果を取得するステップと、    前記制約条件付き相関データ結果から固有ベクトル結果を取得するためのスペクトル分析を実施するステップと、    前記固有ベクトル結果をクラスタリングし、前記固有ベクトル結果の離散化を実施してクラスタを取得するステップとを含む、  デジタル画像処理方法。【請求項16】  離散化を実施する前記サブ・ステップは、前記固有ベクトル結果をクラスタリングして前記クラスタを取得するために、K平均クラスタリングを使用する、請求項15に記載のデジタル画像処理方法。【請求項17】  前記要素は、前記複数のデジタル画像内で発見される人々であり、  前記少なくとも1つのハード制約条件は、前記複数のデジタル画像中の同じ画像内で発見される2人の人が異なる同一性を有するネガティブ制約条件を含む、  請求項16に記載のデジタル画像処理方法。【請求項18】  前記要素間の類似性分析を実施する前記ステップは、  前記人々の顔間の顔類似性分析を実施して、前記人々の顔間の顔類似性測定値を取得するステップと、  前記人々の服装間の服装類似性分析を実施して、前記人々の服装間の服装類似性測定値を取得するステップと、  前記顔類似性測定値と前記服装類似性測定値との利用可能性に基づいて、同じ人物を表す前記複数のデジタル画像中の複数対の人々に関する類似性測定値を推定する複数の公式を提供するステップと  を含む、請求項17に記載のデジタル画像処理方法。【請求項19】  服装をセグメント化し、隣接する服装間の差を最大化することにより、前記複数のデジタル画像内の服装領域を判定するステップと、  類似性分析を実施する前記ステップの前に、前記服装領域からクラッタを除去するステップと、  類似性分析を実施する前記ステップの前に、服装の特徴抽出を実施するステップとをさらに含み、服装の特徴抽出を実施する前記ステップは、    前記服装領域から代表的な画像パッチを抽出するステップと、    前記要素間の類似性分析を実施する前記ステップで使用される前記服装領域の数値表現を取得するために、前記服装領域内に現れる前記代表的な画像パッチの周波数から特徴ベクトルを生成するステップとを含む、  請求項17に記載のデジタル画像処理方法。【請求項20】  類似性分析を実施する前記ステップは、    前記要素間の類似性スコアを取得するステップと、    前記類似性スコアを使用して親和性行列Aを取得するステップとを含み、  組み込みを行う前記サブ・ステップは、    前記親和性行列Aに前記少なくとも1つのハード・ネガティブ制約条件を組み込むステップと、    前記少なくとも1つのハード・ネガティブ制約条件を使用して相反性行列Rを生成するステップと、    前記親和性行列Aと前記相反性行列Rとを使用して、前記制約条件付き相関データ結果を相関データ行列Lの形で取得するステップとを含み、  スペクトル分析を実施する前記サブ・ステップは、    前記相関データ行列Lにおける所定の数の最大固有ベクトルを選択するステップと、    選択された固有ベクトルを列にスタックして行列Xを取得するステップと、    前記行列Xの各行を単位長さに正規化して前記固有ベクトル結果を行列Yの形で取得するステップとを含み、  離散化を実施する前記サブ・ステップは、    K平均クラスタリングを使用し、前記行列Yの各行をクラスタリングして、前記クラスタを取得するステップと、    前記複数の要素中の要素を、前記要素に関連する前記行列Yの各行が割り当てられているクラスタに割り当てるステップとを含む、  請求項15に記載のデジタル画像処理方法。【請求項21】  デジタル画像処理装置であって、  複数のデジタル画像に属する複数の要素を表す要素データを提供する画像データ・ユニットと、  前記複数の要素中の前記要素間の類似性分析を実施して、前記要素に関係する相関データ結果を取得する類似性分析ユニットと、  前記複数の要素のクラスタリングを実施するクラスタリング・ユニットとを備え、前記クラスタリングを実施するクラスタリング・ユニットは、    前記複数の要素中の要素に関係する少なくとも1つのハード制約条件を前記相関データ結果に組み込んで、制約条件付き相関データ結果を取得し、    前記制約条件付き相関データ結果から固有ベクトル結果を取得するためのスペクトル分析を実施し、    前記少なくとも1つのハード制約条件を強制する基準を用いた制約条件付きクラスタリングを使用し、前記固有ベクトル結果の離散化を実施してクラスタを取得することによって、クラスタリングを実施する、  デジタル画像処理装置。【請求項22】  前記クラスタリング・ユニットは、制約条件付きK平均クラスタリングを使用して離散化を実施する、請求項21に記載の装置。【請求項23】  前記要素は、前記複数のデジタル画像内で発見される人々である、請求項21に記載の装置。【請求項24】  前記少なくとも1つのハード制約条件は、前記複数のデジタル画像中の同じ画像内で発見される2人の人が異なる同一性を有するハード・ネガティブ制約条件を含む、請求項23に記載の装置。【請求項25】  前記少なくとも1つのハード制約条件は、前記複数のデジタル画像中の異なる画像内で発見される2人の人が同じ人物となる所定の知識に基づくハード・ポジティブ制約条件を含む、請求項23に記載の装置。【請求項26】  前記類似性分析ユニットは、  前記人々の顔間の顔類似性分析を実施して、前記人々の顔間の顔類似性測定値を取得する顔ユニットと、  前記人々の服装間の服装類似性分析を実施して、前記人々の服装間の服装類似性測定値を取得する服装ユニットと、  前記顔類似性測定値と前記服装類似性測定値との利用可能性に基づいて、同じ人物を表す前記複数のデジタル画像中の複数対の人々に関する類似性測定値を推定する複数の公式を提供する組合せユニットとを備える、  請求項23に記載の装置。【請求項27】  前記組合せユニットは、  前記複数のデジタル画像中の画像が撮影された時間に基づいて、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択し、  前記複数のデジタル画像中の画像が撮影された場所に基づいて、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択し、  単一の画像内で2人以上の人物が同じ服装をしているかどうかに基づいて、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択し、  前記顔類似性測定値に由来する顔類似性測定値だけが利用可能であり、前記服装類似性測定値に由来する服装類似性測定値は利用可能でない場合に、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択し、  前記服装類似性測定値に由来する服装類似性測定値だけが利用可能であり、前記顔類似性測定値に由来する顔類似性測定値は利用可能でない場合に、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択し、  前記顔類似性測定値に由来する顔類似性測定値と、前記服装類似性測定値に由来する服装類似性測定値とが利用可能である場合に、前記相関データ結果に対する2人の人の間の類似性測定値を取得する少なくとも1つの公式を、前記複数の公式から選択する、  請求項26に記載の装置。【請求項28】  隣接する服装間の差を最大化することにより、前記複数のデジタル画像内の服装領域を判定し、前記類似性分析ユニットが前記類似性分析を実施する前に、前記服装領域からクラッタを除去する服装セグメント化ユニット  をさらに備える、請求項26に記載の装置。【請求項29】  前記複数のデジタル画像内の服装は、衣服、靴、腕時計、および眼鏡の内の少なくとも1つを含む、請求項28に記載の装置。【請求項30】  前記服装領域上の服装の特徴抽出を実施する服装表現ユニットをさらに備え、前記服装表現ユニットは、    前記服装領域から代表的な画像パッチを抽出し、    前記服装領域の数値表現を取得するために、前記服装領域内に現れる前記代表的な画像パッチの周波数から特徴ベクトルを生成し、    前記服装領域の前記数値表現を前記服装ユニットに送ることによって、前記服装領域上の服装の特徴抽出を実施する、  請求項28に記載の装置。【請求項31】  前記クラスタの数は、前記クラスタリング・ユニットが前記複数の要素のクラスタリングを実施する前に予め決定される、請求項21に記載の装置。【請求項32】  前記固有ベクトル結果は、数値要素セットであり、  前記複数の要素中の要素と前記数値要素との間に1対1の対応関係が存在し、  前記クラスタリング・ユニットは、前記複数の要素中の各要素を、前記クラスタ中、前記数値要素の対応する数値要素がクラスタリングされたクラスタに割り当てる、  請求項21に記載の装置。【請求項33】  前記類似性分析ユニットは、    前記要素間の類似性スコアを取得し、    前記類似性スコアを使用して親和性行列Aを取得することによって、前記要素間のスペクトル分析を実施し、  前記クラスタリング・ユニットは、    前記親和性行列Aに前記少なくとも1つのハード制約条件を組み込み、    前記親和性行列Aを使用して、前記制約条件付き相関データ結果を相関データ行列Lの形で取得し、    前記相関データ行列Lにおける所定の数の最大固有ベクトルを選択し、    選択された固有ベクトルを列にスタックして行列Xを取得し、    前記行列Xの各行を単位長さに正規化して前記固有ベクトル結果を行列Yの形で取得し、    前記少なくとも1つのハード制約条件を強制する基準を使用した制約条件付きK平均クラスタリングを使用し、前記行列Yの各行をクラスタリングして、前記クラスタを取得し、    前記複数の要素中の要素を、前記要素に関連する前記行列Yの各行が割り当てられているクラスタに割り当てることによって、前記複数の要素のクラスタリングを実施する、  請求項21に記載の装置。【請求項34】  前記要素は、前記複数のデジタル画像内で発見される人々であり、  前記少なくとも1つのハード制約条件は、前記複数のデジタル画像中の同じ画像内で発見される2人の人が異なる同一性を有するハード・ネガティブ制約条件を含み、  前記類似性分析ユニットは、    前記人々の顔間の類似性分析を実施して、前記人々の顔間の顔類似性スコアを取得し、    前記人々の服装間の類似性分析を実施して、前記人々の服装間の服装類似性スコアを取得し、    複数対の人々に関する前記顔類似性スコアと前記服装類似性スコアとを組み合わせて、前記類似性スコアを取得し、    前記複数対の人々に関する前記類似性スコアを使用して前記親和性行列Aを取得することによって、前記要素間の前記類似性分析を実施する、  請求項33に記載の装置。【請求項35】  デジタル画像処理装置であって、  複数のデジタル画像に属する複数の要素を表す要素データを提供する画像データ・ユニットと、  前記複数の要素中の前記要素間の類似性分析を実施して、前記要素に関係する相関データ結果を取得する類似性分析ユニットと、  前記複数の要素のクラスタリングを実施するクラスタリング・ユニットとを備え、前記クラスタリング・ユニットは、    前記要素間の非類似性に関係する少なくとも1つのハード・ネガティブ制約条件を前記相関データ結果に組み込んで、制約条件付き相関データ結果を取得し、    前記制約条件付き相関データ結果から固有ベクトル結果を取得するためのスペクトル分析を実施し、    前記固有ベクトル結果をクラスタリングし、前記固有ベクトル結果の離散化を実施してクラスタを取得することによって、クラスタリングを実施する、  デジタル画像処理装置。【請求項36】  前記クラスタリング・ユニットは、前記固有ベクトル結果をクラスタリングして前記クラスタを取得するために、K平均クラスタリングを使用する、請求項35に記載の装置。【請求項37】  前記要素は、前記複数のデジタル画像内で発見される人々であり、  前記少なくとも1つのハード・ネガティブ制約条件は、前記複数のデジタル画像中の同じ画像内で発見される2人の人が異なる同一性を有するネガティブ制約条件を含む、  請求項36に記載の装置。【請求項38】  前記類似性分析ユニットは、  前記人々の顔間の顔類似性分析を実施して、前記人々の顔間の顔類似性測定値を取得する顔ユニットと、  前記人々の服装間の服装類似性分析を実施して、前記人々の服装間の服装類似性測定値を取得する服装ユニットと、  前記顔類似性測定値と前記服装類似性測定値との利用可能性に基づいて、同じ人物を表す前記複数のデジタル画像中の複数対の人々に関する類似性測定値を推定する複数の公式を提供する組合せユニットとを備える、  請求項37に記載の装置。【請求項39】  隣接する服装間の差を最大化することにより、前記複数のデジタル画像内の服装領域を判定し、前記服装領域からクラッタを除去する服装セグメント化ユニットと、  前記服装領域上の服装の特徴抽出を実施する服装表現ユニットとをさらに備え、前記服装表現ユニットは、    前記服装領域から代表的な画像パッチを抽出し、    前記服装領域の数値表現を取得するために、前記服装領域内に現れる前記代表的な画像パッチの周波数から特徴ベクトルを生成し、    前記服装領域の前記数値表現を前記類似性分析ユニットに送ることによって、前記服装領域上の服装の特徴抽出を実施する、  請求項37に記載の装置。【請求項40】  前記類似性分析ユニットは、    前記要素間の類似性スコアを取得し、    前記類似性スコアを使用して親和性行列Aを取得することによって、前記要素間の類似性分析を実施し、  前記クラスタリング・ユニットは、    前記親和性行列Aに前記少なくとも1つのハード・ネガティブ制約条件を組み込み、    前記少なくとも1つのハード・ネガティブ制約条件を使用して相反性行列Rを生成し、    前記親和性行列Aと前記相反性行列Rとを使用して、前記制約条件付き相関データ結果を相関データ行列Lの形で取得し、    前記相関データ行列Lにおける所定の数の最大固有ベクトルを選択し、    選択された固有ベクトルを列にスタックして行列Xを取得し、    前記行列Xの各行を単位長さに正規化して前記固有ベクトル結果を行列Yの形で取得し、    K平均クラスタリングを使用し、前記行列Yの各行をクラスタリングして、前記クラスタを取得し、  前記複数の要素中の要素を、前記要素に関連する前記行列Yの各行が割り当てられているクラスタに割り当てることによって、前記複数の要素のクラスタリングを実施する、  請求項35に記載の装置。
デジタル画像データの制約条件付きスペクトル・クラスタリングを実施するための方法および装置
