
<<L>>回帰式
一方の項目を独立変数と見ることが妥当なデータ分布について回帰式を求め、これを用いてデータ範囲外の値を推定(予測)します。
<<気象データ>>ブック<名古屋気象台>シートの記録を対象として検討を進めます。
本講の課題
[1] 年平均気温変動
約120年間の年平均気温の変動をグラフ化する。
年平均気温変動の回帰直線とその式をグラフに追加する。
回帰直線式と実際の値の差を観察して、回帰直線を評価する。
年平均気温変動の二次回帰曲線とその式をグラフに追加する。
二次回帰曲線式と実際の値の差を観察して、二次回帰曲線式を評価する。
[2] 年平均気温の近未来予測
回帰式を用いて、10年後までの年平均気温の推定値を求める。
誤差分布の統計量を求めて、推定値に分布幅を加える。
[3] 年降水量変動
年平均気温についての回帰式評価の過程をたどり、適切な回帰式を得る。
得られた回帰式を用いて、10年後までの年降水量の推定値を求める。
誤差分布の統計量を求めて、推定値に分布幅を加える。
年平均気温変動
気温変動のグラフ化
<名古屋気象台>シートの記録は、年単位のものなので、西暦年を項目軸、年平均気温を数値軸とするグラフ化が適切です。次の手順で作業を進めます。
【【挿入】】タブ
【グラフ】ブロック
「折れ線」アイコン
「マーカー付き折れ線」選択
*先にグラフエリアを確保します。
グラフエリア上で右クリック
「データの選択(E)...」メニュー
【データソースの選択】ダイアグラム
「グラフデータの範囲(D)」ボックスで「年」「年平均気温」項目を選択指定
データ系列を選択・右クリック
「データ系列の書式設定(F)...」メニュー
【データ系列の書式設定】ダイアグラム
「線の色」ページ
「線無し(N)」を選択
*折れ線グラフから線を消去して、散布図イメージに近づけます。
凡例を削除し、適切なタイトル、軸ラベルを追加する。
数値軸の範囲を調整して、プロットエリアを有効利用する。
回帰直線の描き入れ
項目軸の「年」は、測定値ではなく、「年平均気温」だけが測定値なので、項目軸を独立変数とした回帰式を検討します。
EXCEL のグラフ描画環境には、このように項目軸を独立変数とする場合の回帰式描き入れ機能が用意されています。
データ系列を選択・右クリック
「近似曲線の追加(R)...」
【近似曲線のオプション】ダイアグラム
「近似または回帰の種類」ブロックで「線形近似(L)」を選択
*線形近似は、直線(Y = a*X + b )回帰を行う指定です。
「グラフに数式を表示する(E)」をチェック
*回帰式を画面表示させます。
「グラフにR-2乗値を表示する(R)」をチェック
*R-2乗値は、決定係数で、回帰式の有効性検討に用います。
上記の手順で、回帰直線が描き入れられ、その回帰式と決定係数がグラフ上に提示されます。
回帰式は項目軸を独立変数としていますが、項目軸が文字列表記の場合('1891年'は文字列表記です)、先頭を 0 とした整数値に変換した式が与えられています。
回帰直線式の評価
決定係数が0.5(≒0.7×0.7、相関係数 0.7相当)に達しないことから、相関性は認められますが強いとは言えないレベルで、回帰式を適用するには十分とは言えません。
回帰式による各年(1891年を 0 とする)の気温と実際の値との差を求めて、その分布をグラフ化してみることで、当てはめの様子を検討することが出来ます。
回帰直線を基準とすると、1930年代半ばを底として実測値は期間の両側で回帰直線から上向きに広がっています。このことから、回帰直線式では表現し切れない変動があると考えられます。
回帰曲線の描き入れ
【近似曲線のオプション】ダイアグラムでは、直線(線形近似)以外の近似式が選択できるので、これを活用します。
【近似曲線のオプション】ダイアグラム
「近似または回帰の種類」ブロックで「多項式近似(P)」を選択、次数(D)は 2 を指定
*2次の多項式近似は、二次式(Y = a*X2 + b*X + C)での回帰を求めるものです。
「グラフに数式を表示する(E)」をチェック
「グラフにR-2乗値を表示する(R)」をチェック
「線の色」ページ
「線(単色)(S)」を選択
「色(C)」で直線回帰の場合とは異なる色を選択
*二つの回帰線を区別するためです。
回帰曲線式の評価
回帰直線式と比較すれば、決定係数が増加して回帰式の決定力=当てはめ具合が増していることが分かります。
また、直線回帰の場合と同様に、回帰式と実際の値の差を求め、その分布状態をグラフ化して評価します。
回帰曲線式(起点の1891年を 0 とすることは、直線回帰の場合と同様です)と実測値との差の分布をグラフ化してみると、全体としては 0 を中心とした平行線状に値がばらついており、大きな歪みは見られません。
年々のバラツキはあるものの、過去100年ほどの名古屋の年平均気温変化は、大凡年を独立変数とする二次式で表現できると言えそうです。
多項式近似の次数を増加すれば、少しずつ決定係数の改善が見られますが、直線回帰から二次曲線回帰への変化に比べると僅かな改良に過ぎません。変化の傾向を捉えるには、二次曲線回帰で良いと判断できるでしょう。
近未来予測
回帰式は、与えられたデータ範囲の変動を表現するものですが、独立変数の値を範囲外に拡張すれば、予測値を得ることができます。
予測結果のグラフ表示(補外)
近似曲線描画機能のオプションとして、回帰式を範囲外へ拡張する機能が用意されています。これを利用して予測結果をグラフに追加できます。
近似(曲)線を選択・右クリック
「近似曲線の書式設定(F)...」メニュー
【近似曲線の書式設定】ダイアグラム
「近似曲線のオプション」ページ
「予測」ブロック
「前方補外(F):」に項目軸を伸ばす量(この例ならば年単位)を指定
予測値の表示は行われませんが、目視でどの程度まで変化するかを読み取ることが出来ます。
予測値の分布幅
回帰曲線式の評価に用いた回帰式と実測値との差の分布(誤差分布)は、言わば年平均気温の変動幅を与えるデータです。
この誤差分布の統計量を調べ、これが(十分に)正規分布性を持つことが確認できるでしょう。従って、実際の年平均気温値は、回帰曲線式を平均値(μ)とし、得られた標準偏差(σ)とで決まる正規分布として扱えることになります。
予測年平均気温に誤差分布の標準偏差(σ)幅を誤差範囲として追加すれば、あまり遠くない近未来の年平均気温は、その幅(±σ)の範囲に68%程度の確率で収まり、2σの幅とすれば、その範囲には 95% 程度の確率で収まると期待して良いでしょう。
このような幅を付けた予測値であれば、近い将来を見通す場合の情報としてより有意義であると言えます。
分布幅を付けた回帰曲線式の描画
上図では、「年平均気温」項目の他に「回帰曲線式値」を系列として加え、「回帰曲線式値」には上下に2σの値幅を加えています。この描画の手順(値に幅を付ける方法を中心に案内します)は次のものです。
「年」「年平均気温」「回帰曲線式値」列について、推計を行う年まで(「年平均気温」にはデータが無い)を選択します。
「マーカー付き折れ線グラフ」でグラフ化します。
二つのデータ系列について、「線無し(N)」を選択して散布図様の仕上がりとします。
回帰曲線式値系列については、マーカーのサイズを3あるいは2程度まで小さくします。
*ここまでは、一般的なグラフ作成操作です。
回帰曲線式値系列を選択します。
【【レイアウト】】タブ
【分析】ブロック
「誤差範囲」アイコン
「その他の誤差範囲オプション(M)...」メニュー
【誤差範囲の書式設定】ダイアグラム
「縦軸誤差範囲」ページ
「表示」ブロック
「両方向」と「キャップなし」を選択
「誤差範囲」ブロック
「固定値」を選択、ボックスに2σ相当値を指定
「線の色」ページ
「線(単色)(S)」を選択
「色(C)」で、他を邪魔しない色を選択
［閉じる］ボタン・クリック
「データ分析Ⅰ」2014
