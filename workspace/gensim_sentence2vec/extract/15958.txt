文字列かを判定するサンプルマクロ
参考になりそうな、サンプルマクロをご紹介しておきます。
以下のマクロを実行すると、アクティブセルが文字列だったときに「文字列です。」、文字列でなければ、「文字列ではありません。」というメッセージが表示されます。
VarType関数を使って、アクティブの値が文字列かどうかを判定している、
If VarType(ActiveCell.Value) = vbString Then
簡単なマクロです。
VarType関数とは
VarType関数は、引数に指定されたデータの型を、VbVarType列挙体で定義された整数値で返してくる関数です。
VbVarType列挙体には下図のような定数が定義されています。
VarType関数は、文字列だったときにvbString(8)を返してきます。
VarType関数による判定時の特長
VarType関数は、データの型をしっかり調べてくれます。
文字列として入力された数字は、数値ではなく、文字列と判定してくれます。
例えば、
「'123」のように「'」(シングルクォート)を入力してから数字を入力した場合は、vbStringを返すということです。
［セルの書式設定］ダイアログ−［表示形式］タブの［分類］欄で「文字列」を指定して、「123」のような数字を入力したときもvbStringを返してくれます。
VBAで文字列かどうかを判定する−VarType関数:エクセルマクロ・Excel VBAの使い方-VBA関数
