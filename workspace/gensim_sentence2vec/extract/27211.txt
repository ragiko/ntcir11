
ツイートする
変数は、宣言のしかたによって、使える場所が限られます。これを、変数の適用範囲といいます。変数の適用範囲を理解するには、VBAの"プロシージャ"と"モジュール"という概念を理解しなければなりません。
プロシージャとモジュール
プロシージャとは、Sub 〜End SubまたはFunction 〜End Functionなど、マクロの最小実行単位です。
''2つのSubプロシージャ「Sample1」「Sample2」と
''1つのFunctionプロシージャ「myCalc」がある
Sub Sample1()
''何かの処理
End Sub
Sub Sample2
''何かの処理
End Sub
Function myCalc(n As Long)
''何かの処理
End Function
モジュールとは、こうしたプロシージャを記述する場所です。一般的には、標準モジュールにプロシージャを作成することが多いですね。この標準モジュールは、その名の通りモジュールです。ブックには、標準モジュール以外にも、いくつかのモジュールが用意されています。VBEの[オブジェクトエクスプローラ]に表示される「Sheet1」や「ThisWorkbook」などイベントを記述するモジュールをまとめてDocumentモジュールと呼びます。また、「Sheet1」や「Sheet2」などワークシートのイベントを記述するところをシートモジュール、ブックのイベントを記述する「ThisWorkbook」をブックモジュールと個別に呼ぶこともあります。ほかにも、UserFormを挿入するとFormモジュールが使えるようになります。
プロシージャ内だけで使える変数
今までの解説で登場した変数は、次のようにプロシージャの中で宣言されていました。
Office TANAKA - VBAの変数[変数の適用範囲]
