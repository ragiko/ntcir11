
Excelによる回帰分析
例えば,このようなデータを分析してみましょう.これは男女100人の身長,体重のデータ(仮想)です.以下の様にExcelの表の上にデータが並んでいたとします.
※データはこの後にもならんでいます.
ここでは,女性の身長が,自身の体重と父親の身長とどのような
関係にあるかを重回帰分析してみます.
【手順】
メニューバーの「ツール」
「分析メニュー」
「回帰分析」
すると,次のダイアログが現れます.データ範囲,出力範囲を設定し,「OK」ボタンをクリックします.
図中の「入力Y範囲」には,従属変数(被説明変数),「入力X範囲」には
独立変数(説明変数)を示す範囲を入力します.
残差や正規確率などのオプションを選択し,出力先を指定したら,「OK」
ボタンをクリックして,分析を行ないます.
※注意1
上記の図中に「定数に0を使用」という項目がありますが,これを指定して回帰した場合,相関係数や決定係数が正しく計算されません(MS側のバグらしいです.群馬大学の青木先生のホームページで知りました).もっとも回帰係数は合っているようです.【追加情報1999/12/30】上記の現象はExcel97での現象でしたが,最新のExcel2000でも同様の現象が確認されています(TSPで確認).なんとかならないものか>MS社様
Excelによる回帰分析(分析結果)
実行すると,Excelは以下の分析結果を出力します.
モデルの当てはまりの具合をしめす決定係数やそれぞれの変数について推定されたパラメータを見ることができます.
「重決定R2」は決定係数(R2)と呼ばれるもので,当てはまりの良さを示しています.R2は0から1の間を取ります.数字を見るとおよそ0.74となっていて,かなり当てはまりがよさそうです.
「補正R2」は「自由度調整済み決定係数」と呼ばれるものです.独立変数を増やすほど,寄与率は1に近付くので,寄与率の上昇が追加された独立変数の効果かどうか不明となるので,重回帰分析の場合はこれを用います.
それぞれの変数についてはどうでしょう.「係数」はそれぞれの変数が1単位増加した時の身長の増加分を表しています.ここでは,女性の身長は父親の身長(X値2)よりも体重(X値1)に強く関係していることが分かります.
係数の欄のt値,p値は推定された係数が0であるという帰無仮説を検定したものです(係数の有意性のチェック).検定結果から帰無仮説が棄却できない,すなわち統計的に0でないとはいえない(0かもしれない)となると,この回帰分析に意味がなくなるので,こうしたチェックが必要になります.判断の仕方は以下の通り.
(1)P(T帰無仮説を棄却
(2)t 境界値<「t」の絶対値 帰無仮説を棄却
t境界値はtinv関数を用いて得ることができます.
表計算ソフトで統計処理
