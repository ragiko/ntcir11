ベイズの定理(入門編)
数学
前回のエントリーで予告した通り、今回は「ベイズの定理」です。
事前に断っておきますが、ベイズの定理は簡単です。
内容は小学生レベルの算数ですから、解らなくても自信を持って何回か読みなおせば絶対にわかります。
(わからなかったらコメントに質問してね)
ベイズの定理ってなんぞ?
ベイズの定理とはトーマス・ベイズ(1702-1761)というイギリスの牧師によって発見されました。
今やベイズの定理はあらゆる所に使われいます、スパムメールを振り分けたり、犯罪捜査に使われたり、マーケティングに使われたり、人工知能に使われたり、沈没しちゃった潜水艦を見つけたり、株の売買に使われたり、結婚相手を見つけちゃったり・・・
ベイズ万能すぎるだろ!!
「ベイズの定理」を理解はしなくても、言葉だけでも覚えていれば何かと便利です。
何かしらの問題に直面した際に、
「ふむ・・・このxにベイズの定理を使えば・・・」
とつぶやくだけで、それっぽく見えるのでオススメです。
(「バルキスの定理」くらい万能ですので、使用は自己責任でお願いします)
ベイズの前に「条件付き確率」
ベイズの定理を理解するには、みんなが大嫌いな「条件付き確率」を理解しなくてはなりません。
「条件付き確率」とは、
ある事象Bが起こる条件下で、別の事象Aが起こる確率のこと。
記号ではP(A|B)と表す。
という事です。
OK,OK、君の言いたい事はよく解ってる、よくわからないんだろ?
例えば「あなたは男だとして、イケメンである確率は?」という問題があった場合、先ほどの記号で表すと「P(イケメン|男)」となります。
P(A|B)で、Bが前提の上でAがで成り立つ確率となります。
ここで1つ有名な問題を出しましょう。
隣の家に2人の子供がいる事が解っています、ある日、隣の子供のうち1人が女の子である事が解りました。*1
隣家のお母さんに「女のお子さんはいますか?」と質問した所「はい」と答えました。
このとき、もう1人の子供も女の子である確率はいくつでしょうか?
※なお、男女比は1:1とする。
答えを記号で表すと「P(2人とも女の子|1人が女の子)」となります。
考え方としては、子供2人の組み合わせは「姉妹」、「姉弟」、「兄妹」、「兄弟」の4通りです。
「1人が女の子」という前提条件があるため、「兄弟」が除外され「姉妹」、「姉弟」、「兄妹」の3通りとなります。
その3通りの中で「姉妹」が当たる確率を求めればいいのですから、答えは「1/3」です。
「1/2」だと思った方、猛省してください。
いよいよベイズの定理
「ベイズの定理」とは、まさしく今まで説明してきた「条件付き確率」を求めるための計算式なのです。
まずは「ベイズの定理」を見てましょう。
P(A|B) = P(A∧B) / P(B)
「P(B)」は事前確率と呼ばれ、単純にBが起こる確率です。
(ちなみに「P(A|B)」は事後確率と呼ばれます)
「P(A∧B)」は同時確率と呼ばれ、AとBの両方の事象が成り立つ確率です、∧は論理記号で論理積を表し、「(A∧B)」は「AかつB (A and B)」という意味となります。
「P(A∧B)」が難しい!と思った方、ほとんどの場合は「P(A∧B)」=「P(A)」と思ってOKです。
ごく稀に例外となる問題もありますが、そういう問題は事前情報が欠けていたりなど、どこか不自然な問題が殆どです。
だから解らない人は無理せずに、こう覚えておいてください、その内慣れてきますから :-)
ベイズの定理に関してはここで面白い問題を見つけました。20年前の早稲田大学の入試問題だそうです。
5回に1回の割合で帽子を忘れるくせのあるK君が、正月に A、B、C 3軒を順に年始回りをして家に帰ったとき、帽子を忘れてきたことに気がついた。2軒目の家 B に忘れて
きた確率を求めよ。
正直、どの家で忘れたかよりも、K君が心配ですが・・・
普通に考えれば、Bの家で忘れた確率は「4/5×1/5=4/25」(A家で忘れない確率×B家で忘れる確率)ですよね。
しかし、上記の確率では「3軒回って帽子を忘れない確率」も含まれています、「帽子を忘れている」という前提条件がついている事に注意です。
条件付き確率の記号で表すと「P(B家で忘れた確率|帽子を忘れた確率)」となり、ベイズの定理を使うと以下の式になります。
P(帽子を忘れた確率) =
(1/5)+(4/5×1/5)+(4/5×4/5×1/5) =
61/125
P(帽子を忘れた確率∧B家で忘れた確率) =
P(B家で忘れた確率) =
(4/5×1/5) = 4/25
P(B家で忘れた確率|帽子を忘れた確率) =
P(帽子を忘れた確率∧B家で忘れた確率) / P(帽子を忘れた確率) =
(4/25)/(61/125) = 20/61
答えは「20/61」となります、簡単でしょ?
前エントリーの問2をベイズの定理で解いてみよう
前エントリーの問2をベイズの定理で解いてみましょう。
多くの方が「扉を変える2/9、扉を変えない2/9、無効になる5/9」と答えていたのが印象的でした。
確かにこれでも間違いではありませんが、条件付き確率を理解しているとは言えません。
問2では「地震で無効にならなかった」という前提条件が付き、「P(扉を変えて当たる確率|地震で無効にならない確率)」を求めるので、以下の様になります。
P(扉を変えて当たる確率) = (4/9)×(1/2)
P(地震で無効にならない確率) = 4/9
P(扉を変えて当たる確率|地震で無効にならない確率) = 
P(扉を変えて当たる確率) / P(地震で無効にならない確率) = 
( (4/9)×(1/2) )/(4/9) = 1/2
となり、答えは「1/2」となります。
まぁ、「変えるか、変えないか」の2択問題なのに「2/9と2/9」という答えはおかしいですよね
私が髪型で「7:3分け」にしようか「真ん中分け」にしようか悩んでいるところへ、
「2:2分けがいいよ^^」
と言ってるようなもんです。
残りの6はどこに?っていうか、ハ、ハゲちゃうわ!!
「残りの6は、近い将来なくなる可能性が高いので除いておきました^^」
く・・・くやしぃ!!
長くなったので続きます
自分でもベイズの定理で曖昧な部分があり、備忘録も兼ねて説明を書きました。
本当はベイズの定理でもっと面白い事が出来るんですが、それはまた次回に。
P.S
確率問題「トランプと3つの箱」 - kojetteの研磨日記にベイズの定理の問題が出ています、ベイズの定理の有効性を示す問題として非常によく出来ています。
時間があったら解いてみると面白いと思います。
(まだ解答が未発表です、私も解答しているけど間違ってたら非常にカッコ悪い・・・)
Permalink | コメント(43) | トラックバック(5) | 17:06   
ベイズの定理(入門編) - Pashango’s Blog
