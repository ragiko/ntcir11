マハラノビスの距離の2乗はカイ二乗分布に従う。
と言うことについての簡単なメモ。
マハラノビスの距離が何なのかと言うことについては、
Wiki(japanese)
Wiki(english)
参照。
p次元のベクトル
は
p×1の平均のベクトルμ
と
p×pの共分散行列Σ
をパラメーターに持つ分布、
だとした時、
このベクトルxのマハラノビス距離は
と定義される。
この式を見て分かる通り、
このxが多次元正規分布に従う時、
ルートの中は、
標準化したp個のベクトルの要素の和の2乗となっている。
ここで、標準正規分布の二乗が、カイ二乗分布(自由度1)に従っていたことを思い出してほしい。
つまりこのルートの中(マハラノビス距離の2乗)は、多次元正規分布に従うと仮定できる時、カイ二乗分布(自由度p)に従うと言える事となる。
ではこの性質をどのような時に使えるかの例として、
2変数が2次元正規分布に従っているかどうかの検定を考えよう。
単なる正規分布に従っているかどうかの検定だと、Shapiro-Wilkなどがあるが、
2次元正規分布になると、、、、、
一応WikiのMultivariate Normality Testの所にあまり聞かない手法が載っている。
これらが使えればいいのだが、使えない時の代替案として、
p個の変数が多次元正規分布に従っている時、そのマハラノビス距離の2乗はカイ二乗分布(自由度p)に従う。
これを使えば良い。
以下はp=2、乱数3000でのシミュレーション
上がカイ二乗分布(自由度2)で、下がマハラノビス距離の2乗
統計量もほぼ一緒であるので、このマハラノビス距離を求めるのに使った2変量は2次元正規分布に従っていると言える。
カイ二乗分布(自由度2)
平均	1.9708977
標準偏差	2.0175718
歪度	2.0697151
尖度	6.1746129
マハラノビス距離の2乗
平均	1.9993333
標準偏差	2.0421202
歪度	2.0426806
尖度	5.9440423
世に潜む日々 (Tokyoに棲む) : マハラノビスの距離の2乗はカイ二乗分布に従う
