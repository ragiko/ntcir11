平均,標準偏差など基本統計量の算出方法とその意味について理解します.Excelの関数についての説明では,引数は断りがない限りセル範囲です.
母集団・標本・記述統計・推測統計・標本数・最大値・最小値
母集団:分析が対象とするすべてのデータ.例えば,早稲田大学の学生全員.
標本:母集団からの一部のデータ.例えば,今日,教室にいる早大生諸君.
記述統計:統計の手法のひとつ。収集したデータの特徴を、平均や標準偏差などから求める手法のこと。(ASCII.jpデジタル用語辞典より)
推測統計:収集した全データの性質を、サンプルデータをもとに推測する方法のこと。推測統計の種類には、推定と仮説検定がある。推定は、サンプルデータ(標本)から、母集団の性質を表す値を求める方法。仮説検定は、データの母集団の性質が、仮定した性質と一致するかどうか調べることで収集したすべてのデータの性質を判断する方法。(ASCII.jpデジタル用語辞典より.一部加筆)
標本数:データの数.よく,Nで表す.
最小値:データの中の最も小さな値.Excelでデータの最小値を求める関数名はmin.
最大値:データの中で最も大きな値.Excelでデータの最大値を求める関数名はmax.
範囲:データの取る範囲.
small:小さい方からの任意の順位を取る値を求める関数名.引数は(範囲,N)となる.Nは順位.したがって,small(範囲,1)=min
large:大きい方からの任意の順位を取る値を求める関数名.引数は(範囲,N)となる.Nは順位.したがって,large(範囲,1)=max
分布:データの散らばり,集まり具合を示す.連続型と離散型がある.
連続型
一様分布:0から1の間の実数値を取る分布.乱数を作るときによく使う.
正規分布:自然や社会の中に観察される多くの事象に当てはまる(と言われる)分布.左右対称,単峰の釣鐘状の形状をしている.特に平均0,分散1の正規分布を標準正規分布と呼ぶ.
指数分布:製品などの寿命,耐用年数,災害が発生するまでの期間によく見られる分布
カイ二乗分布:標本分散に関する分布.実現値と期待値(理論値)との誤差の検定に用いられる.
t分布:標本数が少ない場合に正規分布の代わりに用いる分布.
F分布:2つの母集団の分散比に関する分布
離散型
ベルヌーイ分布:とりうる結果が2つしかないものの分布.(例)合格/不合格とか.
二項分布:ベルヌーイ試行を複数回実施した際の分布.
ポアソン分布:二項分布において,1回あたりの確率が小さく,試行回数が多い場合の分布.(例)あるエリアでの事故件数
平均値・中央値・最頻値
平均:データの中心的傾向を示す数値.各要素をX1,X2,X3,…Xnとすると,平均は,
「Σ」(シグマ)はX1からXnまでの和を表わす記号.Excelでデータの平均を求める関数名はaverage.
中央値:データに順位をつけた時,ちょうど真ん中の順位にくる値.Excelでデータの中央値を求める関数名はmedian.
最頻値:データが最も多く取る値.Excelでデータの最頻値を求める関数名はmode.
※分布が左右対称で,かつ単峰であるならば,平均値=中央値=最頻値.仮に右に歪んだ(右裾が長い)分布であれば,平均値>中央値>最頻値
データの分布〜ヒストグラム〜
度数分布表
観測値の取りうる値をいくつかの値に分け,それぞれの階級で観測値がいくつあるか(度数)を数えて,表にしたもの.
階級値は階級を代表する値.通常,階級値には階級の上限と下限の中間値を用いる.
度数分布表やヒストグラムを作成する場合,何個の階級を作れば良いか,という問題がある.これに関してはスタージェスの公式というものがあるとのこと.あくまでも目安だが,階級数kは,
k≒1+(log10n)/(log102)
で求められる.nはデータの数
で求められる.nは標本数.
相対度数
観測値の総数を1とみなしたときの,各階級に属する観測値の割合.データの大きさが異なる複数のデータ分布の比較に便利.
また,累積度数は度数を下の階級から惇に積み上げたときの度数の累積和.
ヒストグラム
度数分布をグラフにしたもの.測定値の存在する範囲をいくつかの区間に分けた場合, 各区間を底辺とし,その区間に属する測定値の度数に比例する面積を持つ長方形を並べた図(Excelのヒストグラムは区間の取り方が微妙に違う).
【手順】
Max,Min関数でデータの上限と下限を確認する.
データ区間(階級)を入力する.ここで階級が多い場合は,メニューの「編集」「フィル」「連続データ」が便利.
メニューバーの「ツール」「分析メニュー」「ヒストグラム」
「入力範囲」,「データ区間」,「出力先」のセルを選択,「グラフ作成」もチェックしておこう
「OK」をクリックして完成
出力されたヒストグラムは棒の間隔が空いているので,間隔をゼロに設定して完成
横軸は対象の変量の値が適当な区間(階級)でまとめてあり,縦軸にはその区間に入った変量が全体の何%になったかが示されている.例ではまんなかが一番高く,両側に行くにしたがって低くなっていることが読み取れる.
ヒストグラムは必ずしもキレイな山型をしている訳ではなく,データの分布に応じて様々な形を取る.
中央に峰が1つある山型分布:単峰型
峰が左に寄り,右に裾を長く引く分布:右に歪んだ分布
峰が2つ以上ある分布:双峰型
家計資産額階級別世帯分布(2人以上の世帯・全世帯)
総務省:平成16年全国消費実態調査より
このように,貯蓄額や資本金など,金額に関連するデータは右に歪んだ分布をよく持つ.このとき,一般的に,
最頻値<中央値<平均値
となる傾向がある.
分散・標準偏差
分散:データの分布が平均からどのくらい離れているかを示す指標.Excelで分散(標本分散を)を求める関数はvar.
中心的傾向は平均でみるのだが,2つのグループで平均が等しくても,2つのグループは同じ傾向,同じデータであるといえない.例えば,ある2つのデータから次のような分布が得られたとする.
平均が同じでも,データの散らばり具合が異なれば,異なる分布となる.この散らばり具合を表す統計量の1つが分散.分散は個々の数値の平均との距離(離れ具合,偏差という)の2乗値の平均であり,分散をσ2x(σ:シグマ)で示せば,
となる(標本分散).2乗するのは,正負の偏差を合計することで偏差が相殺されることを防ぐためと考えよう.
nではなく,n-1で割るのは自由度のため.「統計学入門」(東大教養学部統計学教室,東大出版会,1991年)には,「自由度とは自由に動ける変数の数という意味である.(中略)通常,推定をするとその個数(1)だけ,自由度が減る」とあるが,ピンとこない.で,こんな説明をネットで見つけたので引用する.
「平均が与えられた場合、変数の1つは自動的に決まってしまう。よって自由な値がとれる変数の個数はn−1となる。例えば、3つのデータで一つ目が1、二つ目が3で、平均が3となってしまえば、三つ目は自動的に5となってしまう。よって自由度は2となる」
どうやら「知の統計学」(福井幸男,共立出版,1995年)からの引用らしい.本ページは孫引きなのだ(^^ゞ データが標本ではなく,母集団であれば,n−1で割る必要はなく,nで割ればよい.この本,ウチの大学(高経大)の図書館にはなかった.早稲田ならあるだろう.
標準偏差:分散は2乗値であるため,元のデータと単位が異なる.そこで,これをそろえるため,分散の平方根を考える.これが標準偏差.Excelで標準偏差(標本標準偏差を)を求める関数はstdev.
余裕があったら,分散⇔標準偏差の関係を確認しよう.
標準偏差^2で分散が,分散^(1/2)またはSQRT(分散)で標準偏差になるはずである.
正規分布と標準偏差
代表的な分布である正規分布の場合,平均値±1σ(標準偏差)の範囲は全体の68.26%
平均値±2σ(標準偏差)の範囲は全体の95.44%
平均値±3σ(標準偏差)の範囲は全体の99.74%
が含まれることが分かっている.
尖度・歪度
尖度:データにおける分布の尖り具合を表す.平均をμ,標準偏差をsとすると,尖度Kurtは,
※この算式はExcel(2013)のマニュアルに記載されているもの.この値が正の数の場合は分布が正規分布に比べて相対的に尖っていることを示し,負の場合は相対的に平坦になっていることを示す.
歪度:データにおける分布の歪みを表す.平均をμ,標準偏差をsとすると,歪度Skewは,
※この算式はExcel(2013)のマニュアルに記載されているもの.この値が正の数の場合は分布が正規分布に比べて相対的に正の方向に歪んでいることを示し,負の場合は相対的に負の方向に歪んでいることを示す.
EXCELによる基礎統計量分析
Excelのアドインにある「分析メニュー」を使うと,上記基礎統計量をまとめて計算することができる.
【手順】
メニューの「データ」
「データ分析」
「基本統計量」
すると,次のダイアログが現れます.
基本統計量の算出
