サンプルプロシージャでは、某製鉄会社(5401)の現在値が494円、前日との差が33円のとき、前日との差が何パーセントあるかを求めています。実行すると、イミディエイトウィンドウに7.15835140997831と表示されます。
ちなみに、この日はアメリカで公的資金注入などのニュースがあったため、相場は全体的に暴騰してました…あーそーですか…(謎)
サンプルプロシージャ
Option Compare Database
Option Explicit
'----------------------------------------------------------------------
'実行用(確認用)
'----------------------------------------------------------------------
Sub TestProcF()
Debug.Print getChangePerB(494, 33)
End Sub
'-------------------------------------------------------------------------------
'現在値と変化量から何パーセント差かを求める
'-------------------------------------------------------------------------------
Function getChangePerB(ByVal Value As Currency _
, ByVal Change As Currency) As Double
'(現在値/前日値-1)  * 100
getChangePerB = (Value / (Value - Change) - 1) * 100
End Function
現在値と変化量から何パーセント差かを求める(自作関数「getChangePerB」) - Access VBA Tips
