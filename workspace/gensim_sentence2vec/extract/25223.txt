
ファイル全体の構造
MPEG オーディオのデコードには MPEG オーディオフレームヘッダ内の情報だけで事足りるので、ID3 
などのメタ情報タグは MP3 形式のオーディオファイルにとって必要不可欠なものではありません。しかしながら、ほとんどの MP3 
形式オーディオファイルにはエンコード時の時点で ID3 タグが付加されますので、ほとんど必須なものとなっています。ID3 タグの付いた一般的な 
MP3ファイルのデータ構造について下図に示します。
一般的な MP3ファイルは MPEG オーディオフレームの前後に ID3 タグが挟み込む形になっています。現在一般的に使われている 
ID3 タグには ID3v1、ID3v2 と呼ばれる 2 種類のタグが存在します。
ID3v1 タグは 128 バイトの固定長で、ファイル末尾に配置されます。ID3v1 
タグには歌手名・曲名・アルバム名などが記述されますが、サイズが固定長なのでそれほど大きい長さのテキストは入りきりません。また、文字コード等の問題も存在します。
ID3v2 タグは可変長で、ファイル先頭に配置されます。ID3v1 
タグを完全に包含するものとなっていて、テキスト形式のメタ情報の他に画像、歌詞などさまざまな情報を埋め込むことができるよう、たくさんの種類(id3v2.3 で 
74 種類)のタグが規定されています。
歌手名等の情報は ID3 タグの解析によって得られますが、楽曲の長さは ID3 
タグには存在しません。楽曲の長さは総フレーム数、もしくはビットレートとファイルサイズによってのみ規定されるからです。しかしながら VBR (Variable 
Bit Rate) 形式の MP3 ファイルにおいては、全体としてのビットレート情報が存在しないため、正確な曲長を得るためにはファイルに存在する全ての MPEG 
フレームを走査する必要があります。これは時間がかかりすぎるので、考えられたのが XING 
ヘッダと呼ばれるヘッダで、これは最初の MPEG オーディオフレームの先頭に格納されています。XING 
ヘッダには総フレーム数を保持するフィールドがあり、これから楽曲全体の長さを計算することができます。また TOC エントリの情報を元に、より正確な VBR 
ファイルのシーク処理を実現できます。
そのほかに存在するタグ情報などには ID3v1 拡張タグや VBRI 
ヘッダが存在しますが、これらを扱うべき機会はかなり少ないと思われるのでここでは解説しません。
ID3v1 タグ
ID3v1 タグが存在する場合、"TAG" の 3 バイトから始まる MP3 ファイル末尾 128 
バイトが ID3v1 タグです。内容は以下の通りです。
ID3v1 タグ:128 バイト
解説: MP3 ファイルのタグについて(id3v1, id3v2, XING ヘッダ)
