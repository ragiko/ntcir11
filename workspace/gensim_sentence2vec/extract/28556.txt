
前回に引き続き、アキュムレータ値(Accumulator Value)にご紹介します。
アキュムレータ値の活用方法として相関ルールやアラームの条件として使用する案を挙げましたが、日常的に参照するダッシュボードでもアキュムレータ値を活用することが出来ます。ここでは例として、ソースIPごとの送信バイト数を表示するダッシュボードの作成します。
アキュムレータ値をソースIPごとに集計するためには、アキュムレータフィールドと集計キーとしたいフィールド(ここではソースIP)を対象としたインデックス設定が必要になります。下記の手順でインデックスを作成します。
1.Webコンソール画面をログインし、[System Properties]画面を開き、左ペインで[Custom Types]を選択します。
2.右ペインでインデックスを付与したいアキュムレータ値の、[Event Field]欄の値を確認します。
今回は送信バイト数を対象とするため、[Bytes_Sent]が対象となり、[Event Field]欄は[Accumulator Field -1]になります。
3.[System Properties]画面の左ペインで[Database]を選択し、右ペインにて、[Setting]を押下します。
4.[Accumulator Indexing]タブを選択します。
5.ドロップダウンリストで、2で確認したフィールド[Accumulator Field -1]を選択します。
6.集計キーとする値を選択し、右矢印を押下して、[Enabled]欄へ移動させます。
ここではソースIPを集計キーとしてバイト数を計算したいので、[Sorce IP Index - Acc.Field 1]を選択します。
アキュムレータの設定は以上で完了です。続いて、ダッシュボードでビューをします。
1.新規ビュー作成ボタンを押下します。
2.Bar Chartをドラッグ&ドロップして、ビュー定義画面を起動します。
3.ドロップダウンリストで、[Accumulator Field -1]を選択します。
4.事前に作成したインデックスに併せて項目を選択します。
今回は、[Bytes_Sent by Source IP Summary]を選択し、Next>OKを押下します。
これで、ソースIPごとの送信バイト数を表示することが出来るようになりました。
同様の手順で受信バイト数やデバイス、国/地域ごとの集計を行うことが可能です。
※本サイト上のコンテンツの内容について、妥当性や正確性について保証するものではなく、一切の責任を負いかねます。予めご了承願います。
SIEM:アキュムレータ値を使用してイベントからデータ量を可視化(後編)  ｜  M*M*-Lab. ｜ ITセキュリティに役立つ最新情報をお届けします
