名前付きクエリは、テーブルとして表現されている SQL 式です。名前付きクエリでは、1 つ以上のデータ ソースの 1 つ以上のテーブルから返される行および列を選択する SQL 式を指定できます。名前付きクエリは、式に基づいていることを除いて、行とリレーションシップを持つデータ ソース ビュー内の他のテーブルに似ています。名前付きクエリを使用すると、基になるデータ ソースを変更せずに、データ ソース ビュー内の既存のテーブルのリレーショナル スキーマを拡張できます。たとえば、一連の名前付きクエリを使用して、複雑なディメンション テーブルを、データベース ディメンション用により小さく単純なディメンション テーブルに分割できます。名前付きクエリは、1 つ以上のデータ ソースの複数のデータベース テーブルを 1 つのデータ ソース ビュー テーブルに結合するために使用することもできます。
名前付きクエリを作成するときは、名前と、テーブルの列およびデータを返す SQL クエリを指定します。必要に応じて、名前付きクエリの説明を入力します。SQL 式は、データ ソース ビュー内の他のテーブルを参照できます。名前付きクエリを定義すると、名前付きクエリ内の SQL クエリがデータ ソースのプロバイダに送信され、すべて検証されます。プロバイダによって SQL クエリでエラーが検出されなければ、列がテーブルに追加されます。SQL クエリで参照されるテーブルと列は、修飾しないか、修飾する場合はテーブル名によってのみ修飾します。たとえば、テーブルの SaleAmount 列を参照するには、SaleAmount または Sales.SaleAmount は有効ですが、dbo.Sales.SaleAmount ではエラーが発生します。名前付きクエリの作成手順については、「データ ソース ビュー デザイナを使用して名前付きクエリを追加、表示、変更、または削除する方法 (Analysis Services)」を参照してください。データ ソース ビュー デザイナでクエリ定義機能を使用する方法については、「[名前付きクエリの作成]/[名前付きクエリの編集] ダイアログ ボックス (Analysis Services - 多次元データ)」を参照してください。
注SQL Server 2000 または SQL Server 7.0 のデータ ソースに対してクエリを実行する名前付きクエリを定義する場合、相関サブクエリおよび GROUP BY 句を含む名前付きクエリは失敗します。詳細については、Microsoft サポート技術情報の「BUG:相関サブクエリと相関 GROUP BY を含む SELECT ステートメントでの内部エラー」を参照してください。
データ ソース ビューでの名前付きクエリの定義 (Analysis Services)
