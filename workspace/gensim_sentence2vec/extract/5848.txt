[技術講座(データ通信—1)]                 (2002/11/12作成)
データ通信の技術進歩は著しく、知識習得が追いつかないほどめまぐるしく変化し続けています。ここでは、それらの新技術を理解するうえで必要なデータ通信の基礎技術についてまとめることにしました。
1.通信制御
データ通信(ディジタル)は、変復調装置(モデム)を利用し、公衆電話網(アナログ)を介してデータ伝送を行うことから始まりました。その後、高速モデムの開発によって、電話網の帯域幅に基づく伝送速度の制限も克服されました。ディジタル伝送ではシンボル間の干渉を防ぐために、位相特性(群遅延)に対して比較的厳しい規準が課せられます。そのため、NTT等のコモンキャリアは、ディジタル伝送用の専用線をサービスしています。
一方、電話回線の帯域3kHz内で位相特性を修正する技術も進歩し、位相ひずみを自動的に補正する自動等化器では一連のトレーニング信号のやり取りを行い、回線特性を計測して受信側モデムの等化回路が調整されます。ダイヤル接続のときは個々の呼ごとにトレーニングが行われます。このような通信信号を制御することをデータリンク制御(DLC)といいます。
1.1 HDLC(ハイレベルデータリンク制御手順)
HDLCは国際標準化機構(ISO)が制定した規格です。ハイレベルデータリンク(HDLC:High level 
Data Link Control)制御手順といわれ、それまでのベーシック手順を発展させた伝送手順です。SDLC手順は米IBMが開発した手順で、HDLCはこれを基に作られました。ここではまず手順の約束事(プロトコル)から説明します。HDLC手順は端末間で符号上制約なしにデータを同期伝送するための手順で、ISDNやPHSなどの制御にも、この手順、定義が採用されています。HDLC手順では伝送制御用の情報は全てフレームを通して一定の位置に収められています。図1にフレームフォーマットを示します。情報部(情報フィールド)は制御用の部分とは独立しており、ファクシミリ等用の上位の制御手順を入れることができ、階層構造を形成することが容易になっています。
図1 HDLCのフレーム構成
HDLCはフラグ同期で、フラグコード"01111110" 
(7E)hで同期をとります。また、フレームの開始と終わりを示すものです。データ転送において、数フレームに対してOKの応答(伝送確認を1個)とすることができます。これは同時監視方式と呼ばれ、ブロック単位で個々に応答確認するベーシックのような交互監視(ストップアンドスタート方式)に比較し、伝送効率を上げることができます。図1(b)はフラグシーケンスを除いたフレーム長についての規定を示します。誤り検出はCRCを用い、生成多項式にはX16+X12+X5+1を使用しています。図2に誤り検査対象を示します。生成多項式により作成されたフレーム検査シーケンス(FCS)は16ビットで、図2に示す位置にあります。
図2 フレームの構成と誤り検査の範囲
(1)データリンク(DLC)の機能
HDLC手順はOSI 7階層レベルのデータリンク層に機能分類されています。HDLCはこの層(レイヤ)の標準の考えより前から存在し、データリンク手順(DLC)の1つと分類されていました。通信システムには通信誤りが存在し、データ保証するためにある対策を講じます。それはエラーを検出することと、当該メッセージを再送するか、または受信側のみでエラー訂正することです。メッセージはある区切り(ブロック単位)で送られ、ブロックごとにエラー発生を検出します。伝送制御では、テキスト(text)はメッセージと同じ意味で使われています。データは設定されたデータリンクを通して、誤り制御や同期コードなどのために分割されたテキスト(メッセージ単位)で送られます。フレーム(frame)は伝送するデータ情報のテキスト分割と、テキストの制御を示す情報を付けることであり、リンクレベルの伝送制御の機能です。
基本ベーシック手順では、文字単位のパリティチェックを基に分割するテキストが作られています。従って、テキスト自体の中に制御用のコード、例えばテキストの先頭を示すSTXが存在することができません。もしSTXが出現すると、そこがテキストの先頭と間違えて識別してしまいます。このため拡張ベーシック手順が用意され、工夫がなされています。HDLCのフラグは、特別のビットパターンでデータブロックの区切りを識別するために用いられ、これをユーザデータの一部としてテキストの中に入れて送出してはなりません。誤って挿入されることを防ぐために、図3に示すようにゼロインサート(挿入)と呼ぶ手法を使っています。"1"が5ビット連続したらその直後に"0"を挿入することです。
図3 ゼロインサートの必要性
これによりデータの保障ができるが欠点もあります。第1にビット挿入のための送信元のデータに遅延が生じます。このため音声データのように実時間性を重視する用途にはジッタと呼ばれる到着時間の揺らぎを生じさせ、対策が必要になります。第2にビット挿入はユーザのデータが持つキャラクタ構造を壊してしまい、8ビットで文字を示す関係がなくなってしまいます。キャラクタ単位の構造ではビット挿入の手法をとりません。しかし、あるキャラクタが送れないとか、キャラクタの内部に制約が生じてしまうなどで、完全な透過性(トランスペアレンシー)は望めません。
HDLCはビットベースで、キャラクタについては完全な透過性が保障されています。ベーシック手順はキャラクタベースで、伝送制御符号をテキスト内に入れて伝送する際には、その前にDLEキャラクタを付けて透過性を持たせています。HDLCはアポートと呼ばれる処理を採用しています。これは、伝送の途中で送信を打ち切った場合にフラグの代わりに送出するもので、"1"の連続です。受信側では"1"が連続して8個以上続くことでアポートを検出します。フラグで開始されていても、アポートを検出した場合には、そのフレームは不正として取り扱います。
<3つの動作モード>
リンクレベルの回線制御方式は、次の3つの動作モードに分類されました。この概念はベーシックでも存在しましたが、HDLCとともに明確になりました。
(a) DLCの動作モード
① 非平衡型(1次局/2次局)
② 平衡型(コンテンションタイプ:Contention)
③ 非平衡型と平衡型の組み合わせ
①、②の違いはデータリンクの制御、つまり発信権の調整をある特定の局が責任を持って行うか、それとも互いの局が対等の立場で責任を持つかです。ポーリング/セレクションは非平衡型の中でよく使われており、様々な変形があります。ベーシックに比較しHDLCのほうが論議が尽くされ、種々のバリエーションに対応できる用意があります。
(b) HDLCの動作モード
HDLCの動作モードも3つあり、データリンク確立に先立って動作設定コマンドでこの中の1つを決定します。
① 正規応答モード(NRM:Normal Response Mode)
② 非同期応答モード(ARM:Asynchronous Response Mode)
③ 非同期平衡モード(ABM:Asynchronous Balanced Mode)
①の正規応答モードでは伝送制御は完全に1次局が管理し、2次局は1次局からの送信許可のコマンドを受け取ったときだけ1次局にレスポンスを送信することができます。②の非同期応答モードも伝送制御権は1次局のみが持っていますが、2次局は1次局からの送信許可がなくてもレスポンスを送り返すことができます。③の非同期平衡モードは制御権が対等な平衡モードです。このモードのとき1次局、2次局の区別なく複合局と呼ばれます。複合局は相手の許可がなくてもレスポンスだけでなくコマンドも送ることができます。表1に各モードの内容をまとめて示します。
表1 HDLCのクラスとモード
技術講座(データ通信)
