
1日目(7,8時限)音声の特徴量
今回学ぶ事項
振幅スペクトル・位相スペクトル
音声の特徴量(基本周波数, フォルマント周波数)
目次
人間の発話機構
周波数分析(基礎知識)
振幅スペクトル・位相スペクトル
純音の周波数分析           
音声の周波数分析
振幅スペクトルとF0の関係
振幅スペクトルとフォルマント周波数の関係
課題1-2
1 音声の特徴量
発話機構、つまり音声生成の仕組みを見てみましょう。
音声生成過程において、肺(lungs)、声門(glottis)は音源、声道(vocaltracts)は共振、
口唇(lips)は放射としての役割を持ちます。
声門と声道(声門から口唇まで)のイメージ図は以下の通りです。声道は鼻につながる経路がありますが図では省略してあります。
図1
音源
音源は声門は緊張して閉じた状態になり呼吸流により断続的な振動を起こします。
第1回で勉強した通り、男性の場合1秒間に100から150回、女声の場合250から
300回ほど振動します。この振動数を基本周波数(F0)、あるいは単にピッチと呼び、
声の高さを表します。
共振
共振(共鳴)は物理学的には外部エネルギーによって固有振動が起こる状態を言
います。音叉(おんさ)をたたいて発する音は小さいものですが、これを箱状の共鳴器
に接続すると、驚くほど音が大きくなります。これも共振(共鳴)現象を利用したもので、
音叉の振動数に合わせたサイズの共鳴器によって音圧が著しく高まるのです。
声道を通るときに「ア」「イ」などの響きがつけられます。これは、口が形を変えて
共振の特性を変えているから「ア」や「イ」等に聴えるのです。この振幅スペクトルの
ピークである共振周波数をフォルマント周波数と呼び、低い方から順に第1フォルマン
ト(F1)、第2フォルマント(F2)、 第3フォルマント(F3)、、、と名付けられています
この機会に、「音源の特徴量=基本周波数」と「共振の特徴量=フォルマント周波数」は
覚えてください。
基本周波数やフォルマントが音声の特徴量であることが分かりました。具体的に
自分の音声で、これらの特徴量を見ていきましょう。
2 周波数分析(基礎知識)
2.a 振幅スペクトルと位相スペクトル
信号をフーリエ変換して複素数を求め、横軸を周波数で表した図をスペクトルと呼びます。
縦軸が振幅の場合と位相の場合で、それぞれ振幅スペクトル・位相スペクトルと呼びます。
基本周波数やフォルマント周波数は振幅スペクトルを使って分析することが出来ます。
********** 複素数を忘れた人に
*****************************************
複素数(下図でX)は、「実部(Re(X))」と「虚部Im(X)」の組み合わせで値を表すほかに、
「振幅(r)」と「位相(θ)」でも値を表せましたね。
このように、スペクトル分析では、振幅スペクトル以外に位相スペクトルも求められます。
図2
複素数は少しは思い出して来ましたか?  いきなり音声特徴量の分析に入ると混乱するかもしれないので、
前回作った純音で周波数分析の練習をしましょう。
2.b 純音の周波数分析 
フーリエ変換をする前に、窓関数を掛けるという前処理をします。
窓関数(今の場合ハニング窓を採用)をかけると、データの始点・終点で値が0になり、
フーリエ変換後に正しいスペクトルが得られます。次のMファイルを作成して
anawave1(1000);で
実行して見て下さい。
function anawave1(freq)
fs=44100;            % サンプリング周波数
ana_sec=0.02;        % 分析時間
t=[0:1/fs:ana_sec];  % 時間軸データの作成
y= sin( 2*pi*freq*t );  % 周波数freqのサイン波の作成
w= hanning(length(t))';  % 窓関数の作成
yy= y.*w;              % 窓関数をかける
plot(t,y,t,w,t,yy);     % 描画
return
図3
図3の3つの波形のうち、青色=元の波形、緑色=窓関数、赤色=窓関数をかけた波形、です。
横軸は時間(秒)ですが、前回と異なり、分析時間が20msecとなっていますので
0.02までです。
さて、窓関数をかけたデータをフーリエ変換してみましょう。次のMファイルを作成して
anawave2(1000);で
実行して見て下さい。(注: anawave1.mからの変更部分だけ赤くしてあります。)
function anawave2(freq)
fftpt=2^16;          % フーリエ変換の分析精度を決定する数
fs=44100;            % サンプリング周波数
ana_sec=0.02;        % 分析時間
t=[0:1/fs:ana_sec];  % 時間軸データの作成
y= sin( 2*pi*freq*t );  % 周波数freqのサイン波の作成
w= hanning(length(t))';  % 窓関数の作成
yy= y.*w;              % 窓関数をかける
fyy=fft(yy,fftpt);    % フーリエ変換
fx=(0:fftpt-1)*fs/fftpt;  % 周波数軸データの作成
samp=abs(fyy);   % 複素数=>振幅の計算
sph=angle(fyy);  % 複素数=>位相の計算
subplot(211); plot(fx,samp);    % 振幅スペクトルの描画
subplot(212); plot(fx,sph);     % 位相スペクトルの描画
return
図4
横軸が標本化周波数の範囲になっています。フーリエ変換をすると、
標本化周波数の半分で、分析データが折り返しになります。つまり、
現在のデータでは、44100Hz/2=22050Hzまでで振幅スペクトルも
位相スペクトルも折り返されています。
さて、1000Hz付近の情報が分かりませんので、0から2000Hzまでの範囲に
x軸を拡大してみましょう。各plotのすぐ後で、軸の範囲を指定するコマンドを入れて下さい。
subplot(211); plot(fx,samp); set(gca,'XLim',[0 2000]);   
subplot(212); plot(fx,sph); set(gca,'XLim',[0 2000]);   
図5
上段の振幅スペクトルの図から、1000Hz付近の周波数成分が大きい事が分かります。
では、sin波をcos波に変えるとどうなるでしょう? sin波とcos波は位相がπ/2だけずれて
いるだけで、波形の形状は同じでしたね。
anawave2.mのsinをcosに変えて試してみましょう。
図6
図6より振幅スペクトルが全く同じで、位相スペクトルが異なる事が分かります。
音を聞いてみると、sin波とcos波の差は分かりません。一方、周波数(freqの値)を
変化させると、振幅スペクトルの値は変化し、耳では音の高さが異なる事を知覚する
事は、前回試した通りです。
この様に、人間の耳は、振幅スペクトルの変化に対して位相スペクトルは鈍感であり、
昔はあまり重視されていませんでした。(最近は位相も重要な音の特徴量であることが
分かっています。) この演習では、以後、位相スペクトルは扱いません。
3 音声の周波数分析
3.a 振幅スペクトルとF0の関係
では、いよいよ音声の周波数分析に入りましょう。
次の図は音声をフーリエ変換して得られた振幅スペクトルの図です。
声の高さを変えると、細かい変化(スペクトル微細構造)が変化します。
5・6時限の演習では、母音を発声してスペクトログラムで赤い帯が等間隔になって現れている
部分を見て、基本周波数(F0)を求めました。下の図で微細構造の山の部分が赤く
なっていたのでしたね。つまり、F0は一番左(周波数が低い)の山のピークでした。
図7
3.b 振幅スペクトルとフォルマント周波数の関係
振幅スペクトルの包絡線を、スペクトル包絡と呼びます(図7参照)。
声道の共振により、スペクトル包絡の形が変化します。
声道の共振によって、スペクトル包絡にも共振部分(ピーク部分)が現れます。
これが音声の特徴で、何を発声しているのかによってピーク値のパターンが
異なります。スペクトル包絡のピーク(共振周波数)が「人間の発話機構 2.共振」の部分で述べた
フォルマント周波数です。低い周波数側から
順に第1フォルマント(F1),第2フォルマント(F2),...です。
声道の形と対応する母音(ただし英語)のフォルマントの例を次の図8に示します。
図8
この例は英語の母音で調べたものですが、下に日本語の母音/a/,/i/,/u/,/e/,/o/
についてフォルマントF1とF2の平均を求めた図を示します。
横軸がF1で縦軸がF2です。
図9
4 課題1-2  
自分で/a/,/i/,/u/,/e/,/o/の音を録音して図5を参考にF1,F2フォルマントを求めなさい。
また、/a/の場合で基本周波数も求めなさい。
操作手順
44.1kHzで0.5秒間発声した母音を録音します。
あらかじめ発声しておいて、発声途中で録音するときれいなデータが取れます。
[y,fs]=recordsound(0.5,44100);
きちんと録音されているか確認する。
soundsc(y,fs);
各データをフーリエ変換してスペクトル振幅の図を作ります。
まず、次のコードのMファイルを作成して、anafq.mで保存して下さい。
function anafq(y,fs)
SEC=0.03;   % 分析時間 30msec
fftpt=2^15  % フーリエ変換の分析精度を決定する数
CN=70;      % スペクトルの包絡線の精度を決定する数
stN=fs*0.05;
puN=fs*SEC
t=(1:puN)/fs; 
y=y(stN+1:stN+puN);
w=hanning(puN)';
y=y.*w;
yf=20*log10(abs(fft(y,fftpt)));  %フーリエ変換、dB(対数)軸に変換
fx=(0:fftpt-1)*fs/fftpt;
ycep=real(ifft(log(abs(fft(y,fftpt))),fftpt)); %以下、包絡線を求める処理
yc=zeros(1,length(ycep));
yc(1:CN)=ycep(1:CN);
yc(end-CN+1:end)=ycep(end-CN+1:end);
yfc=20*log10(abs(exp(fft(yc,fftpt))));
subplot(121);plot(t,y); set(gca,'XLim',[0 SEC]); %波形表示部分
legend('waveform');xlabel('time(sec)');
subplot(122);plot(fx,yf,fx,yfc,'r'); %振幅スペクトル表示部分
set(gca,'XLim',[0 4000]);   % 横軸の範囲
set(gca,'YLim',[-40 50]);   % 縦軸の範囲
legend('amplitude spectrum',['cepstrum ' int2str(CN)]);xlabel('frequency(Hz)');
return
Mファイルが出来たら、anafq(y,fs);と
実行すると分析結果が画面に現れます。
このプログラムでは、包絡線を求める為にケプストラム(cepstrum)分析という方法を
用いています。CNという分析精度を決定する数は、値が大きくなる程、包絡線で出来る
ピークの個数が増えます。図9を参考にしながら、CNを50--70くらいの間で変化させて
一番良くF1とF2のピークが見える所を探して下さい。
20*log10は、dBと呼ばれる対数表示への変換です。人間の耳は対数的に
音の大きさを知覚するので、音の分野では振幅スペクトルをdBに変換して
表示します。
縦軸と横軸の範囲も、データに合わせて変化させて下さい。
以下に、女声の/a/,/i/,/u/,/e/,/o/の分析例を挙げます。
図11: /a/の分析 
図12: /i/の分析 
図13: /u/の分析 
図14: /e/の分析 
図15: /o/の分析 
次にマウスを使ってピーク値の周波数を調べます。MATLABのコマンド画面に
次のginputコマンドを入力します。
>> [x,y]=ginput(1)
コマンドを実行してからマウスを画面へ持っていくと、画面に交差する
縦線と横線が現れます。マウスを調べたいピーク値の所に移動し、1回
クリックします。すると、コマンド画面にxとyの値が出力されます。
xには、マウスで指した横軸の値が入ります。上の/a/の図で試してみましょう。
図16: /a/のF1ピーク値を調べる
>> [x,y]=ginput(1)
x =
1.0341e+03  %(注: 1034.1)
y =
0.8097
>>
これより、ピーク値の周波数が1034Hzであることが分かります。
同様の方法で、/a/での基本周波数も調べてみて下さい。
図17: /a/の基本周波数を調べる
参考文献 
音響・音声工学, 古井著,  近代科学社
ディジタル音声処理, 古井著,  東海大学出版会
改訂音声, 日本音響学会編, コロナ社
音声・聴覚と神経回路網モデル, 甘利他著, オーム社
1日目7,8時限[河原・山本担当の演習課題]
