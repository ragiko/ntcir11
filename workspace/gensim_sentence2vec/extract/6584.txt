
概要
基本概念
論理削除との相性
InlineView でも実現可能
実装方法
実装の流れ
メソッド仕様
リレーションに対してのみ利用
他の機能との組み合わせ
OnClause と InlineView どちら?
概要
基本概念
リレーションの結合における、on 句での絞り込み条件を設定します。
例えば、"会員ステータスの表示順が 2 であること" という条件があったとして、通常の Query では、この条件は where
句に展開されます。それを、where 句ではなく、結合(join)の on 句に展開されるようにできます。この場合、検索結果は大きく異なります。
where 句表示順が 2 のステータスに関連付く会員のみ検索対象
on 句表示順が 2 のステータスのみが会員と結合される(会員は全て検索対象)
on 句での絞り込みは、言わば "結合時に結合先テーブルだけを絞り込む"
と捉えることができます。(実行計画の内部的な挙動と一致するかどうかは別にして)
これにより、DB構造上は {n : 1} 型リレーションでも、SQL上では(一時的な) {n : 0...1} 型リレーションになります。
例えば、SetupSelect をした場合、基点テーブルの Entity は on 句で絞り込まれた関連テーブルのデータを持っていません(null になる)。
OnClause | DBFlute
