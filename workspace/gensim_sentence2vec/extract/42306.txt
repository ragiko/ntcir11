最近、Androidのデータ初期化について、「AVAST」から興味深いレポートが出た。
市場に出回る中古のAndroidを20台ゲットして解析したら、個人情報がいっぱい入ってた、と。
写真4万件以上
電子メールとテキストメッセージ750件以上
連絡先250件以上
4台分の前所有者らの身元
記入済みのローン申請1件
むぅ。
自分も気をつけないとなぁ、と思いつつ。
たまたま、初めてAndroid端末を買い換えたので、古いのを売ろうかと思って。
実際に初期化してみると、、、
そもそも「上記レポート以前の問題」で、データが全然削除されねーな、と。
データが解析される?
写真は手動で削除が必要?
おサイフケータイのデータはどうなる?
各アプリが作ったフォルダの扱いは?
そこら辺について。
メモにて。
「Android」の初期化機能、個人情報の消去が不完全
まずは「AVAST」のレポートから。
セキュリティソフトウェアで知られるAVASTは、eBayでAndroidスマートフォン20台を購入した。
AVASTの従業員がこれらのスマートフォンのデータを復旧したところ、写真4万件以上、電子メールとテキストメッセージ750件以上、連絡先250件以上、4台分の前所有者らの身元、記入済みのローン申請1件などが見つかったという。
「Android」の初期化機能、個人情報の消去が不完全--セキュリティ企業が指摘 - CNET Japan
Androidには、「データ削除」のメニューが用意されている。
メニュー
バックアップとリセット
データの初期化
「データの初期化」には、以下のような説明文がついている。
携帯端末内のすべてのデータを消去する
なるほど。
「すべてのデータを消去する」、ね。
しかし、これを実際に行って
初期化した
工場出荷状態に戻した
と思っても、、、
実はAndroid端末内には、個人情報を含む各種データが残っている、という。
なぜか?
「ファイル削除」とは、、、OSから「ファイル」を見れなくしただけ
ディスク上には、ファイルのデータ実体は残っている
という、例のアレです。
このデータ実体は、OSからは「ないもの」として扱われるので、他のデータを記録する際にアドレス空間上では上書きされたりする。
上書きされれば、晴れて「完璧にデータが世の中から消えた」。
上書きされるまでは?
解析しようと思えば、可能な状態で残り続ける。
このため、PCの初期化では
ディスク全体をランダムな値で7回上書きする
※全領域・全アドレスを確実に上書き処理する
みたいな手法がありますよね。
データの完全消去 - Wikipedia
まぁ、スマホでも同じことが言える、と。 
ふーむ。
しかし「AVAST」は、どうやってデータを解析できたのか?
OSから見れなくなったデータ実体を?
再現手順については、AVAST公式サイトをチェケら。
Avast blog » Android Forensics, Part 1: How we recovered (supposedly) erased data
データを解析した手法は3つ。
Mass storage mount
Logical analysis
Low level analysis
以下、ちょっと詳しく。
Mass storage mount
中古で買ったAndroidをUSBでPCにつなぎ、外部ストレージとしてマウントする。
It might seem unbelievable, but 
そんなトコロにデータは残ってないと思うでしょ?
でも、いくつかのメーカーでは、残ってるんだな。
※データをどこに置くかは、割と端末メーカーが決めてる
a lot of personal data was recovered from this particular example.
このようにマウントさえできれば、そこからデータを解析することができる。
これは簡単すね。
Logical analysis
using Android Debug Bridge (adb backup command). 
adb backupコマンドを使う。
※USBでつないだ上で
得られたバックアップ・ファイルを「Android Backup Extractor」で展開し、tarファイルにする。
そこにはSQLite database filesが含まれ、もちろんSQLiteのビューアーでみることができる。
AndroidではSQLiteが内部的によく使われているので、まぁ、そうなんでしょうね。
※アプリの保存データとかに使われる
Low level analysis
上記2つでデータが得られなかった場合。
rootをとり、パーティションをガバっとdumpコピーして、マウントする。
これには色んなツール・コマンドを使う必要がある。
ちょっと長いので省略。
これは、ちょっとスキルと根気が必要な手段となる。
さて。
AVASTが言うには、今回のテスト(20台の中古Android)では、SMSやチャットの記録を得るには大抵の場合、「low level analysis」が必要だったとのこと。
In most cases, we got to the low level analysis, which helped us recover SMS and chat messages.
あの、一番面倒そうな手法ね。
そーゆー意味では、「自分が売った端末」が「データ解析の憂き目」にあう可能性は、そこまで高くない気がするな。
「low level analysis」まで頑張る人が、それほどいないでしょう、という意味合いにおいて。
万が一、個人情報を集めるために中古端末を買いあさってる人にとられたらキツいけど。
個人的な感想。
まー、あんま気にしすぎてもアレかな。
Androidでデータを完全削除するには?
PCと同様に、データが解析される可能性があるのは分かった。
では、どうすればいいのかにゃ?
端末全体の暗号化をしてから、初期化すると良いらしい。
スマホ廃棄前に必須！ データを完膚なきまでに消去する方法 ｜ ライフハッカー［日本版］
ということで、
端末を暗号化する
初期化する
で、OKとのこと。
「暗号化」はちょっと時間がかかるが、メニュー上から実施可能。
メニュー
セキュリティ
携帯電話の暗号化
この手法は、「MacBook Air」を初期化する時の手法と同じっすね。
「MacBookAir」を売る前に、「SSD」からデータを「完全消去」する方法。「SSD」におけるデータ復元と削除の話。 - やじり鳥
ただし。
工場出荷時の状態にリセットしてデータを消去すれば、理論的にはわざわざデータを上書きする必要はありません。
けれども、不安な場合や、念には念を入れたい場合には、スマートフォンを暗号化してから(たいていは「セキュリティ」の「設定」から実行できます)データを消去すれば、さらに安心感が得られます。
とのこと。
まぁ、気になるなら、という感じすかねー。
Androidの「データの初期化」はEdyに注意
実際に初期化してみた。
まずは普通に、暗号化ナシで。
メニュー
バックアップとリセット
データの初期化
しかし、気になる文言が。
この操作を行っても次のデータは削除されません。
・おサイフケータイ
なるほど。
「おサイフケータイ」というと、
Suica
iD
Edy
Waon
nanaco
QuickPay
など。
自分が使ってるのは、Suica・Edy・Waon・QuickPay、など。
これらの「おサイフケータイ」では、機種変更用にメニューが用意されている。
手法は全部同じで、
旧端末でネット(センター)にデータを預ける
新端末でネット(センター)からデータを取り出す
これで、旧機種ではデータが削除される。
このため、Androidの機能である「データの初期化」の対象となってなくても、問題なかった。
ただし。
Edyについては、ちょっと事情が特別な感じ。
電子マネー「楽天Edy（エディ）」 | 楽天Edyをはじめる | おサイフケータイの機種変更・譲渡時
Edyには、
残高の移動
アカウント(残高含む)の移動
の2タイプある。
しかし「アカウント移動」は有料。
※他のおサイフケータイではアカウント移動は無料
なので、「残高の移動」だけしたんだが。。。
残高を移動して0円にする
Edyアプリを削除する
Androidによるデータの初期化
まぁ、一般的に端末を売る前に行う操作ですね。
「データ初期化」の後で、もう一度アプリをインストールしてみると?
「利用履歴」がみれてしまった。
おー尿!
俺のEdyでの買い物履歴が!
つまり、スマホの前の持ち主の、利用履歴がみれてしまう。
この利用履歴には個人情報は含まれないし、設定していたクレカの情報などのアカウント情報は、ちゃんと削除されている。
なので、過度に心配する必要はない気がする。
ただまぁ、ちょっと「気持ち悪いかな」、という。
また、初期化後でも「Edy番号」も変わってない。
自分が使っていたEdy番号を、他人が使うことになる。
「Edy番号」は、「Edyもらえるモール」や「ANA ICサービス」で設定したりする。
なので、ここら辺は注意が必要かなぁ、と。
深刻な問題にはならないが、「ポイント/マイルがどこにつくのか?」みたいな。
Androidの「データの初期化」って、なんぞ?
「おサイフケータイ」はともかく。
「データの初期化」で、ちゃんとデータは削除されただろうか?
初期化後の端末に、別の「Googleアカウント」でログインして初期設定し、他人が端末を入手した前提でデータをチェックしてみた。
結論からいうと、以下が残っていた。
写真、写真、写真!
各アプリの作ったフォルダと、データ
自分の端末はN-04Dで、正直いうと、ちょっと「やんちゃ」かもしれない。
最新の機種とかは、もう少しちゃんとしてると思うので、ご留意ください。
まず、N-04Dでは、/mnt/sdcard以下に色んなデータが保存される。
※sdcardといいつつ、メーカーによっては本体メモリ内のデータ領域がマウントされている
それらは、初期化後も基本的に残ってた。
電子書籍アプリでDLした書籍データとか、掲示板アプリの閲覧ログとか、そーゆーの。
※これはAVAST調査の一番簡単な手法によるサルベージの好例だな
逆に、何が「削除/初期化」されたのか?
紐付けたGoogleやfacebookアカウントは削除される。
このため、直接的にID/PASSのようなモノが流出することはない。
それから、スマホのカメラで撮った写真。
スクリーンショットの写真。
WEBからDLした写真。
ばっちり残ってる。
そうか。
Andriodの「初期化」ってのは、写真とかは含まれないのか。。。
ガラケーというより、スマホはPC的な感覚で見てしまうから、全部クリアしてくれるような雰囲気を勝手に想像してたぜ。
まぁ写真や文書は手動で削除しないとイケないっすね。
「/mnt/sdcard」以下を全削除するだけだが。
※自分の場合
Androidは、sdcardとかexternal_sdとか、外部SDかと思いきや内部メモリだったり、シンボリックリンクだったり。
それもメーカーによってパスや扱いが違ったり。
割とカオスっぽいんだよねぇ。
それも関係しているかもしれない。
ちなみに、「暗号化してから初期化」もやってみたが、結果はあまり変わらない。
そもそも「初期化」の対象に「なるか/ならないか」の問題なので。
暗号化はされてるかもしれんが。
なんにしろ
手動でのファイル削除が必要
ということっすかね。
んー。
とりあえず、ファイル全消去とかしとくか。。。
Androidの初期化は「個人情報」がダダ漏れ?確実に削除する方法と、「おサイフケータイ」の注意点など - やじり鳥
