データがハフマン符号化法で符号化されたデータ(フレームタイプ0)であることを表すセグメントで、DCTデータをハフマン符号化する時の各種バラメータを定義しています。
1) マーカー識別子(M_ID)
このバイトと次のバイトがマーカーであることを識別するためのデータで、常に固定値FFHです。
2) SOF0マーカー(M_SOF0)
SOF0セグメントであることを表すマーカーで、常に固定値C0Hです。
3) フィールドの長さ(Length)
マーカーに続くフィールドのバイト数を表すデータで、このデータ自体も含めた値です。
この値に2を足した値がセグメントの長さになります。
4) サンプルの精度(P)
DCTデータの精度をビット単位で表した値で8または12です。
ベースラインJPEGでは常に8です。
5) イメージの行数と列数(Y、X)
イメージの行数(高さ)と列数(横幅)をピクセル単位で表した値です。
6) 構成要素数(Nf)
DCTデータの構成要素の数を表す値で、通常はY、Cb、Crの3種類ですから3です。
このデータに続く構成要素識別子(Ci)、サンプル化要因(H/V)、量子化テーブルの番号(Tqi)の3つのフィールドは、3つ1組で構成要素数だけ存在します。
7) 構成要素識別子(Ci)
構成要素の種類を表す整数コードで、以下のような種類があります。
コード1…Yのデータ
コード2…Cbのデータ
コード3…Crのデータ
ハフマン符号化されたデータは、ここで定義された構成要素順に並んでいます。
8) サンプル化要因(H/V)
サブサンプリングした時の比率を表す値で、上位4ビットが水平方向の比率、下位4ビットが垂直方向の比率を表します。
例えばサンプリング比率を4対1として、2×2(=4)ピクセルの領域ごとに、Yデータはそのまま4データをサンプリングし、CbとCrは4ピクセルの平均値を各1データとしてサブサンプリングした場合、YデータとCb、Crデータの水平方向の比率と垂直方向の比率はどちらも2:1になります。
したがって、Yに関するサンプル化要因データは22H(上位4ビット=2、下位4ビット=2)、Cb・Crに関するサンプル化要因データは11H(上位4ビット=1、下位4ビット=1)となります。
9) 量子化テーブルの識別子(Tqi)
DCTデータを量子化した量子化テーブルの識別子で、DQTセグメント中の量子化テーブル識別子(P/Tの下位4ビット)に対応した値(Y要素は0、Cb・Cr要素は1で、3以上は非ベースラインJPEGとなる)です。
(5) ハフマン法テーブル定義セグメント(Define Huffman table segmet、DHT)
CGファイル概説 第6章 第3節 その2
