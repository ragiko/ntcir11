03.11.17。MOC法のサブルーチンにバグを発見。おそらく結果はそんなに変わらないと思われるので、テスト計算はしなおしません。多分結果は変わらないはず…。良くなることはあっても悪くはならない、はず…。
03.12.15。人工粘性のサブルーチンにバグを発見。グリット幅の最小値を使うべきところを最大値で計算していた。とりあえず3次元コードのみ修正済み。
上図は左から修正Lax-Wendroff法(cans2d)、CIP-MOCCT法、CIP-CSL2-MOCCT法で
計算した線形MHD波の伝播のテスト計算。グリッド数は全て103X103。
この場合だけ以下とはカラーレンジが違うことに注意。
これは先程と同様の初期条件であるが、グリッド数が203X203の場合。
グリッド数が403X403の場合。
Parker-Instabilityの計算。グリッド数は103X113。
左はCIP-MOCCT法、右はCIP-CSL2-MOCCT法。
CSL2法では、うまく解けていないのが分かる。線形問題では
普通のCIP法と差が無いので、非線形問題を扱う時に問題があるのかもしれない。
(ただしShock-Tube問題は普通に解けるのですが…)
ケルビン・ヘルムホルツ不安定性の計算。上は普通のCIP法。下はCIP-CSL2法
グリッド数は103X103。クーラン数は0.5、人工粘性係数は0.75。
色は密度の大きさを表している。
やはりCSL2だとうまく計算できていない模様。再度コードのチェックが必要かも。
レイリー・テイラー不安定性の計算。普通のCIP法で計算した結果。
グリッド数は103X103。クーラン数は0.5、人工粘性係数は0.75。
色は密度の大きさを表している。
(2004.8.31 クーラン数0.4でも結果は同じ。人工粘性係数を0.6にして実行すると、時間発展の結果がいびつになる。理由は不明。)
重いガス側で、どうも波長の短いモードが成長している。
普通のCIPコードにもどこかにバグがあるのか、もしくは初期条件の与え方が
まずいのか。再度コードチェックが必要かも。
03/11/14 update
レイリー・テイラー不安定性の計算。普通のCIP法で計算した結果。
グリッド数は103X103。クーラン数は0.5、人工粘性係数は0.75。
色は密度の大きさを表している。
非移流相を先に解いてから移流させるように変更し、かつ圧力を解くようにした。
vx,vy,roにのみ擾乱を与えて、スタッガードメッシュの速度(vxm,vym)には擾乱を
与えないと上のように波長の短いモードの成長が弱くなった。
ただしvxm,vymにも擾乱を与える(またはvx,vyの平均としてvxm,vymを与える)と
前回のように波長の短いモードの成長が見られる。このように初期条件の与え方に
かなり依っているようだ。
3次元コードで、ある一方向に物理量のjumpを与えた場合の計算。
上からx,y,z方向にjumpを与えている。グリッド数は109x109x109
(-0.5と0.5の間に101グリッド)。
クーラン数は0.5で、人工粘性係数は0.75。比熱比は2.0。
3次元コードで、2次元コードを用いて行ったParker-Instabilityと同じ初期条件
の計算を行った。
左の図はx-y平面で不安定性が発展するケース。右の図はy-z平面でのケース。
グリッド数は109X119X11,or,11X109X119(x,yもしくはy,z方向には0.0と40.0の
間に101グリッド)。
zもしくはx方向は自由境界を設定。
クーラン数は0.5で、人工粘性係数は0.75。比熱比は5/3。
(03/11/13:convert.fでvx,bxのところに周期境界条件を課すのを忘れていた。
しかし結果を見る限り、それでもうまく計算されていそう。)
03/11/14 update
レイリー・テイラー不安定性の計算。普通のCIP法で計算した結果。
グリッド数は109X109X11。クーラン数は0.4、人工粘性係数は0.75。
色は密度の大きさを表している。
このコードは移流非移流の順で解く。また内部エネルギーを解いている
vx,vy,roにのみ擾乱を与えて、スタッガードメッシュの速度(vxm,vym)には擾乱を
与えない場合。やはり移流、非移流の解く順番、内部エネルギーを解くか圧力を
解くかには依らず、初期条件を同じにすれば2次元と同じ結果が出た。
また密度、内部エネルギーに関して、移流をLog変換して行っても同じ結果を得た。
03/11/27 update
3次元CIP-MOCCTコード(並列化済み)のコードでのリコネクションの計算。
グリッド数は207X307X17。クーラン数は0.4、人工粘性係数0.75。
0<x<5, 0<y<20の範囲にグリッドがそれぞれ101,201ある
(x方向のメモリで数字が無いのはx=5.0)。
圧力(Logスケール)と速度場を示している。
線形Alfven波の伝播。振幅が小さい場合(初期に与えるVy=0.001)。グリッド数は800。γ=2.0。クーラン数は0.5。上がVy、下がBy。
線形Alfven波の伝播。振幅が大きい場合(初期に与えるVy=0.1)。グリッド数は800。γ=2.0。クーラン数は0.5。上がVy、下がBy。
Back to the top page of the research
CIP-MOCCTコード作成のページ
