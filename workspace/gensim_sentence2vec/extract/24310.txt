VLOOKUP (e1tw)
基本的なVLOOKUPの使い方を超簡単に解説します
VLOOKUPは 縦型(Vertical)の表の中からデータを探し出すことができます
HLOOKUPは 横型(Horizontal)の表の中からデータを探し出すことができます
VLOOKUPの例
食品名の表から、ある食品のカロリーを求める例でVLOOKUPを説明します
セルB5 からセルC10 の範囲に縦型の表を作成します
セルC3 に =VLOOKUP(B3, B6:C10, 2, FALSE) と入力し[Enter]キーを押します
セルB3 に 食パン と入力し[Enter]キーを押します
VLOOKUP は赤い矢印の経路で ポテトチップス  チーズあられ  食パン と探し
結果、セルC3 に 食パン のカロリー 240 が表示されます
また、セルB3 に ポテトチップス と入力すると、セルC3 にポテトチップスのカロリー 583 が表示されます
VLOOKUP・式の意味
=VLOOKUP(<検索値>, <範囲>, <列番号>, <検索の型>)
=VLOOKUP( B3 , B6:C10 ,  2 , FALSE )
<検索値>
この例ではセルB3
調べたいデータが入ったセルを指定します
<範囲>
この例ではセル範囲 B6:C10
探すべきテーブル(縦型の表)の範囲を指定します
この例ではVLOOKUPは (範囲の左端の列)B6からB10の範囲にセルB3の内容と同じものがないか探します
<列番号>
この例では 2
表の何列目を答えとして使うかを指定します
<検索の型>
この例では FALSE (フォールスと読む)
近似検索するとき:TRUE
完全に一致するものを探すとき:
FALSE
原理的にはB列の品名の文字コードの昇順に並べてあれば
FALSEは省略可能ですが現実として単純な並べ替えでは文字コードの順に
並んでくれない場合が多いです
VLOOKUPの使用法
VLOOKUPはこのように、テーブル(表)から何らかの情報を探し出すことに使われます
人名の一覧から  電話番号を探し出す
会社名の一覧から  担当者名を探し出す
生徒の一覧から  数学の点数を探し出す
VLOOKUPのテーブルが別のシートにある場合 [sheet]
=VLOOKUP(B3, sheet3!B6:C10, 2, FALSE) のように シート名!テーブルの範囲 を指定します
関連ページ:
VLOOKUP (e1t) [別シート版]
[[20020625230516]]
『VLOOKUP 範囲指定を複数sheetで』(HIRO)
2つの条件でのVLOOKUPを使いたい場合
2条件の例 
VLOOKUP (mm0921)
VLOOKUPでエラー #N/Aが表示されるいろいろなケース [N/A]
原因1) セルB3に何も入力されていない場合、データ未入力の場合
原因2) セルB3にテーブルにない品名が入力された場合
原因3) テーブルにあるはずなのに#N/Aが返される場合
データ又はテーブルの文字の間違い
[チーズあられ]と[チ−ズあられ] : 
ーと −
[DD580-2]と[DD58O-2] : 
0ゼロと O英字のオー
[DD580-2]と[DD580-2] : 
D半角と D全角
[A548-R1]と[A548-Rl] : 
1数字と l英字のエル
[Y45-651]と[Y45-651 ] : 
うしろにスペース
テーブル範囲の間違い
=VLOOKUP(B3,B6:C9,2,FALSE):テーブルの最後が含まれていない
関連ページ:
エラー #N/A
VLOOKUPで#N/Aを表示させない2種類の方法 (2011/12/16更新)
IF関数を使って#N/Aを表示しない方法
=IF(ISERROR(
VLOOKUP(B3, B6:C10, 2, FALSE)),"",VLOOKUP(B3, 
B6:C10, 2, FALSE))
VLOOKUPの結果がエラーだったら何も表示しない、エラーがなければVLOOKUPの結果を表示
IF関数を使って #N/A を 0 表示する方法
=IF(ISERROR(
VLOOKUP(B3, B6:C10, 2, FALSE)),0,VLOOKUP(B3, 
B6:C10, 2, FALSE))
VLOOKUPの結果がエラーだったら 0 を表示、エラーがなければVLOOKUPの結果を表示
条件付書式を使う方法
セルC3をクリック
[書式]メニューの[条件付き書式]で条件を[数式が]に
式を =iserror(C3) に
書式でフォント色を背景色と同じ白にします
VLOOKUPでエラー #REF! が表示される[REF]
VLOOKUPの式が入ったセルをコピーして、テーブルの位置がずれてきた場合 #REF! になります
テーブルを参照している式を 相対参照方式 から 絶対参照方式 に変えて対策します
B6:C10 (相対参照)  $B$6:$C$10 (絶対参照)
関連ページ
[[20070920113940]]
『VLOOKUP コピーをすると#REF!が出てしまう』(みこ)
絶対参照と相対参照 (mm0724)
エラー #REF!
関連サイト
Microsoft Office OnLine:
VLOOKUP 関数 Excel2010
Microsoft Office OnLine:
VLOOKUP Excel2003
Microsoft Office OnLine:
エラー値 #N/A を修正する Excel2003
Microsoft Office OnLine:
エラー値 #REF! を修正する Excel2003
キーワード
VLOOKUP
関数
検索の型
#N/A
#REF!
未入力
別シート版
2条件
2003/11/26:登録 2013/05/23:更新 訪問者:
VLOOKUP 関数 使い方 検索の型 エラー #N/A #REF! 0表示 未入力 エクセル Excel [エクセルの学校]
