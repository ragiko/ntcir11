
はじめに
YouTubeやFacebookでも利用されているという噂のFFmpegは、開発が非常に活発で、ここ1年だけでもバージョン1.0から2.1まで上がっています。
ちょっと前まではFFmpegでエンコードした動画をストリーミングに対応させるのは一手間かかったのですが、今では-movflags faststartオプションを付けるだけで対応できるようになりました。(…というのも新しい機能のほんの一部で、他にもたくさんあります)
ここでは、FFmpegの簡単な使い方をメモします。
内容は基本的なことですが、実運用で得たTipsもできるだけ混ぜていきたいと思います。
また、内容に誤りなどあれば、是非ご指摘頂けると有難いです。
インストール
インストールについては公式サイトに丁寧な解説があるので、そちらをご参照ください。
https://trac.ffmpeg.org/wiki/CompilationGuide
基本的には書いてある通りに進めば問題なく動きますが、動画エンコード時に使うフィルタによっては、configure時に何らかのオプションを付ける必要があります。
例えば、映像内に文字を書き込むにはdrawtextというフィルタを使いますが、これを利用するためにはconfigure時に--enable-libfreetypeオプションを追加する必要があります。
※ビデオフィルタに関するドキュメント
http://ffmpeg.org/ffmpeg-filters.html
使い方
FFmpegは豊富なエンコードオプションが用意されていますが、何も指定しなくても十分に使えます。
H.264でmp4形式に変換する
H.264でのエンコードは、以下のように行います。
[元動画]は、FFmpegが対応しているものであれば自動判別してくれます。
ちなみに、H.264はWebでの動画配信では非常に多く利用されている動画コーデックです。ライセンスの問題があり、ブラウザによっては採用されていないのですが(その場合でもFlash経由なら使える)、つい先日CiscoがH.264のオープンソース化を発表し、それに伴ってFirefoxもH.264をサポートすることを発表しました。
※CiscoとMozilla、H.264のオープンソース化とFirefoxでのサポートを発表
http://www.itmedia.co.jp/news/articles/1310/31/news064.html
特定の時間帯を切り出す
特定の時間帯を切り出すのも簡単です。
H264 - 動画処理の定番ツール「FFmpeg」ことはじめ - Qiita
