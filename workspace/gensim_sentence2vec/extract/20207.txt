
こんにちは。Professional Serviceの須藤です。
Force.comデベロッパーの皆さんは、下記の要件をどのように実装しますか?
1. 親子関係のオブジェクトが存在する。
2. 親オブジェクトは、子オブジェクトの必須項目にしたくない。
3. 子オブジェクトの件数やサマリー値を親オブジェクトページに表示したい。
通常、下記のような実装になるのではないでしょうか。
1. 子オブジェクトに参照項目(Lookup Field)として親オブジェクトを定義する。
2. トリガーでサマリーロジックを実装。
上記のような要件をコーディングレスで実現できるお手軽ツールをご紹介します。
Declarative Rollup Summaries for Lookups
【設定手順】
1. パッケージのインストール
上記リンクのページ内中央付近にPackaged Release Historyというタイトルがあり、Latest Version 1.15(2014/12/21時点)の下にPackage Production URL, Sandbox URLというリンクがあります。
インストール先の環境のリンクを押下するとインストールが始まります。
インストールが完了するとアプリケーションが追加されます。
2. サマリー用のフィールド作成
今回は取引先に所属する取引先責任者の人数を取引先ページに表示してみます。
下図のように取引先オブジェクトに数値フィールドを作成します。
3. サマリー情報の設定手順
初めて「Lookup Rollup Summaries」ページを開くと下図のようなエラーメッセージが表示されるようです。
エラーメッセージは気にせず??「Create Remote Site Setting」ボタンを押下します。
下のページに遷移します。
「次へ」ボタンを押下します。
「Lookup Rollup Summaries」ページに戻ると、SFDC標準のタブページが表示されています。
「新規」ボタンを押下後、下図のように設定を行います。
下記の例は、取引先オブジェクトに該当する取引先責任者の人数を表示するように設定しています。
まだPilotのようですが、「Enhanced Edit(Pilot)」ボタンを押下後に表示されるページでは、より簡単に設定が可能なようです。※ 一度、設定を完了させないと「Enhanced Edit(Pilot)」ボタンは表示されません。
設定を保存後、「Managed Child Trigger」ボタンを押下します。
画面下部の「Deploy」ボタンを押下します。
再度、「Lookup Rollup Summaries」ページを開き、「Active」チェックボックをONにして保存します。
「Calculate」ボタンを押下します。
下記の「Run Calculate Job」ページに自動的に遷移します。ページ下部の「「Run Calculate Job」」ボタンを押下することにより、既存データの積み上げ集計処理が実行されます。
4. 動作確認
さあ、取引先ページで結果を見てみましょう。
取引先責任者数が2と表示されていますね。
参照関係項目の積み上げ集計が期待どおりに実行されました!!
参照関係(Lookup)項目のコードレス積み上げ集計 | ブログ｜パソナテキーラとは｜株式会社パソナテキーラ
