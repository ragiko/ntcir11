ポーズに追従する衣服
Poserにはフィギュアに衣服を着せて色々なポーズをさせても、きちんと衣服がポーズに追従する仕組みがあるので、比較的簡単に色々なポーズをさせることができます。でもドレスが風にたなびいたり動きに合わせて複雑な形状をとるような時、ただ単に着せただけの衣服では、表現しきれません。そればかりかスカートのような衣装は、ポーズに合わせただけの形状では、どこか不自然になったりします。
そんな動きのある衣装を表現する時に使うのが、クロスルームです。
スカートを履いたフィギュア
スカートを履かせたフィギュアで様々なポーズをとると、スカートが不自然な形になるとこがよくあります。XinXinさんににセーラー服を着てもらって、しゃがんでもらったのが右の図です。
明らかに不自然な絵になっています。不自然というよりも、愛らしい太腿にスカートが食い込んで、なんだか痛々しい状態です。しかし良くしたものでこのスカートには、モーフデータが仕込まれているので、的確にパラメータをいじるとそれっぽい状態にすることが可能です。
しかしパラメータをいくらいじっても、この位、深々としゃがみこんでしまったようなポーズだと、不自然さを拭いきることができません。
不自然さがどうしても気になる時には、クロスルームでスカートを「布化」して、シミュレーション計算を行い、形状を変形するのが手っ取り早いと思います。
クロスルーム
クロスルームに入り、まず最初にすることは「新規シミュレーション」ボタンを押すことです。上図の赤丸1番のボタンです。このボタンを押して、布化したブジェクトを計算する準備をします。
次にオブジェクトを布化しますが、このとき目的のオブジェクトが正しく選ばれている必要があります。上図の緑丸で示された箇所に現在選択中のオブジェクト名が表示されています。この例では「スカート」フィギュアが選択されている状態で「布化」ボタンを押します。上図の赤丸2番のボタンです。布化の場合、オブジェクトのマテリアル単位で行うので、ボタンを押した直後のダイアログ画面右上の印をクリックして表示されるコンテキストメニューで、実際に布化するマテリアルを選択します。このスカートフィギュアの場合は、「腰部」マテリアルを選択して布化します。色々と試してみると、全てのマテリアルが布化できる訳ではありませんが、ここでは説明を省きます。
そして布化したときに忘れてはならないのが、衝突対象を設定することです。衝突設定を行わないでシミュレーション計算しても、結局足に食い込んだ形状になってしまうのは、当然の結果と言えるでしょう。衝突設定を行うために「衝突設定」ボタンを押します。上図の3番のボタンです。
衝突設定ボタンを押して表示されるダイアログで、シミュレーション計算を行う時に考慮するオブジェクトを選びます。対象のオブジェクトを選ぶには、ダイアログ画面にある「追加/削除」ボタンを押します。ボタンは右図の赤丸のところにあります。ボタンを押すと、またダイアログが開きます。このダイアログから目的のオブジェクトを見つけてチェックマークを付けます。作例では女子高生フィギュアにチェックマークを入れました。必要なオブジェクトを選択した後、OKボタンを押してダイアログを閉じます。
布衝突オブジェクト設定には、まだ続きがあります。
布衝突オブジェクトダイアログの下方にある「ポーズなしからのドレーピングを開始」オプションにチェックが入っていることを確認してください。このオプションは、計算を行う時の開始ポーズをどうするかを決めるものです。後に詳しく解説しますが、シミュレーションはコマ送りの映像を作ることで、布の動きを計算します。つまりアニメーションを作成して計算するのですが、このアニメーションを開始する時のポーズをどうするかによっては最後の状態、つまり結果が変わることになります。このオプションを有効にすると、ポーズ設定に関わらず、関節がのびた状態からシミュレーション計算を開始することを意味します。もし有効ではない場合、この作例ではずっとしゃがんだままの姿勢で計算することになります。最初のフレームで既にスカートが足に食い込んでしまっているので、形状に変化することはなく、結果的に足に食い込んだスカート形状となってしまいます。
この作例では、スカートが頭や手にぶつかることはないので、さらに「頭への衝突を無視」と「手への衝突を無視」オプションを有効にします。これで計算時間をちょっと短縮できるはずです。
最後に「シミュレーション計算」ボタンを押して計算します。上図の赤丸4番のボタンです。この計算にはアニメーション機能が利用されるので、計算に要するフレーム数を指定しなければなりません。指定したフレーム数のアニメーションが作られるのですが、このとき最初と最終フレームに現在のポーズが適用され、中間のフレームは最初と最後のフレームから計算されたポーズで補完されます。
このようにして計算した結果、スカートが足を切断する状態は解消されました。しかしよく見るとお腹の前あたりに、スカートが抱え込まれてしまったようになっている部分があります。先の状態から比べたら、何のことはない状態ですが、それでも気になります。
実はスカートの形状が、しゃがみ込んでから落ち着くまでにはしばらく時間が掛かります。右のピクチャは、しゃがみ込んだ直後の計算結果なので、スカートの形状がまだ落ち着いていない現在進行形の状態なのです。そうしたことまで考慮すると、前述の操作で出来上がったアニメーションを調整することになります。この例の場合で、どのような調整をしたかが分かれば、今後の役に立つことと思います。
アニメーション機能を使う
女子高生役のXinXinさんには1～30フレームの間にしゃがみこみんでもらい、スカート形状が落ち着くまで30フレームとして、XinXinさんには30～60フレームの間はじっとしてもらうことにします。言葉で説明すると、なんだか難しいですね。
上図は、Poserのキーフレームパレットと呼ばれるものです。キーフレームパレットの細かい説明は省きますが、フレーム毎にオブジェクトのポーズ設定があるかないか、ポーズ設定されていないフレームの補完をどうするかなどの情報を見たり大まかに操作するのに使います。
キーフレームパレットで、赤矢印1が示すのは最初のフレーム位置で、赤矢印3が示しているのが最後の60フレーム目です。矢印の上方には、緑と茶色の四角がならんでますが、女子高生の横列をみると矢印に対応した3カ所が濃い色になっているのが分かると思います。この濃い色は、ポーズ設定がされていることを意味しています。薄い緑と茶の四角は、ポーズ設定のないフレームで他のポーズとポーズを滑らかに補完することを表しています。薄緑の四角はスプライン補完を表し、薄茶の四角は線形補完を表しています。
赤矢印1で示された第1フレームには、立っている状態のパラメータが設定してあります。この状態をレンダリングしたのが緑Aの絵です。ただ床の上に立っているのではなく、床の中に沈んだ状態で立たせてあります。こうすることで、腰の位置の変化が少なくなり、スカート自身の上下動による、よけいな皺の発生を抑えることが出来ます。
もし腰の位置が高い所からしゃがんでしまうと、計算の途中では右図のようにスカートがめくれ上がってしまいます。そのため余計な皺ができることがあるので、それを避ける目的で第1フレームでは腰の位置が低くなるようにポーズを調整してあります。
赤矢印2の示す第30フレームでは、すでにしゃがみ込んだ姿勢(図B)になっています。その状態のまま最終60フレームまで、微動だにしない状態に設定するため、キーフレームパレット上で60フレーム目の四角を選択してコピー、30フレーム目を選択してペーストし、その間を薄茶の四角が示す線形補完で繋いでいます。
作例
いかがでしょうか。スカートがポーズになじんでいるのが分かると思います。
作品を作る時には、最初にポーズを決めてそれで終わりという訳にはいかず、途中で何度もポーズの微調整を行うことになります。その度にシミューレーション計算を行う必要はありませんので、最初に借りのポーズをつけたところで計算し、最終確認で計算すれば良いでしょう。上手く行けば2回のシミュレーション計算で済みますが、現実にはそう上手くいかないと思います。それでもシミュレーション計算は、時間が掛かりますので、できるだけ計算しないで済ますことは、制作時間を短縮させることに繋がります。
最後に同じ作品を少しローアングルな別の視点からレンダリングし直してみました。
1つの作品を色々な視点で見直すと、新しい魅力を発見できるのが3DCGの魅力でもあります。話がずれますが、鉄道模型のレイアウトやAFV模型のジオラマの感覚ですね。場所や塗料の匂いを伴わないので、家族に文句を言われない分だけ3DCGの方が趣味として認めてもらえるかもしれません。隠れてする趣味としても好都合かもしれません。
この角度になると、スカートの大部分が見えなくなってしまいますので、あまりクロスルーム機能のありがたみが感じられません。それでもクロスルーム機能を使わなければ、この視点からでもスカート形状の不自然さは残ってしまいます。実際、作品を作ってみると、この機能がいかに構図やポーズの自由度を高めているかが良く理解できます。
こうしてみると巨大少女のスカート姿は、ちょっと無防備すぎますね。きっと巨大女子高生のご学友たちは、彼女の顔を見る機会よりも、巨大なスカートの中を眺める機会の方が多いのではないでしょうか。

