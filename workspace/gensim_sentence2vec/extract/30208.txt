こちらのクエリーを活用して経過日数を算出しているのですが、
http://oshiete.goo.ne.jp/qa/8769213.html
(SQL構文)
SELECT テーブル.ID, Max(テーブル.利用日) AS 直近利用日, Max(テーブル.利用回数) AS 利用回数, Sum(テーブル.利用金額) AS 利用金額合計, Min(DateDiff("d",[利用日],DateValue([yyyymmdd]))) AS 経過日数
FROM テーブル
GROUP BY テーブル.ID;
パラメータのyyyymmddには「2013/12/10」のように、区切り記号付きの日付を入力。
エクセル上で同じ日付-日付の経過日数でみると、エクセルの方が1多いのですが、これはエクセルが誤りでしょうか。
例
クエリー: 2014/09/27でパラメーターを指定  2014/05/13 が直近日付 = 137
例
エクセル: 2014/09/27とセルに入力 そこから右記のセルを引く 2014/05/13 が直近日付 = 136
No.1
回答者:bin-chan回答日時:2014/09/26 22:11
> エクセルの方が1多いのですが、エクセルが誤りでしょうか。
いいえ。「関数の仕様が異なる」です。fの数も違うし。
参考URL:http://www.office-kitami.com/lesson/afunction/da …
原因はわかったのですが、xls.と同じ定義にはできないのでしょうか。
他の方は、このような場合、どのように対処されているのでしょうか。。。
現在のSQL構文に、参考URLにある、
IIf(Format(Date(),"mmdd")<Format([経過日数],"mmdd"),DateDiff("yyyy",[経過日数],Date())-1,DateDiff("yyyy",[経過日数],Date()))
の要素を組み込むことはできないのでしょうか。それとも新たに別列で組み込まなければならないでしょうか。
通報する
ACCESSとEXLの算出で差分が出る - オフィス系ソフト - 教えて!goo
