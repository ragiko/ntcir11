システム準備 (Sysprep) ツールは、複製、監査、および顧客向けの納入のために、Windows® のインストールを準備します。複製 (イメージングとも呼びます) を使用すると、組織内で再使用できるカスタマイズされた Windows イメージをキャプチャすることができます。監査モードでは、追加のデバイス ドライバーまたはアプリケーションを Windows インストールに追加できます。追加のドライバーとアプリケーションをインストールした後、Windows インストールの整合性をテストすることができます。また、顧客に納入するイメージを準備することもできます。顧客が Windows を起動すると、[Windowsへようこそ] が起動します。
Sysprep は、Windows の新しいインストールの構成にのみ使用してください。Windows のインストールの構築と構成に必要であれば、Sysprep を何回でも実行できます。ただし、Windows ライセンス認証をリセットできるのは 3 回までです。Sysprep を使用して、既に展開された Windows の既存のインストールを再構成しないでください。
Windows イメージを別のコンピューターに転送する場合、コンピューターのハードウェア構成が同じ場合でも、/generalize オプションを指定して sysprep コマンドを実行する必要があります。sysprep /generalize コマンドによって、Windows インストールからコンピューター固有の情報が削除され、そのイメージを別のコンピューターで再利用できるようになります。ハードウェア構成が同じコンピューターに Windows イメージをインストールする場合、応答ファイル内で PersistAllDeviceInstalls の設定を使用することにより、デバイス ドライバーのインストールを Windows イメージ内に保持できます。詳細については、無人 Windowsセットアップに関するリファレンス (Unattend.chm) を参照してください。
次回 Windows イメージを起動するとき、specialize 構成パスが実行されます。この構成パスでは、多くのコンポーネントについて、Windows イメージを新しいコンピューターで起動したときに処理する必要のあるアクションが適用されます。 
イメージング、ハード ディスクの複製、その他の方法など、Windows イメージを新しいコンピューターに移行するための方法を実行する前に、/generalize オプションを指定して Sysprep を実行する必要があります。sysprep /generalize コマンドを実行せずに Windows イメージを別のコンピューターに移動またはコピーすることは、サポートされていません。
Sysprep には次のような利点があります。
Windows からシステム固有のデータを削除します。Sysprep を使用すると、インストール済みの Windows イメージから、コンピューターのセキュリティ識別子 (SID) などのシステム固有の情報をすべて削除できます。その後で Windows インストールをキャプチャすると、組織全体でインストールすることができます。
監査モードで起動するように Windows を構成します。監査モードでは、サード パーティのアプリケーションやデバイス ドライバーをインストールすることができるほか、コンピューターの機能をテストすることもできます。
[Windowsへようこそ] が起動するように Windows を構成します。コンピューターの次回起動時に [Windowsへようこそ] が起動するように、Windows インストールを構成します。[Windowsへようこそ] が起動するようにシステムを構成するのは、一般的には、コンピューターを顧客に納入する直前です。
Windows 製品のライセンス認証をリセットします。Sysprep では Windows製品のライセンス認証を 3 回までリセットできます。
BTP シナリオでは、Windows 参照イメージを 1 つだけ作成して、同一のハードウェア構成を使用している複数のコンピューターにインストールします。Windows をインストールしてからドライバーとアプリケーションを追加して、単一の Windows 参照インストールをカスタマイズします。その後で、Windows イメージをキャプチャし、各コンピューターへのインストールに使用します。このイメージに変更を加えることはありません。
このシナリオには次の段階があります。
参照コンピューターに Windows をインストールします。
インストールが完了したら、コンピューターを起動し、追加のデバイス ドライバーやアプリケーションをインストールします。
Windows インストールを更新した後、sysprep /oobe /generalize コマンドを実行します。/generalize オプションは、Windows インストールからシステム固有のデータを削除するよう、Sysprep に対して指示するためのものです。システム固有の情報には、イベント ログ、一意なセキュリティ識別子 (SID)、およびその他の一意な情報があります。固有のシステム情報の削除が完了すると、コンピューターはシャットダウンします。/oobe オプションは、コンピューターの次回起動時に [Windowsへようこそ] を実行するよう、Windows インストールに対して指示するためのものです。
コンピューターがシャットダウンした後、そのコンピューターでは、Windows PE か別のオペレーティング システムを起動することができます。
次に、ImageX を使用して Windows インストールをキャプチャします。これで、同一のハードウェア構成を持つ複数のコンピューターにインストールする参照イメージが作成されます。
BTO シナリオでは、Windows 参照イメージを基にして作業を開始します。その参照イメージをインストールしてから、インストール先のコンピューターに固有の更新を Windows インストールに追加します。一般に、これは顧客から要求されたアプリケーションや更新です。監査モードで起動することで、コンピューター固有の追加デバイスやアプリケーションをインストールできます。
BTO シナリオが BTP シナリオと異なる点は、コンピューターに固有の変更を Windows 参照インストールに追加する点です。
このシナリオには次の段階があります。
まず組織内のすべてのコンピューターに適用できる Windows 参照イメージを用意します。
Windows 参照イメージを、顧客に納入する必要があるコンピューターにインストールします。
インストールが完了したら、sysprep /audit /generalize /shutdown コマンドを実行し、コンピューターを監査モードで起動するよう Windows を構成します。その後、別のパーティションに起動するか、または WindowsPE を使用して、Windows イメージをキャプチャできます。
この結果、イメージは、保存しておくと同じ構成のコンピューターにインストールすることができる参照イメージになります。
新しい参照イメージは、別の新しいコンピューターへのインストールに使用できます。インストールを行うと、Windows イメージがコンピューターに適用され、Windows が監査モードで起動します。
顧客からの注文に応じて追加のアプリケーションとその他の更新をインストールすることができます。また、コンピューターをテストして、すべてのコンポーネントが正常に動作しているかどうかを確認することもできます。
Sysprep とは
