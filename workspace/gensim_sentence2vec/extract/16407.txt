
時系列解析
予測とは? 多数の例について全般的に見る場合には強力なものである。しかし、個の問題、あるいは予期されないことがただ一度起きたと言う場合には、案外役に立たない。しかしそれは仕方がないのであって、本来そういう性質のものである。回帰分析でも時系列分析でも、基本的にはデータの平均値を予測することになるからです。
要するに、100発100中で当たる予報と言うのは存在し得ないんです。
予測のためには、実世界をモデル化しなければなりません。
時系列解析
時系列とは、時間とともに変動する現象に対して時間の順序で測定・観測した結果の記録を時系列データと言い、略して時系列(time series)と
言う。心電図や脳波のような医療データ、気温や気圧のような気象データ、株価および為替レートのような金融・経済データなどがある。
時系列データは、常に変動を伴うものである。その振る舞いを統計的に分析し、データ変動の特徴を捉え、現象の解明と将来の変動を予測・制御しようとするのが時系列データ分析の主要な目的である。
自己共分散と自己相関
通常のデータの基本的な統計的特性を表す統計量として、平均、分散、相関などが用いられている。
これに対応して時系列では、平均(average)、自己共分散(autocovariance)、自己相関(autocorrelation)と呼ばれる統計量がある。
自己相関係数は、過去の値とどれくらい似ているか(あるいは似ていないか)を表したものです。
たとえば、一日前と大きな正の自己相関があれば、「一日前に多ければ、今日も多い」ということになり、2日前と負の自己相関があれば「二日前に多ければ、今日は少ない」ということになります。
時系列の平均や自己共分散の性質が、時間が経過しても変化しない場合、その時系列を定常時系列と言い、それらの性質が何らかの形で変化するものを非定常時系列と言う。
スペクトル分析
時系列データは、幾つかの成分が混合されているものと考えられる。
例えば、トレンド、周期の成分、ノイズなど。
時系列の分析では、周期成分の有無やその成分の値などを分析する必要がある。
時系列データに隠されている周期性を解析する方法としてスペクトル解析がある。
ランダムウォーク
時系列データ解析は、回帰分析と同じく、収集したデータを用いてモデルを作成し、将来の予測やシステムの制御などを行うのが1つの主な目的である。
ある時系列データがモデルで表現でき、かつ｜a｜=1(単位根)である場合、ランダムウォークであると言う。
ランダムウォークである時系列データは非定常である。
時系列データを分析する際には、まずデータがランダムウォークであるか、そうでないかを調べることが重要である。
時系列がランダムウォークであるかどうかを検定することを単位根検定と呼ぶ。
単位根検定は「単位根｜a｜=1が存在する」という帰無仮説検定で、1970年代後半にDickey-Fullerによって初めて考案され、その後Phillips-
Perron検定、McKinnonss検定などが提案されている。
Back to Top
時系列Model
時系列分析では,あるデータの動きの特徴を探るときは,そのデータ自身の持っている特性をモデルに基づいて詳細に探るというアプローチをとります.いわばデータのことはデータ自身にきけという立場です.ARとは Autoregressive の略で自己回帰となります.自己回帰とは,自らの動きを自らの過去の値で説明することを意味します。
ARモデル
時系列データの時間t− pからtまでの関係式を自己回帰(AR:AutoRegressive)モデルと呼ぶ。
ai , i =1,2,…, p を自己回帰係数と呼び、p を次数(order)と呼ぶ。次数p であるARモデルを通常AR( p)で表す。et
は平均0、分散σ2の正規分布に従う残差である。
自己回帰分析は、最も適切な次数p と自己回帰係数ai を推定することであり、このプロセスをモデルの当てはめ、あるいはモデルの推定と呼ぶ。
ARモデルを当てはめる方法としては、ユールウォーカー(Yule-Walker)法、最小2乗法、最尤法、Burg法など幾つかの方法が提案されている。
モデルの評価にはAIC、BICなどの情報量規準が多く用いられている。
-OLS(最小二乗法:Ordinary Least Squares) 線形予測の最も基本的な方法は、OLSと呼ばれる方法。
(いわゆる線形最適化。予測した誤差を2乗したものを、全部足して、その合計が最小になるように係数を調節する計算を、OLSと呼ぶ。
-MLE(最尤推定:Maximu Likelihood Estimation) OLSは、誤差が正規分布すると言う話にして、期間に最適な係数を計算したわけだが、別に誤差の分布なんかどうでもいいから、結果が、いかにも尤もらしくなっていれば、それでも良い話なのかも知れない。
-YW(Yule-Walker) YWは、最も初歩的な状態変化に対応した線形予測(こういうのを適応化と言う)。ARした期間の間で最適な係数を求めるのでは無く、係数そのものにも線形予測を行って、明日専用の係数を算出してくれる方法が、YWと言う事。早い話が、OLSは回帰計算をするだけだが、YWは同時に係数の先読み計算を行いながら回帰をする2段構えの計算をしていると言う事。
-BURG MEM(最大エントロピー法)に基づくARにBURGがある。制御に明るい人であれば、H∞への道すがらとでも言えば良い話なのかもしれないが(この場合はH2)早い話がYWのロバスト版と言ったところ。一般にYWよりBURGのほうが、状態変化への応対も速く、やや良い値を示す事が多い。
MAモデル(移動平均モデル)
MA(q)という表記は、次数 q の移動平均モデルを表す。以下の数式で表される。
MAモデルはARモデルとは違って,y(t)を今期から過去にさかのぼった撹乱項についての移動加重和として表わされます.1やθはウェイトとみなせます.
ARMAとARIMAモデル
自己回帰モデルに移動平均モデルを結合したモデルを自己回帰移動平均(AutoRegressiveMoving Average) モデルと呼び、通常ARMA( p, q)で表す。定義式から分かるようにARモデルはARMAモデルの特殊なケースである。
yt のd 階の差分演算子⊿d yt のARMAモデルを自己回帰和分移動平均( AutoRegressive Integrated Moving Average )モデルと呼び、ARIMA( p, d, q ) で表す。
ARIMAモデルは、1960年代末にBoxとJenkinsにより提案されていることから、彼らの名前を冠してBox-Jenkins法とも呼ばれている
ARMA(自己回帰移動平均モデル)
ARMA(p, q)という表記は、p次の自己回帰とq次の移動平均を組合わせたモデルを指す。以下の数式で表される。
実データに適用する場合、ARMAモデルの p と q を選択後、誤差項を最小化するパラメータを探るため最小二乗法を使うのが普通である。また、実データに適合する最小の p および q を見つけることでよい結果が得られることが知られている。純粋なARモデルでは、これに Yule-Walker 方程式を利用することができる。
Xt の過去の値や誤差項 εt との依存関係は特に何かが判明するまで線形な関係であると見なすのが普通である。依存関係が非線形である場合、このモデルを「非線形移動平均」(NMA)、「非線形自己回帰」(NAR)、「非線型自己回帰移動平均」(NARMA)モデルと呼ぶ。
自己回帰移動平均モデルは他の方法でも一般化される。例えば、ARCH(自己回帰条件付き分散変動)モデルやARIMA(自己回帰和分移動平均)モデルがある。複数の時系列を扱うベクトルARIMAモデルもある。データに季節変動効果がある場合、SARIMA(季節ARIMA)モデルでモデル化される。
自己回帰移動平均モデル(ARMAモデル)は、モデルは自己回帰(AR)部分と移動平均(MA)部分からなる。一般に ARMA(p,q)モデルと表記され、p は自己回帰部分の次数、q は移動平均部分の次数を表す(定義は後述)。
ARIMA(自己回帰和分移動平均)
データの差分を取ってからARMAを適用したモデルです。
ARIMAモデルはBox & Jenkins(1976)によって最初に導出された。
モデルには、3つのタイプパラメータ、つまり自己回帰パラメータ(p)、差分の階数(d)、移動平均パラメータ(q)が含まれる。
時系列データの分析において、多くの場合、時系列の統計的な性質が時間の推移によって変化しない定常過程を前提として分析が行われる。
SARIMAモデル(季節自己回帰和分移動平均モデル)
ARIMAモデルに、さらに周期的な変動(季節変動とか)を取り入れさせたモデルです。
Back to Top
GARCH model
ARCHモデル
なぜARCHモデルが重要なのか?ARMAモデルでは、時系列データの残差はホワイトノイズという前提で議論されていたのですが、
為替レートや株価などの金融資産の時系列データを詳しく調べてみると、実は残差はホワイトノイズの性質を満たしていない。
つまり、金融資産時系列データの残差の分散は一様ではなくばらつきに特徴があることがわかったのです。
例えば為替レートの場合であれば、ある期間大きく円高方向に変化した場合はその後で逆に円安方向に大きく変化する期間が続くという性質です。
このような性質を「分散の不均一性(heteroscedasticity)」と呼んでいます。
このような分散の不均一性を組み込んだ時系列モデルがARCHであり、2003年ノーベル経済学賞を受賞したエングル(R.F. Engle)が1982年に発表したモデルです。
ARCHモデルでは,今期の分散が過去の分散に依存することをモデルに組み込みます。これが、分散不均一の自己回帰過程(ARCH)の意味です。
GARCH model
EngleのARCHモデルを拡張したのが彼の弟子BollerslevによるGARCH(ガーチ,Gereralized ereralized AutoRegressive
Conditional Heteroscedastic)モデルです。ARCHモデルの条件付き分散が過去の分散だけでなく過去の残差の2乗にも依存するという関係を組み込みました。ARCHからGARCHへの拡張は,ちょうどARをARMAに拡張したのと対応しています.
金融資産時系列データの分散の不均一性をとらえるモデルとしては、ARCHよりもGARCHの方がすぐれていることが今日ではわかっています。ノーベル賞はオリジナリティのある研究に授けられるので、ARCHの概念を最初に提案したエングルが受賞したわけです。
Back to Top
Kalman filter
未稿
ページトップ
カオス(Chaos)
カオスとは、振舞いが非常に複雑で不規則に見えるが、実は決定論的に記述できる現象のことである。
決定論的カオスの特徴
・初期値鋭敏依存性
カオス力学系の挙動において2つの近接する軌道間距離は次第に発散してゆき、ついには全く違った挙動を呈するようになる。このように初期値のわずかな誤差、または不確定性が指数関数的に増幅されてゆくという性質はカオスの最も重要な特徴である。
・長期予測不可能性
初期値鋭敏依存性から、無限大の精度で初期状態を観測しない限り、観測誤差が指数関数的に拡大されるため長期的には予測不可能となる。
・有界性
初期値鋭敏依存性のみでは、誤差が拡大され、発散する。アトラクタは非線形折り返しによる再帰運動により漸近安定な状態を保ち、有界領域に存在している。
・フラクタル性
アトラクタでは軌道が折り曲げられ重ね合わせられて、再びもとの軌道に戻っていくという動作を無限に繰り返している。これにより、その断面は相似構造をもつ。このようにストレンジアトラクタの幾何学的構造はフラクタル構造を含んでいるため、フラクタル次元は非整数である。
・非周期性
時系列信号として観測したときに、非周期的な挙動を示す。この性質はアトラクタにも現れており、どの部分の軌道も決して交わることがない。 
各微分方程式の解説
Lorenz 方程式
Ressler方程式
化学者O. Rosslerにより提案された数理モデルである。このように非常に単純な非線形性を有するシステムでありながら、非常に豊富なダイナミクスを有している。
Chen-Ueta方程式
Guanrong Chenにより提案された3次の数理モデル。
Chua回路
電気工学者 松木隆、L. Chua、小室現政、徳永隆治らによって提案されたストレンジアトラクタである。
3次元原点対称3領域系
Langford方程式
時系列解析
実験などでの現実のシステムで計測された1変数の時系列データを解析する際に、高次元空間における力学系のアトラクタの軌道を再構成することが有効である。
D. RuelleとN. Packardらにより、一定の時間遅れ毎の差分による時間遅れ座標系への変換の有効性も示されている。
現在では、1変数の時系列信号x(t)からアトラクタを再構成するための手法として、この変換が最も良く用いられる。
具体的な時間遅れ座標系への変換は、時間遅れの大きさをτとして、m次元の再構成状態空間においてm次元ベクトルを構成すれば良い。
ここではその手法を紹介する.
􀁺カオス時系列解析での処理手順を次に示す.
1. 一変数の一連の時系列データy(t)を多次元空間の1点Y(t)で表現する.
􀁺 例: Y(t)=( y(t), y(t-τ), y(t-2τ),…,y(t-(n-1)τ)
2. その点の再構成軌道(アトラクタ)を求める.
􀁺 n次元空間中にY(t)をプロットしたときの軌跡を求める.
3. アトラクタを用いて予測を行なう.
􀁺 アトラクタを幾何学的に関数近似して表現する.
4. 予測の解析・評価を行なう.
􀁺 近似関数を用いることで将来の変動を予測する.
時系列データを3次元空間に写像してアトラクタを求める.
-アトラクタを幾何学的に再現する.
-重心座標法を用いて軌道を再構成して予測する.
Back to Top
ベイズ統計
ベイズ統計
ベイズ統計(Bayesian Statistics)は、 既知の事象の知識を使って、観測できない確率を計算してしまう手法です。 計算のよりどころは、ベイズの定理です。
「ベイズ統計学」は、18世紀イギリスの確率論研究家トーマス・ベイズ(1710-1761)が提案した「ベイズの定理」とよばれる逆確率計算法を基礎にした統計学の体系である。これに対して、現在広く大学などで教えられ応用されている統計学の体系(検定、推定など)は、統計学史的にいうと「ネイマン・ピアソン理論」といわれる。
ベイズの定理 
ベイズの定理は、
P(A|B)=P(B|A) P(A) / P(B)
P(A)が事前確率、P(A|B)が事後確率 
この定理を繰り返し使うことで、連鎖的な確率を次々に求めることができる。 
上記のベイズの定理に対して、
P(A|B)とP(A)  ⇒ 「確率分布」
P(B|A) ⇒ 「尤度」
P(B) ⇒ 「定数」         
としているのが、「ベイズ統計」と呼ばれる統計学の分野です。
MCMC(マルコフ連鎖モンテカルロ)法
マルコフ連鎖の性質を利用して任意の確率分布から乱数を生成し、解析的に求めることの難しい確率分布を推定する方法。
意思決定ツリー、またはデシジョンツリーとも呼ばれる手法で、樹形図、またはツリー構造と呼ばれる図を作り出し、アウトプットには分類を行なうためのルールを作成します。
決定木を実施した場合、ツリー構造が示されます。
これを別な形で表現すると、IF THEN形式のルールになります。
逐次モンテカルロ
カルマンフィルタは、誤差を正規分布だと決め付けて扱うが、必ずしも誤差は正規分布だけが適切だとも思えない。
逐次モンテカルロは、そういったモデルで、実際の誤差に合うようにサイコロを振って予測する。
マルコフスイッチ
もっとアグレッシブに相場が強いとき用と弱いとき用を自動的に切り代えて予測する。
マルコフ過程とは、一期前の事だけに次に起きて来ることが依存すると言う確率過程のこと。
強いときと弱いときをスイッチ(切り替え)して予測するのがマルコフスイッチ。
モンテカルロフィルター
モンテカルロフィルターと呼んできたのですが、最近は「粒子フィルター」という呼び名で普及しています。
Particle filter
PF は、予測・フィルタ分布を、システムの線型性や、分布が正規分布であることを仮定せずに導かれるアルゴリズムである。
Back to Top
KURENAI NO SYSTEM
