スペル ミス、末尾の不要なスペース、不要なプレフィックス、大文字小文字の誤り、印刷できない文字などがあると、第一印象が良くありません。これ以外にも、データの状態を損なう要素があります。ここで本腰を入れて、Microsoft Office Excel のワークシートの大掃除をしましょう。
データのクリーンアップの基本情報
スペル チェック
重複行を削除する
文字列を検索して置換する
文字列の大文字と小文字を変更する
文字列内のスペース文字と印刷できない文字を削除する
数値と符号を修正する
日付と時刻を修正する
列を結合または分割する
列と行を変換して配置し直す
結合または照合によってテーブル データを調整する
サード パーティ プロバイダ
ページの先頭へデータのクリーンアップの基本情報
データベース、テキスト ファイル、Web ページなどの外部データ ソースからデータをインポートする場合、インポートされるデータの形式や種類を必ずしも制御できるとは限りません。そのようなデータを分析するには、先にそのデータをクリーンアップすることが必要な場合があります。Office Excel にはデータを必要な形式にするための各種機能が用意されています。単純な作業の場合には、単一の機能で必要な処理を行うことができます。たとえば、コメントや説明が含まれる列のスペル ミスの修正は、スペル チェック機能で簡単に処理でき、重複行の削除は、[重複部分の削除] ダイアログ ボックスで簡単に処理できます。
一方、インポートした値を別の値に変換するために、数式を使用して 1 つまたは複数の列を操作することが必要な場合もあります。たとえば、末尾のスペースを削除するには、まず新しい列を作成し、データをクリーンアップする数式を入力し、新しい列全体に数式をコピーして数式をそれぞれ新しい値に変換してから、元の列を削除します。
データをクリーンアップする基本的な手順は次のとおりです。
外部データ ソースからデータをインポートします。
別のブックに元のデータのバックアップ コピーを作成します。
データが行と列から成る表形式になっており、各列に同様のデータが含まれ、すべての列と行が表示可能になっていて、範囲内に空白行がないことを確認します。最善の結果を得るには Excel テーブルを使用します。
列の操作を必要としない作業を先に行います。たとえば、スペル チェックや [検索と置換] ダイアログ ボックスによる作業です。
次に、列の操作を必要とする作業を行います。一般的な列の操作の手順は次のとおりです。
クリーンアップが必要な元の列 (A) の隣に新しい列 (B) を挿入します。
新しい列 (B) の先頭に、データを変換する数式を入力します。
数式を新しい列 (B) 全体にコピーします。Excel テーブルでは、各値を使用する計算列が自動的に作成されます。
新しい列 (B) を選択してコピーし、値として新しい列 (B) に貼り付けます。
元の列 (A) を削除します。これで新しい列が B から A に変わります。
同じデータ ソースを定期的にクリーンアップする場合は、マクロ記録やコード記述によってその作業全体を自動化することを検討してください。サード パーティ ベンダから外部アドインも提供されています。詳細については、「サード パーティ プロバイダ」を参照してください。処理を独自に自動化する時間やリソースがない場合は、これらを利用することを検討してください。
データをクリーンアップする方法トップ 10 - Excel
