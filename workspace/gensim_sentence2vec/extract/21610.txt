XMAP3サーバをWindowsサービスとして設定して運用できます。WindowsサービスとしてのXMAP3サーバは,サーバのWindowsデスクトップ上,またはターミナルサービスクライアント上で操作できます。
注意
Windowsサービスとして動作するXMAP3サーバのユーザアカウントに,「システムアカウント」または「アカウント」を指定してください。インストール時には「システムアカウント」が設定されます。アカウントの設定は,XMAP3サーバが自動起動したAPに引き継がれます。
「システムアカウント」を指定した場合:
「デスクトップとの対話をサービスに許可」のチェックはオフにしてください。ただし,Windowsサービスで印刷サービスを起動するときは,［印刷中］ダイアログを表示するために,このチェックをオンにしてください。オフの場合,［印刷中］ダイアログは表示されません。また,スタンドアロン構成で,XPSプリンタに出力するときは,「デスクトップとの対話をサービスに許可」のチェックはオンにしてください。なお,オンにしても,［印刷中］ダイアログは表示されません。
「アカウント」を指定した場合:
ユーザ名を指定し,パスワードを入力します。
<この項の構成>
(1) Windowsサービスで外字を出力する場合の設定
WindowsサービスでXMAP3を実行すると,OSとサービスの実行アカウントおよびWindowsへのログイン状況によって外字の出力結果が異なります。
Windowsサービスで外字を出力するときの動作を変更する場合には,次の環境変数を設定して,XMAP3サーバを起動します。
環境変数名:XMAP3_ENABLEEUDC
環境変数に設定できる値は,「ON」または「OFF」です。それ以外の設定値や値を省略すると,「OFF」が仮定されて動作します。
Windowsサービスの実行アカウント,実行時のWindowsへのログインの状態および環境変数の設定値に対応する外字の出力動作を次の表に示します。「OFF」の場合,印刷実行時に割り当てられる外字環境は,Windowsのシステム依存となるため,動作が異なることがあります。明示的に外字を出力させるときは,環境変数に「ON」を設定して運用することをおすすめします。
表11-5 外字の出力動作(Windows XP,Windows Server 2003またはWindows Server 2003 R2の場合)
サービスアカウント
ログイン状態
環境変数 XMAP3_ENABLEEUDC
OFF
ON
Windowsのサービスとして運用する場合のOS設定
