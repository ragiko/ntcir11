
(Rで)塩基配列解析
～NGS、RNA-seq、ゲノム、トランスクリプトーム、正規化、発現変動、統計、モデル、バイオインフォマティクス～ 
(last modified 2014/12/25, since 2010)
はじめに 
このページは、次世代シーケンサー(Next-Generation Sequencer; NGS)などから得られた短い塩基配列(short read)データ解析をRで行うための一連の手続きをまとめているものであり、
特にアグリバイオインフォマティクス教育研究プログラムの被養成者がわかる程度のレベルで作成した(しつつある)ものです。
Maintainerは門田幸二(東京大学大学院農学生命科学研究科)が永らく一人でやっていましたが、
2013年7月のリニューアル以降は私の出身研究室(東京大学・大学院農学生命科学研究科・応用生命工学専攻・生物情報工学研究室: 清水謙多郎教授)大学院生の孫建強氏が
W3C validation、美しいコーディング、TCCパッケージ開発および有用関数のTCCへの追加など重要な役割を担っています。
また、私がこの仕事にこれだけの時間を費やせるのは、ボスである清水謙多郎教授の全面的なサポートのおかげです。
アグリバイオの分野は、ヒトやマウスといったゲノム配列既知のモデル生物ではなくアノテーション情報が乏しい非モデル生物を主に取り扱います。
例えば、主に次世代シーケンサー(NGS)から得られるRNA-seqデータを用いて、「de novo (genome or transcriptome) assemblyを行い、発現変動領域を同定する」
といった解析が第一段階として行われます。アセンブル周辺は未だにLinux上でのみ動作するプログラムを利用するしかありませんが、
2013年頃から本格的にWindows OS上でマッピングやカウントデータ取得が行えるようになり、(マイクロアレイ解析を行うためにRに慣れたWindowsユーザの)実験系研究者にとっての敷居が低くなってきました。
もともと私は「徹底的にR」派ではありませんでしたが、50-100人規模のハンズオン(PCを用いて生物系の学生が手を動かす)講義を講義として成立させうるのは経験上、
「Rでコピペ」を基本とする以外はあり得ません。Linux(やWindowsのコマンドプロンプト系)の場合、基本コマンドの部分で多くの学生がつまづきます。
「スペース」、「特殊文字」、「コマンドの打ち間違い」、「ファイルが存在しない」など、講義を中断せざるを得ない様々な局面に遭遇し、
学生の側も手を動かしてついていくだけで精一杯で「作業」に忙殺される傾向にあります。結果として、「本質的な全体像の理解」もままならずストレス、という愚痴や感想に至りがちです。
このページの記述形式(必要な部分のみ変更してコピペ)は、私が心穏やかにハンズオン講義を行うためのほぼ最終形です。しかし、私にとってのメリットだけでなく
「今手元にあるデータを心穏やかに最小限の労力で解析したい人」にとっても有意義なページであろうと思っています。
ここでは、アグリバイオインフォマティクス教育研究プログラム
の教育研究用資料として、また、一部新学術領域研究「複合適応形質進化の遺伝子基盤解明」
の研究を遂行する上で私が用いたテクニックや知識を項目別にまとめてあります。本当に正しいやり方かどうかなど一切の保証はできませんので予めご承知おきください。
このページの中身自体は、所属機関とは一切関係ない一個人の備忘録のようなものです。リンクは自由にしていただいて構いませんし、講義資料として使うのもご自由になさってください、
前もっての連絡なども一切必要ありません。個別の項目へのリンクはときどき切れると思いますがご容赦ください。必要に応じて随時変更していますので...。
間違いや修正点、また「このような解析をやりたいがどうすればいいか?」などのリクエストがあればメール()をいただければ...
(実際問題として相当様々なことにトラップされてますので対応は難しいですが...)前向きに検討させていただきます。
もちろん、アグリバイオインフォマティクス教育研究プログラム被養成者からのリクエストは優先的に対応します。
なお、よく(例えばDドライブの)外付けHDに大きなサイズのファイル(4GB以上)を保存できない、ということがあったりしますが、その対処法はおまじない的にコマンドプロンプト上で「convert D: /fs:ntfs」とやっておくことです。
このページ内で用いる色についての説明:
コメント
特にやらなくてもいいコマンド
プログラム実行時に目的に応じて変更すべき箇所
...
rm(list = ls())
「"...\Rgui.exe"  LANGUAGE=en」で英語環境にできる
2013年7月以降のリニューアルで、コードのコピーがやりずらくなっています。「CTRL」キーと「ALT」キーを押しながらコードの枠内で左クリックすると、全選択できます。
参考資料(講義、講習会、本など)
基本的に私門田の個人ページに記載してあるものです。
かなり古い講演資料などの情報をもとに勉強されている方もいらっしゃるようですので、
ここでは2013年秋以降の情報を載せておくとともに、大まかな内容についても述べておきます。講演予定のものについては、資料のアップは講演当日が基本です。
50-100MB程度ありますがオリジナルのPowerPointファイルがほしい方はお気軽にリクエストしてください。
講義資料としての利用などは事前連絡や私個人への謝辞も気にせずご自由にお使いください。
(Rで)塩基配列解析
