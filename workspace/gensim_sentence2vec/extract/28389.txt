今回は表の使い方です。
表を作る
表を作る時は、tabular環境 を使います。
まずは表の列数、仕切りの線と要素の位置を決めます。たとえば、 4列で,最初の1列が中央揃え、次の一列が左揃え、残りが右揃え、すべてに仕切り線をいれたい とします。その場合は、 tabular環境 を始めるときにオプションで以下のように設定しましょう。
\begin{tabular}[|c|l|r|r|]
行数を増やしたいときは、 \\ で改行すれば自動で増やしてくれます。このとき、各行の間に仕切り線を入れたいときには、 \hline という命令を使います。これは、一つにつき一本線を引いてくれるので、多重に線を引きたいときには何個か続けて命令を書いてください。
一行の中の各要素は &記号 で区切ります。
\begin{tabular}{|c|l|r|r|}
\hline
11 & 12 & 13 & 14 \\ \hline
21 & 22 & 23 & 24 \\ \hline
\end{tabular}
ふつうLaTeXで表を文書中に配置するときには、tabular環境 をさらにtable環境 の中に入れます. また、中央に表示したい場合はcenter環境 も併用します。表に対してキャプションを付けたいときには\begin{table} から\begin{tabular} の間に\caption{} という命令を挿入して指定して下さい。
\begin{table}
\begin{center}
\caption{test table} %これがキャプション
\begin{tabular}{c|c|c|c}
\hline \hline
11 & 12 & 13 & 14 \\ \hline
21 & 22 & 23 & 24 \\ \hline
31 & 32 & 33 & 34 \\ \hline
41 & 42 & 43 & 44 \\ \hline
\end{tabular}
\end{center}
\end{table}
今回はキャプションが ” Table 1: “ から始まっていますが、これはドキュメントクラスで指定されている形式、もしくはプリアンブル部で再定義した形式に従います。
table環境 では、数式の時と同じように 相互参照 が利用出来ます。 ただし、注意しなければならないのが表では数式と違い、ラベルが付くのはキャプションに対して である点です。なので、\caption{} よりも先に \label{} を付けてしまうと、正しい番号が取得できなくなってしまいます。
\begin{table}
\begin{center}
\caption{test table}
\label{test-table} %必ずcaptionの後に書くこと!
\begin{tabular}{c|c|c|c}
\hline \hline
11 & 12 & 13 & 14 \\ \hline
21 & 22 & 23 & 24 \\ \hline
31 & 32 & 33 & 34 \\ \hline
41 & 42 & 43 & 44 \\ \hline
\end{tabular}
\end{center}
\end{table}
文書中の表の配置
表を配置する位置を決めるには、table環境でオプションを指定します。オプションは以下の4種類を使えます。
h  ソースコードに入力した位置(here)に表示
t   ページの一番上(top)に表示
b   ページの一番下(bottom)に表示
p   図表だけのページ(page)を新たに作成して表示
たとえば、以下のようにします。
\begin{table}[htbp]
このようにすると、LaTeXはまず hオプション で表示しようとし、それが不可能だった場合は tオプション で表示しようとし、という動作をします。
LaTeXでは、図表の配置に関して様々な制限があり、なかなか思い通りに配置できないこともありますが工夫してみてください。
面倒なので専用ソフトを使おう.
ここまで見てきて分かると思いますが、LaTeXで表を作るのはとても面倒です。簡単な表ならまだしも、大量のデータを表にしたい時は大変です。
そこで、Excel風の操作感で簡単に tabular環境 のソースコードを生成してくれるソフトを無料で公開して下さっている方がいるので、利用させてもらいましょう。
Visual Tabular
http://homepage2.nifty.com/~sugi/#release
使い方は非常に簡単なので、Readmeを見てください。
また、既にExcelにデータがある場合はExcel2Latexも有用です。
Excel2LaTeX Vector
http://www.vector.co.jp/soft/win95/writing/se091052.html
表が横にはみ出る
LaTeXでレポートを作成していると、表が文書領域をはみ出してしまうことが多々あります。
そのような時には、\scalebox を用いて表を縮小しましょう。 これにはgraphixパッケージが必要です。たとえば以下の用にします。
\scalebox{0.6}[0.8]{
\begin{tabular}{|c|c|c|c|}
\hline
11 & 12 & 13 & 14 \\ \hline
21 & 22 & 23 & 15 \\ \hline
\end{tabular}
}
上の例では、{0.6}が横方向の倍率で、[0.8]が縦方向の倍率です。縦方向の倍率は省略することもできます。これで横方向が収まるように調整しましょう。
大学学部生のためのLaTeXによるレポート作成入門 その7 表の挿入 | inashiro's blog
