DAOは、プログラムコードを使用してJetデータベースエンジンに直接接続して、テーブルやクエリなどのオブジェクトを作成、更新、削除するためのオブジェクトモデルとなります。
主にDAOでは以下のような操作が可能です。
テーブル、クエリへ直接アクセスでき、追加や削除が自由にできる。
テーブルやクエリのフィールドにもアクセスができる。
データベースを新規に作成できる。
その他
DAOモデルの階層構造
DAOは、複雑な階層構造になっています。基本的なオブジェクトとコレクションを紹介します。下の図は代表的なオブジェクトとコレクション類となります。これ以外にもたくさんのコレクションとオブジェクトが存在します。
DBEngineオブジェクト
最上層にあるオブジェクトで、Jetエンジンを表して、これを直接操作することになります。
Workspacesコレクション
DBEngineオブジェクトにあるアクティブで表現可能なWorkspaceオブジェクトが含まれます。
Workspaceオブジェクト
開いているデータベースに領域を提供します。
Databasesコレクション
Workspaceオブジェクトで開かれた、または作成されたすべての開いているDatabaseオブジェクトが含まれる。
Databaseオブジェクト
DAOで開かれ、または作成されたデータベースを表します。テーブルやクエリを定義したり、Recordsetオブジェクトを開く時に使用します。
TableDefオブジェクト
指定されたデータベースのテーブルや保存されたテーブルの定義を表します。
QueryDefオブジェクト
指定されたデータベースのクエリや作成されたクエリの定義を表します。
※ 各名称にコレクションとオブジェクトが付加されていますが、コレクションはオブジェクトを含むだけの働きだけで、メソッド、プロパティ、コレクションで構成された実体はオブジェクトが担当します。
オブジェクト変数
VBAのプログラミングとしてDAOを使用する場合、プログラム内で使う変数はオブジェクト型を定義し、これをプロパティやメソッドの対象にしてデータベースを操作します。この変数を「オブジェクト変数」と言います。
宣言方法
オブジェクト変数の宣言は、一般の変数と同じように、Dim、Static、Private、Publicステートメントのいずれかを接頭語として使用します。
※ 一般的にDimステートメントで事足ります。
株式会社K-fix｜VBA for Access
