
Oracleのソート機能の概要
ソート順序は言語によって異なります。さらに、同じアルファベットを使用している文化または国の間でも、文字のソート方法が異なる場合があります。たとえば、デンマーク語のÆは、Zの後にきます。また、YとÜは同じ文字の変形とみなされます。
ソート順序には、大/小文字区別の有無を指定できます。ケースは、大文字であるか小文字であるかの条件を指します。 たとえばラテン・アルファベットのAは、小文字の絵文字aの大文字です。
ソート順序では、発音区別記号を無視するか考慮するかを指定できます。発音区別記号は、文字または文字列の上または下にある記号で、それが付いていない場合の文字とは発音が異なることを示します。たとえば、façadeの場合、セディラ(,)は発音区別記号です。 セディラが付いている場合は、cの発音が変化します。
表音的なソート順序や、文字の外観に基づいたソート順序も指定できます。たとえば、東南アジアの表意文字の場合は、画数に基づいたソート順序を指定できます。ソート上の一般的な問題となるものに、結合文字があります。たとえば、伝統的なスペイン語のchは1つの独立した文字であり、ソート順序ではcの後にきます。つまり、正しいソート順序は、cerveza、colorado、cheremoyaのようになります。したがって、文字cは、次にくる文字がhであるかどうかが確認されるまで、ソートされません。
Oracleには、次のタイプのソートが用意されています。
バイナリ・ソート
単一言語ソート
多言語ソート
これらのソートにより、単一言語に応じた正確なソート順序に加えて、多言語ISO規格(ISO 14651)に準拠したソートが実現できます。この規格は、複数言語を同時に処理するように設計されています。
バイナリ・ソートの使用
文字データをソートする方法の1つは、文字コード体系によって定義された文字の数値に基づいています。このようなソートをバイナリ・ソートと呼びます。バイナリ・ソートは最も高速なソート・タイプです。ASCIIやEBCDICの規格では、文字A〜Zを昇順の数値で定義しているため、英語のアルファベットについてはこのタイプで正しいソート結果が得られます。
他の言語で使用されている文字が存在すると、通常、バイナリ・ソートでは正しい結果が得られません。たとえば、文字コード体系で、Äの数値がBの数値より高い場合、昇順のORDER BY問合せでは、ABC、ABZ、BCD、ÄBCの順で文字列が戻ります。表意文字を使用するアジア言語の場合、通常、バイナリ・ソートに言語的な意味はありません。
言語ソートの使用
文字のアルファベット順に一致するソート基準を得るには、文字コード体系内の数値に依存せずに文字をソートする別のソート方法を使用する必要があります。この方法を言語ソートと呼びます。言語ソートでは、各文字を、言語的に適切な文字順序を反映した数値に置換することによって、ソート操作を行います。
Oracleでは、単一言語ソートと多言語ソートの2種類の言語ソートを提供しています。
この項の内容は、次のとおりです。
単一言語ソート
多言語ソート
多言語ソート・レベル
言語ソートの例
単一言語ソート
単一言語ソートの場合、文字列は2つの手順で比較されます。最初の手順では、メジャー値テーブルにある文字列全体のメジャー値が比較されます。通常、同じ外観の文字には、同じメジャー値があります。第2の手順では、マイナー値テーブルにあるマイナー値が比較されます。メジャー値とマイナー値はOracleによって定義されます。Oracleでは、マイナー値が異なる同じメジャー値を使用して、発音区別記号を持つ文字と大/小文字区別を定義します。
各メジャー・テーブル・エントリには、1文字のUnicodeコード・ポイントとメジャー値が含まれています。Unicodeコード・ポイントは、1文字を表す16ビットのバイナリ値です。
表5-1に、a、A、ä、Äおよびbのソートに使用するサンプルの値を示します。
言語ソートと文字列検索
