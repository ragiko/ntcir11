約半年に渡って解説してきた「Oracle9i物理設計」もとうとう最終回になりました。物理設計のうち皆さんが興味を持ちそうなところを中心に解説してきたつもりでしたがいかがでしたでしょうか?今後もiSeminarやOTNを通じてOracleDirect のメンバーで技術情報を発信してまいりますのでご期待ください。
第1章 断片化解決の概要
はじめに
第5部の解説を受けて、本項では断片化の解決方法について解説いたします。断片化の解消の作業は出来る限り発生しない方がDBAの方々にとっても幸せだと思いますので、該当の断片化が発生しにくくなる事前の対策についても出来る限り解説します。
断片化解決の概要
断片化の解決方法は、断片化現象によりある程度は異なりますが、共通の手法で解決できるものもあります。まずは断片化現象ごとの解決方法を一覧にまとめてみました。次章以降で個別に解説したいと思います。
表1:Oracleの物理構造と断片化、解決方法
階層
断片化現象
解決方法(再編成方法)
解説章
データファイル(表領域)
ファイルレベルの断片化
OSコマンドによるデフラグ
第2章
データファイルレベルの未使用領域の発生
表領域レベルの再編成
第2章
データファイルの縮小
第2章
セグメント
位置の高いハイウォーターマーク
セグメントレベルの再編成
第3章
セグメントレベルの未使用領域の発生
エクステントの切り捨て
第3章
セグメントレベルの再編成
第3章
階層の深いインデックス
セグメントレベルの再編成
第3章
エクステント
不連続のエクステント
セグメントレベルの再編成
第3章
表領域レベルの再編成
第2章
ブロック
行移行
セグメントレベルの再編成
第3章
行移行しているレコードのみの再編成
第4章
行連鎖
ブロックサイズ変更して再編成
第4章
ブロック内の未使用領域の発生
セグメントレベルの再編成
第3章
第2章 データファイル(表領域)レベルの断片化対策
OSコマンドによるデフラグ
UNIXやLinuxなどではファイルの断片化はあまり気にする必要はないと言われていますし、Windows系OSでもひどくないレベルの断片化はパフォーマンスへの影響はほとんどありません。ただ、システム構築後一度もデフラグを実施したことがないのであれば最低限断片化具合の調査くらいはした方がいいかもしれません。Windows系OS上でOracleを構築する場合はデフラグツールでファイルレベルの断片化を解消します。例えばWindows2000系のOSの場合だと、「スタートボタン」「プログラム」「アクセサリ」「システムツール」「ディスクデフラグ」で起動できます。なお、デフラグツール等で最適化を実施する場合はインスタンスは停止してください。
表領域レベルの再編成
Oracle9iからある表領域に格納されているテーブルをまるごとExport/Importすることができるようになりました。この機能を使えば、ある表領域全体をまとめて再編成することが可能です。以下表領域レベルの再編成の手順になります。
(1)Exportを実施
OTN Japan - Oracle9i 物理設計:第6部 断片化の解決
