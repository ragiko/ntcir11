今日の小話はリクエストがあったので、それについて。
「マルコフモデル」って何? 
- 目次 - 
前置き
前置きその2
「マルコフモデル」説明
マルコフモデルについてさらに説明
何の役に立つのか、前置き
何の役に立つのか(応用)
前置き 
「マルコフモデル」
今日の話は難しいかもしれません。
この言葉を知っている女の子を私は見かけたら
ときめく。と思います。.. 
高いテクノロジーと豊かな文化を創造し、日本再生を担い、
常に新しいことにチャレンジし続けおもしろラボの建設し、
世界で活躍できるチームを目指し、次の世代への実際的な
啓蒙をし、日本再生を目指すチームラボの社員は知るべし!
だと思います。
前置きその2
次のマークから山手線の駅28個を例に説明します。
直接中身を知りたい人は下30行くらいを読み飛ばしてOK.
たぶん日常生活をする上でマルコフモデルをわざわざ
考える必要はあんまり無いかも。
でもなぜか私はいろんな人に説明をしてきたことが
あるのであります。今まで五回くらい。
今日の話は丁寧に書くと長くなりそうなので、
かなりかいつまんで書いています。
斜め読みされると、誤解されそう。
話せば理解してもらえる自信はあるのですが。
理解してしまうとそんなに難しくは無いと思います。
「マルコフモデル」説明
前置きが長くなりました。
マルコフは19世紀後半の数学者で、確率論で
よく名前の出てくるロシア人の3人のうちの1人です。
マルコフモデルは自然言語処理/音声処理/ゲノム解析に
出現する専門用語です。
マルコフモデルの説明はここから。
JR山手線には駅が28個あります。
あなたは、30分ごとにどこかの駅のホームに立っているとします。
(山手線は30分も電車に乗ればどの駅にでも行くことができます。) 
そして、どの駅からでも、全ての28個の駅に30分後に行く確率が
決まっているとします。
ただし、それらの確率(全部で28*28=576個)は決まっています。
駅のホームに立っている30分おきのそれぞれの時刻について、
それらの確率はいつも変わりません。
また、一つ手前の状態つまり、30分前にどの駅にいたかが分かり
さえすれば、それより前の状態つまり60分以上前にどの駅にいたか
とは *無関係* に、その時の駅にいる確率が定まる、とします。
以上が、たぶんもっとも基本的な形の「マルコフモデル」の例の説明。
マルコフモデルのポイントは、ある時の状態は、ある過去の状態が
分かりさえすれば、それよりも前の状態の履歴とは無関係に、
そのある過去の状態に基づいて確率的に定まることです。
マルコフモデルについてさらに解説
マルコフモデルは、上記のような28個の駅の例に限らず、他の有限な数の
別の状態で考えることもあれば、無限個の状態について考えること
もあるし、時刻も30分おきのように、飛び飛びのこともあれば、
連続的に考えることもあります。
次のようなものはマルコフモデルではありません。
- 確率が時刻によって変わる。
- ある時刻の状態が、それより過去の時間での状態から確率的に
決まるにしても、さらにその前の状態によってその確率が
変わる場合。
ところが、マルコフモデルの概念を使って何かを研究する
場合には、厳密にマルコフモデルではなくても、マルコフモデルと
見なして考えることが多いです。
上記の山手線の例だと、終電の時刻を過ぎると電車は止まるので、
移動ができなくなり、不変と仮定していた572個の確率が変わって
しまいます。また、同じ駅に降り立つことを好きになるか飽きたり
するような、ありがちなことが起きると、「その時の状態は確率的に
直前の状態のみによるのであって、それよりさらに過去の履歴に
よらない」というマルコフモデルの大事な条件に反してしまいます。
それでも株価の動きや遺伝子の塩基配列の変動については、
マルコフモデルとみなしていろんなことを考えることが多いです。
なぜそうするかというと、マルコフモデルとして数学的に抽象化
して得られたいろいろな研究成果が適用できて、何らかの合理的
な判断に使うときに有効だからです。
何の役に立つのか、前置き
以上が「マルコフモデル」の定義の説明でした。
ここまで読んだ人は以下のような疑問を持つかと思います。
- 何の役に立つんだ?
- 何のためにわざわざ定義したんだ?
そういう疑問は私は今日も調べてみました。
でもよく分かりません。マルコフモデルそれ自体が
何かを描写しても、何かに直接役に立つ例を見たこと
がありません。
でも「マルコフモデル」という言葉は
いろんなところでたくさん出現するのです。
- 岩波理化学事典の本文に19箇所くらい
- 数理科学事典に 10箇所くらい
- 東京大学出版会の基礎統計学の本に4箇所くらい
私が思うに、上記の山手線の例のような説明を数学的に
きちんと書くと結構長くなるので、マルコフの研究に
敬意を表しながら、短く「マルコフモデル」と言っている
んだと思います。
何の役に立つのか(応用)
ここからは説明は短め。後は、SAGOOLとかして欲しいです。
マルコフモデルが使われるのは次のような対象で、
理論的な研究対象となるものに使われます。
- 自然言語解析
- 音声解析
- ゲノム
- 金融(株の動きなど)
マルコフモデルに関連して、「隠れマルコフモデル」
もよく使われます。
人の動きをビデオカメラで捉えたとします。
その人の気持ちを考えたいとしましょう。
とりあえず「興奮している」か「興奮していない」か
どっちか判別したいとします。興奮していれば、
その人の動きは激しくなります。興奮していなければ
動きは緩やかです。ビデオで捉えた動きをどちらかの
マルコフモデルとして考え、興奮しているのかそうで
ないのか判定する問題が、「隠れマルコフモデルから
パラメータを推定する問題」です。
計算機で実際に計算するときの技術的課題が研究対象と
なっています。たとえばどの程度計算に手間がかかるか
研究されたりしています。インターネットで、何かの
サーバーへのアクセスの仕方から不審な動きを取り出す
研究もされています。
この隠れマルコフモデルの技術が発達すれば、
人の顔をビデオ撮影して、何をしゃべっているのか
言葉を再現したり、気持ちを推定したり、その時の
気温や湿度を推定したり(?)、発情しているとか、
ストレスがどれくらいたまっているとか、ある程度の
精度で推定できます。そういうことがSF的なことを
実現して見たいものです。
今日の話は以上。
Team-lablog » 「マルコフモデル」
