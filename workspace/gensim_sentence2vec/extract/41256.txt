無線 LAN はデジタルデータを電波に乗せて伝達するシステムです。しかし、「0」と「1」のデータがどうやって電波になって飛んでゆくのでしょうか。今回はこの原理をできるだけ簡単にご紹介しようと思います。
ASK(OOK)さて、「電波で 0, 1 を飛ばす」にはどうすれば良いでしょう。誰でも考え付く一番簡単な方式は、ビット「1」の時に電波を出し、ビット「0」の時に電波を出さなければ良いということです。実はこの方式には立派に名前が付いていて、振幅変調(ASK:Amplitude Shift Keying)と呼ばれています。ASK の中でも特に「信号を出す・出さない」で制御するものを OOK(On Off Keying) と呼びます。ASK/OOK はシンプルな反面、幾つもの問題があります。例えば同じビットが続いたとき、たとえば「0」ばかりの情報が連続した場合、ずっと「電波が出ていない」時間が続きますが、受信側ではこれが「連続したゼロの情報」なのか、それとも「電波が途絶えた」のか「装置が壊れた」のかわかりません。また逆に、連続した「1」を受信しているとき一瞬の妨害で電波が途切れても、それを「妨害」ではなく「0」の情報として認識してしまいます。というわけで、単純な OOK にはあまり実用性がありません。そこで「信号の有り・無し」をそのまま情報にするのではなく、「信号の種類」を情報に割り当てることで伝達性を上げることが行われます。最も有名な例はモールス符号で、これは「信号が ON である長さ」をトン(短音)とツー(長音)の2種類に分け、この組み合わせによって情報を伝送します。これはパルス幅変調(PWM:Pulse Width Modulation)とも呼ばれ、モールス符合が死語になりつつある今でも TV の赤外線リモコンなどに多用されています。モールス符号(PWM)の欠点は伝送効率の悪さです。まずビット(シンボル)の区切りとして必ず一定の無信号区間を挿入する必要がありますし、また長音側のシンボルが続けばそのぶん伝達に時間がかかってしまいます。モールス符号では後者の欠点を、英文に多用されるアルファベットに短音を多く割り当てるという一種のハフマン圧縮によって緩和していました。しかし、これは日常会話で使われる文章をそのまま伝達する平文伝送には効果を発揮しますが、圧縮された情報や暗号文の伝送ではアルファベットの分布が均一化する(※註)ため、効果がありません。(※註)情報工学ではこれを「エントロピーが増大する」と呼びます。FSK以上のように、OOK は単純ですが信頼性や効率に欠ける欠点があります。では次にどうするかと言うと、「0」「1」を「信号の有無」や「信号の長さ」ではなく「違う種類の電波」に割り当てます。例えば「0」のときは 1MHz、「1」のときは 2MHz というように。こうすれば「信号がある」「信号が無い」状態と「信号の 0 ないし 1」を別々に捉えることができますし、PWM のようにシンボルの間に区切りを入れる必要もありません。これにも立派な名前が付いていて、周波数変調 FSK (Frequency Shift Keying) と呼ばれます。Bluetooth BDR で使われている GFSK(Gaussian FSK)は周波数切り替え時の遷移を工夫して不要輻射を抑えた方式ですが、基本原理は FSK と変わりません。FSK は電波の世界よりむしろ、有線通信の世界で広く使われていました。300bps の音響カプラ(モデムの前身)が「ピーギョロギョロギョロギョロ」という音を立てていたのは「ピー(2400Hz)」音と「ポー音(1200Hz)」がビットの 0/1 に対応した FSK 変調だったからです。これを AM 変調して短波に乗せればテレタイプになりましたし(tty の語源です)、8bit 時代のパソコンはこれをそのままオーディオテープに録音してデータを保存していました。しかし、こんな話題はもう昔話ですね。PSKさて、FSK 変調の欠点は(PWM よりマシだとはいえ)伝送効率が悪いことです。先ほどの音響カプラを例にとると、低い方の 1200Hz が通信速度の上限を決めてしまっています。1ビット(1シンボル)に1サイクルの波を割り当てると、2400Hz であれば2サイクルが乗る時間に 1200Hz の信号は1サイクルしか乗りません。伝送路の周波数帯域が 2400Hz 確保されているのに、そこにわざわざ周波数の低い信号を流すのは勿体ないことなのです。また FSK を無線通信に利用する場合には、2つの周波数域を占有するため周波数利用効率が悪くなります(限られた周波数帯域の中に収められる局の数が減ることになります)。2つの周波数を接近させれば効率は上がりますが、周波数シフトによる「0」「1」の取り違えが起こる確率も上がって信頼性が下がります。こういった欠点を解決すべく開発されたのが位相変調、PSK(Phase Shift Keying) です。PSK では同じ周波数の搬送波を、伝送信号の「0」「1」に応じて位相をずらします。例えば 180 度の位相変調のばあい、「0」「1」に応じて波形の山と谷が入れ換わります。この場合は2つの位相を使うということで、BPSK(Binary Phase Shift Keying)と呼ばれます。ASK や FSK は直感的に理解しやすいのですが、PSK は直観では理解しにくいですね。n-PSKPSK が更に判りにくくなるのは、この先に4つの位相を使う QPSK(Quarter Phase Shift Keying)なんてものが出てくるからです。これは位相変調角が 90 度単位なので、伝送波形は4つの位相を取り得ます。つまり1単位の波はもはや「0」「1」という2状態に対応するのではなく、「00」「01」「10」「11」という4つの状態に対応します。ということは1波形あたり 2bit のデータを送れるので、伝送効率が一気に2倍に向上するのです。この場合「変調パターン」と「変調パターンの示すビット数」が必ずしも1:1に対応しなくなるため、変調パターンを「シンボル」と呼び、「1シンボルあたり2ビット」というように表現します。PSK 変調の様子は位相図で描かれることが多いです。一位相を 360 度...ラジアンの2πで表現すると、シンボルあたりの位相は BPSK で 0 とπの2点を、QPSK では 0, 1/2π, π、 3/2 πの4点を指していると解釈できます。このような位相図をコンスタレーション(Constellation)と呼びます。コンスタレーションとは「星座」のことです。無線通信や情報工学にはとかく難しい数式やら紛らわしい略語ばかり出てきますが、コンスタレーションとはちょっとだけロマンチックな名前ですね。QAMPSK で位相変化の幅を小さくしてゆけば 8-PSK(3bit/シンボル) や 16-PSK(4bit/シンボル) のように、1シンボルあたりのビット数を増やしてゆくことも可能です。しかし、コンスタレーション・ポイントが接近しすぎると正確な分離が難しくなって信頼性が下がる割に、情報量は大して上がらない(位相角を半分にするたび 1bit/シンボルしか増えない)ため、8-PSK が実用上限とされています。そこで、よりシンボルあたりの情報密度を詰め込むために開発されたのが直角位相振幅変調、QAM(Quadrature Amplitude Modulation) です。QAM は QPSK 変調に「振幅」という概念を取り入れることで、1シンボルあたりの情報量を増やしたものです。まず例として、QPSK 変調に「波形の大小」というもう一つの変化(+1bit ぶんの情報)を含めた変調方式(4-APSK:Amplitude 4-Phase Shift Keying)を考えてみましょう。これによって8ポイントのコンスタレーションが生成され、すなわち1シンボルあたり 3bit の情報を伝送することが可能になります。実際に使われている QAM は同心円状ではなく、コンスタレーションが格子状になる矩形 QAM(Rectangular QAM) で、4x4 ポイントの 16QAM (4bit/シンボル)か 8x8 ポイントの 64QAM (6bit/シンボル)が主用されています。特に高速を必要とする用途では 16x16 ポイントの 256QAM (8bit/シンボル) も使用されますが(※註)、256QAM はコンステレーションが非常に高密度になるのでノイズや波形の歪みに弱く、伝送品質が確保できなければ性能が出せないため、無線通信への用途は限定されています。(※註):12x12=144 ポイントのコンスタレーションのうち 128 ポイントを使って情報伝達する 144QAM (7bit/シンボル) があっても良さそうなものなのですが、私の知る限り 2^n 以外の QAM は実用化されていません。QAM のコンスタレーション図...例えば 64QAM を見ると、あたかも 64 個の 0/1 情報が並行して送られるように勘違いしてしまいがちですが、誤解しないよう注意してください。コンスタレーション図は「ある時間における電波の状態が 64 点のうちどこか1点を指す」ことを示しており、これによって log2(64)=6 ビットの情報を一気に送ることができる、ということを意味しています。QAM とフーリエ変換QAM の送信側回路はフーリエ変換という数学的操作を必要とします。送信側は 01 の羅列からコンスタレーションを作成し、それを逆フーリエ変換してサイン波(実相成分, Real)とコサイン波(虚相成分, Imaginary)の係数を算出する必要があります。受信側は受信波形をサイン波とコサイン波に分離し、その係数(振幅)からコンスタレーションを算出する必要があります。フーリエ変換のように高度な数学的操作をアナログ回路で実現するのは至難の技で、QAM の原理は知られていても長らく使われていませんでした。しかし数値演算プロセッサ(DSP:Digital Signal Processor)が実現し、高速・高集積の半導体上で高速フーリエ変換ができるようになってから QAM 変調は一気に普及したという経緯があります。まとめ以上、ASK から QAM まで変調方式を駆け足に解説してみました。情報を電波で伝達するには「電波を何らかの形で(振幅、周波数、周波数)変形する=変調」こと、「変調の単位はシンボルと呼ばれる」「1シンボル=1ビットとは限らない:シンボルあたりのビット数を増やせば情報効率は向上する」ことを理解して頂ければと思います。次回は高速デジタル無線通信のデファクトスタンダードであり、直観的理解の難しい OFDM(直交周波数分割多重変調)について解説します。
変調のはなし(1)｜Wireless・のおと｜サイレックス・テクノロジー株式会社
