二つのクラスタシステム環境のうち,片方を業務が実行できアクティブ状態になっている実行システム,もう片方をフェールオーバー時に実行システムに切り替わるまでスタンバイ状態になっている待機システムとします。このアクティブ・スタンバイ構成の場合,この環境下でJP1/Scriptを使用することはできますが,フェールオーバー時に実行中のスクリプトを継続して実行することはできません。
しかし,フェールオーバー時に実行環境を引き継ぐことができます。そのためには次のような環境設定を行います。
操作
JP1/Scriptをインストールする。
JP1/Scriptをインストールします。インストール先のフォルダはローカルドライブ上のフォルダにしてください。
JP1/Scriptサービスのスタートアップの種類を「手動」に変更する。
［スタート］−［設定］−［コントロールパネル］−［サービス］※ダイアログでJP1/Scriptサービスのスタートアップの種類を「自動」から「手動」に変更します。
注※
Windows 2000では,［コントロールパネル］−［管理ツール］−［サービス］。
Scriptランチャを終了し,スタートアップから削除する。
Scriptランチャが起動している場合は終了させてください。Scriptランチャを終了させる方法は,JP1/Scriptのインストール先フォルダにある"SPTHSTP.exe"にコマンドライン"/INST"を付けて起動してください。終了後,スタートアップに登録されているScriptランチャを削除します。
使用する共有ディスクを決定する。
操作7.でJP1/Scriptの管理ファイルの出力先に指定する共有ディスクを決めます。
クラスタアドミニストレータを起動する。
［スタート］−［プログラム］−［管理ツール］−［クラスタアドミニストレータ］ウィンドウを起動します。
リソースを作成する。
［クラスタアドミニストレータ］ウィンドウで次に示す四つのリソースを作成します。
(1)操作4.で決定した共有ディスク リソース
・リソースの種類:物理ディスク
・リソース名:任意
(2)論理IPアドレス リソース
・リソースの種類:IPアドレス
・リソース名:任意
・リソースの依存関係:(1)のリソース
(3)Scriptランチャ リソース
・リソースの種類:汎用アプリケーション
・リソース名:任意
・コマンドライン:JP1/Scriptのインストール先フォルダの"SPTHLNCH.exe"
・「デスクトップとの対話をアプリケーションに許可する」をチェック
(4)JP1/Scriptサービス リソース
・リソースの種類:汎用サービス
・リソース名:任意
・リソースの依存関係:(1),(2),(3)のリソース
・サービス名:JP1_Script
JP1/Scriptの管理ファイルの出力先を共有ディスク上のフォルダに変更する。
マネージャウィンドウの［ツール］−［オプション(クラスタ環境)］ダイアログで管理ファイルの出力先を操作4.で決定した共有ディスク上のフォルダに変更します。
システムを再起動する。
操作7.で設定した内容を有効にするため,システムを再起動します。
操作4.から操作6.は二つのクラスタシステム環境のうちどちらかで設定します。それ以外の操作は二つのシステムでそれぞれ設定します。
処理詳細
二つのクラスタシステム環境ともアクティブ状態の実行システムになっているアクティブ・アクティブ構成の場合は,JP1/Scriptを使用することはできますが,フェールオーバー時に実行中のスクリプトを継続して実行することはできません。また,フェールオーバー時に実行環境を引き継ぐこともできませんので,上記の環境設定は行わないでください。
クラスタシステム環境での環境設定
