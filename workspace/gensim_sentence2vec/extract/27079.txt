
ヘッダーをスキップ
Oracle Database 管理者ガイド10gリリース2(10.2)B19224-02
目次
索引
23  メンテナンス・ウィンドウを使用した自動システム・タスクの管理
Oracle Databaseは、一部の日常的なデータベース・メンテナンス・タスクを実行するように事前構成されているため、システムの負荷が軽いと予測される時間帯にメンテナンス・タスクを実行できます。この時間帯には、メンテナンス・タスクに関わるリソース使用を制御するためのリソース・プランを指定できます。
この章の内容は、次のとおりです。
メンテナンス・ウィンドウ
事前定義済の自動システム・タスク
自動システム・タスクのリソース管理
メンテナンス・ウィンドウ
Oracle Schedulerを使用すると、ジョブが自動的に実行される時間ウィンドウを作成できます。一般的なスケジューラ・ウィンドウでは、開始時間および継続時間が定義され、オプションでアクティブ化するリソース・プランが定義されます。スケジューラ・ジョブは、ウィンドウをそのジョブのスケジュールとして指定できます(このウィンドウをオープンすると、ジョブの実行が開始します)。また、複数のウィンドウをウィンドウ・グループに結合できます。ジョブが、1つのウィンドウを指定するかわりに、ウィンドウ・グループをそのジョブのスケジュールとして指定した場合は、指定したウィンドウ・グループ内のウィンドウをオープンするとジョブが実行されます。
次の2つのスケジューラ・ウィンドウが、Oracle Databaseのインストール時に事前定義されています。
WEEKNIGHT_WINDOWは、毎週月曜日から金曜日の午後10時に開始し、午前6時に終了します。
WEEKEND_WINDOWは、土曜日と日曜日の終日を対象とします。
これらのウィンドウの組合せによって、MAINTENANCE_WINDOW_GROUPが構成され、すべてのシステム・メンテナンス・タスクがスケジュールされます。Oracle Databaseでは、自動統計収集、領域管理および他の内部システム・メンテナンス・ジョブに、このメンテナンス・ウィンドウを使用します。
事前定義されたメンテナンス・ウィンドウを、使用するデータベース環境に適した時間に調整するには、DBMS_SCHEDULER.SET_ATTRIBUTEプロシージャを使用します。たとえば、次のスクリプトは、WEEKNIGHT_WINDOWの実行時間を、毎週平日の午前0時から午前8時までに移動します。
EXECUTE DBMS_SCHEDULER.SET_ATTRIBUTE(
'WEEKNIGHT_WINDOW', 
'repeat_interval',
'freq=daily;byday=MON, TUE, WED, THU, FRI;byhour=0;byminute=0;bysecond=0');
ウィンドウの継続時間はすでに8時間に設定されているため、スクリプトによって変更する必要はありません。
また、ウィンドウの他のプロパティを調整するには、SET_ATTRIBUTEプロシージャを使用します。たとえば、次のスクリプトは、WEEKNIGHT_WINDOWにリソース・プランDEFAULT_MAINTENANCE_PLANを設定します。
EXECUTE DBMS_SCHEDULER.SET_ATTRIBUTE (
'WEEKNIGHT_WINDOW',
'resource_plan',
'DEFAULT_MAINTENANCE_PLAN');
この場合、すでに異なるリソース・プランを使用可能にしていると、Oracle Databaseでは、WEEKNIGHT_WINDOWのオープン時にDEFAULT_MAINTENANCE_PLANをアクティブ化し、WEEKNIGHT_WINDOWのクローズ時に元のリソース・プランを再アクティブ化します。
関連項目
スケジューラの詳細は第27章「スケジューラの使用」を、DBMS_SCHEDULERパッケージの詳細は『Oracle Database PL/SQLパッケージ・プロシージャおよびタイプ・リファレンス』を参照してください。
リソース・プランの作成と変更の詳細は、第24章「データベース・リソース・マネージャの使用」を参照してください。
事前定義済の自動システム・タスク
次のジョブは、メンテナンス・ウィンドウで実行されるように事前定義されている自動システム・タスクの一部です。
自動統計収集ジョブ
自動セグメント・アドバイザ・ジョブ
自動統計収集ジョブ
スケジューラ・ジョブGATHER_STATS_JOBは、Oracle Databaseのインストール時に事前定義されます。 GATHER_STATS_JOBは、データベース内で、統計がないかまたは失効した統計のみがあるすべてのオブジェクトのオプティマイザ統計を収集します。
統計収集を手動で管理するほうがよい場合は、次のように、このスケジューラ・ジョブを使用禁止にします。
EXECUTE DBMS_SCHEDULER.DISABLE('GATHER_STATS_JOB');
関連項目
自動統計収集の詳細は、『Oracle Databaseパフォーマンス・チューニング・ガイド』を参照してください。 
自動セグメント・アドバイザ・ジョブ
スケジューラ・ジョブAUTO_SPACE_ADVISOR_JOBもまた、インストール時に事前定義されます。 AUTO_SPACE_ADVISOR_JOBは自動セグメント・アドバイザを実行します。自動セグメント・アドバイザは、再生可能な領域があるセグメントを特定し、Enterprise ManagerまたはPL/SQLパッケージ・プロシージャのセットで表示可能な推奨を提示します。
セグメント・アドバイザを手動で実行して、最新の推奨を取得したり、自動セグメント・アドバイザが再生可能な領域の対象として検証しなかったセグメントに関する推奨を取得できます。
関連項目
詳細は、「セグメント・アドバイザの使用」を参照してください。 
自動システム・タスクのリソース管理
自動システム・タスクが他のデータベース・アプリケーションのパフォーマンスに著しい影響を与えないように、自動システム・タスクに割り当てられるCPUリソースを制御する場合は、リソース・プランを作成し、プランをメンテナンス・ウィンドウに割り当てることができます。 (これらのウィンドウには、初期状態ではリソース・プランが割り当てられていません。) このリソース・プランには、自動システム・タスクが実行されるリソース・マネージャのコンシューマ・グループである、事前定義済コンシューマ・グループAUTO_TASK_CONSUMER_GROUPのディレクティブを含める必要があります。
自動システム・タスクとAUTO_TASK_CONSUMER_GROUP間の接続は、次のようにして作成されます。まず、スケジューラ・ジョブ・クラスAUTO_TASKS_JOB_CLASSが事前定義され、AUTO_TASK_CONSUMER_GROUPをそのresource_consumer_group属性として指定します。 自動システム・タスクGATHER_STATS_JOBおよびAUTO_SPACE_ADVISOR_JOBは、AUTO_TASKS_JOB_CLASSジョブ・クラスで実行するように定義されます。
関連項目
ジョブ・クラスの詳細は、第27章「スケジューラの使用」を参照してください。
リソース・プラン、リソース・プラン・ディレクティブおよびリソース・コンシューマ・グループの詳細は、第24章「データベース・リソース・マネージャの使用」を参照してください。
Copyright &copy; 2006 Oracle Corporation. 
All Rights Reserved.
目次
索引
メンテナンス・ウィンドウを使用した自動システム・タスクの管理
