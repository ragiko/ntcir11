
Access(アクセス)技・テクニック!営業企画事務のためのAccess活用方法!
差分データを抽出する方法を紹介しています。
HOME ≫ Access(アクセス)編トップ ≫ 差分データを抽出する
差分データを抽出する
部長:「今月の新規顧客の獲得状況はどうだ。」
あなた:「えっ!新規顧客ってどうやって調べるんですか?」
部長:「俺に聞くなよ。今月の顧客データで先月の顧客データになかった人が新規顧客だろう。」
あなた:「えっ!Accessって顧客データの引き算が出来るんですか?」
部長:「だから俺に聞くなって!!」
あなた:「せんぱ〜い。。。」
A先輩:「一言で言えば、比較する2つのデータベースの一致するクエリを作成して、比較したいデータとそのクエリをつないで、Null表示される部分だけ抜き出せば出来るわよ。」
あなた:・・・。
まず比較する2つのデータを用意しましょう。
(例では先月の顧客データと今月の顧客データを使用します。)
オブジェクト[クエリ]を選択して、[デザインビューでクエリを作成する]をダブルクリックしてください。
今回使用する2つのデータを選択して、[追加]してください。
クエリに追加されました。
リレーションを組むデータ同士をドラッグ&ドロップでつないでください。
使用するデータを画面下のフィールドにドラッグ&ドロップしてください。
このクエリを保存し、名前を[重複データ]とでもしましょう。
また、オブジェクト[クエリ]の[デザインビューでクエリを作成する]をダブルクリックしてください。
今度は比較したいデータとクエリタブから先ほど作成したクエリを[追加]してください。
リレーションを組むデータ同士をドラッグ&ドロップで繋いでください。
繋いだ線の上で右クリックし、[結合プロパティ]を選択してください。
比較したいデータの[全レコード]と重複データの同じ結合フィールドのレコードだけを含める2番目を選択してください。
もう一個のフィールドも同じように設定してください。
矢印が下の画像のようになっていることを確認してください。
フィールドに比較したいデータを全部追加すると同時に最後に[重複データ]クエリからデータを一つだけ参照させてください。
[重複データ]クエリからの参照データの[抽出条件]を[Is Null]としてください。
画面左上の[ビュー]で見てみましょう。
[差分データ]が抽出されました!
データをカウントする《 ｜ 》削除クエリの作り方
差分データを抽出する/Access(アクセス)編
