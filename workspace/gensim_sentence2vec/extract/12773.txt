不正ログインを防ぐ「アカウント保護」対策～パスワード強化から2段階認証まで
インターネット上のサービスのほとんどは、正しいIDとパスワードが入力されるだけで、ユーザー本人が操作しているとみなしてしまいます。対面ではないので、年齢や性別、不審な挙動などは一切考慮されません。IDとパスワードさえあれば、誰でもあなたになりすまし、利用しているサービスを不正に使用してしまうかもしれないのです。今回は、あなたであることの証となるIDとパスワードの役割を再認識するとともに、不正使用を防ぐための、さまざまな保護対策をご紹介します。
IDとパスワードの役割
パスワードを守る基本対策
安易な「秘密の質問」と「答え」にご用心
オプション機能の活用
通知/履歴/IDの秘匿化/2段階認証
2段階認証の概要
認証コード/認証コード生成アプリ/端末の登録/アプリ専用パスワード/バックアップコード
2段階認証の設定
Microsoftアカウントで2段階認証を使う
IDとパスワードの役割 
インターネット上の会員制サービスのほとんどは、「ID」と「パスワード」による認証で会員本人であることを確認し、サービスを提供している。「ID」は、システムがユーザーを識別するためのもので、システム側から付与される場合と、ユーザー自身で任意の名前や有効なメールアドレスなどを登録する場合とがある。どちらの場合でも、システムが個々のユーザーを識別しなければならないので、重複しないことが絶対条件だ。
「パスワード」は、その「ID」の使用者が本人であることを識別するためのもので、ユーザー自身が任意の文字列を設定する。「ID」は、直接あるいは間接的に表に出て、ユーザー間での識別用に使われることも多いが、本人であることを証明する「パスワード」の方は、本人しか知らないことが絶対条件だ。したがって通常は、表に出たり、第三者の手に渡ったりすることはない。ところが、何らかの方法で入手されてしまうと、システムは「パスワードを知っている人=本人」とみなすので、本人になりすましてサービスが使われてしまう。IDとパスワードによる認証では、本人しか知らないはずの情報である「パスワード」をいかに守るかが、不正使用防止のキモとなる。
パスワードを守る基本対策
ログイン情報を入手されてしまう原因には、不正アクセスを受けたサイトやウイルスに感染したパソコンからの流出、フィッシングによる詐取、また「類推」、「安易なパスワードを機械的に試行する攻撃」など、さまざまなものが考えられる。これらの原因のうち、サイトからの流出を除くと、いずれもユーザー側で対処できることだ。
ウイルスに感染したパソコンからの流出については、システムやソフトウェアを最新の状態に保つことと、信頼できると確信が持てるとき以外は絶対に実行しないことを心がければ、ほとんどを回避することができる。フィッシングによる詐取については、正規のサイトであることを必ず確認するよう心がければ、ほとんどを回避することができる。
この2つ(ウイルス感染とフィッシング)についての詳しい対策は、以下の関連トピックスを参照していただきたい。
・セキュリティの第一歩「Windows Update」を実行しよう
http://www.so-net.ne.jp/security/news/newstopics_201302.html
・セキュリティの第一歩「Windows Update」を実行しよう
http://www.so-net.ne.jp/security/news/newstopics_201302.html
・「トロイの木馬」～実行被害を防ぐ基本対策
http://www.so-net.ne.jp/security/news/newstopics_201211.html
・国内ユーザーを狙うフィッシング～偽メール・偽サイトの見分け方)
http://www.so-net.ne.jp/security/news/newstopics_201208.html
・無視してはいけない「ブラウザの警告」～個人情報保護編
http://www.so-net.ne.jp/security/security_new/news/newstopics_201109.html
・無視してはいけない「ブラウザの警告」～ウイルス感染防止編
http://www.so-net.ne.jp/security/security_new/news/newstopics_201110.html
「類推」や「安易なパスワードを機械的に試行する攻撃」については、強いパスワードの設定が最も有効な対策となる。具体的には、電話番号や誕生日、名前といった推測されそうなもの、「password」「12345678」のような安易なものを避け、大文字、小文字、数字、記号を織り交ぜた、長いパスワードを使用する。
このほかにも、たとえば人がいるところでの操作は、のぞき見されるかもしれない。自分が管理していないパソコンでは、入力情報を記録されているかもしれない。公衆無線LANなどの預かり知らない回線では、途中で盗聴されるかもしれない。こういったことにも気をとめ、注意を払うようにしたい。
安易な「秘密の質問」と「答え」にご用心
サービスによっては、パスワードのほかに「秘密の質問」と「答え」を登録することがある。これを、通常のパスワード認証に加えた追加認証として用いる場合もあるが、多くは、パスワードを忘れてしまった場合に備えた、本人確認の代替手段として用意しており、パスワードの再設定などが行えるようになっている。すなわち、登録する「答え」は、パスワードと同様、本人しか知らないはずの情報であることが前提なのだ。
図1は、あるサービスのユーザー約1000人が選んだ「秘密の質問」の内訳だ。多彩な選択が用意されるも、4位以降とは5倍以上の差をつけて3つの質問が集中的に選ばれている。はたしてその「答え」には、パスワード並みに強いものを用意しているだろうか。正直な「答え」を、何の細工もなくストレートに登録しているのなら、この機会にぜひ再考していただきたい。ありがちな「秘密の質問」と「答え」は、パスワードよりもはるかに簡単に突破されてしまうかもしれない。実際、昨年6月には、神奈川県内の大学で、この機能を悪用した不正アクセスが発生した。女子生徒のメールをのぞき見たとして、昨年12月に書類送検された兵庫県内の中学生も、この機能を悪用してパスワードを再設定していたという。
図1:選ばれやすい「秘密の質問」の傾向
出所:あるサービスのフィッシングで詐取された被害者約1000人が選んだ「秘密の質問」データを元に著者が作成 
「秘密の質問」と「答え」を登録する際には、それがパスワードと同レベルの要件を満たしているか、よく考えていただきたい。いくら強いパスワードを設定しても、ここが弱いと元も子もないのだ。
オプション機能の活用
なりすましログインによる不正使用を防ぐために、サービスには、さまざまなオプションを用意していることがある。以下に代表的なものをご紹介するので、有用なものは、積極的に利用していただきたい。
・通知
あなたのアカウントに対し特定の操作が行われた場合に、あらかじめ登録しておいたメールアドレス宛てに通知する機能だ。サービスによっては、通知するだけでなく、受け取った通知から承認や無効化の操作を行えるものもある。利用頻度の少ないサービスに関しては、可能であればログインの時点で通知するよう設定しておくとよいかもしれない。通知先は、常時持ち歩いている携帯宛てがよい。アカウントを破られないようにすることの次に重要なのは、破られたことやその予兆をいかに早く察知し、適切に対処できるかである。
・履歴
ログイン通知の機能がない、あるいは頻繁に利用するので無効化しているような場合には、身に覚えのない日時やアドレスなどから使われていないかどうか、履歴機能を使ってこまめにチェックしよう。ログイン時に前回のアクセスを表示するサービスでは、これを見逃さないようにしたい。もし身に覚えのない不審なアクセスがあったら、直ちにパスワードを変更しよう。
・IDの秘匿化
ログインするためには、IDとパスワードの両方が正しくなければならない。パスワードだけでなく、IDも秘密にしておけば、セキュリティをより強化できる。サービスによっては、ログイン用のIDを表に出ることのない専用のものに設定できる場合や、表に出る表示名を別のものに設定できる場合がある。IDが表に出ることのないサービスであれば、同じIDを使いまわさない、他人に教えないといった、自身の意識ひとつで秘匿化が可能だ。重要なサービスとそうでないサービスとで使い分けるだけでも、安全性が増す。
メールアドレスをIDとして登録するサービスでは、ふだん使用しているメールアドレスとは異なるものを個別に使用する手段がある。しかし、いたずらにメールアドレスを作成してしまうと、メールアカウントが増えて煩雑になり、管理もずさんになってしまうおそれがある。こうした用途には、ひとつのメールアドレスを拡張して別のアドレスを生成できるメールサービスや、ひとつのアカウントに複数のメールアドレスを統合できるメールサービスを利用すると便利だ。メールサービスにある、「サブアドレス」「別名アドレス」「エイリアスアドレス」などと呼ばれている機能がそれだ。
本来のメールアドレスを拡張するタイプでは、「ベース名@ドメイン名」という元のメールアドレスに対し、「@」の左側に「+」や「‐」を付けて任意の文字列を追加。「ベースアドレス+任意の文字列@ドメイン名」という形に拡張したものが利用できるようになる。複数のメールアドレスを統合するタイプでは、全く別のアドレスを取得し、同じアカウントの管理下に加えることができる。両者は若干異なるものの、どちらも表向きは別のメールアドレスとして扱われ、実際には同じアカウントにメールが配信される仕組みだ。
・2段階認証
ネットバンキングの不正送金被害が問題化しはじめた2005年ごろから、国内の金融機関では、それまでの「ID/パスワード」のみの認証に加え、乱数表やトークン(パスワード生成機)などを使い、毎回異なる別のパスワード(以後「認証コード」と呼ぶ)を入力させる、新たな認証方式を導入するようになった。金融庁の昨年3月時点でのまとめによると、銀行や信用金庫の個人向けネットバンキングの約73%が、この種の認証方式を導入しているという。
最近では、オンラインゲームやポータルサイト、SNSなどでも、同様の仕組みが積極的に採用され始めている。サービスによって、名称や仕様に若干の違いはあるが、万が一IDとパスワードが盗まれても、それだけでは利用できないようにしてしまう仕掛けなので、アカウントを保護するためのオプション機能として高い効果が期待できる。
ここからは、この「2段階認証」の仕組みを解説し、実例として、今年5月から始まったMicrosoftの2段階認証の設定方法を詳しくご紹介する。
2段階認証の概要
2段階認証は、IDとパスワードを使った従来のログイン手順に、もう1段階、毎回変わる「認証コード」の入力を加えたものだ。2段階認証を使うと、ログインは図3のような手順になる。
図2:2段階認証のログイン手順
ID/パスワードの入力だけで済んだログインに新たな手順が追加され、2段階目を行えないとログインできなくなってしまうわけだ。サービスによっては、パスワード変更などの重要な操作を行う際にも、改めてログイン手順を実行させたり、2段階目の認証を行わせたりする場合もある。
2段階認証は、セキュリティの向上と引き換えに、ログインプロセスを煩雑化してしまう側面がある。さらに、認証コードを受け取る携帯電話が圏外の場合や、紛失してしまった場合なども考えると、ついつい二の足を踏んでしまうかもしれない。各サービスでは、さまざまな状況に対応できるように、あらかじめいくつかの機能を用意している。(表1)
表1:2段階認証のサポート状況
セキュリティ通信 | サービス一覧 | 会員サービス | So-net
