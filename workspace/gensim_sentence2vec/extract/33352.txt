【課題】大気条件に依存せずに、背景画像と目標モデル画像を融合する際に生じる画像間の不整合を低減する。【解決手段】3Dモデルに対して光線追跡処理を行い高分解能撮像画像データを生成する光線追跡処理部(11)と、広域撮像画像データおよび高分解能撮像画像データに対して解像度劣化処理を行う光学センサ特性付加部(12)と、解像度劣化処理後の両画像データに対して反射率データを用いた反射率変換処理を行う反射率変換部(13)と、反射率変換処理後の両データを合成した反射率画像データを生成する反射率画像融合処理部(14)と、反射率画像データに対して大気条件データを考慮した画像データを生成する光波伝搬処理部(21)と、光学センサの雑音量を付加する光学センサ雑音付加部(22)と、量子化処理を行って目標撮像模擬画像を生成する量子化処理部(23)とを備える。
【発明の詳細な説明】【技術分野】【0001】  本発明は、光学センサ撮像模擬画像を生成するための模擬画像生成装置に関するものである。【背景技術】【0002】  光学センサの性能予測技術は、光学センサ設計やシステム設計など広い分野で用いることができる有益な技術である。例えば、従来技術として、任意背景画像内に目標モデル画像を配置することで、目標撮像画像を模擬する技術がある(例えば、特許文献1、2参照)。【0003】  特許文献1では、実空間を背景画像として撮像するとともに、距離データを測定することによって、背景画像を3次元データとして取得する。そして、目標が背景物体と重なって一部分が見えないようなシーンの撮像画像を模擬している。【0004】  また、特許文献2では、既存の撮像画像を背景画像とし、背景画像から目標モデル画像を配置する周辺部分を切り出してメモリに格納する。これにより、目標が移動するようなシーンの撮像画像を複数模擬するときの処理付加を低減させている。【0005】  しかしながら、シーン全体を3Dモデルで構築して光学センサの撮像模擬画像を生成するには、計算処理負荷が多大となる。そこで、背景画像と目標モデル画像を融合することで、計算処理負荷を低減する従来技術もある。【先行技術文献】【特許文献】【0006】【特許文献1】米国特許第6166744号明細書【特許文献2】米国特許第4641255号明細書【発明の概要】【発明が解決しようとする課題】【0007】  しかしながら、従来技術には、以下のような課題がある。  従来技術では、リアルタイムで撮像した画像や既存の撮像画像を背景として、目標モデル画像との合成処理を行っている。しかし、光波が大気中を伝搬する際に生じる減衰や散乱は、大気条件によって変化する。従って、背景画像を撮像した時の大気条件と同等の光波減衰や散乱光を、目標モデル画像に付加することは困難であり、合成する際に画像間で不整合が生じる結果となる。【0008】  本発明は、前記のような課題を解決するためになされたものであり、大気条件に依存せずに、背景画像と目標モデル画像を融合するに生じる画像間の不整合を低減し、撮像画像の模擬精度を向上させることのできる模擬画像生成装置を得ることを目的とする。【課題を解決するための手段】【0009】  本発明に係る模擬画像生成装置は、背景画像としての広域撮像画像データと、目標画像としての3Dモデルデータを入力画像データとして取得し、背景画像および目標画像を融合させることで光学センサを用いた目標撮像模擬画像を生成する模擬画像生成装置において、光学センサの特性データを取得し、3Dモデルデータに対して特性データを用いた光線追跡処理を行うことで光学センサに入射する光量を計算し、高分解能撮像画像データを生成する光線追跡処理部と、光学センサの空間分解能データを取得し、広域撮像画像データおよび高分解能撮像画像データに対して空間分解能データを用いた解像度劣化処理を行う光学センサ特性付加部と、入力画像データの画素値と反射率とを対応付けた変換データを反射率データとして取得し、光学センサ特性付加部による解像度劣化処理後の広域撮像画像データおよび高分解能撮像画像データに対して反射率データを用いた反射率変換処理を行う反射率変換部と、反射率変換部による反射率変換処理後の広域撮像画像データおよび高分解能撮像画像データを合成した反射率画像データを生成する反射率画像融合処理部と、大気条件データを取得し、反射率画像融合処理部により生成された合成後の反射率画像データに対して、大気条件データを用いて光学センサで検出する信号量に相当する画像データを生成する光波伝搬処理部と、光波伝搬処理部で生成された画像データに対して、光学センサの雑音特性に対応した雑音量を付加した画像データを生成する光学センサ雑音付加部と、光学センサ雑音付加部で生成された画像データに対して、光学センサに対応した量子化処理を行う量子化処理部と、量子化処理部による量子化処理後の画像データを目標撮像模擬画像として出力する画像出力部とを備えるものである。【発明の効果】【0010】  本発明に係る模擬画像生成装置によれば、背景画像(広域撮像画像)と目標モデル画像(高分解能撮像画像)を物体固有の反射率画像に変換した後に融合処理を行うことにより、大気条件に依存せずに、背景画像と目標モデル画像を融合する際に生じる画像間の不整合を低減し、撮像画像の模擬精度を向上させることのできる模擬画像生成装置を得ることができる。【図面の簡単な説明】【0011】【図1】本発明の実施の形態1における模擬画像生成装置の構成図である。【図2】本発明の実施の形態2における模擬画像生成装置の構成図である。【図3】本発明の実施の形態3における模擬画像生成装置の構成図である。【発明を実施するための形態】【0012】  以下、本発明の模擬画像生成装置の好適な実施の形態につき図面を用いて説明する。【0013】  実施の形態1.  図1は、本発明の実施の形態1における模擬画像生成装置の構成図である。図1に示す模擬画像生成装置は、反射率画像生成部10、およびシミュレーション計算処理部20を備えている。そして、模擬画像生成装置は、外部から広域撮像画像データ1、3Dモデルデータ2、光学センサ特性データ3、反射率データ4、および大気条件データ5を取得し、最終的に、撮像模擬画像を出力する。【0014】  ここで、反射率画像生成部10は、光線追跡処理部11、高分解能撮像画像への光学センサ特性付加部12a、広域撮像画像への光学センサ特性付加部12b、高分解能撮像画像反射率変換部13a、広域撮像画像反射率変換部13b、および反射率画像融合処理部14を備えて構成されている。一方、シミュレーション計算処理部20は、光波伝搬処理部21、光学センサ雑音付加部22、量子化処理部23、および画像出力部24を備えて構成されている。【0015】  広域撮像画像データ1は、広域を撮像したカメラ写真や航空機写真、衛星画像等のデータで構成され、細かい空間分解能を必要としない背景画像に相当する。また、3Dモデルデータ2は、着目する目標の3次元データで構成され、目標モデル画像に相当する。また、光学センサ特性データ3は、画素数、画素サイズ、焦点距離、F値などの特性データ、および模擬する光学センサの空間分解能データで構成される。【0016】  また、反射率データ4は、入力画像データの画素値と反射率を対応付けた変換データとして構成されている。また、大気条件データ5は、太陽反射光成分や大気散乱光成分などのデータで構成されている。なお、外部から取得するこれらのデータは、データベース化されて、模擬画像生成装置内に持たせることも可能である。【0017】  次に、図1に示した模擬画像生成装置の動作について説明する。  まず始めに、反射率画像生成部10内で、背景画像である広域撮像画像の反射率画像を生成する処理について説明する。なお、以下の説明においては、広域撮像画像への光学センサ特性付加部12bのことを、単に、光学センサ特性付加部12bとして記載することとする。【0018】  光学センサ特性付加部12bは、広域撮像画像データ1を入力する。ここで、広域撮像画像データ1は、模擬する光学センサの撮像画像と同程度の空間分解能を持つ必要がある。【0019】  そして、光学センサ特性付加部12bは、入力した広域撮像画像データ1に対して、光学センサ特性データ3から取得した、模擬する光学センサの空間分解能データを用いて、解像度劣化処理を行う。【0020】  そして、広域撮像画像反射率変換部13bは、解像度劣化処理された広域撮像画像データを反射率画像へと変換する。ここで、広域撮像画像反射率変換部13bは、入力画像データの画素値と反射率を対応付けた変換データを反射率データ4として読み込むことで、反射率変換処理を行う。【0021】  次に、反射率画像生成部10内で、目標モデル画像である高分解能撮像画像の反射率画像を生成する処理について説明する。なお、以下の説明においては、高分解能撮像画像への光学センサ特性付加部12aのことを、単に、光学センサ特性付加部12aとして記載することとする。【0022】  光線追跡処理部11は、着目する目標モデル画像である3Dモデルデータ2を入力する。そして、光線追跡処理部11は、3Dモデルデータ2が配置された3Dシーンに対して、光学センサ特性データ3から取得した光学センサの画素数、画素サイズ、焦点距離、F値などの特性データを用いた光線追跡処理により、光学センサに入射する光量を計算し、高分解能撮像画像を出力する。ここで、高分解能撮像画像は、模擬する光学センサの撮像画像と同程度の空間分解能を持つ必要がある。【0023】  そして、光学センサ特性付加部12aは、光線追跡処理部で生成された高分解能撮像画像に対して、光学センサ特性データ3から取得した、模擬する光学センサの空間分解能データを用いて、解像度劣化処理を行う。【0024】  そして、高分解能撮像画像反射率変換部13aは、解像度劣化処理された高分解能撮像画像データを反射率画像へと変換する。ここで、高分解能撮像画像反射率変換部13aは、入力画像データの画素値と反射率を対応付けた変換データを反射率データ4として読み込むことで、反射率変換処理を行う。【0025】  次に、反射率画像生成部10内における、背景画像と目標モデル画像の融合処理について説明する。反射率画像融合処理部14は、広域撮像画像反射率変換部13bおよび高分解能撮像画像反射率変換部13aで生成されたそれぞれの反射率画像データの融合処理を行う。ここで、反射率画像融合処理部14は、広域撮像画像データ1から生成された反射率画像の任意部分を、3Dモデルデータ2から生成された反射率画像に置き換えることで、両反射率画像の融合を行う。【0026】  次に、反射率画像生成部10内で生成された背景画像と目標モデル画像の融合後の反射率画像に対して、シミュレーション計算処理部20で行われる一連処理について説明する。光波伝搬処理部21は、反射率画像融合処理部14で生成された融合後の反射率画像に対して、大気条件データ5から取得した太陽反射光成分や大気散乱光成分などのデータを用いて、模擬する光学センサで検出する信号量を計算する。【0027】  次に、光学センサ雑音付加部22は、光波伝搬処理部21で計算された信号量に基づく画像データに対して、模擬する光学センサの雑音特性に対応した雑音量を付加する。そして、量子化処理部23は、雑音量が付加された画像データに対して、模擬する光学センサに対応した量子化処理を行う。そして、画像出力部24は、量子化後の画像データを撮像模擬画像として出力する。【0028】  以上のように、実施の形態1によれば、背景画像として、航空機写真などの広域を撮像した画像を用意し、目標モデル画像として、着目する目標の3Dモデルから高分解能撮像画像を生成する。そして、背景画像と目標モデル画像の両画像を融合することで撮像模擬画像を生成する。これにより、シーン全体を3Dモデルで構築して光学センサの撮像模擬画像を生成するよりも、計算処理負荷を大幅に低減することが可能である。【0029】  さらに、両画像を物体固有の反射率を用いて反射率画像に変換した後に融合処理を行うことで、大気条件に依存せずに、融合処理を行うことができる。この結果、両画像間の不整合を低減させることができ、撮像画像の模擬精度を向上させることが可能となる。さらに、任意の大気条件下での撮像模擬画像を、容易に生成することが可能となる。【0030】  さらに、実施の形態1では、光線追跡処理部を有しており、3Dモデルデータに対して光学センサに入射する光量を光線追跡処理により計算している。これにより、目標表面の陰影や影部を表すことができ、従来技術よりも模擬精度を向上させることが可能となる。【0031】  さらに、実施の形態1では、反射率画像融合処理部を有しており、広域撮像画像(背景画像)と高分解能撮像画像(目標モデル画像)を融合する際に、両画像を物体固有の反射率へと変換している。この結果、目標位置を変換させた撮像画像を模擬する場合でも、容易かつ高精度で融合させることが可能となる。【0032】  さらに、実施の形態1では、反射率画像に変換した後に融合処理を行うため、反射率画像に変換した複数の異なる目標モデルを、容易かつ高精度で融合させることが可能となる。【0033】  さらに、実施の形態1では、反射率画像融合処理部で生成した反射率画像に対して、光波伝搬処理部で大気条件データから取得したデータを用いて、光学センサで検出する信号量を計算している。この結果、大気条件が変化した場合を模擬する場合でも、大気条件データから取得する太陽反射光成分や大気散乱光成分などのデータを変更して光学センサで検出する信号量を再度計算するだけでよい。すなわち、光波伝搬処理部以降のシミュレーション計算処理のみを再実行だけでよいため、模擬画像生成処理時間の大幅な短縮が可能となる。【0034】  実施の形態2.  図2は、本発明の実施の形態2における模擬画像生成装置の構成図である。ここで、反射率画像生成部10は、光線追跡処理部11、高分解能撮像画像への光学センサ特性付加部12a、広域撮像画像への光学センサ特性付加部12b、高分解能撮像画像反射率変換部13a、広域撮像画像反射率変換部13b、反射率画像融合処理部14、および2Dモデル蓄積部15を備えて構成されている。一方、シミュレーション計算処理部20は、光波伝搬処理部21、光学センサ雑音付加部22、量子化処理部23、および画像出力部24を備えて構成されている。【0035】  図2に示した本実施の形態2における模擬画像生成装置は、先の実施の形態1における模擬画像生成装置と比較すると、反射率画像生成部10内に2Dモデル蓄積部15をさらに備えている点が異なっている。そこで、この相違点を中心に、以下に説明する。【0036】  2Dモデル蓄積部15は、3Dモデルデータ2に基づいて、光線追跡処理部11、高分解能撮像画像への光学センサ特性付加部12a、高分解能撮像画像反射率変換部13aを介して生成された目標の2D反射率モデルを蓄積する記憶部である。目標の2D反射率モデルを蓄積する2Dモデル蓄積部15を備えることで、2D反射率モデルを流用する際の再計算処理をなくすことが可能となる。【0037】  以上のように、実施の形態2によれば、複数の同一形状モデルを広域撮像画像上に配置するときに、3Dモデルデータに対して光線追跡処理部で行う光線追跡処理、光学センサ特性付加部で行う解像度劣化処理の再計算を不要にすることができる。この結果、高分解能撮像画像の反射率画像生成処理の高速化、および模擬画像撮像装置全体の計算処理付加の減少を図ることが可能となる。【0038】  さらに、実施の形態2では、反射率画像融合処理部において、広域撮像画像と高分解能撮像画像を融合する際に、両画像を物体固有の反射率へと変換している。このため、2Dモデル蓄積部に蓄積された複数の異なる目標モデルの反射率画像を用いることで、再計算のための処理付加を軽減した上で、複数の異なる目標モデルを、容易かつ高精度で融合させることが可能となる。【0039】  実施の形態3.  本実施の形態3では、広域撮像画像データ1として、複数の異なる観測波長帯で撮像された画像を用いる模擬画像生成装置について説明する。【0040】  図3は、本発明の実施の形態3における模擬画像生成装置の構成図である。ここで、反射率画像生成部10、およびシミュレーション計算処理部20の基本構成は、先の実施の形態1における図1の構成と同様である。【0041】  ただし、本実施の形態3における模擬画像生成装置は、外部から取得する広域撮像画像データ1a、光学センサ特性データ3a、反射率データ4a、および大気条件データ5aのそれぞれを、波長帯情報ごとに識別されたデータとして取得することで、異なる観測波長帯で撮像した画像に応じた撮像模擬画像を出力することを可能としている。【0042】  図3における広域撮像画像データ1aは、広域撮像画像が複数の異なる観測波長帯を持つマルチバンド画像であり、観測波長帯情報が付された広域撮像画像データとして構成されている。また、光学センサ特性データ3aは、画素数、画素サイズ、焦点距離、F値などの特性データ、および模擬する光学センサの空間分解能データが、各観測波長帯に対応したデータとして構成されている。【0043】  また、反射率データ4aは、入力画像データの画素値と反射率を対応付けた変換データが、各観測波長帯に対応したデータとして構成されている。また、大気条件データ5aは、太陽反射光成分や大気散乱光成分などのデータが、各観測波長帯に対応したデータとして構成されている。【0044】  そして、広域撮像画像への光学センサ特性付加部12bおよび高分解能撮像画像への光学センサ特性付加部12aは、各観測波長帯に対応した光学センサ特性を用いて、広域撮像画像および高分解能撮像画像の解像度劣化処理を行う。【0045】  また、広域撮像画像反射率変換部13bおよび高分解能撮像画像反射率変換部13aは、各観測波長帯に対応した反射率データを用いて広域撮像画像および高分解能撮像画像を反射率画像へと変換する。【0046】  さらに、光波伝搬処理部21は、反射率画像融合処理部14で融合させた後の観測波長帯に対応した反射率画像に対して、光学センサで検出する信号量を計算する。このとき、光波伝搬処理部21は、大気条件データ5aから、各観測波長帯に対応した大気条件データを取得することで、各観測波長帯に対応した信号量を計算することができる。【0047】  このように、本実施の形態3では、異なる観測波長帯の撮像模擬画像を複数合成することで、カラー模擬画像を生成することが可能となる。例えば、450nm近傍に観測波長帯を持つ撮像模擬画像を青(B)、550nm近傍に観測波長帯を持つ撮像模擬画像を緑(G)、650nm近傍に観測波長帯を持つ撮像模擬画像を赤(R)、にそれぞれ割り当てることで、RGBカラー撮像模擬画像を生成することが可能となる。【0048】  また、紫外領域や赤外領域に観測波長帯を持つ撮像模擬画像に対して、色を付けて複数の撮像模擬画像を合成することで、普段は人間の目に見えない光を視覚化した撮像模擬画像を生成することが可能となる。【0049】  また、高分解能のパンクロマティック撮像模擬画像(単色画像)と、低解像度の450nm近傍に観測波長帯を持つ撮像模擬画像を青(B)、550nm近傍に観測波長帯を持つ撮像模擬画像を緑(G)、650nm近傍に観測波長帯を持つ撮像模擬画像を赤(R)、にそれぞれ割り当てたRGBカラー撮像模擬画像と合成することで、高分解能のRGBカラー撮像模擬画像を生成することが可能となる。【0050】  以上のように、実施の形態3によれば、観測波長帯情報を備えたデータを用いることで、観測波長帯を持つ広域かつ高分解能な撮像模擬画像を生成することが可能となる。【符号の説明】【0051】  1、1a  広域撮像画像データ、2  モデルデータ、3、3a  光学センサ特性データ、4、4a  反射率データ、5、5a  大気条件データ、10  反射率画像生成部、11  光線追跡処理部、12a  光学センサ特性付加部、12b  光学センサ特性付加部、13a  高分解能撮像画像反射率変換部、13b  広域撮像画像反射率変換部、14  反射率画像融合処理部、15  2Dモデル蓄積部、16  波長帯情報格納部、20  シミュレーション計算処理部、21  光波伝搬処理部、22  光学センサ雑音付加部、23  量子化処理部、24  画像出力部。
【特許請求の範囲】【請求項1】  背景画像としての広域撮像画像データと、目標画像としての3Dモデルデータを入力画像データとして取得し、前記背景画像および前記目標画像を融合させることで光学センサを用いた目標撮像模擬画像を生成する模擬画像生成装置において、  前記光学センサの特性データを取得し、前記3Dモデルデータに対して前記特性データを用いた光線追跡処理を行うことで前記光学センサに入射する光量を計算し、高分解能撮像画像データを生成する光線追跡処理部と、  前記光学センサの空間分解能データを取得し、前記広域撮像画像データおよび前記高分解能撮像画像データに対して前記空間分解能データを用いた解像度劣化処理を行う光学センサ特性付加部と、  入力画像データの画素値と反射率とを対応付けた変換データを反射率データとして取得し、前記光学センサ特性付加部による前記解像度劣化処理後の広域撮像画像データおよび高分解能撮像画像データに対して前記反射率データを用いた反射率変換処理を行う反射率変換部と、  前記反射率変換部による前記反射率変換処理後の広域撮像画像データおよび高分解能撮像画像データを合成した反射率画像データを生成する反射率画像融合処理部と、  大気条件データを取得し、前記反射率画像融合処理部により生成された合成後の前記反射率画像データに対して、前記大気条件データを用いて前記光学センサで検出する信号量に相当する画像データを生成する光波伝搬処理部と、  前記光波伝搬処理部で生成された前記画像データに対して、前記光学センサの雑音特性に対応した雑音量を付加した画像データを生成する光学センサ雑音付加部と、  前記光学センサ雑音付加部で生成された前記画像データに対して、前記光学センサに対応した量子化処理を行う量子化処理部と、  前記量子化処理部による前記量子化処理後の画像データを前記目標撮像模擬画像として出力する画像出力部と  を備えることを特徴とする模擬画像生成装置。【請求項2】  請求項1に記載の模擬画像生成装置において、  前記反射率変換部による前記反射率変換処理後の高分解能撮像画像データを前記目標画像の2D反射率モデルとして蓄積する2Dモデル蓄積部をさらに備え、  前記反射率画像融合処理部は、前記2Dモデル蓄積部に蓄積された前記2D反射率モデルを用いて前記反射率画像データを生成する  ことを特徴とする模擬画像生成装置。【請求項3】  請求項1または2に記載の模擬画像生成装置において、  前記広域撮像画像データは、複数の異なる観測波長帯で撮像された波長帯情報付きの広域撮像画像データとして構成され、  前記光線追跡処理部は、各観測波長帯に対応した前記光学センサの特性を取得して前記光線追跡処理を行うことで各各観測波長帯に対応した高分解能撮像画像データを生成し、  前記光学センサ特性付加部は、各観測波長帯に対応した前記光学センサの空間分解能データを取得して前記解像度劣化処理を行い、  前記反射率変換部は、各観測波長帯に対応した反射率データを取得して前記反射率変換処理を行い、  前記光波伝搬処理部は、各観測波長帯に対応した大気条件データを取得して前記光学センサで検出する信号量に相当する画像データを生成する  ことを特徴とする模擬画像生成装置。
模擬画像生成装置
