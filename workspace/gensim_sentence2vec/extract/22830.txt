
地殻構造探査学
データ解析演習(課題その2)
課題その1へ
< 課題その2 >
課題その3へ
スペクトルと周波数フィルタ
この課題では、サンプルデータdemo_bpf.suを使用する。データがなければここを参考にしてコピーする。
まず、波形を表示する。
$ suxwigb 
スペクトルを計算して表示する。
$ suspecfx 
suspecfx は時間軸方向にフーリエ変換(f-x)して振幅スペクトルを出力する。
表示には suximage, suxwigb, suxgraph などが使える。
suop は演算をするプログラムで、ここではスペクトルの対数を取ってデシベルにしている (op=db)。
どのような周波数成分が含まれているかわかる。
図:(左)波形。縦軸は時間 (s)、横軸はトレース、(中)スペクトルのカラー表示。縦軸は周波数 (Hz)、横軸はトレース、(右)スペクトル(グラフ表示)、横軸はリニア表示。
フィルタをかけて表示してみる。
スペクトルから、データには大きく分けて 0〜20 Hz, 20〜40 Hz, 50〜100 Hz の3つの
周波数帯域のデータが混在していることがわかる。そこで下図のようなフィルタ
を適用する。
まず、(a)のバンドパスフィルタを適用し、20〜40 Hzの信号を取り出す。
$ sufilter f=10,20,40,50 amps=0,1,1,0 
sufilter はフィルタのプログラム
'f= ' で周波数、'amps= ' でその周波数に対応する振幅を指定する。
amps=1,0 (ローパスフィルタ) amps=0,1 (ハイパスフィルタ),
amps=0,1,1,0 (バンドパス)などフィルタの形状を指定する。
図:(左)波形。縦軸は時間 (s)、横軸はトレース、(右)スペクトル(グラフ表示)、横軸はリニア表示。
20〜40 Hz の信号のみが残っていることを確認しよう。
(b)は(a)のバンドパスフィルタの帯域を削除するフィルタ。'amps= 'の指定方法が変化していることに注意。
$ sufilter f=10,20,40,50 amps=1,0,0,1 
図:(左)波形。縦軸は時間 (s)、横軸はトレース、(右)スペクトル(グラフ表示)、横軸はリニア表示。
逆に、20〜40 Hzの信号が除去されていることを確認しよう。
(c), (d)はそれぞれローパス、ハイパスフィルタ。
$ sufilter f=10,20 amps=1,0 
図:(左)波形。縦軸は時間 (s)、横軸はトレース、(右)スペクトル(グラフ表示)、横軸はリニア表示。
図:(左)波形。縦軸は時間 (s)、横軸はトレース、(右)スペクトル(グラフ表示)、横軸はリニア表示。
(c)では20 Hz以下の低周波数信号が、(d)では40Hz異常の高周波数信号が取り出されていることを確認すること。
速度フィルタ (f-k フィルタ)
ここではサンプルデータdemo_fkf.su, emo_fkf2.suを使用する。なければここを参考にしてコピーする。
まず、波形を表示する。
$ suxwigb 
f-kスペクトルを計算して表示する。
$ suspecfk d1=1 d2=1 
suspecfk はt方向、x方向にそれぞれ2重フーリエ変換を行い、f-kスペクトルを作成するプログラム。
図:(左)波形。縦軸は時間 (s)、横軸は距離 (m)、(右)f-kスペクトルのカラー表示。縦軸は周波数 (Hz)、横軸は波数 (1/m)
t-x平面の(1),(2),(3)の波はf-k平面上ではそれぞれ対応する位置に表示される。
(3)の波は空間エリアシングしている(波数領域でスペクトルの回り込みがある:右端の部分が左端に戻ってくる)ことがわかる。
速度フィルタをかけてみる。まず(1)の波を消去する。t-x平面で傾き(dt/dx)が0
なので、傾きが0付近(幅を与える)の波を除去するフィルタを適用する。
f-k平面では下図のようなフィルタに相当する(斜線の濃い部分をカット)。
$ sudipfilt dt=1 dx=1 slopes=-1.0,-0.5,0.5,1.0 amps=1,0,0,1 
sudipfilt はt-x平面で、ある傾斜をもつ領域を通過したり削除したりするフィルタ。実際には、プログラムの内部でt方向、x方向に2重フーリエ変換を行い、f-k領域でフィルタを作用させている。
'dt=1 dx=1'はそれぞれt, x軸のサンプル間隔。
'slopes= ' でフィルタをかける傾斜を指定する。ちょうどsufilterの 'f= 'に相当する。ここでは0付近の傾きを除去する。
'amps =' の使用方法は sufilter のものと同じ。
f-kスペクトルを表示させると、指定した部分が切り取られていることがわかる。
(3)の高周波数部分も一部切り取られているので、少し波形が歪んでいる。
図:(左)波形。縦軸は時間 (s)、横軸は距離 (m)、(右)f-kスペクトルのカラー表示。縦軸は周波数 (Hz)、横軸は波数 (1/m)
次に(3)の波を消去する。t-x平面で傾き(dt/dx)が2
なので、傾きが2付近の波を除去するフィルタを適用する。
f-k平面では下図のようなフィルタに相当する。
$ sudipfilt dt=1 dx=1 slopes=1.5,1.75,2.25,2.5 amps=1,0,0,1 
図:(左)波形。縦軸は時間 (s)、横軸は距離 (m)、(右)f-kスペクトルのカラー表示。縦軸は周波数 (Hz)、横軸は波数 (1/m)
t-x平面で少し波が残っていることがわかる。これはf-k平面を見ると明らかで、
今回適用したフィルタではエリアシングした部分(左側に回り込んでいる部分)
が残ってしまっているためである。
これを削除するには、さらに傾きが負の部分を削除するフィルタを適用するとよい。
課題
その1
サンプルデータ demo_fkf.su を用いて、(1)と(3)の波をできるだけ保ち(2)の波のみを除去するフィルタを適用せよ。
フィルタを与えるコマンドとオプション
フィルタを適用した結果の波形表示
そのf-kスペクトルのイメージ表示
を提出せよ。
その2
サンプルデータdemo_fkf2.su から、表面波(図の左上から右下に並んでいる低周波数の波)を取り除け。ヒントを以下に示す。
sudipfilt dx=1 slopes=(切り取る傾きを図から読み取る) amps=?,?,?,? 
波形表示の縦軸から時間を読んで傾きを求め、'slopes= 'に与えるパラメータを指定せよ。(このデータではdtの値が与えられているので、'dt= ' は指定しない)。
フィルタを与えるコマンドとオプション
フィルタを適用した結果の波形表示
そのf-kスペクトルのイメージ表示
を提出せよ。
図:(左)サンプルデータ demo_fkf2.su の表示。縦軸は時間 (s)、横軸は距離 (m)、(右)ちなみに、表面波だけを残すとこうなる。結果はこの逆になる。
課題その1へ
< 課題その2 >
課題その3へ
戻る
Last modified: Sun Sep 15 11:21:50 2013
Geophysical Exploration
