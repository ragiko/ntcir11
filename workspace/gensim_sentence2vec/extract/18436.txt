【課題】音響モデルと言語モデルを同一のモデルで表現する。【解決手段】この発明の音響モデルパラメータ学習方法は、モデルパラメータ初期化過程とモデルパラメータ更新過程を含む。モデルパラメータ初期化過程は、認識スコアを求めるモデルパラメータを初期化する。モデルパラメータ更新過程は、特徴量ベクトルを入力としてその特徴量ベクトルとモデルパラメータの内積値の累積に基づく目的関数が外部から与えられ、その目的関数を最大化するモデルパラメータを、上記初期化されたモデルパラメータを更新して求め、各音素に対応する所定フレーム数から成る部分モデルパラメータを出力する。
【発明の詳細な説明】【技術分野】【0001】  この発明は、HMM(Hidden Markov Model)に比べて簡素な構造を持ち、N−gram言語モデルを表現可能な線形分類モデルにより音響モデルを作成する方法とその装置と、その方法で作成した音響モデルを利用し、音声信号と音素を対応付けるための音素重み付き有限状態変換器生成方法とその装置と、それらのプログラムに関する。【背景技術】【0002】  標準的な音声認識システムを構成する要素のうち、主要な要素は音響モデルと言語モデルである。音響モデルとは、音声信号と音素を対応付けるモデルである。一般に音響モデルにはHMMやそれを基にしたモデルが広く利用されている。時間伸縮を考慮したモデルであり、音声信号のように伸び縮みが存在する物理現象をモデル化するために広く用いられて来た。【0003】  言語モデルには、N−gram言語モデルが広く利用されている。このモデルは音響モデルとは異なる表現形式となっている。図9に、音響モデル(HMM)と言語モデルによって単語列の探索空間が構成された例を示す(参考文献1)。この図に示すように、音声認識における探索空間は、言語モデルで決められた音素の並びに音響モデルが埋め込まれたネットワークで表現される。【0004】  音響モデルと言語モデルは、それぞれ独立に学習されるのが一般的であるが、近年、全体最適化のための幾つかの試みが行われている。しかし、HMM自体の複雑さに加え、異なる形式で表現された言語モデルのモデルパラメータも同時に調整しなければならないため、音声認識システムが複雑なものとなっている。【先行技術文献】【非特許文献】【0005】【非特許文献1】堀  貴明、塚田  元音声情報処理の最先端3「重み付き有限状態トランスデューサによる音声認識」情報処理学会誌「情報処理」45巻10号、pp.1020-1026(2004.10).【非特許文献2】安藤彰男「リアルタイム音声認識」電子情報通信学会【非特許文献3】Annette J Dobson, Adrian G Barnett, An Introduction to Generalized Linear Modeles,CRC Press.(和訳本、田中  豊、森川敏彦、山内竹春、富田  誠訳「一般化線形モデル入門」共立出版株式会社)【非特許文献4】Koby Crammer, Ofer Dekel, Joseph Keshet, Shai Shalev-Shwartz, Yoram Singer, Online passive aggressive algorithms,Journal of Machine Learning Research, Vol.7, pp.531-583, 2006.【非特許文献5】工藤  拓、山本  薫、松本祐治Conditional Random Fields を用いた日本語形態素解析情報処理学会誌全言語処理研究会  SIGNL-161, 2004.【非特許文献6】Hal Daume Iii, Daniel Marcu, Learning as search optimization:Approximate large margin methods for structured prediction, International Conference on Machine Learning, pp.169-176, 2005.【発明の概要】【発明が解決しようとする課題】【0006】  そこで、音響モデルと言語モデルが同一のモデルで表現されれば全体を最適化し易く、また、そのプロセスも単純化が図れるものと期待できる。しかし、従来の線形分類モデルは、時系列に入力される特徴量に従ったスコアを、時系列に出力するようには形成されていなかった。そのため、音響モデルを線形分類モデルで表現することを考えたときに連続音声認識に利用できない問題があった。【0007】  この発明は、このような問題点に鑑みてなされたものであり、音響モデルと言語モデルを統一的な枠組みで表現可能な音響モデルの学習方法とその装置と、その方法で作成した音響モデルを利用し、音声信号と音素を対応付けるための音素重み付き有限状態変換器生成方法とその装置と、それらのプログラムを提供することを目的とする。【課題を解決するための手段】【0008】  この発明の音響モデルパラメータ学習方法は、モデルパラメータ初期化過程とモデルパラメータ更新過程を含む。モデルパラメータ初期化過程は、認識スコアを求めるための各音素に対応する所定フレーム数から成る部分モデルパラメータを初期化する。モデルパラメータ更新過程は、特徴量ベクトルを入力としてその特徴量ベクトルと部分モデルパラメータの内積値の累積に基づく目的関数が外部から与えられ、その目的関数を最大化するモデルパラメータを、上記初期化されたモデルパラメータを更新して求め、各音素に対応する部分モデルパラメータを出力する。【0009】  また、この発明の音素重み付き有限状態変換器生成方法は、初期状態設定過程と中間状態設定配列過程と最後状態設定過程とを含む。初期状態設定過程は、音素に対応する部分モデルパラメータを入力とし、当該音素と最初のフレームに対応するスコアを出力する初期状態を設定する。中間状態設定配列過程は、部分モデルパラメータを構成するモデルパラメータWp,iと入力特徴量ベクトルの内積として定義される関数をスコアとし、かつ、入力無しでスコア0を出力する状態遷移を持つ中間状態を設定して配列する。最後状態設定過程は、スコア0を出力する自己遷移状態とし、入力無しでスコア0を出力して終了状態に遷移する最後状態を設定する。【発明の効果】【0010】  この発明の音響モデルパラメータ学習方法によれば、音響モデルを言語モデルと同一の表現形式で表すことができるので、音声認識システム全体の最適化を容易にする。また、この発明の音素重み付き有限状態変換器生成方法によれば、その音響モデルパラメータ学習方法で作成した音響モデルを、重み付き有限状態変換器の形式で記述する。その音響モデルは、高速かつ高精度な音声認識を可能にする。【図面の簡単な説明】【0011】【図1】この発明の音響モデルパラメータ学習装置100の機能構成例を示す図。【図2】音響モデルパラメータ学習装置100の動作フローを示す図。【図3】モデルパラメータ更新部14の機能構成例を示す図。【図4】モデルパラメータ更新部14の動作フローを示す図。【図5】この発明の音素重み付き有限状態変換器生成装置200の機能構成例を示す図。【図6】音素重み付き有限状態変換器生成装置200の動作フローを示す図。【図7】音素重み付き有限状態変換器生成装置200で作成した状態遷移モデルの一例を示す図。【図8】音素重み付き有限状態変換器生成装置200で作成した状態遷移モデルを用いた音声認識装置300の簡単な機能構成を示す図。【図9】従来の音響モデルを用いた音声認識の探索空間の例を概念的に示す図。【発明を実施するための形態】【0012】  以下、この発明の実施の形態を図面を参照して説明する。複数の図面中同一のものには同じ参照符号を付し、説明は繰り返さない。実施例の説明の前に、この発明の音響モデルと言語モデルの全体最適化について説明する。【0013】〔音響モデルと言語モデルの全体最適化〕  音響モデルと言語モデルをそれぞれC,Lとおく。そしてこれらモデルパラメータそれぞれが支配する関数をMC,NLとおく。MCは音響スコアを返す関数、NLは言語スコアを返す関数である。【0014】  音響モデルと言語モデルの全体最適化を行う場合、事前に用意された目的関数O(MC,NL)を最大化するC,Lを求めることになる。例えば、勾配法などにより目的関数の傾きを考慮しながら最適なモデルパラメータを探索するものとすると、式(1)と式(2)を計算する必要がある。【0015】【数1】【0016】  MC,NLが全く異なる関数であるとすると、2種類のモデルを学習する必要がある。これが従来の音響モデルを統一的に扱えない原因である。【0017】  これに対し、もし、音響モデルと言語モデルとが線形分類モデルであるとすると、音声認識を行う過程で音響スコアと言語スコアを算出する関数は式(3)と式(4)で表せる。【0018】【数2】【0019】  ここでTは転置記号、A′は音響モデル学習に用いる特徴量ベクトル、A″は言語モデル学習に用いる特徴量ベクトルである。特徴量ベクトルA′とA″を並べた特徴量ベクトルをAと表記すると音声認識スコアはWTAである。WはCとLを並べたものに一致。【0020】  よって、音響モデルと言語モデルを統一した目的関数はO(WTA)と書けるので、モデルパラメータの学習装置を1個に集約することができる。【0021】  この発明は、本来複数の時間フレームにまたがって算出される特徴量ベクトルAを、フフレームごとに分割し、分割された特徴量ベクトルとモデルパラメータの内積値をフレームごとに累積する形にすることで、時系列に入力される特徴量ベクトルに対応したスコアを時系列に生成できるようにしたものである。【実施例1】【0022】  図1にこの発明の音響モデルパラメータ学習装置100の機能構成例を示す。図2にその動作フローを示す。音響モデルパラメータ学習装置100は、モデルパラメータ初期化部12と、モデルパラメータ更新部14と、を具備する。その各部の機能は、例えばROM、RAM、CPU等で構成されるコンピュータに所定のプログラムが読み込まれて、CPUがそのプログラムを実行することで実現されるものである。【0023】  モデルパラメータ初期化部12は、認識スコアを求めるモデルパラメータを初期化する(ステップS12)。モデルパラメータ更新部14は、特徴量ベクトルXt+nt+1を入力として目的関数OWを最大化するモデルパラメータを、モデルパラメータ初期化部12で初期化されたモデルパラメータを更新して求め、各音素pに対応する所定フレーム数から成る部分モデルパラメータを出力する(ステップS14)。Xt+nt+1の表記は、図中(図1)の表記が正しい。また、Xt+nt+1はt+1からt+nの各時間フレームで得られる特徴量ベクトルから構成される。これに対し、ある時刻tのフレームで得られる特徴量ベクトルはXtと表記する。【0024】  特徴量ベクトルXt+nt+1は、正解音素pの特徴量ベクトルXt+nt+1を記憶した正解データベース10から入力される。目的関数OWは、特徴ベクトルXt+nt+1とモデルパラメータの内積値の累積に基づく関数であり外部から与えられる。この構成によって、音響モデルパラメータ学習装置100は、言語モデルと同一の表現形式の音響モデルを生成する。【0025】〔線形分類モデル〕  線形分類モデルとは、式(5)に示す制約を満たす要素関数GWに基づく分類モデルである。【0026】【数3】【0027】  要素関数GWは、例えば式(6)や式(7)などが考えられる。【0028】【数3】【0029】  モデルパラメータ更新部14に与えられる目的関数OWは、要素関数GWを累積した形のものである。線形分類モデルの意味するところは、認識は式(5)の右辺に示す式で表される方法で行い、モデルの学習は目的関数OWを用いて行うことである。目的関数OWは、モデルパラメータWに対して非線形な関数を用いることができるので、線形な内積値WTpAを用いて学習を行うより高精度なモデルの生成が期待できる。【0030】  この発明では、特徴量ベクトルとモデルパラメータの内積値の累積(式(8))を計算し、これを音素pのスコアとする。【0031】【数4】【0032】  ここでnは、考慮すべき時間フレームを意味する。入力音素信号の時間フレーム数がt+nを超える場合は、t+n以降を無視することになる。よって、所定数nは十分に長く設定する。例えば、学習用データの最大値とする。式(8)では、入力音声信号の時間フレーム数がt+nを下回る場合は、入力長以降の特徴量ベクトルXt+nt+m+1をゼロベクトルと考えるものとする。t+m(<(t+n))は入力信号の最後のフレームに対応する。【0033】  学習により推定すべきモデルパラメータ全体は、式(9)で表せる。【0034】【数5】【0035】  所定数nは例えば20といった値に設定される。【0036】  図3にモデルパラメータ更新部14のより具体的な機能構成例を示し更に詳しくその動作を説明する。図4にその動作フローを示す。傾き算出手段140と、傾き評価手段142と、パラメータ更新手段144を備える。傾き算出手段140は、外部から与えられる偏微分関数に、特徴量ベクトルXt+nt+1と、パラメータ更新手段144で更新されるモデルパラメータを与えて目的関数OWの傾きを計算する(ステップS140)。【0037】  傾き評価手段142は、目的関数OWの傾きが単調増加して極値になるまで、パラメータの更新をパラメータ更新手段144に指示すると共に、現在のパラメータで計算した目的関数OWの傾きを求め、目的関数OWが収束したと判定されるまで、その動作を繰り返す(ステップS142〜S145のNoの繰り返しループ)。パラメータ更新手段144は、傾き評価手段142からの制御信号に基づいてパラメータを更新する(ステップS144)。傾きが極値になると(収束したと判定された場合を意味する)その時のパラメータを、モデルパラメータとして出力する(ステップS146)。【0038】  偏微分関数には、例えば式(10)に示す目的関数OWをWの各要素で偏微分した関数が用いられる。【0039】【数6】【0040】〔音素重み付き有限状態変換器生成装置〕  図5に、この発明の音素重み付き有限状態変換器生成装置200の機能構成例を示す。その動作フローを図6に示す。音素重み付き有限状態変換器生成装置200は、初期状態設定部20と、中間状態設定配列部22と、最後状態設定部24と、制御部26とを備える。【0041】  重み付き有限状態変換器とは、状態遷移機械のモデルとして広く知られる有限オートマトン(Finite Automaton)を入出力系列の変換用に拡張したものである。具体例は後述する。音素重み付き有限状態変換器生成装置200は、音響モデルパラメータ学習装置100が出力するモデルパラメータのうち、ある音素pに対応する部分モデルパラメータ{Wp,i｜1≦i≦n}(以降、{Wp,i}と略記)を入力として、その音素pの音素重み付き有限常態変換器を生成する。【0042】  制御部26は、入力された部分モデルパラメータ{Wp,i}を図示しないメモリなどに記憶する。そして、繰り返し変数iなどを初期化(i=1)する(ステップS260)。【0043】  初期化設定部20は、特徴量ベクトルを入力したときに、部分モデルパラメータ{Wp,i}の最初のモデルパラメータWp,1と入力特徴量ベクトルの内積として定義される関数を出力重みとし、音素pを出力記号とする状態遷移を設定する(ステップS20)。制御部26はiを更新する(ステップS261)。【0044】  中間状態設定配列部22は、iに対応させて、部分モデルパラメータ{Wp,i}を構成するモデルパラメータWp,iと入力特徴量ベクトルの内積として定義される関数を出力重みとし、かつ、出力信号を持たない(何も出力しないことを表す記号εを出力記号)とする状態遷移を設定する。前者は次状態に後者は終了状態に遷移する。この処理は、iが所定数n+1になるまで繰り返される(ステップS22〜S262のNoの繰り返しループ)。つまり、初期状態の後に、初期状態を含めてn個のモデルパラメータWp,iに対応する状態が配列される。  【0045】  最後状態設定部24は、所定数n+1個目の状態に、特徴量ベクトルを入力したときに0を重み出力とし、出力信号を持たない自己状態遷移を設定する(ステップS24)。【0046】  図7に、上記した過程を経て生成された重み付き有限状態変換器の一例を示す。図中のは状態を表し、1が初期状態であり、二重丸で表された状態は終了を意味する。κは変換器の入力として特徴量ベクトルが与えられたときに状態を遷移させる、μは必ず遷移させる、εは何も出力しないことを意味する記号である。【0047】  この重み付き状態遷移変換器で、特徴量ベクトルの各要素と対応するモデルパラメータとの内積演算を通してフレーム毎のスコアが算出される。【0048】  音素重み付き有限状態変換器生成装置200が生成した重み付き有限状態変換器を用いることで音声認識装置を構成することができる。図8に、重み付き有限状態を用いた音声認識装置300の簡単な機能構成例を示す。【0049】  音声認識装置300は、WFSTデータベース32と、音声認識部30を備える。WFSTデータベース32は、複数の音素の重み付き有限状態変換器を記憶する。音声認識部30は、特徴量ベクトルXt〜Xt+nを入力として、それを重み付き有限状態と演算してスコアを求め音声認識処理を実行する。  【0050】〔確認実験〕  この発明による線形分類モデルに基づく音響モデルの有用性を確認する目的で、従来のHMM音響モデルと性能比較を行った。実験は孤立音素認識で行った。孤立音素認識とは、音素の境界が与えられた下で、音素のラベルのみを判定する問題である。【0051】  学習データには、日本語話し言葉コーパス(CSJ)の学会講演150を用いた。この発明の音響モデルのモデルパラメータの推定のために高速なオンラインマージン最大化学習手法であるPAアルゴリズム(Passive Aggressive)を用いた。評価データは学会10講演分である。特徴量ベクトルには一般的なMFCC12次元+対数パワー+Δ+ΔΔ全39次元を用いた。【0052】  その結果は、従来のHMM音響モデルの正解率が60.1%に対して、この発明による音響モデルを用いた場合の正解率が59.9%と、ほぼ同等の正解精度を得ることができた。この結果から、この発明による音響モデルが従来のHMM音響モデルに取って代わる能力を備えていることが確認できた。【0053】  なお、上記装置における処理手段をコンピュータによって実現する場合、各装置が有すべき機能の処理内容はプログラムによって記述される。そして、このプログラムをコンピュータで実行することにより、各装置における処理手段がコンピュータ上で実現される。【0054】  この処理内容を記述したプログラムは、コンピュータで読み取り可能な記録媒体に記録しておくことができる。コンピュータで読み取り可能な記録媒体としては、例えば、磁気記録装置、光ディスク、光磁気記録媒体、半導体メモリ等どのようなものでもよい。具体的には、例えば、磁気記録装置として、ハードディスク装置、フレキシブルディスク、磁気テープ等を、光ディスクとして、DVD(Digital Versatile Disc)、DVD−RAM(Random Access Memory)、CD−ROM(Compact Disc Read Only Memory)、CD−R(Recordable)/RW(ReWritable)等を、光磁気記録媒体として、MO(Magneto Optical disc)等を、半導体メモリとしてEEP−ROM(Electronically Erasable and Programmable-Read Only Memory)等を用いることができる。【0055】  また、このプログラムの流通は、例えば、そのプログラムを記録したDVD、CD−ROM等の可搬型記録媒体を販売、譲渡、貸与等することによって行う。さらに、このプログラムをサーバコンピュータの記録装置に格納しておき、ネットワークを介して、サーバコンピュータから他のコンピュータにそのプログラムを転送することにより、このプログラムを流通させる構成としてもよい。【0056】  また、各装置の機能構成部は、コンピュータ上で所定のプログラムを実行させることにより構成することにしてもよいし、これらの処理内容の少なくとも一部をハードウェア的に実現することとしても良い。
【特許請求の範囲】【請求項1】  モデルパラメータ初期化部が、認識スコアを求めるための各音素に対応する所定フレーム数から成る部分モデルパラメータを初期化するモデルパラメータ初期化過程と、  音素の特徴量ベクトルを入力としてその特徴量ベクトルとモデルパラメータの内積値の累積に基づく目的関数が外部から与えられ、その目的関数を最大化するモデルパラメータを、上記初期化されたモデルパラメータを更新して求め、各音素に対応する部分モデルパラメータを出力するモデルパラメータ更新過程と、  を含む音響モデルパラメータ学習方法。【請求項2】  請求項1に記載の音響モデルパラメータ学習方法において、  上記モデルパラメータ更新過程は、  目的関数の偏微分関数が外部から与えられ、特徴量ベクトルと、更新されるモデルパラメータとに基づく上記目的関数の傾きを算出する傾き算出ステップと、  上記目的関数の傾きが単調増加して極値となるまで上記目的関数の傾きを評価して各音素に対応する所定フレーム数から成る部分モデルパラメータを出力する傾き評価ステップと、  上記傾き評価ステップの評価結果を基に上記モデルパラメータを更新するパラメータ更新ステップと、  を含むことを特徴とする音響モデルパラメータ学習方法。                    【請求項3】  初期状態設定部が、音素に対応する所定フレーム数から成る部分モデルパラメータを入力とし、当該音素と最初のフレームに対応するスコアを出力する初期状態を設定する初期状態設定過程と、  中間状態設定配列部が、上記部分モデルパラメータを構成するモデルパラメータWp,iと入力特徴量ベクトルの内積として定義される関数をスコアとし、かつ、入力無しでスコア0を出力する状態遷移を持つ中間状態を設定して配列する中間状態設定配列過程と、  最後状態設定部が、スコア0を出力する自己遷移状態とし、入力無しでスコア0を出力して終了状態に遷移する最後状態設定過程と、  を含む音素重み付き有限状態変換器生成方法。【請求項4】  認識スコアを求めるための各音素に対応する所定フレーム数から成る部分モデルパラメータを初期化するモデルパラメータ初期化部と、  音素の特徴量ベクトルを入力とし、その特徴量ベクトルとモデルパラメータの内積値の累積に基づく目的関数が外部から与えられ、その目的関数を最大化するモデルパラメータを、上記初期化されたモデルパラメータを更新して求め、各音素に対応する部分モデルパラメータを出力するモデルパラメータ更新部と、  を具備する音響モデルパラメータ学習装置。【請求項5】  請求項4に記載の音響モデルパラメータ学習装置において、  上記モデルパラメータ更新部は、  目的関数の偏微分関数が外部から与えられ、特徴量ベクトルと、更新されるモデルパラメータとに基づく上記目的関数の傾きを算出する傾き算出手段と、  上記目的関数の傾きが単調増加して極値となるまで上記目的関数の傾きを評価して各音素に対応する所定フレーム数から成る部分モデルパラメータを出力する傾き評価手段と、  上記傾き評価ステップの評価結果を基に上記モデルパラメータを更新するパラメータ更新手段と、  を備えることを特徴とする音響モデルパラメータ学習装置。【請求項6】  音素に対応する所定フレーム数から成る部分モデルパラメータを入力とし、  当該音素と最初のフレームに対応するスコアを出力する初期状態を設定する初期状態設定部と、  上記部分モデルパラメータを構成するモデルパラメータWp,iと入力特徴量ベクトルの内積として定義される関数をスコアとし、かつ、入力無しでスコア0を出力する状態遷移を持つ中間状態を設定して配列する中間状態設定配列部と、  スコア0を出力する自己遷移状態とし、入力無しでスコア0を出力して終了状態に遷移する最後状態設定部と、  を具備する音素重み付き有限状態変換器生成装置。【請求項7】  請求項4乃至7のいずれか1項に記載した音響モデルパラメータ学習装置の各部の機能、または音素重み付き有限状態変換器生成装置の各部の機能を、コンピュータに実行させるための装置プログラム。
線形分類モデルに基づく音響モデルパラメータ学習方法とその装置、音素重み付き有限状態変換器生成方法とその装置、それらのプログラム
