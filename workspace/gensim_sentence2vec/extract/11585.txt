【課題】WFSTを用いたネットワーク表現を利用した音声認識パラメータの最適化を図る。【解決手段】本発明の音声認識装置は、記録部、WFST合成部、特徴量抽出部、WFST型ログリニアデコーダ、出力シンボル抽出部を備える。記録部は、発音辞書モデルと言語モデルと音響モデルと重みベクトルαとを記録する。WFST合成部は、発音辞書モデルと言語モデルと音響モデルを合成し、WFSTネットワークを出力する。WFST型ログリニアデコーダは、特徴量ベクトルの時系列が与えられたときの対数領域でのアーク系列AのスコアW(X,A)を、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と、重みベクトルαとの線形表現で表現し、最もスコアの高いアーク系列を出力する。出力シンボル抽出部は、アーク系列に対する単語系列を求め、出力する。
【発明の詳細な説明】【技術分野】【0001】  本発明は、音声認識装置と音声認識方法、音声認識装置または音声認識方法に用いる重みベクトルを学習するための重みベクトル学習装置と重みベクトル学習方法、およびこれらの装置としてコンピュータを動作させるプログラムに関する。【背景技術】【0002】  音声認識装置は、音声データX(多くの場合はMFCC(Mel-Frequency Cepstrum Coefficient)などのD次元特徴量ベクトルの時系列X=｛x1,x2,…,xt,…｜xt∈RD｝)を入力として、単語や音素などの単語系列yを出力する装置として考えることができる。現在の確率統計的音声認識装置はこれらの問題を確率論的に解釈し、音声データXが与えられた際に、単語系列yが出力される確率分布p(y｜X)に対して、確率値が最大となる単語系列y−を次のようにして求める問題に帰着させる。【0003】【数1】【0004】ここで、確率分布p(y｜X)は大量の学習データから、統計的に推定する。確率分布p(y｜X)はあらゆる単語系列yとそれに相当する音声データXを用意すれば、原理的に求めることが可能である。しかし一般にそれらのデータを集めるのは困難であるため、次のように式(1)の確率分布を音響モデル、発音辞書モデル、言語モデルと分解するのが一般的である。【0005】【数2】【0006】ここで、sは音素系列もしくは隠れマルコフモデル(HMM)の状態系列である。つまり、確率分布p(y｜X)を直接求めるのではなく、分解された分布である音響モデル、発音辞書モデル、言語モデルを個別に学習し、音声認識をする際には式(2)を用いてそれぞれを合成した上で、認識を行う。【0007】  図1は、従来の音声認識装置の機能構成例を示す図である。音声認識装置900は、特徴量抽出部910、単語列探索部920、記録部990を備える。記録部990には、発音辞書モデル、言語モデル、音響モデルが記録されている。特徴量抽出部910は、音声データを特徴量ベクトルの時系列に変換する。単語列探索部920は、音響モデル・発音辞書モデル・言語モデルを組み合わせたネットワークにおいて、p(X｜s)p(s｜y)p(y)によって与えられるスコアを算出し、スコアが最大となる単語系列を探索し、その単語系列を認識結果として出力する。単語列探索部920は、デコーダと呼ばれることもある。単語列探索部920は、モデルの合成、スコアの算出、単語系列探索を一手に担う。音響モデルp(X｜s)は、音素ラベルと音声データから求めることができる。発音辞書モデルp(s｜y)は、発音辞書から与えられる。言語モデルp(y)は大量のコーパスから学習すればよい。【0008】  図1に示した音声認識装置900では、音声データが与えられた際の単語系列の出力確率p(y｜X)をダイレクトに求めるのではなく、それを近似的に音響モデルp(X｜s)・発音辞書モデルp(s｜y)・言語モデルp(y)に分解して、それぞれのモデルパラメータを最適化する。例えば非特許文献1は識別的に音響モデルを、非特許文献2は識別的に言語モデルを最適化している。【0009】  また、非特許文献3、4では、WFST(重み付有限状態トランスデューサ)を利用した音声認識デコーダ(WFST型デコーダ)が示されている。WFST型デコーダでは、図1の通常のデコーダ(単語列探索部920)のように、音響モデル・発音辞書モデル・言語モデルの合成を行うのではなく、そのような複雑なネットワークの合成および冗長なアークの除去などのネットワークの最適化をWFST合成部で行い、WFSTネットワークを出力する。WFST型デコーダを用いた音声認識装置では、WFSTネットワークと音声データから、スコアの最も高い単語系列を出力する。図2は、WFST型デコーダを用いた音声認識装置の機能構成例を示す図である。音声認識装置800は、特徴量抽出部910、WFST型デコーダ820、WFST合成部830、出力シンボル抽出部840、記録部890を備える。記録部890には、発音辞書モデル、言語モデル、音響モデルが記録されている。WFST合成部830は、音響モデル内のHMMネットワークH、音響モデル内のトライフォンなどの音素コンテクストネットワークC、発音辞書モデル内のネットワークL、言語モデル内のn−gramネットワークGを合成し、WFSTネットワークRを出力し、記録部890に記録する。WFSTの枠組みにおいては、これらのそれぞれのネットワークを合成し、かつネットワークに対して最適化を行う演算が用意されている。例えば、WFSTネットワークRは下記のような合成演算であらわすことができる。【0010】【数3】【0011】ここで、はWFSTの合成演算を表わす。実際には、WFST合成演算のみでは冗長なアークが多数生成されてしまう。そのため、WFST合成部830は、決定化や最小化などのWFST演算によってネットワークに対する最適化を行う。WFSTの利点は上記の合成演算のみならず、決定化や最小化などのオートマトン理論に基づく様々なアルゴリズムが存在するため、容易にネットワークの最適化が可能な点である(非特許文献3,4参照)。本明細書内ではこのような合成及びネットワーク最適化等の操作を行うモジュールを総称してWFST合成部と呼ぶ。【0012】  特徴量抽出部910は、音声データを特徴量ベクトルの時系列に変換する。WFST型デコーダ820は、WFSTネットワーク内の経路に注目する。ここで、ある経路は、アークの系列で表現される(つまり、M個のアーク系列はA=｛a1,…,am,…,aM｝で表現される)。このときm番目のアークamには以下のような情報が付随する。【0013】【数4】【0014】例えば、入力シンボルと出力シンボルは、それぞれHMMの状態ID、単語(音素認識などの場合は音素)IDとなる。WFSTネットワークにファクトライズ演算が施された場合は、入力・出力シンボルが単一のIDではなくIDの系列で表現される場合もある。WFST型デコーダでは、式(2)で表現される複雑な階層構造での探索問題を考えるのではなく、アーク系列Aの探索問題として考える。このとき、探索問題は音声認識用WFSTネットワークRに含まれるあらゆるアーク系列の候補の中から最適な(スコアの高い)アーク系列A−=｛a1−,…,am−,…,aM−｝を求める問題に帰着される。【0015】【数5】【0016】そして、出力シンボル抽出部840が、アークの付随情報を用いて次のように単語系列y−を求める。【0017】【数6】【0018】式(5)のw(X,A)は対数領域でのアークごとの重み係数であり、HMMの場合は以下のように計算される。【0019】【数7】【0020】ここで、g(xt,i［am］)はHMM状態i［am］と音声データxtが与えられた上でのフレームtでの音響スコア(音響モデルから計算可能)である。ちなみに、もし入力シンボルi［am］が何もない場合(イプシロンシンボルが割り当てられる)、gは0を返す。γは言語スコアと音響スコアを調節するスケーリングパラメータである。b(am)とe(am)はamにどのフレームの特徴量ベクトルが属するかを示す割り当て情報であり、それぞれ開始時刻と終了時刻をあらわす。この割り当て情報も実際にはWFST型デコーダ820の探索過程(式(5))で選ばれる。【先行技術文献】【非特許文献】【0021】【非特許文献1】D. Povey and P. C. Woodland, Minimum phone error and I-smoothing for improved discriminative training, In Proc. ICASSP02, Vol. 1, pp. 13-17, 2002.【非特許文献2】B. Roark, M. Saraclar, M. Collins, and M. Johnson, Discriminative language modeling with conditional random fields and the perceptron algorithm, In Proc. ACL04, 2004.【非特許文献3】M. Mohri, F. Pereira, and M. Riley, Weighted finite-state transducers in speech recognition, In Proc. ASR2000, pp. 97-106, 2000.【非特許文献4】T. Hori, C. Hori, Y. Minami, and A. Nakamura, Efficient WFST-based one-pass decoding with on-the-fly hypothesis rescoring in extremely large vocabulary continuous speech recognition, IEEE Transactions on Audio, Speech, and Language Processing, Vol. 15, No. 4, pp. 1352-1365, 2007.【発明の概要】【発明が解決しようとする課題】【0022】  図1に示した音声認識装置900では、単語系列の出力確率p(y｜X)を近似的に音響モデルp(X｜s)・発音辞書モデルp(s｜y)・言語モデルp(y)に分解して、それぞれのモデルパラメータを最適化する。したがって、部分的な最適化に留まり、単語列探索部920が扱う各モデルが合成されたモデルを直接最適化しているわけではない。よって、この方法では、音声認識装置全体の性能を高める最適化が行われていない。非特許文献1は識別的に音響モデルを、非特許文献2は識別的に言語モデルを最適化しているが、両手法とも各モデルが合成されたモデルを直接最適化してはいない。また、合成されたモデルの直接最適化するという問題に対しても、実際に合成されたモデルは非常に大規模なネットワークとなる。したがって、膨大なネットワークを如何に効率よく表現し、適切に学習を行うかというのが重要な課題である。【0023】  一方、図2に示した音声認識装置800では、従来の音響モデル・発音辞書モデル・言語モデルが合成されたWFSTネットワークRでのアーク系列を一つの経路とした最適経路探索問題として音声認識の探索問題を置き換えるアプローチである。その際、式(7)で示したスコアを用いることにより、従来の音声認識と同様に扱うことができる。つまり、音声認識装置800のメリットの一つは従来階層的に表現されていた音響モデル・発音辞書モデル・言語モデルを、それぞれのネットワークを合成した単一のネットワークで表現できることである。しかし、WFSTネットワーク表現を利用し、音響・発音辞書・言語情報を十分に考慮した音声認識パラメータの最適化は従来実現されていなかった。【0024】  そこで、本発明では、WFSTを用いたネットワーク表現を利用した音声認識パラメータの最適化を目的とする。【課題を解決するための手段】【0025】  本発明の音声認識装置は、記録部、WFST合成部、特徴量抽出部、WFST型ログリニアデコーダ、出力シンボル抽出部を備える。記録部は、発音辞書モデルと言語モデルと音響モデルと重みベクトルαとを記録する。WFST合成部は、発音辞書モデルと言語モデルと音響モデルを合成し、WFSTネットワークを出力する。特徴量抽出部は、音声データから特徴量を抽出し、特徴量ベクトルの時系列Xを出力する。WFST型ログリニアデコーダは、特徴量ベクトルの時系列が与えられたときの対数領域でのアーク系列AのスコアW(X,A)を、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と、重みベクトルαとの線形表現で表現し、最もスコアの高いアーク系列を出力する。出力シンボル抽出部は、アーク系列に対する単語系列を求め、出力する。なお、重みベクトルαは、あらかじめ定めた数の学習データを用いてアーク系列Aと素性ベクトルφ(X,A)のペアを蓄積し、蓄積した結果から推定したものである。【0026】  本発明の重みベクトル学習装置は、あらかじめ定めた数の正解単語系列と対応する特徴量ベクトルの時系列Xを入力される学習データとし、学習記録部、仮説WFST型ログリニアデコーダ、正解WFST合成部、正解WFST型ログリニアデコーダ、パラメータ更新部を備える。学習記録部は、あらかじめ定められたWFSTネットワークと重みベクトルαとを記録する。仮説WFST型ログリニアデコーダは、WFSTネットワークを用いて、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と最もスコアの高い正解アーク系列Aを、仮説素性ベクトルφ(X,A−)、仮説アーク系列A−として出力する。正解WFST合成部は、WFSTネットワークと単語系列を合成し、正解アーク系列A＾を出力する正解WFSTネットワークを出力する。正解WFST型ログリニアデコーダは、正解WFSTネットワークを用いて、特徴量ベクトルの時系列Xと正解アーク系列A＾から得られる正解素性ベクトルφ(X,A＾)と、最もスコアの高い正解アーク系列A＾を出力する。パラメータ更新部は、仮説WFST型ログリニアデコーダが出力した仮説アーク系列A−に対する単語系列が正解単語系列と異なる場合に、重みベクトルαを、正解素性ベクトルφ(X,A＾)と仮説素性ベクトルφ(X,A−)を用いて更新する。【発明の効果】【0027】  本発明では、WFSTネットワークの各アークに依存するモデルパラメータをシンプルな対数線形モデル(ログリニアモデル)を用いる。したがって、本発明の音声認識装置は、膨大なネットワーク中のパラメータを効率よく推定できる。また、本発明の重みベクトル学習装置は、適した重みベクトルを学習できる。【図面の簡単な説明】【0028】【図1】従来の音声認識装置の機能構成例を示す図。【図2】従来のWFST型デコーダを用いた音声認識装置の機能構成例を示す図。【図3】実施例1の音声認識装置の機能構成例を示す図。【図4】実施例1の音声認識装置の処理フローを示す図。【図5】実施例1変形例の音声認識装置の機能構成例を示す図。【図6】重みベクトルの学習の処理フローを示す図。【図7】重みベクトルを更新する処理で使用される情報とそれらの情報の流れを付加した実施例2の重みベクトル学習装置の機能構成例を示す図。【図8】重みベクトルを平均化する処理で使用される情報とそれらの情報の流れを付加した実施例2の重みベクトル学習装置の機能構成例を示す図。【図9】重みベクトル学習装置の処理フローを示す図。【図10】効果を確認する実験の条件を示す図。【図11】音素コンテクスト非依存HMM(CI)による実験結果を示す図。【図12】音素コンテクスト依存HMM(CD)による実験結果を示す図。【発明を実施するための形態】【0029】  以下、本発明の実施の形態について、詳細に説明する。なお、同じ機能を有する構成部には同じ番号を付し、重複説明を省略する。【実施例1】【0030】  実施例1の音声認識装置の機能構成例を図3に、実施例1の音声認識装置の処理フローを図4に示す。図4(A)は、WFSTネットワークを合成する処理フローを、図4(B)は音声認識の処理フローを示している。音声認識装置100は、記録部190、WFST合成部830、特徴量抽出部910、WFST型ログリニアデコーダ120、出力シンボル抽出部840を備える。記録部190は、あらかじめ発音辞書モデルと言語モデルと音響モデルと重みベクトルαとを記録している。WFST合成部830は、記録部190に記録されている発音辞書モデルと言語モデルと音響モデルを合成し、WFSTネットワークを出力し、記録部190に記録する(S830)。音声認識フローでは、まず、特徴量抽出部910が、音声データから特徴量を抽出し、特徴量ベクトルの時系列Xを出力する(S910)。次に、WFST型ログリニアデコーダ120は、特徴量ベクトルの時系列が与えられたときの対数領域でのアーク系列AのスコアW(X,A)を、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と、重みベクトルαとの線形表現で表現し、最もスコアの高いアーク系列を出力する(S120)。出力シンボル抽出部840は、アーク系列に対するシンボル系列(単語系列)を求め、出力する(S840)。なお、重みベクトルαは、あらかじめ定めた数の学習データを用いてアーク系列Aと素性ベクトルφ(X,A)のペアを蓄積し、蓄積した結果から推定したものである。【0031】WFST型ログリニアデコーダ120の原理  次に、WFST型ログリニアデコーダ120の原理について説明する。本発明では、式(7)に示されたスコア計算式を、次式のようにベクトル同士の内積で表現する。【0032】【数8】【0033】ここで、φ(X,am)は音声データXとアークamにより得られる素性ベクトル、αamはアークamの重みベクトルであり、学習データから推定可能である。学習データXからアークamの重みベクトルを推定する方法の例としては、後述の平均化パーセプトロンアルゴリズムなどがある。本発明では、このように対数領域でのスコアを素性ベクトルの線形表現であらわすモデル(ログリニアモデルと呼ぶ)を用いる。つまり,本発明のWFSTでは、アークに付随する重みh(式(4))をスカラーで表現するのではなく、変わりにαamを与える。ちなみに、【0034】【数9】【0035】と設定したときに、W(X,am)は式(7)のw(X,am)になることから、式(8)は従来のWFST型デコーダで用いられるスコア(式(7))の一般表現と考えることもできる。素性ベクトルに関しては、音響・発音辞書・言語モデルから様々なものを与えることができる。またはリッチトランスクリプションと総称される、音声データに付随する単語系列以外の話者情報や感情情報・環境情報などの様々なトランスクリプション情報を素性ベクトルに加えることができる。例えば、次のシンプルな素性ベクトルを用いればよい。【0036】【数10】【0037】ここで、右辺第1行は従来の音響スコア(たとえば、HMMに対するフォワードアルゴリズムで算出した音響スコア)、第2行は割り当てられたフレーム数、第3行は割り当てられた音声データ(特徴量ベクトル)の和である。この素性表現は非常にシンプルであるが(例えば、特徴量ベクトル次元を39としたときには、アークごとに41次元のベクトル)、アーク数が大変膨大になるため、全ての素性ベクトルの次元は音響モデルや言語モデルの総パラメータ数を時には上回るほど膨大な数に上る。このようにして、本発明で提案するログリニアモデルは従来の音響モデルや言語モデル以上の表現力を持つ。【0038】  このログリニアモデルを用いることにより、経路Aに対する総スコアW(X,A)はアーク系列の和から、アークIDごとの和に書き換えることができる。【0039】【数11】【0040】ここで、KはWFSTネットワーク内のアークの総数であり、k番目のアークakに対して、素性ベクトルφk(X,A)を次のように定義する。【0041】【数12】【0042】ここで、δam,kはクロネッカーのデルタ関数であり、am=kのとき1を、それ以外のとき0を返す。さらに、素性ベクトルφ(X,A)と重みベクトルαを、  φ(X,A)=(φ1(X,A),φ2(X,A),…,φK(X,A))T  α=(α1,α2,…,αK)Tとし、アークIDごとの素性・重みベクトルを連結させると、音声データXが与えられた際の経路Aに対するスコアW(X,A)は次のように重みベクトルと素性ベクトルの内積で表現される。【0043】  W(X,A)=φ(X,A)・α          (12)つまり、図3のWFST型ログリニアデコーダ120の対数領域でのアーク系列AのスコアW(X,A)を、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と、重みベクトルαとの線形表現で表現するとは、例えば式(12)の表現である。【0044】  このように本発明の音声認識装置では、ある仮説が与えられた上での認識過程を高次元重みベクトルと高次元素性ベクトルの内積で表現することができる。本発明の音声認識装置はこの表現を用いるので、膨大なネットワーク中のパラメータを効率よく推定できる。また、この表現は重みベクトルのαの推定の際に便利な表現である。したがって、重みベクトルの学習でも容易に、適した重みベクトルを学習できる。【0045】［変形例］  図5は、重みベクトル学習装置を備えた音声認識装置の機能構成を示す図であり、図6は重みベクトルの学習の処理フローを示している。音声認識装置200は、重みベクトル学習装置300も備えており、その他の構成は音声認識装置100と同じである。本発明の場合、従来のWFSTネットワークのアークに付随する情報(式(4))において、重みwをベクトル表現に拡張する必要がある。また、WFST型のデコーディングのみを目的とする場合は、WFSTネットワークのアークにID情報を付与しないのが通常である。そこで、本発明の重みベクトル学習装置300は、アークIDをWFSTネットワークのアークに埋め込む。したがって、重みベクトル学習装置300は、アーク系列Aごとに素性ベクトルφ(X,A)を蓄積し、重みベクトルαをN個の学習データ｛(X1,y1),…,(XN,yN)｝を用いて推定する(S300)。ここで、Xnはn番目の特徴量ベクトルの時系列、ynはn番目のシンボル系列(単語系列)を示している。本変形例の音声認識装置は、このような構成なので、実施例1と同様の効果が得られる。【0046】  なお、重みベクトル学習装置300を音声認識装置の外部に備え、学習結果である重みベクトルαのデータのみを音声認識装置の記録部に記録してもよい(このように配置した場合が実施例1の音声認識装置100になる)。【実施例2】【0047】  本実施例では、重みベクトル学習について詳細に説明する。本実施例では、まず、原理の説明を行う。重みベクトルの推定は、最尤法や識別学習法、最急降下法などの様々な最適化アプローチが存在する。本実施例では、近年系列データを対象にしたログリニアモデルの学習問題としてよく用いられる平均化パーセプトロンアルゴリズムを例にして説明を行う。n番目の学習サンプル(音声データXnと対応する正解シンボル系列ynが与えられる)に注目したとき、WFSTネットワークR内の最適仮説y−nは次のようなWFST型デコーダによって得ることができる。【0048】【数13】【0049】ここで、a−nは仮説アーク系列である。本発明における平均化パーセプトロンでは、正解単語系列(正解シンボル系列)ynを出力するアーク系列を求める必要がある。これを正解アーク系列a＾nと呼ぶ。正解アーク系列を得るために、正解アーク系列を出力することが可能なアクセプター型のWFSTネットワークYnを用意する。そのとき、正解アーク系列は次のように求めることができる。【0050】【数14】【0051】ここで合成されたネットワーク内のアークのインデックスは、音声認識用WFSTネットワークのインデックスと同じものが付与される。このとき、もしXnが誤って認識されたすなわちyn≠y−nの場合に、重みベクトルαnを以下の式でαn+1に更新する。【0052】【数15】【0053】これは一般的なパーセプトロンによる更新式であり、ρは学習係数である。式(15)の更新式は全ての学習データ(N個の学習データ)に対して行われ、更にそれらの手続きが反復的に実行される(例えば、J回反復される。なお、Jはあらかじめ定めた数とする)。平均化パーセプトロンでは、次のような学習データごと、反復計算のステップごとに得られる全ての重みベクトルαn,jを、次のように平均化することにより得られる。【0054】【数16】【0055】ここで、jは反復計算における各ステップをあらわす指標であり、Jは反復の回数である。【0056】  次に、重みベクトル学習装置の具体例について説明する。図7と図8は重みベクトル学習装置の機能構成例を、図9は重みベクトル学習装置の処理フローを示している。なお、図7は、重みベクトルを更新する処理で使用される情報とそれらの情報の流れを付加した図である。図8は、重みベクトルを平均化する処理で使用される情報とそれらの情報の流れを付加した図である。【0057】  重みベクトル学習装置300は、N個の正解単語系列と対応する特徴量ベクトルの時系列を入力される学習データ｛(X1,y1),…,(XN,yN)｝とし、学習記録部390、仮説WFST型ログリニアデコーダ325、正解WFST合成部330、正解WFST型ログリニアデコーダ320、パラメータ更新部350、重みベクトル平均化部360を備える。学習記録部390は、あらかじめ定められたWFSTネットワークと重みベクトルα(重みベクトルαの初期状態)とを記録しておく。初期状態となる重みベクトルが特にない場合には、最初の重みベクトルとしてα1=(0,0,…,0)のように、アークの総数Kのすべてに対して重みを0としておいてもよい。【0058】  重みベクトル学習装置300は、n(学習データの順番を示す1〜Nの整数)に1を、j(現在の処理が何回目の繰返しかを示す1〜Jの整数、Jは学習の繰返し回数)に1を代入する(S301)。そして、重みベクトル学習装置300は、n番目の単語系列ynと特徴量ベクトルの時系列Xnとを入力データとする(S302)。仮説WFST型ログリニアデコーダ325は、WFSTネットワークを用いて、特徴量ベクトルの時系列Xnとアーク系列Aから得られる素性ベクトルφ(Xn,A)と最もスコアの高い正解アーク系列Aを、仮説素性ベクトルφ(Xn,A−n)、仮説アーク系列A−nとして出力し、学習記録部390に記録する(S325)。例えば、式(13)のように仮説アーク系列A−nを求めればよい。【0059】  正解WFST合成部330は、WFSTネットワークと単語系列ynを合成し、正解アーク系列A＾を出力する正解WFSTネットワークを出力する(S330)。正解WFST型ログリニアデコーダ320は、正解WFSTネットワークを用いて、特徴量ベクトルの時系列Xと正解アーク系列A＾nから得られる正解素性ベクトルφ(Xn,A＾n)と、最もスコアの高い正解アーク系列A＾nを出力し、学習記録部390に記録する(S320)。例えば、式(14)のように正解アーク系列A＾nを求めればよい。【0060】  パラメータ更新部350は、仮説WFST型ログリニアデコーダ325が出力した仮説アーク系列A−nに対する単語系列y−nが正解単語系列ynと異なる場合に、重みベクトルαn,jを、正解素性ベクトルφ(Xn,A＾n)と仮説素性ベクトルφ(X,A−n)を用いて更新し、重みベクトルαn+1,jを得る(S350)。例えば、式(15)のように重みベクトルαn+1,jを求めればよい。重みベクトル学習装置300は、n=N−1かを確認し(S303)、Noの場合にはnの値に1を加え(S306)、ステップS302に戻る。ステップS303がYesの場合には、j=Jかを確認し(S304)、Noの場合には重みベクトルαN,jを重みベクトルα1,j+1とし(S307)、nに1を代入し、jの値に1を加え(S308)、ステップS302に戻る。ステップS304がYesの場合には、重みベクトル更新手段305の処理を終了し、ステップS360に進む。【0061】  重みベクトル平均化部360は、学習データごと、反復計算のステップごとに得られる全ての重みベクトルαn,jを、式(16)のように平均化し、学習記録部390に記録する(S360)。【0062】  実施例1で説明したように、本発明の音声認識装置では、ある仮説が与えられた上での認識過程を高次元重みベクトルと高次元素性ベクトルの内積で表現することができる。この表現は重みベクトルのαの推定の際に便利な表現である。したがって、重みベクトル学習装置は、容易に適した重みベクトルを学習できる。【0063】効果の確認  本発明の音声認識装置は、従来のモデルでは表現できないコンテクストや単語モデルなどが表現でき、全体最適化ができる。以下では連続音素認識実験を使って本発明の効果を検証する。TIMIT連続音素認識実験では、音素音響モデルと音素言語モデル(音素バイグラム)モデルを用いた。この場合、WFST型デコーダは音素音響モデルと音素言語モデルを合成したネットワークの探索問題を扱うことになる。本発明では従来法として、音素音響モデルと音素言語モデル各々を学習データから個別に求める従来法と、それらが合成されたネットワーク上でのモデルを学習データにより求める本発明との比較を行う。合成されたネットワークにおいては、音素バイグラムの制約から、音素コンテクスト表現が内包されており、従来法に比べてより精細なモデルを構築していると期待される。【0064】  実験条件を図10に示す。音声データの特徴量ベクトルは12次元MFCC(Mel-Frequency Cepstrum Coefficient)と対数パワー、それらの1階差分Δ、2階差分値からなる39次元ベクトルを用いた。音響モデルはleft to right 型HMMを用い、時間軸方向の状態数は音素ごとに3状態とした。音素カテゴリー数は48個であり、音素誤り率を計算する際には48カテゴリーを39カテゴリーに縮約した。言語モデルは音素バイグラムを用いた。【0065】  学習データは3,696発話からなり、評価データは192発話である。HMM内のガウス分布の共分散行列は対角行列(diag.)もしくは非対角要素も考慮した通常の全共分散行列(full)の2種類を用意し、それぞれ混合数を1,2,4,8,16,32混合としてモデルを構築し実験を行った。音素コンテクスト非依存HMM(CI)及び音素コンテクスト依存HMM(CD)による実験結果をそれぞれ図11及び図12に示す。本発明(DM)の比較として、従来アプローチで音響モデルに対する最尤学習(ML)法、識別学習法(誤り最小化学習(MCE:E. McDermott and S. Katagiri, String-level MCE for continuous phoneme recognition, In Proc. Eurospeech, pp. 123-126, 1997.)、マージン最大化学習(LM:F. Sha and L. K. Saul, Comparison of large margin training to other discriminative methods for phonetic recognition by hidden Markov models, In ICASSP07, Vol. 4, pp. 313-316, 2007.)を用いた。なお、図11の実験結果は、各混合数(n mix.)、共分散行列が対角行列(diag.)か通常の行列(Full)の場合の本発明(DM)と最尤学習法(ML)、識別学習法(誤り最小化学習(MCE)、マージン最大化学習(LM))との音素誤り率による比較を示している。図11の実験においては、音響モデルは音素コンテクスト非依存モデルである。図12の実験結果は、各混合数(n mix.)、共分散行列が対角行列(diag.)か通常の行列(Full)の場合の本発明(DM)と最尤学習法(ML)の音素誤り率による比較を示している。図12の実験においては、音響モデルは音素コンテクスト依存モデルである。なお本発明(DM)に必要な素性ベクトルの要素である音響スコアは、最尤学習法(ML)によって得られた音響モデルから算出した。従って本発明(DM)の図11、図12における認識性能は、混合数・共分散行列の種類・コンテクスト依存性等の各実験条件により得られるML音響モデルの音響スコアを用いて本発明(DM)を実施した際の性能である。実験結果より、モデルの複雑度が小さい(混合数が少ない、コンテクスト非依存、対角表分散行列)の場合は、顕著に本発明が従来法を上回っているのがわかる。例えば、本実験中で最もモデルの複雑度が小さい音素コンテクスト非依存(CI)、対角共分散(Diag.)、1混合(1mix.)モデルの場合、MLと比較して最大で5.8%、識別学習法と比べても3%の改善効果が得られているのがわかる。本発明は認識ネットワーク全体の最適化を考慮することによって表現力が向上しているといえる。【0066】  また、モデルの複雑度が増すごとに提案法との差分が小さくなるという結果も、従来法の表現力が向上し、本発明とのモデル表現力における差が小さくなるという考察から道理的な結果であるといえる。【0067】プログラム  上述の構成をコンピュータによって実現する場合、各装置が有すべき機能の処理内容はプログラムによって記述される。そして、このプログラムをコンピュータで実行することにより、上記処理機能がコンピュータ上で実現される。【0068】  この処理内容を記述したプログラムは、コンピュータで読み取り可能な記録媒体に記録しておくことができる。コンピュータで読み取り可能な記録媒体としては、例えば、磁気記録装置、光ディスク、光磁気記録媒体、半導体メモリ等どのようなものでもよい。【0069】  また、このプログラムの流通は、例えば、そのプログラムを記録したDVD、CD−ROM等の可搬型記録媒体を販売、譲渡、貸与等することによって行う。さらに、このプログラムをサーバコンピュータの記憶装置に格納しておき、ネットワークを介して、サーバコンピュータから他のコンピュータにそのプログラムを転送することにより、このプログラムを流通させる構成としてもよい。【0070】  このようなプログラムを実行するコンピュータは、例えば、まず、可搬型記録媒体に記録されたプログラムもしくはサーバコンピュータから転送されたプログラムを、一旦、自己の記憶装置に格納する。そして、処理の実行時、このコンピュータは、自己の記録媒体に格納されたプログラムを読み取り、読み取ったプログラムに従った処理を実行する。また、このプログラムの別の実行形態として、コンピュータが可搬型記録媒体から直接プログラムを読み取り、そのプログラムに従った処理を実行することとしてもよく、さらに、このコンピュータにサーバコンピュータからプログラムが転送されるたびに、逐次、受け取ったプログラムに従った処理を実行することとしてもよい。また、サーバコンピュータから、このコンピュータへのプログラムの転送は行わず、その実行指示と結果取得のみによって処理機能を実現する、いわゆるASP(Application Service Provider)型のサービスによって、上述の処理を実行する構成としてもよい。なお、本形態におけるプログラムには、電子計算機による処理の用に供する情報であってプログラムに準ずるもの(コンピュータに対する直接の指令ではないがコンピュータの処理を規定する性質を有するデータ等)を含むものとする。【0071】  また、この形態では、コンピュータ上で所定のプログラムを実行させることにより、本装置を構成することとしたが、これらの処理内容の少なくとも一部をハードウェア的に実現することとしてもよい。【符号の説明】【0072】100、200、800、900  音声認識装置120  WFST型ログリニアデコーダ190、890、990  記録部300  重みベクトル学習装置            305  重みベクトル更新手段320  正解WFST型ログリニアデコーダ325  仮説WFST型ログリニアデコーダ330  正解WFST合成部              350  パラメータ更新部360  重みベクトル平均化部            390  学習記録部820  WFST型デコーダ              830  WFST合成部840  出力シンボル抽出部              910  特徴量抽出部920  単語列探索部 
【特許請求の範囲】【請求項1】  発音辞書モデルと言語モデルと音響モデルと重みベクトルαとを記録する記録部と、  前記発音辞書モデルと前記言語モデルと前記音響モデルを合成し、WFSTネットワークを出力するWFST合成部と、  音声データから特徴量を抽出し、特徴量ベクトルの時系列Xを出力する特徴量抽出部と、  特徴量ベクトルの時系列が与えられたときの対数領域でのアーク系列AのスコアW(X,A)を、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と、重みベクトルαとの線形表現で表現し、最もスコアの高いアーク系列を出力するWFST型ログリニアデコーダと、  アーク系列に対する単語系列を求め、出力する出力シンボル抽出部と  を備える音声認識装置。【請求項2】  請求項1記載の音声認識装置であって、  前記記録部に記録された重みベクトルαは、あらかじめ定めた数の学習データを用いてアーク系列Aと素性ベクトルφ(X,A)のペアを蓄積し、蓄積した結果から推定したものである  ことを特徴とする音声認識装置。【請求項3】  請求項1記載の音声認識装置であって、  あらかじめ定めた数の正解単語系列と対応する特徴量ベクトルの時系列Xを入力される学習データとし、  WFSTネットワークを用いて、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と最もスコアの高い正解アーク系列Aを、仮説素性ベクトルφ(X,A−)、仮説アーク系列A−として出力する仮説WFST型ログリニアデコーダと、  前記WFSTネットワークと前記単語系列を合成し、正解アーク系列A＾を出力する正解WFSTネットワークを出力する正解WFST合成部と、  前記正解WFSTネットワークを用いて、特徴量ベクトルの時系列Xと正解アーク系列A＾から得られる正解素性ベクトルφ(X,A＾)と、最もスコアの高い正解アーク系列A＾を出力する正解WFST型ログリニアデコーダと、  前記仮説WFST型ログリニアデコーダが出力した仮説アーク系列A−に対する単語系列が前記正解単語系列と異なる場合に、前記重みベクトルαを、前記正解素性ベクトルφ(X,A＾)と前記仮説素性ベクトルφ(X,A−)を用いて更新するパラメータ更新部  も備えることを特徴とする音声認識装置。【請求項4】  あらかじめ定めた数の正解単語系列と対応する特徴量ベクトルの時系列Xを入力される学習データとし、  あらかじめ定められたWFSTネットワークと重みベクトルαとを記録する学習記録部と、  前記WFSTネットワークを用いて、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と最もスコアの高い正解アーク系列Aを、仮説素性ベクトルφ(X,A−)、仮説アーク系列A−として出力する仮説WFST型ログリニアデコーダと、  前記WFSTネットワークと前記単語系列を合成し、正解アーク系列A＾を出力する正解WFSTネットワークを出力する正解WFST合成部と、  前記正解WFSTネットワークを用いて、特徴量ベクトルの時系列Xと正解アーク系列A＾から得られる正解素性ベクトルφ(X,A＾)と、最もスコアの高い正解アーク系列A＾を出力する正解WFST型ログリニアデコーダと、  前記仮説WFST型ログリニアデコーダが出力した仮説アーク系列A−に対する単語系列が前記正解単語系列と異なる場合に、前記重みベクトルαを、前記正解素性ベクトルφ(X,A＾)と前記仮説素性ベクトルφ(X,A−)を用いて更新するパラメータ更新部  を備える重みベクトル学習装置。【請求項5】  あらかじめ記録部に、発音辞書モデルと言語モデルと音響モデルと重みベクトルαとを記録しておき、  前記発音辞書モデルと前記言語モデルと前記音響モデルを合成し、WFSTネットワークを出力するWFST合成ステップと、  音声データから特徴量を抽出し、特徴量ベクトルの時系列Xを出力する特徴量抽出ステップと、  特徴量ベクトルの時系列が与えられたときの対数領域でのアーク系列AのスコアW(X,A)を、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と、重みベクトルαとの線形表現で表現し、最もスコアの高いアーク系列を出力するWFST型ログリニアデコードステップと、  アーク系列に対する単語系列を求め、出力する出力シンボル抽出ステップと  を有する音声認識方法。【請求項6】  請求項5記載の音声認識方法であって、  前記記録部に記録された重みベクトルαは、アーク系列Aごとに素性ベクトルφ(X,A)を蓄積し、重みベクトルをあらかじめ定めた数の学習データを用いて推定したものである  ことを特徴とする音声認識方法。【請求項7】  請求項5記載の音声認識方法であって、  あらかじめ定めた数の正解単語系列と対応する特徴量ベクトルの時系列Xを入力される学習データとし、  WFSTネットワークを用いて、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と最もスコアの高い正解アーク系列Aを、仮説素性ベクトルφ(X,A−)、仮説アーク系列A−として出力する仮説WFST型ログリニアデコードステップと、  前記WFSTネットワークと前記単語系列を合成し、正解アーク系列A＾を出力する正解WFSTネットワークを出力する正解WFST合成ステップと、  前記正解WFSTネットワークを用いて、特徴量ベクトルの時系列Xと正解アーク系列A＾から得られる正解素性ベクトルφ(X,A＾)と、最もスコアの高い正解アーク系列A＾を出力する正解WFST型ログリニアデコードステップと、  前記仮説WFST型ログリニアデコードステップが出力した仮説アーク系列A−に対する単語系列が前記正解単語系列と異なる場合に、前記重みベクトルαを、前記正解素性ベクトルφ(X,A＾)と前記仮説素性ベクトルφ(X,A−)を用いて更新するパラメータ更新ステップ  も有することを特徴とする音声認識方法。【請求項8】  あらかじめ定めた数の正解単語系列と対応する特徴量ベクトルの時系列Xを入力される学習データとし、  学習記録部に、あらかじめ定められたWFSTネットワークと重みベクトルαとを記録しておき、  前記WFSTネットワークを用いて、特徴量ベクトルの時系列Xとアーク系列Aから得られる素性ベクトルφ(X,A)と最もスコアの高い正解アーク系列Aを、仮説素性ベクトルφ(X,A−)、仮説アーク系列A−として出力する仮説WFST型ログリニアデコードステップと、  前記WFSTネットワークと前記単語系列を合成し、正解アーク系列A＾を出力する正解WFSTネットワークを出力する正解WFST合成ステップと、  前記正解WFSTネットワークを用いて、特徴量ベクトルの時系列Xと正解アーク系列A＾から得られる正解素性ベクトルφ(X,A＾)と、最もスコアの高い正解アーク系列A＾を出力する正解WFST型ログリニアデコードステップと、  前記仮説WFST型ログリニアデコードステップが出力した仮説アーク系列A−に対する単語系列が前記正解単語系列と異なる場合に、前記重みベクトルαを、前記正解素性ベクトルφ(X,A＾)と前記仮説素性ベクトルφ(X,A−)を用いて更新するパラメータ更新ステップ  を有する重みベクトル学習方法。【請求項9】  請求項1から3のいずれかに記載の音声認識装置、もしくは請求項4記載の重みベクトル学習装置としてコンピュータを動作させるプログラム。 
音声認識装置、重みベクトル学習装置、音声認識方法、重みベクトル学習方法、プログラム
