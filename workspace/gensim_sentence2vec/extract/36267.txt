
ホームへ 目次へ 前へ 次へ
Base:クエリーの作成
二つのテーブルを連結させた一覧や計算を行います。
1、クエリーを選んで、「デザイン表示でクエリーを作成」を選択します。
2、テーブル作成時にリレーション済みでない場合は、Base:複数テーブルのリレーションを参考にリレーションを作成してください。
作成済みの場合、「テーブルまたはクエリーの追加」画面は閉じておいてかまいません。
たぶんそのままだと邪魔になると思います。
M.Kamataki さんの指南によると
クエリーデザインの画面でもリレーションの設定は可能です。つまり、リレーションは複数のパターンの設定が可能ということです。
リレーションシップによる設定は必須ではないのですが、フォーム作成時にメインテーブル、サブテーブルが絞り込まれる形(1対他)のサブフォームを作成する際、フォームウィザードのサブフォームの設定時にリレーションシップが設定されたテーブルが候補として表示されるようになります。
また、リレーションシップでカスケード削除を許可する設定にすると、サブフォームでメインテーブルのデータを削除すると、サブテーブルのリレーションされたレコードも削除できるようになります。
ここで、カスケード削除だけ例に出したのは、カスケード更新の方はAccessと同じ動きをしてくれないから。
上記は、私にはよく理解できてないので参考までに。(^^ゞ
3、画面下の左の最初のところでフィールドのボタンで「商品テーブル:連番」を選択します。
4、順に商品コードまでは、販売テーブルの方を選択します。
選択が終わったらテーブルをクリックしていくと販売テーブルが現れるようになります。
5、次の列は、「商品一覧テーブル:商品名」を選択します。
「販売テーブル」の方の選択ではありません。
6、次は、「商品テーブル一覧:単価」です。
7、最後は直接文字入力します。
販売個数*単価 と入力します。*(アスタリスク)は、半角で入力です。
フィールド名が異なる場合は、そのフィールド名とします。
8、 "" (ダブルクオーテーション)は下図のように自動的に入ります。
9、その下の「エイリアス」に「金額」と入れます。
エイリアスは、クエリーテーブルのフィールド名になります。
ここを入力しないとフィールドに表示されたものが使われます。
10、名前を付けて保存します。
11、保存されたクエリーを開きます。
12、それぞれ書式を変更します。
注:日付形式は上の例のようなものでなく、もう少し簡単な 1999/01/31 形式などの方がよさそうです。
レポート作成時に、日付が日付連番(シリアル値)になることがあります。
その時は、再度ここで書式の変更をしておいてください。上の例は、まずい例です。
ホームへ 目次へ 前へ 次へ
Base:クエリーの作成
