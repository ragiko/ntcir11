トピックモデルを用いた映像コンテンツの理解支援
岡本昌直
1)
祖父江美香
2)
祖父江翔
1)
中村明
3)
田村哲嗣
2)
速水悟
2)
1) 岐阜大学大学院 工学部研究科2) 岐阜大学 工学部
3) 三洋電機(株)エコロジー技術研究所
1.はじめに
現在, インターネットの発達に伴い, TV番組のインターネット配信や動画投稿サイトなど, さまざまな形で映像コンテンツに触れる機会が増加している.しかし, 膨大な映像コンテンツの中から, ユーザごとに求める情報のみをユーザ自身が発見するのは困難であり, また, 閲覧にも多大な時間を消費する.そのため, 映像コンテンツをリアルタイムで理解することを支援するシステムの開発が望まれている.その代表例として字幕が挙げられ, 近年の音声認識技術の進展により, リアルタイムでの放送音声への字幕付与を目指した研究が行われている[1, 2].しかし, 音声認識結果をそのまま字幕に用いた場合, 冗長な箇所が多いという問題があるため, 音声要約を行う必要があると考えられる.また, 字幕提示方式もユーザの理解に影響を与える.これまでに, 会議議事録のように複数話者を対象とした際の字幕提示方式の検討がなされている[3].一方で, 書き起こし文からキーワードを抽出する手法も考えられる.キーワードは映像コンテンツの内容を端的に表しているため, 効果的にユーザに内容を伝えることが可能となる.これまでに我々は, TF-IDFなど複数特徴量を用いた, 線形回帰によるキーワード自動抽出, ジャンルにおける重要度ベクトルの調査・最適な字幕提示方式の検討を行った[4].
トピックごとにキーワードを提示することで, ユーザはより深い理解を得ることができると考えられる.そこで本研究では, 大語彙音声認識エンジンJuliusを用いた字幕自動生成へ向けた取り組みとして、音声区間検出(VAD)と条件付き確率場(CRF)を用いて, 文境界推定を行った.また, LDAトピックモデルを用いて, トピック境界を推定し, キーワード抽出を行い, 吹き出し型字幕として提示する.
2.字幕自動生成システム2.1システムの概要
本研究が提案する字幕自動生成システムの概要を図1に示す.まず, 動画ファイルより音声ファイルを取り出し, 音声認識を行う.認識結果より, 動画ファイル, 音声区間開始点, 字幕テキストを統合し, Adobe Flashを用いて吹き出し型字幕としてユーザに提示する.
音声区間検出・文境界推定の実験には2008年11月18日放送分NHK時論公論の動画ファイルを使用した.
2.2VAD(VoiceActivityDetection)
音声ファイルに対しフレーム分割を行い, 各フレームにおいて得られた特徴を基に, 音声/非音声の識別を行う.
音声区間の特徴としては, 音声/非音声区間の間にあるポーズ情報を利用したものが挙げられる[5].
今回使用した音声ファイルには雑音が少ないため, ポーズ情報のみを特徴量に使用し, 閾値処理を行うことにより音声区間の検出を行った.また, ハングオーバー処理を行った.ハングオーバー処理とは, 音声区間の抜けている部分を補う処理のことである.最適フレーム数を検討するために, 表1に示す条件で音声区間検出実験を行った.
表1
音声区間検出実験条件
動画
NHK時論公論(約10分)
フレーム数
1~7
時間誤差
5ms
字幕提示
TV型字幕
字幕文字数
制限なし
話者
1人
フレーム数1~7で音声区間検出実験を行った結果, フレーム数4, 5, 6のときに, 精度が最も高く, 85.8%であった.
2.3CRF(ConditionalRandomFields)による文境界推定
VADによる音声区間検出結果に句点を付与し, 「文」を入力単位と仮定する自然言語処理を行うため, 文境界の推定を行う必要がある.
文境界の推定はラベリング問題として考えることができる.そこで, 対象テキストの形態素解析結果列にラベルを付与する.また, ポーズの部分は, 書き起こしと比較した際, 句読点部分である可能性が高いと考えられるため, これら2つを特徴量とし, 識別モデルとしてCRF を用いた.CRFは, 入力例xに対する各出力ラベルの列yの条件付き確率Pθ y|xを表現する.θは学習により求められるモデルのパラメータで, それらをベクトルにし
図1
動画ファイル
音声分離
音声ファイル
音声区間検出
開始点
音声認識
文境界推定
字幕テキスト
キーワード抽出
字幕提示
システム概略図
たものがΘである.位置iの素性ベクトルをf y, x, i, それに基づく大域素性ベクトルをFy, x =i f y, x, i とすると, Pθ y|x は次式で求められる.
Pθ y|x =
exp Θ ∙ Fy, x
Zθ x
(1)
Zθ x =
exp Θ ∙ Fy, x
y
(2)
音声認識などで使われる隠れマルコフモデル(HMM)は, 特徴が互いに独立である必要がある.これに対し, CRF はその必要がなく, HMMより細かい特徴の指定が可能である.また, 条件付き確率により確率が直接推定できるという特徴がある.
本研究では, 句点があらかじめ挿入された新聞記事と話し言葉のテキストデータより, モデルを作成する.音声認識のテキストデータに, テキスト情報のみで作成した識別モデルを適用して文境界推定を行う.学習に用いる適切な素性を決定するため, 前後の形態素数, 使用する単語情報について, CRFによる学習で予備実験を行った.予備実験により, 学習素性は, 前後2形態素を用いて単語情報に表層形と品詞を用いる場合が適切という結果になった[6].
今回使用した動画ファイルにおける文境界推定結果の精度, 再現率, F値を表2に示す.
正解の句点と本手法で挿入した句点との一致数
精度=
本手法で挿入した句点数
正解の句点と本手法で挿入した句点との一致数
再現率=
人手で挿入した句点数
F値= 2 ×精度×再現率
精度+再現率
(3)
(4)
(5)
表2
文境界推定結果
精度
再現率
F値
92.6
98.4
95.5
2.4吹き出し型字幕提示方式
映画などでみられる, 一般的なTV型字幕は, 発話内容が話者の下に表示されることが多い.これに対し, 吹き出し型字幕提示方式とは, 図2(右)のように, 話者の顔付近に字幕を表示する方式である.この字幕表示方式をとることによって, 話者が複数存在する場合においても, 誰が・いつ・何を話したのか認識しやすくなると考えられる.図2にTV型字幕と吹き出し型字幕の例を示す.
図2 字幕提示方式(左:TV型, 右:吹き出し型)
2.5システム評価実験
本研究の提案手法によって作成されたコンテンツによるユーザの理解支援への有効性を示すため, 5段階評価にて被験者実験を行った.以下に評価項目を示し, 実験条件を表3に示す.また, 実験結果を図3に示す.
【評価項目】
(1)字幕の切り替えのタイミング(2)表示文の句切れ
(3)吹き出し型字幕の見やすさ(4)表示文字数(5)全体の評価
表3
システム評価実験条件話者数 1字幕文字数
制限なし
コンテンツの長さ
約3分
被験者数 14字幕提示方式
吹き出し型
図3
システム評価実験結果
評価項目(1), (2)より, VADによる音声区間検出とCRFを用いた文境界推定を用いた字幕提示は有効であることが分かる.しかし, 1つ1つの音声区間内において, 文字数にばらつきがみられた.これにより, 1度の吹き出しに表示される文字数が増加し, 複数行にまたがって字幕が表示される, 被験者が1秒当たりに読みとる文字数が増えるといった問題のために, (3), (4)の評価項目を下げたと考えられる.そのために, 改行の挿入, 1度に表示する字幕文字数制限, キーワード抽出などの検討を行う必要があると考えられる.また, 吹き出し型字幕は, 本実験のように話者1人における状況下では, TV型字幕提示方式よりも理解を損なう可能性があるため, 複数話者での吹き出し型字幕の有効性を検討する必要がある.
3.キーワード抽出
キーワードはトピックを端的に表すという仮定に基づき, 複数のトピックが存在する場合においても, トピックごとにキーワードを提示することにより, ユーザは現在述べられているトピックを容易に理解することができる.トピックごとにキーワードを提示するために, トピック境界の推定, キーワード抽出を行う必要がある.本
0
1
2
3
4
5
(1) (2) (3) (4) (5)
評価項目
字幕
字幕
研究ではLDAを用いて, トピック境界推定, キーワードの抽出を行った.形態素解析には形態素解析エンジンMeCabを使用した.また, 学習テキストには2008年の毎日新聞1年分の記事を用いた.
3.1LDA(LatentDirichletAllocation)
確率・統計的自然言語処理や音声認識の分野では, 単語の生起確率を直前の(N-1)単語を用いてモデル化したN-gramモデルや, 単語間の大域的な依存関係を単語対の関係でモデル化したトリガーモデルやキャッシュモデルが多用されている.これらに対し, 単語間の大域的な依存関係を話題としてモデル化したものにトピックモデルがありPLSI(Probabilistic Latent Semantic Indexing)[7]や, DM (Dirichlet Mixtures)[8]などが挙げられ, LDAもこれに該当する.トピックモデルは, 現在の話題に応じて単語の生起確率を動的に推定でき, 言語モデルの高精度化が期待できる.LDAは, 各潜在トピック(z1, z2 ... zC)(C :潜在トピック数)の生成確率θ = (θ1, θ2 ... θC)が多項分布の共役事前分布であるディリクレ分布Dir(θ|α)に従うと仮定したモデルである.文書d =(w1, w2 ... w|d|) の出現確率は次式で表される(|d|は文書dの総単語数を表す)
d C
Pd
DirP
Pzk
| |
(|, )  (|) (|, ) (|)
n1 k1
(6)
α, βがLDAのモデルパラメータであり, βkjはトピックzkにおける語wjのuni-gram確率P(wj|zk)を表す(1≦j ≦V)(V:語彙数).α = (α1, α2 ... αC)はディリクレ分布のパラメータである.パラメータα, β の学習には変分ベイズ法による近似計算が用いられる[9].本研究では対象となる文書にフレーム化処理を行う.未知のフレーム化された文書fに対するトピック適応は, 学習時と同様の変分近似により計算される.即ち, fに対する変分パラメータγkおよび∅kjを導入し, 学習済みのα, β を用いて以下の手順を収束するまで繰り返す.
VB  Estep :  exp((
)  (
)) (7)
k'1
k'
C
k
kj
kj
j1
VB  Mstep :   n(
h, w) (8)
V
kj j
k
k
(γ)はdigamma関数であり, n (h, wj)はhにおける語wjの出現回数を表す.得られたγkをフレーム化された文書fの元での各潜在トピックの混合比とする.したがって, フレーム化された文書fの元での語wjの生起確率は次式により与えられる.
k
k1
k
kj'
C k1
P(
wj
| h
C
'
)
(9)
LDAはトピックの事前分布にディリクレ分布を用いることにより, トピックの拡がりやトピック間の関係を表
現できる点でPLSIより優れている.またベイズ推定に基づくため過適応の問題が少ないとされている.
3.2トピック境界推定
LDAは, 1つの文書内に複数の潜在トピックが同時に混在していると考えたモデルである.そのため, トピックの混合比は, 潜在トピック数を要素とし, トピック混合比ベクトル(γ1, γ2 ... γC)(C:潜在トピック数)として表される.本研究では, 対象となる文章を移動幅1文でフレーム化し, 次式に表すコサイン尺度を算出する.
cos t1, t2 = t1・t 2
t1 t2
(10)
トピック混合比ベクトルt1, t2間のなす角度を測り, 閾値以下の場合にトピックの変化点と判定する.以下の図4にトピック混合比ベクトルの概略を示す.
図4
トピック混合比ベクトル概略図
3.3複合語
複合語とは, 2つ以上の単語が組み合わさってなる語のことである.形態素解析において, MeCab標準のIPA 辞書を用いた結果では, 例として「日経平均株価」という語は, 「日経」, 「平均」, 「株価」として解析される.キーワードとして提示される語としては, 不十分であると考えられるため, 複合語の処理を検討する必要がある.複合語を扱うために, 形態素解析に使用するMeCab辞書に, 2009年9月時点でのWikipediaに存在するページのタイトルとなる語, 約90万語を素性「名詞・複合語」として登録した.それらに加え, 学習テキスト内で, 名詞と名詞が隣接している場合, それらを1つの語とする, 約56万語を辞書に登録した.
3.4キーワード抽出
3.2より, 同トピックと判定された範囲内で, キーワードの抽出を行う.LDAを用い, トピックzkにおける語wjのuni-gram確率βkjをソートすることにより, 単語ごとに出現しやすいトピックを判定し, そのトピックに属するものとする.その際, 潜在トピック数は100とした.
文書dに対し, トピック境界を推定した後, 同じトピックであると判定された範囲Rにおいて, トピック混合比を求め, 閾値T以上となる潜在トピックγkに属する単語を範囲Rにおけるキーワードとする.
{ |  T}
(1 k 100)
R
k
k
n
(11)
キーワードとされた語にはトピックごとに色を付け, ユーザに提示する.図5にトピックごとに抽出されたキーワード例を示す.
図5
キーワード抽出例
4.被験者実験
2章の表3と同条件にて, 抽出されたキーワードの適切さ・キーワード提示によるユーザの理解支援への有効性を示すために, キーワード提示に対する被験者実験を行った.以下に評価項目を示し, 図6に作成したコンテンツの提示例, 図7に被験者実験結果を示す.
【評価項目】
(1)キーワード提示数
(2)提示キーワードの適切さ(3)理解支援に役立つか
(4)トピックの変化を把握できるか
図6
コンテンツ提示例
図7
被験者実験結果
評価項目(4)より, 提案手法はトピック変化の把握を支援することがわかる.しかし, 本研究では, トピック混合比が閾値以上となる潜在トピックに属する単語すべて
をキーワードとしたために, 1度に多数のキーワードを提示する場面がみられた.そのため, 評価項目(1), (2)を下げたと考えられる.また, キーワードを提示する際の色によって, 被験者の理解度の変化がみられる可能性がある.そのため, 字幕における色の影響について検討を行う必要があると考えられる.
5.まとめ
本研究では, ユーザの理解を支援することを目的とし, 音声認識, VAD, CRFによる文境界推定, LDAを用いて, 吹き出し型字幕自動生成に取り組んだ.今後の課題として, 完全な自動化へ向けて, 吹き出し位置の決定を自動で行う必要があるため, 動画内の話者の顔の位置を特定する必要があると考えられる.被験者実験では, 話者1人の状況下における実験を行ったが, 話者識別を行い, 複数話者が存在する状況下でのTV型字幕, 吹き出し型字幕の双方で検討する.また, トピック境界推定, キーワード抽出の精度を上げることで, よりユーザの理解を支援することができると考えられるので, 検討する必要がある.
参考文献
[1] 堀智織, 古井貞煕, 単語抽出による音声要約生成法とその評価, 電子通信情報通信学会誌, D-IINO.2, pp.200-209 (2002)
[2] 大野誠寛, 松原茂樹, 柏岡秀紀, 稲垣康善, 同時的な独話音声要約に基づくリアルタイム字幕生成, 情報処理学会研究報告Vol.2006, No.73, 2006 -SLP–62 -(10), pp.51-56 (2006)
[3] 藤井絢子, 南條浩輝, 吉見毅彦, 会議の情報保障を目的とした吹き出し型字幕提示方式の検討, 情報処理学会研究報告, 2009-SLP-75-14, pp.75-82 (2009)
[4] 岡本昌直, 祖父江美香, 山本けい子, 田村哲嗣, 速水悟, 映像コンテンツの理解支援のためのキーワード提示方式の検討, 第8回情報科学技術フォーラム, E-021, pp.299-300 (2009)
[5] 羽柴隆志, 竹内伸一, 田村哲嗣, 速水悟, マルチストリームHMM を用いた音声と画像による音声区間検出, 日本音響学会2009年春季講演論文集, 1-P-5, pp.131-132(2009)
[6] 祖父江翔, 山本けい子, 田村哲嗣, 速水悟, 音声認識結果の文境界推定における識別モデルの評価, 言語処理学会, 第 15回年次大会, P2-28, pp.582-585(2009)
[7] T.Hofman, Probabilistic latent semantic indexing, Proc.of 22nd Annual ACM Conference on Research and Development in Information Retrieval, pp.50-57(1999)
[8]貞光九月, 三品拓也, 山本幹雄, 混合ディリクレ分布を用いたトピックに基づく言語モデル, 電子情報通信学会論文誌D-II Vol.J88-D-II, NO.9, pp.1771-1779(2005)
[9] D.Blei, A.Y.Ng and M.Jordan, Latent dirichlet allocation, journal of Machine Learning Research, Vol.3, pp.993-1022(2003)
[10] 津田裕亮, 中村明, 速水悟, 松本忠博, 池田尚志, LDAトピックモデルに基づく話題変化点検出, 言語処理学会, 第15回年次大会, P2-25, pp.570-573 (2009)
[11] 門馬隆雄, 江原暉将, 白井克彦, 沢村英治, 三橋哲雄., 聴覚障害者向けニュースの字幕提示方法に関する主観評価, 映像情報メディア学会誌Vol.54, No9, pp.1288–1297(2000)
[12] J.Lafferty, M.Andrew, P.Fernando, Conditional Random Fields:Probabilistic Models for Segmenting and Labeling Sequence Data, In Proceeding of the 18th International Conference on Machine Learning(2001)
0
1
2
3
4
5
(1) (2) (3) (4)評価項目

