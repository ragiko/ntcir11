
種類[編集]
t検定は大きく次のように分けられる。
二つの母集団がいずれも正規分布に従うと仮定した上での、平均が等しいかどうかの検定。
標本が対になっている、つまり1組の標本のメンバー各々と、もう1組の特定のメンバーとの間に特別な関係がある場合(例えば、同じ人に前後2回調査する場合、夫と妻とで比較する場合など)。
標本が独立で、比較する二つの群の分散が等しいと仮定できる場合(等分散性の仮定)。
標本が独立で、等分散性が仮定できない(異分散)場合。これは正確にはウェルチのt検定と呼ばれる。
正規分布に従う母集団の平均が、特定の値に等しいかどうかの検定。
回帰直線の勾配が0と有意に異なるかどうかの検定。
方法[編集]
一群のt検定[編集]
母集団の平均値μが特定の値である μ0と等しいかどうかの帰無仮説を検定する際に使用する。
は標本平均であり sは 標本の標準偏差 である。標本サイズは nであり、t検定における自由度はn − 1である。
回帰分析の係数[編集]
次のような回帰分析のモデルを考える。
xi, i = 1, ..., nは既存の説明変数であり、 α と βは未知の係数である。そして εiは独立に同一の正規分布に従った期待値0で未知の分散σ2であるランダムな誤差とする。 Yi, i = 1, ..., nは観測値である。この際、 βがある特定の値β0と等しいかどうかをテストしたい (多くの場合β0は 0である。何故なら、βが0であればx と y に相関性が無いと言う事になり、0以外の値であればx と y は相関しているということになる)。
すると
帰無仮説が正しければ、この数値はt値の自由度がn − 2に従う。
すると は
独立二群の平均値の差の検定[編集]
一つ目の母集団の平均値μ1が二つ目の母集団の平均値μ2と等しいかどうかの帰無仮説を検定する際に使用する。言い換えるとμ1−μ2=0かどうかの帰無仮説を検定する。
t検定を始める前に[編集]
実務的なデータ分析では、母集団が様々な前提を満たしているかどうかを調べるため、以下のような検定をt検定の前段階に行う場合がある。
標本が正規分布に従うかどうかは、コルモゴロフ-スミルノフ検定やシャピロ-ウィルク検定などの正規性検定によって判断することもできる。
標本の分散が等しいかどうかは、F検定、ルベーン検定、バートレット検定などにより判断する方法がある。
等分散の場合[編集]
比較する両群をX1, ..., XmおよびY1, ..., Yn(標本サイズはmおよびn)とする。両群から標本平均および、ならびに不偏分散およびを求める。 両群を合わせた分散の推定値を
により算出する。
これから検定統計量t0 を
により算出する。 両群の平均が等しい場合には「統計量T は自由度ν = m + n – 2 のt分布に従う」ので、これを帰無仮説として両側検定を行う。 このt分布におけるの上側のp値を求め、有意水準αと比較する(あるいは数表で比較を行う)。p < α ならば帰無仮説は棄却され、「両群の平均には有意差がある」といえる。
異分散の場合(ウェルチのt検定)[編集]
前と同じ標本(ただし分散が等しくない)を対象とする。
検定統計量t0 を
により算出する。 t分布の自由度νは、
であるが、これは整数になるとは限らないので、10未満の場合は小数自由度のt分布表を利用する。10以上ならば小数部を切り捨て整数部のみを使用してよい。
関連二組の差の平均値のt検定[編集]
n 対のデータがあるとし、対応する2変数をXi とYi 、両者の差をdi = Xi - Yi とする(i = 1, 2, ... , n)。di の平均をとする。差の母集団の平均値μdが特定の値である μ0と等しいかどうかの帰無仮説を検定する際に使用する。
検定統計量 t0 を
により算出する。 t分布の自由度はν = n -1となる。
t検定の代替手段[編集]
t検定は、母集団が正規分布をしており標本の分散がχ2 分布をしているという前提の下において、「完全に」正確な確率を計算することができる(ウェルチ検定では「ほぼ」正確な値を計算できる)。逆の言い方をすると、母集団が正規分布に従っていない場合は、標本平均はt値からは多かれ少なかれ乖離する。実務的に標本から母集団が正規分布をしているかどうかという事を判断する事は、色々な検定方法があるとは言うものの、非常に困難である。ただし、中心極限定理によると、母集団の分布が正規分布に従わない標本でさえも、サンプル数が多くなればなるほど、標本平均は正規分布に近似していく。したがって、標本サイズが多ければ多いほど、標準検定値であるはZ値に近似することになる。このような基礎に基づくと、母集団が正規分布から完全に逸脱した分布に従っていて、標本サイズが十分に大きな場合(大学の初等の統計の教科書などではn>30などと載っている場合があるが、勿論多ければ多いほど良い)、Z検定で近似的な確率を計算できる。ただしt値は自由度が上がるとZ値に近似するため、計算上はt検定を用いても殆ど大差ない結果を得られる(哲学的には異なるが)。それがt検定が頑強(robust)であると言われる所以である。
ノンパラメトリック手法[編集]
t検定は母集団の正規分布を前提とするパラメトリック検定であるが、この条件が満たされず、さらに標本サイズが小さいと、t検定で近似することも困難となる。そういった場合にはノンパラメトリック検定を用いる方法がある。ノンパラメトリック検定は汎用性を重視し、効率性を犠牲にしているというものの、場合によっては統計のパワー(1 − β)がt検定に比べてはるかに高い。
標本が独立ならばマン・ホイットニーのU検定など
対になる標本ならばウィルコクソンの符号順位検定など
を用いることができる。ただしt検定やZ検定が母集団の平均値に注目して仮説を立てるのに対して、ノンパラメトリック検定ではランキング、中央値や分布などに注目して仮説を立てることに注意が必要。
t検定 - Wikipedia
