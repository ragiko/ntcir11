【課題】画像系列から検出された顔画像をより効率的にクラスタリングすること。【解決手段】画像に含まれる顔を検出する顔検出部と、前記顔検出部により検出された顔の向きを検出する顔向き検出部と、前記顔向き検出部により検出された顔の向きを考慮し、特徴が近い顔を検出して当該顔の特徴を表す顔情報の集合を形成する顔識別部と、前記顔識別部により形成された各顔情報の集合について、前記顔向き検出部により検出された顔の向きに基づいて顔の向き毎に予め設定された数まで顔情報の数を絞り込み、数が絞り込まれた各顔情報の集合を単位グループに設定する単位グループ設定部と、前記単位グループ設定部により設定された単位グループを単位として、当該各単位グループに含まれる顔情報に基づくクラスタリングを実行するクラスタリング部と、を備える、顔クラスタリング装置が提供される。
【発明の詳細な説明】【技術分野】【0001】  本発明は、顔クラスタリング装置、顔クラスタリング方法、及びプログラムに関する。【背景技術】【0002】  近年、動画に含まれる登場人物の顔情報などを効率的に管理する方法に注目が集まっている。例えば、下記の特許文献1には、動画に含まれる登場人物の顔情報、及び当該登場人物の登場場面をユーザが容易に把握できるようにするためのリソースデータを提供する方法が開示されている。また、下記の特許文献2には、動画に含まれる顔情報を検出する際に同一人物の顔情報を集約し、集約した顔特徴量の中から顔クラスタリングに適さない顔情報を除去して、顔クラスタリングの高速化及び高精度化を実現する方法が開示されている。【先行技術文献】【特許文献】【0003】【特許文献1】特開2009−81883号公報【特許文献2】特開2010−  3021号公報【発明の概要】【発明が解決しようとする課題】【0004】  しかしながら、動画に含まれる登場人物の顔情報を全て対象にして顔クラスタリングを実行するには大きなメモリ容量と高い演算能力が要求される。そこで、本発明は、上記問題に鑑みてなされたものであり、本発明の目的とするところは、より効率的に高精度で顔情報をクラスタリングすることが可能な、新規かつ改良された顔クラスタリング装置、顔クラスタリング方法、及びプログラムを提供することにある。【課題を解決するための手段】【0005】  上記課題を解決するために、本発明のある観点によれば、画像に含まれる顔を検出する顔検出部と、前記顔検出部により検出された顔の向きを検出する顔向き検出部と、前記顔向き検出部により検出された顔の向きを考慮し、特徴が近い顔を検出して当該顔の特徴を表す顔情報の集合を形成する顔識別部と、前記顔識別部により形成された各顔情報の集合について、前記顔向き検出部により検出された顔の向きに基づいて顔の向き毎に予め設定された数まで顔情報の数を絞り込み、数が絞り込まれた各顔情報の集合を単位グループに設定する単位グループ設定部と、前記単位グループ設定部により設定された単位グループを単位として、当該各単位グループに含まれる顔情報に基づくクラスタリングを実行するクラスタリング部と、を備える、顔クラスタリング装置が提供される。【0006】  また、前記単位グループ設定部により設定された単位グループを第1の単位グループ、第k(k=1〜N)の単位グループに基づいて設定された単位グループを第(k+1)の単位グループと表現すると、前記クラスタリング部は、前記第1の単位グループのうち、所定の第1時間T1で区切った各区間内に存在する単位グループを対象にし、特徴が近い単位グループをマージして第2の単位グループを設定し、前記第kの単位グループのうち、所定の第k時間Tk(Tk>Tk−1)で区切った各区間内に存在する単位グループを対象にし、特徴が近い単位グループをマージして第(k+1)の単位グループを設定するステップをk=2〜Nについて順次実行するように構成されていてもよい。【0007】  また、前記クラスタリング部は、全ての前記単位グループに設定された顔情報を対象に、当該各顔情報の類似度に基づいて前記特徴が近い単位グループをマージする第1マージ部と、個々の前記単位グループに設定された顔情報を用いて、当該各単位グループの類似度に基づいて前記特徴が近い単位グループをマージする第2マージ部と、を有し、前記第i(1≦i≦N)の単位グループを対象にして、特徴が近い単位グループをマージするステップを前記第1マージ部が実行し、前記第j(j≠i)の単位グループを対象にして、特徴が近い単位グループをマージするステップを前記第2マージ部が実行するように構成されていてもよい。【0008】  また、前記クラスタリング部は、略同一時間に対応する2つの単位グループをマージしないように構成されていてもよい。【0009】  また、前記第1マージ部は、前記第i(1≦i≦N)の単位グループを対象にして、特徴が近い単位グループをマージするステップを実行する際、マージが起こらなくなるまで当該ステップを繰り返し実行するように構成されていてもよい。【0010】  また、前記単位グループ設定部は、離れた時間に対応する顔情報が同じ単位グループに設定されやすいように顔情報の数を絞り込むように構成されていてもよい。【0011】  また、前記第2マージ部は、少なくとも前記第1の単位グループを対象にして、特徴が近い単位グループをマージするステップを実行するように構成されていてもよい。【0012】  また、前記クラスタリング部は、特徴が近い単位グループをマージする際、マージ前の単位グループに設定されている顔情報、及びマージ前の単位グループとマージ後の単位グループとの対応関係を表す階層情報を保持するように構成されていてもよい。【0013】  また、上記課題を解決するために、本発明の別の観点によれば、画像に含まれる顔を検出する顔検出ステップと、前記顔検出ステップで検出された顔の向きを検出する顔向き検出ステップと、前記顔向き検出ステップで検出された顔の向きを考慮し、特徴が近い顔を検出して当該顔の特徴を表す顔情報の集合を形成する顔識別ステップと、前記顔識別ステップで形成された各顔情報の集合について、前記顔向き検出ステップで検出された顔の向きに基づいて顔の向き毎に予め設定された数まで顔情報の数を絞り込み、数が絞り込まれた各顔情報の集合を単位グループに設定する単位グループ設定ステップと、前記単位グループ設定ステップにより設定された単位グループを単位として、当該各単位グループに含まれる顔情報に基づくクラスタリングを実行するクラスタリングステップと、を含む、顔クラスタリング方法が提供される。【0014】  また、上記課題を解決するために、本発明の別の観点によれば、画像に含まれる顔を検出する顔検出機能と、前記顔検出機能により検出された顔の向きを検出する顔向き検出機能と、前記顔向き検出機能により検出された顔の向きを考慮し、特徴が近い顔を検出して当該顔の特徴を表す顔情報の集合を形成する顔識別機能と、前記顔識別機能により形成された各顔情報の集合について、前記顔向き検出機能により検出された顔の向きに基づいて顔の向き毎に予め設定された数まで顔情報の数を絞り込み、数が絞り込まれた各顔情報の集合を単位グループに設定する単位グループ設定機能と、前記単位グループ設定機能により設定された単位グループを単位として、当該各単位グループに含まれる顔情報に基づくクラスタリングを実行するクラスタリング機能と、をコンピュータに実現させるためのプログラムが提供される。【0015】  また、上記課題を解決するために、本発明の別の観点によれば、上記のプログラムが記録された、コンピュータにより読み取り可能な記録媒体が提供される。【発明の効果】【0016】  以上説明したように本発明によれば、より効率的に高精度で顔情報をクラスタリングすることが可能になる。【図面の簡単な説明】【0017】【図1】本発明の一実施形態に係る情報処理装置の機能構成例を説明するための説明図である。【図2】同実施形態に係る顔クラスタリング方法(全体的な処理の流れ)を説明するための説明図である。【図3】同実施形態に係る顔クラスタリング方法(全体的な処理の流れ)を説明するための説明図である。【図4】同実施形態に係る顔クラスタリング方法(全体的な処理の流れ)を説明するための説明図である。【図5】同実施形態に係る顔クラスタリング方法(初期設定)を説明するための説明図である。【図6】同実施形態に係る顔クラスタリング方法(アクター情報の生成)を説明するための説明図である。【図7】同実施形態に係る顔クラスタリング方法(アクタークラスタリングの実行)を説明するための説明図である。【図8】同実施形態に係る顔クラスタリング方法(対象階層の解析実行)を説明するための説明図である。【図9】同実施形態に係る顔クラスタリング方法(マージ処理の実行)を説明するための説明図である。【図10】同実施形態に係る顔クラスタリング方法(アクター情報の更新)を説明するための説明図である。【図11】同実施形態に係る顔クラスタリング方法(最終クラスタリング)を説明するための説明図である。【図12】同実施形態に係る顔クラスタリング方法(アクター情報の構成)を説明するための説明図である。【図13】同実施形態に係る顔クラスタリング方法(アクター情報の構成)を説明するための説明図である。【図14】同実施形態に係る顔クラスタリング方法(アクター情報の構成)を説明するための説明図である。【図15】同実施形態に係る顔クラスタリング方法(予選/決勝方式)を説明するための説明図である。【図16】同実施形態に係る顔クラスタリング方法(第1のクラスタリング方式)を説明するための説明図である。【図17】同実施形態に係る顔クラスタリング方法(第1のクラスタリング方式)を説明するための説明図である。【図18】同実施形態に係る顔クラスタリング方法(第1のクラスタリング方式)を説明するための説明図である。【図19】同実施形態に係る顔クラスタリング方法(第1のクラスタリング方式)を説明するための説明図である。【図20】同実施形態に係る顔クラスタリング方法(第1のクラスタリング方式)を説明するための説明図である。【図21】同実施形態に係る顔クラスタリング方法(第2のクラスタリング方式)を説明するための説明図である。【図22】同実施形態に係る顔クラスタリング方法(性能改善策1)を説明するための説明図である。【図23】同実施形態に係る顔クラスタリング方法(性能改善策2)を説明するための説明図である。【図24】同実施形態に係る顔クラスタリング方法(性能改善策3)を説明するための説明図である。【図25】同実施形態に係る顔クラスタリング方法(性能改善策4)を説明するための説明図である。【図26】同実施形態に係る情報処理装置のハードウェア構成例を説明するための説明図である。【発明を実施するための形態】【0018】  以下に添付図面を参照しながら、本発明の好適な実施の形態について詳細に説明する。なお、本明細書及び図面において、実質的に同一の機能構成を有する構成要素については、同一の符号を付することにより重複説明を省略する。【0019】  ［説明の流れについて］  ここで、以下に記載する本発明の実施形態に関する説明の流れについて簡単に述べる。まず、図1を参照しながら、本実施形態に係る情報処理装置100の機能構成について簡単に説明する。次いで、図2〜図25を参照しながら、情報処理装置100の動作、及び本実施形態に係る顔クラスタリング方法について詳細に説明する。次いで、図26を参照しながら、情報処理装置100のハードウェア構成例について簡単に説明する。最後に、本実施形態の技術的思想について纏め、当該技術的思想から得られる作用効果について簡単に説明する。【0020】  (説明項目)  1:実施形態      1−1:情報処理装置100の構成      1−2:情報処理装置100の動作(顔クラスタリング方法)          1−2−1:第1クラスタリング方式          1−2−2:第2クラスタリング方式          1−2−3:適用ステップについて      1−3:性能改善策          1−3−1:性能改善策1          1−3−2:性能改善策2          1−3−3:性能改善策3          1−3−4:性能改善策4      1−4:ハードウェア構成例  2:まとめ【0021】  <1:実施形態>  本発明の一実施形態について説明する。本実施形態は、連写画像や動画などの画像系列から検出された人物の情報(例えば、顔情報など)をクラスタリングする方法(以下、顔クラスタリング方法)に関する。特に、本実施形態は、画像系列から検出された人物の情報を所定の単位(以下、アクター)で管理する方法に関する。以下では、人物の情報として顔情報を具体例に挙げ、顔情報をクラスタリングする方法について説明する。【0022】  ［1−1:情報処理装置100の構成］  まず、図1を参照しながら、本実施形態に係る顔クラスタリング方法を実現することが可能な情報処理装置100の機能構成例について簡単に説明する。図1は、情報処理装置100の機能構成例を示す説明図である。【0023】  図1に示すように、情報処理装置100は、主に、表示部101と、記憶部102と、データ取得部103と、顔認識部104と、アクター生成部105と、アクタークラスタリング部106とを有する。さらに、アクタークラスタリング部106は、第1クラスタリング部1061と、第2クラスタリング部1062とを含む。【0024】  表示部101は、画像を表示する手段である。例えば、表示部101は、記憶部102に格納された画像系列を読み出して表示する。また、表示部101は、画像系列から抽出された顔画像を表示する。さらに、表示部101は、画像系列中に顔画像が登場する区間及びその区間に対応する顔画像を登場人物毎に表示する。記憶部102は、データを保持する手段である。例えば、記憶部102は、画像系列を構成する各画像を保持する。また、記憶部102は、後述する顔認識部104やアクタークラスタリング部106などにより抽出又は選別された画像系列中の顔画像を保持する。【0025】  データ取得部103は、記憶部102から画像系列を構成する各画像を取得する。但し、記憶部102に保持されている画像が符号化されている場合、データ取得部103は、記憶部102から取得した画像を復号する。例えば、MPEG−2、MPEG−4、H.264/AVCなどの符号化方式により画像系列が符号化されている場合、データ取得部103は、対応する符号化方式に基づいて各画像を復号する。また、画像系列を構成する各画像がJPEGなどの符号化方式により符号化されている場合、データ取得部103は、対応する符号化方式に基づいて各画像を復号する。このようにしてデータ取得部103により記憶部102から取得された各画像は、顔認識部104に入力される。【0026】  顔認識部104は、データ取得部103から入力された各画像に含まれる顔画像を検出する。顔画像の検出には、画像を入力として「顔らしさ」を判定することが可能な判定器を利用すればよい。例えば、ハールライク特徴(Haar−Like  Feature)に基づく複数の弱判定器を作成し、その弱判定器を適応的ブースティング(AdaBoost)に適用すれば「顔らしさ」を計算する判定器を得ることができる(例えば、特開2010−3021号公報を参照)。但し、顔画像の検出方法は、これに限定されない。例えば、2画素の輝度差の組み合わせ(以下、ピクセル差分特徴)に基づく複数の弱判定器を作成し、その弱判定器を適応的ブースティングに適用する手法も考えられる。【0027】  こうしたブースティング手法を利用することにより、顔画像に対応する顔の向きや3次元的な位置などを検出したり、似た特徴を持つ顔画像を検出したりすることができる。顔認識部104は、上記のような手法を利用して各画像に含まれる顔画像を検出する。また、顔認識部104は、各顔画像に対応する顔の向きや3次元的な位置などを検出する。そして、顔認識部104は、画像系列に登場する顔画像の間で、似た特徴を持つ顔画像を検出する。そして、顔認識部104は、似た特徴を持つ顔画像に同じ識別情報(以下、顔ID)を付与し、その顔画像が検出された時間(以下、検出時間)に対応付けて管理する。例えば、各顔画像に対し、顔ID、検出時間、顔情報などが対応付けられる。【0028】  なお、上記の顔情報は、顔画像の特徴を表す特徴量である。例えば、顔情報には、顔の向き、顔の3次元的な位置、年齢、性別、ピクセル差分特徴などが含まれる。なお、年齢や性別なども、上記のブースティング手法のような機械学習により検出可能である。また、顔検出により検出された顔画像に対してユーザが年齢や性別などの情報を付与するように構成されていてもよい。このように、上記の顔情報には、顔画像の類似度を比較するための情報が含まれている。そのため、顔情報を巧く利用することにより、画像系列の中から検出された顔画像が同一人物のものであるか否かを判定することが可能になる。【0029】  上記のようにして顔認識部104により検出された顔画像及び当該顔画像に対応する顔ID、検出時間、顔情報は、アクター生成部105に入力される。アクター生成部105は、本実施形態の顔クラスタリング方法におけるクラスタリングの対象(アクター)を生成する手段である。ここで言うアクターは、画像系列に登場する個々の人物に対応する。つまり、アクター生成部105は、各アクターの特徴を表すアクター情報を生成する。アクター情報は、顔認識部104によって検出された顔情報の集合により構成される。【0030】  ここで、図12に人物Aに対応するアクター情報の例を示す。図12に示すように、アクター情報は、顔情報を割り当てる所定数の特徴量スロットを有する。なお、特徴量スロットは、顔情報を割り当てるためのメモリ領域に相当する。アクター情報に設けられる特徴量スロットの種類及び数は任意に設定することができる。図12の例では、1つのアクター情報に対し、3つの顔の向き(左向き、正面、右向き)に対応する3つの特徴量スロットが設けられている。本実施形態の場合、各特徴量スロットに割り当て可能な顔情報の数は、所定数に制限される。そのため、画像系列から膨大な数の顔画像が検出されたとしても、1つのアクターを特徴付ける顔情報の数は制限される。【0031】  図12には、顔ID=Aの顔情報が検出時間順に並べて記載されている。以下の説明において、検出時間の早い順に1から番号を付し、例えば、A1、A2、…、A8などと表記して顔情報の顔IDと検出時間(検出順)を共に表す。また、図12の例では、各特徴量スロットに4つの空きスロット(顔情報を割り当て可能なメモリ領域)が設けられている。そのため、各特徴量スロットには、最大で4つの顔情報を割り当てることが可能である。図12の例に基づいて説明すると、アクター生成部105は、図13に示すように、まず、時系列に並んだ顔情報を顔の向きで分類する(Step.1)。次いで、アクター生成部105は、検出時間順に、顔の向きに応じた特徴量スロットへと顔情報を割り当てる(Step.2)。【0032】  但し、各特徴量スロットに割り当て可能な顔情報の数が限られているため、検出時間順が後の顔情報は、特徴量スロットに割り当てられなくなる。そこで、アクター生成部105は、図14に示すように、既に特徴量スロットに割り当てられた顔情報(以下、既存の顔情報)と、これから特徴量スロットに割り当てようとする顔情報(以下、新規の顔情報)とを比較し、最適な顔情報を選択する。例えば、アクター生成部105は、既存の顔情報A3、A4、A6、A7と、新規の顔情報A8とを比較し、既存の顔情報A4よりも新規の顔情報A8の方が適していると判断した場合、新規の顔情報A8を選択する。そして、アクター生成部105は、既存の顔情報A4を新規の顔情報A8に置き換える(Step.3)。【0033】  なお、最適な顔情報を選択する際、アクター生成部105は、例えば、「顔らしさ」「人物Aの顔らしさ」「他の顔情報との類似度」などのスコアを既存の顔情報と新規の顔情報との間で比較し、よりスコアの高い顔情報を選択する。顔の識別が容易な「正面に近い顔」や「ボケ、ぶれの少ない顔」を優先的に選んでもよい。アクター生成部105は、図14に示したStep3の処理を繰り返してアクター情報を生成する。なお、アクター生成部105は、顔ID毎にアクター情報を生成する。そのため、個々のアクター情報は、顔ID、及び特徴量スロットに割り当てられた顔情報などにより特徴付けられる。また、図12〜図14では「顔の向き」毎に特徴量スロットを設ける構成を例示したが、これに限定されない。【0034】  再び図1を参照する。上記のようにしてアクター生成部105により生成されたアクター情報は、アクタークラスタリング部106に入力される。アクタークラスタリング部106は、アクターを単位としてクラスタリングを実行してアクターの絞り込みを行う。本実施形態に係るアクタークラスタリング部106は、図15に示すように、階層的なクラスタリング手法(以下、予選/決勝方式)によりアクターの絞り込みを行う。まず、アクタークラスタリング部106は、最初にアクター(顔画像)が検出された時刻taSを解析開始時刻tbSとし、解析開始時刻tbSから所定期間tbR(以下、解析区間)に含まれるアクターをクラスタリングの対象として選択する。【0035】  図15の例では、アクターAを含む解析区間にアクターB、Cが含まれる。この場合、アクタークラスタリング部106は、アクターA、B、Cを対象にクラスタリングを実行する。同様に、アクターDを含む解析区間にはEが含まれるため、アクタークラスタリング部106は、アクターD、Eを対象にクラスタリングを実行する。さらに、アクターFを含む解析区間にはGが含まれるため、アクタークラスタリング部106は、アクターF、Gを対象にクラスタリングを実行する。なお、アクターHは、アクターFを含む解析区間内に入りきらない(例えば、H1,…,H8のうち、H7、H8が解析区間から外れてしまう。)ため、次の解析区間におけるクラスタリングの対象とされる。【0036】  このようにして第1階層のクラスタリングが実行され、特徴の近いアクターがマージされる。図15の例では、アクターBがアクターAに、アクターDがアクターEに、アクターI、JがアクターHにマージされている。ここで、マージとは、マージ対象のアクターに対応するアクター情報の特徴量スロットに割り当てられていた顔情報をマージ後のアクターに対応するアクター情報の特徴量スロットに再び割り当てなおすことを言う(例えば、図25を参照)。例えば、顔情報E1が割り当てられたスロット数2のアクターEに、顔情報D1、D2が割り当てられたアクターDをマージする場合、顔情報E1、D1、D2から最適な2つの顔情報を選択して、マージ後のアクターEに割り当てる。【0037】  第1階層のアクター群に対するクラスタリングが終了すると、アクタークラスタリング部106は、マージ後のアクター群を対象にして第2階層のクラスタリングを実行する。但し、第2階層における解析区間の長さは、第1階層における解析区間の長さよりも長く設定される。そして、第2階層のクラスタリングが終了すると、アクタークラスタリング部106は、第2階層のクラスタリングにおいてマージされたアクター群(第3階層のアクター群)の情報を記憶部102に格納する。なお、図15では3階層の場合を例示したが、階層数を4階層以上に設定することも可能である。また、各階層におけるクラスタリングの方法については後述する。【0038】  このようなクラスタリング手法によりマージされた最上位階層のアクター群は、同一人物を表していると考えられる。そこで、表示部101は、最上位階層の各アクターに対応する顔画像の登場シーンをアクター毎に表示する。このように、アクター毎に登場シーンが表示されることにより、画像系列の中で、どの人物が、どの時間帯に登場するかをユーザが容易に把握できるようになる。なお、上記のクラスタリング手法はスロット数が制限されたアクター情報を単位として実行されるため、アクター同士の類似判断を行う際に解析すべき顔情報の数が少なくて済み、同手法を実現するために要求されるメモリ容量や演算能力などの条件が緩和される。【0039】  以上、本実施形態に係る情報処理装置100の機能構成について簡単に説明した。但し、上記説明の中でクラスタリング手法に関する詳細な説明を省略した。そこで、以下では、情報処理装置100の動作について説明すると共に、顔クラスタリング方法について詳細に説明する。なお、アクタークラスタリング部106に含まれる第1クラスタリング部1061、及び第2クラスタリング部1062の機能については後述する。【0040】  ［1−2:情報処理装置100の動作(顔クラスタリング方法)］  以下、図2〜図25を参照しながら、情報処理装置100の動作、及び本実施形態に係る顔クラスタリング方法について詳細に説明する。なお、本実施形態に係る顔クラスタリング方法は、先に説明したアクター情報(図12〜図14を参照)に基づくクラスタリング手法に関する。【0041】  図2に示すように、情報処理装置100は、初期設定を実行する(S101)。この初期設定は、図5に示すように、ルートノードの設定(S201)、階層数の設定(S202)、階層毎のパラメータ設定(S203)の3ステップで実行される。先に述べた通り、本実施形態に係る顔クラスタリング方法は図15に示した予選/決勝方式に基づく。この予選/決勝方式を実現するには、最上位階層までの階層数(クラスタリングの実行回数)や各階層における解析区間の長さなど、パラメータの設定が必要になる。ステップS101においては、これらのパラメータが設定される。なお、パラメータの設定は、ユーザ入力に基づいて情報処理装置100により実行される。【0042】  再び図2を参照する。ステップS101に次いで、情報処理装置100は、データ取得部103の機能により、コンテンツを時系列で並べ替える(S102)。例えば、記憶部102に複数の動画や静止画が含まれている場合、データ取得部103は、動画や静止画のデータに付与された時間情報に基づいて記憶部102に格納されたデータの並べ替えを行う。次いで、情報処理装置100は、データ取得部103の機能により、動画や静止画などのコンテンツデータを記憶部102から取得する(S103)。次いで、情報処理装置100は、データ取得部103の機能により、取得したコンテンツデータが動画であるか否かを判定する(S104)。【0043】  コンテンツデータが動画である場合、情報処理装置100は、処理をステップS121(図3)に進める。一方、コンテンツデータが動画でない場合、情報処理装置100は、処理をステップS105に進める。処理をステップS105に進めた場合、情報処理装置100は、コンテンツデータが静止画であるか否かを判定する(S105)。コンテンツデータが静止画である場合、情報処理装置100は、処理をステップS106に進める。一方、コンテンツデータが静止画でない場合、情報処理装置100は、処理をステップS141(図4)に進める。【0044】  (コンテンツデータが静止画の場合)  ステップS106に処理を進めた場合、情報処理装置100は、顔認識部104の機能により、静止画から顔画像を検出する(S106)。次いで、情報処理装置100は、静止画から顔画像が検出されたか否かを判定する(S107)。顔画像が検出された場合、情報処理装置100は、処理をステップS108に進める。一方、顔画像が検出されない場合、情報処理装置100は、処理をステップS141(図4)に進める。【0045】  ステップS108に処理を進めた場合、情報処理装置100は、アクター生成部105の機能により、アクター情報を生成する(S108)。ここで、図6を参照しながら、ステップS108におけるアクター情報の生成に係る処理の流れについて説明を補足する。【0046】  図6に示すように、まず、アクター生成部105は、アクターを定義する(S211)。例えば、人物Aの顔画像が検出された場合、アクター生成部105は、図12に示すような人物Aのアクター情報の枠組みを生成する。例えば、アクター生成部105は、顔の向きに応じた複数の特徴量スロットを含み、各特徴量スロットに4つの顔情報を割り当て可能なアクター情報の枠組みを生成する。【0047】  次いで、アクター生成部105は、図13、図14に示したStep.1〜Step.3の要領でアクター情報を構成する特徴量スロットに顔情報を割り当てて顔情報の登録を行う(S212)。次いで、アクター生成部105は、各アクターを代表する顔画像(以下、代表顔画像)を選択し、アクター情報に対応付けることにより代表顔画像の登録を行う(S213)。以上の処理が終了すると、図2のステップS108におけるアクター情報の生成に係る処理が完了する。【0048】  再び図2を参照する。ステップS108に次いで、情報処理装置100は、アクタークラスタリング部106の機能により、予選/決勝方式に基づくクラスタリング(以下、アクタークラスタリング)を実行する(S109)。ここで、図7を参照しながら、ステップS109におけるアクタークラスタリングに係る処理の流れについて説明を補足する。【0049】  図7に示すように、まず、アクタークラスタリング部106は、アクターの発生開始時刻taS(図15を参照)を取得する(S221)。次いで、アクタークラスタリング部106は、下位階層から順にクラスタリングの対象となる階層を選択する(S222)。次いで、アクタークラスタリング部106は、ステップS222で選択した階層の解析開始時刻tbSと解析区間の長さ(範囲時間tbR)を取得する(S223)。次いで、アクタークラスタリング部106は、tbS+tbR<taSであるか否かを判定する(S224)。tbS+tbR<taSである場合、アクタークラスタリング部106は、処理をステップS225に進める。一方、tbS+tbR<taSでない場合、アクタークラスタリング部106は、処理をステップS227に進める。【0050】  ステップS225に処理を進めた場合、アクタークラスタリング部106は、解析対象とする階層(以下、対象階層)に対して解析を行う(S225)。ここで、図8を参照しながら、ステップS225における対象階層の解析に係る処理の流れについて説明を補足する。【0051】  図8に示すように、まず、アクタークラスタリング部106は、対象階層における解析開始時刻tbSと範囲時間tbRを取得する(S231)。次いで、アクタークラスタリング部106は、解析区間が時刻tbS〜時刻(tbS+tbR)に含まれるアクター情報を取得する(S232)。次いで、アクタークラスタリング部106は、ステップS232で取得したアクター情報を用いて、特徴が近いアクターをマージするマージ処理を実行する(S233)。ここで、図9を参照しながら、ステップS233におけるマージ処理の流れについて説明を補足する。【0052】  図9に示すように、まず、アクタークラスタリング部106は、マージアルゴリズム(第1のクラスタリング方式(図16〜図20を参照)、第2のクラスタリング方式(図21を参照))を選択する(S241)。なお、第1のクラスタリング方式、及び第2のクラスタリング方式については後述する。次いで、アクタークラスタリング部106は、選択したマージアルゴリズムを用いてアクター間の類似度を算出する(S242)。次いで、アクタークラスタリング部106は、マージ後に残ったアクター情報の数だけ新たなアクター情報の枠組みを生成する(S243)。次いで、アクタークラスタリング部106は、マージ前のアクター情報に含まれる顔情報を整理し、マージ後のアクター情報に含めるべき適切な顔情報を選択して新たなアクター情報にそれぞれ登録する(S244)。【0053】  つまり、アクタークラスタリング部106は、類似度の高いアクター同士を同一人物に対応するアクターであると認識してマージし、そのアクターに対応するアクター情報を生成する。先に説明したように、各アクター情報の特徴量スロットに割り当て可能な顔情報の数は制限されている。そのため、アクタークラスタリング部106は、マージ前に2つのアクター情報に含まれていた顔情報からマージ後のアクター情報に含めるべき適切な顔情報を選択し、選択した顔情報を新たなアクター情報に割り当てる。以上の処理が終了すると、図8のステップS233におけるマージ処理が完了する。【0054】  再び図8を参照する。ステップS233でアクター情報がマージされると、アクタークラスタリング部106は、マージ後のアクター情報を1つ上位階層の解析対象とする(S234)。以上の処理が終了すると、図7のステップS225における解析処理が完了する。【0055】  再び図7を参照する。ステップS225に次いで、アクタークラスタリング部106は、tbS=taSに設定し(S226)、処理をステップS227に進める。ステップS227に処理を進めると、アクタークラスタリング部106は、対象階層の1つ上位階層が最上位階層か否かを判定する(S227)。最上位階層である場合、アクタークラスタリング部106は、処理をステップS228に進める。一方、最上位階層でない場合、アクタークラスタリング部106は、対象階層を1つ上位階層に移動し、処理をステップS222に進める。【0056】  ステップS228に処理を進めた場合、アクタークラスタリング部106は、最上位階層にあるアクター情報を最下位階層の解析対象に追加する(S228)。以上の処理が終了すると、図2のステップS109におけるアクタークラスタリングに係る処理が完了する。ステップS109の処理が完了すると、情報処理装置100は、処理をステップS141(図4)に進める。【0057】  図4に示すように、情報処理装置100は、全コンテンツの解析が終了したか否かを判定する(S141)。全コンテンツの解析が終了した場合、情報処理装置100は、処理をステップS142に進める。一方、全コンテンツの解析が終了していない場合、情報処理装置100は、処理をステップS103(図2)に進める。ステップS142に処理を進めた場合、情報処理装置100は、アクタークラスタリング部106の機能により、最終的なクラスタリングの処理を実行する(S142)。ここで、図11を参照しながら、ステップS142におけるクラスタリング処理の流れについて説明を補足する。【0058】  図11に示すように、まず、アクタークラスタリング部106は、下位の階層から順に対象階層を選択する(S261)。次いで、アクタークラスタリング部106は、対象階層における解析開始時刻tbSと範囲時間tbRを取得する(S262)。次いで、アクタークラスタリング部106は、対象階層の解析を実行する(S263)。ステップS263における対象階層の解析に係る処理の流れは、図8を参照しながら既に説明したステップS225(図7)の処理と実質的に同じである。【0059】  次いで、アクタークラスタリング部106は、対象階層の1つ上位階層が最上位階層であるか否かを判定する(S264)。最上位階層である場合、アクタークラスタリング部106は、図4のステップS142に係るクラスタリング処理を完了する。一方、最上位階層でない場合、アクタークラスタリング部106は、処理をステップS265に進める。ステップS265に処理を進めた場合、アクタークラスタリング部106は、対象階層を1つ上位階層に移動し(S265)、処理をステップS261に進める。【0060】  以上の処理が終了すると、図4のステップS142におけるクラスタリング処理が完了する。再び図4を参照する。ステップS142に次いで、情報処理装置100は、記憶部102に格納されたアクター情報のデータベース(以下、アクター情報DB)を更新する(S143)。アクター情報DBが更新されると、表示部101は、更新後のアクター情報DBに基づいてアクター毎の顔情報や顔情報の登場タイミングなどを表示する。その後、情報処理装置100は、このような表示内容を受けて、ユーザによりアクター情報を修正するための入力があったか否かを判定する(S144)。修正するための入力があった場合、情報処理装置100は、処理をステップS143に進める。一方、修正するための入力がなかった場合、情報処理装置100は、一連の処理を終了する。【0061】  (コンテンツデータが動画の場合)  ところで、図2のステップS104において、コンテンツデータが動画であった場合、情報処理装置100は、処理をステップS121(図3)に進める。【0062】  図3に示すように、まず、情報処理装置100は、データ取得部103の機能により、記憶部102から動画フレームを読み込む(S121)。このとき、記憶部102に格納されていた動画データが符号化されたものであれば、データ取得部103は、動画データを復号して符号化なしの動画フレームを生成する。次いで、情報処理装置100は、顔認識部104の機能により、動画フレームに含まれる顔画像を検出したり、顔の向きや3次元的な位置などを検出したりする(S122)。【0063】  次いで、情報処理装置100は、顔認識部104の機能により、ステップS122で検出された顔画像に関する顔トラッキングを開始するか否かを判定する(S123)。顔トラッキングを開始する場合、情報処理装置100は、処理をステップS124に進める。一方、顔トラッキングを開始しない場合、情報処理装置100は、処理をステップS125に進める。ステップS124に処理を進めた場合、情報処理装置100は、顔認識部104による顔トラッキングの結果や顔情報などをアクター生成部105に入力し、アクター情報を生成する(S124)。ステップS124におけるアクター情報の生成に係る処理の流れは、図6を参照しながら既に説明したステップS108(図2)と実質的に同じである。【0064】  ステップS124の処理が完了すると、情報処理装置100は、処理をステップS125に進める。ステップS125に処理を進めると、情報処理装置100は、顔トラッキングを継続するか否かを判定する(S125)。顔トラッキングを継続する場合、情報処理装置100は、処理をステップS126に進める。一方、顔トラッキングを継続しない場合、情報処理装置100は、処理をステップS127に進める。ステップS127に処理を進めた場合、情報処理装置100は、アクター生成部105の機能により、アクター情報を更新する(S127)。ここで、図10を参照しながら、図3のステップS127におけるアクター情報におけるアクター情報の更新に係る処理の流れについて説明を補足する。【0065】  図10に示すように、まず、アクター生成部105は、更新の対象となるアクター情報を取得する(S251)。次いで、アクター生成部105は、取得したアクター情報を構成する特徴量スロットの空きを確認する(S252)。次いで、アクター生成部105は、ステップS252における確認により空きスロットが存在するか否かを判定する(S253)。空きスロットが存在する場合、アクター生成部105は、処理をステップS254に進める。一方、空きスロットが存在しない場合、アクター生成部105は、処理をステップS255に進める。【0066】  ステップS254に処理を進めた場合、アクター生成部105は、顔情報を特徴量スロットの空きに割り当てて当該顔情報を登録し(S254)、処理をステップS258に進める。一方、ステップS255に処理を進めた場合、アクター生成部105は、更新対象となる顔情報のスコアを計算する(S255)。つまり、アクター生成部105は、特徴量スロットに割り当てられている既存の顔情報と新規の顔情報とを比較し、アクター情報の特徴量として、より適切な顔情報を選出するためのスコアを計算する。【0067】  例えば、既存の全顔情報と新規の顔情報との類似度を算出し、その類似度の平均値を新規の顔情報に対するスコアとする。また、ある既存の顔情報(対象顔情報)と他の全ての既存の顔情報との類似度を算出し、その類似度の平均値を対象顔情報のスコアとする。つまり、このスコアは、似た特徴を持つ顔情報として集められた顔情報の集合に対し、どの程度類似しているかを表している。従って、スコアが高い顔情報は、既存の顔情報が持つ特徴を強く反映したものであり、既存の顔情報で形成される集合に適していると言える。また、類似度以外のスコア尺度として、顔の識別が容易な「正面に近い顔」や「ボケ、ぶれの少ない顔」のスコアが高くなるようにしてもよい。なお、上記のスコアは、顔情報間の類似度の平均値や「正面に近い顔」「ボケ、ぶれの少ない顔」の値に限定されず、アクター情報に含めるべき顔情報の優先度を決めることが可能な指標であればよい。【0068】  次いで、アクター生成部105は、新規の顔情報のスコアが、既存の顔情報のスコアの中で最低のスコアよりも大きいか否かを判定する(S256)。最低のスコアよりも大きい場合、アクター生成部105は、処理をステップS257に進める。一方、最低のスコアよりも大きくない場合、アクター生成部105は、処理をステップS258に進める。処理をステップS257に進めた場合、アクター生成部105は、既存の顔情報の中で最低スコアの顔情報と、新規の顔情報とを交換し(S257)、処理をステップS258に進める。【0069】  ステップS258に処理を進めると、アクター生成部105は、更新した顔情報のスコア(以下、更新顔スコア)と、アクター情報の代表顔画像に対応する顔情報のスコア(以下、代表顔スコア)とを比較し、更新顔スコア>代表顔スコアであるか否かを判定する(S258)。更新顔スコア>代表顔スコアである場合、アクター生成部105は、処理をステップS259に進める。一方、更新顔スコア>代表顔スコアでない場合、アクター生成部105は、図3のステップS126におけるアクター情報の更新に係る処理を完了する。ステップS259に処理を進めた場合、アクター生成部105は、既存の代表顔画像を新たな顔情報に対応する顔画像に更新し(S259)、図3のステップS126におけるアクター情報の更新に係る処理を完了する。【0070】  再び図3を参照する。ステップS126におけるアクター情報の更新に係る処理が完了すると、情報処理装置100は、処理をステップS127に進める。次いで、情報処理装置100は、顔トラッキングを終了するか否かを判定する(S127)。顔トラッキングを終了する場合、情報処理装置100は、処理をステップS128に進める。一方、顔トラッキングを終了しない場合、情報処理装置100は、処理をステップS130に進める。処理をステップS128に進めた場合、情報処理装置100は、顔トラッキングが終了した後で得られたアクター情報をクラスタリングの対象とするアクター情報として選択し(S128)、処理をステップS129に進める。【0071】  次いで、情報処理装置100は、アクタークラスタリング部106の機能により、選択したアクター情報を対象としてクラスタリングを実行し(S129)、処理をステップS130に進める。なお、ステップS129におけるアクタークラスタリングの実行に係る処理の流れは、図7を参照しながら既に説明したステップS109(図2)と実質的に同じである。ステップS130に処理を進めると、情報処理装置100は、現在の動画フレームが最終読み込みフレームであるか否かを判定する(S130)。最終読み込みフレームである場合、情報処理装置100は、処理をステップS141(図4)に進める。一方、最終読み込みフレームでない場合、情報処理装置100は、処理をステップS121に進める。【0072】  図4に示すように、情報処理装置100は、全コンテンツの解析が終了したか否かを判定する(S141)。全コンテンツの解析が終了した場合、情報処理装置100は、処理をステップS142に進める。一方、全コンテンツの解析が終了していない場合、情報処理装置100は、処理をステップS103(図2)に進める。ステップS142に処理を進めた場合、情報処理装置100は、アクタークラスタリング部106の機能により、最終的なクラスタリングの処理を実行する(S142)。【0073】  次いで、情報処理装置100は、記憶部102に格納されたアクター情報のデータベース(アクター情報DB)を更新する(S143)。アクター情報DBが更新されると、表示部101は、更新後のアクター情報DBに基づいてアクター毎の顔情報や顔情報の登場タイミングなどを表示する。その後、情報処理装置100は、このような表示内容を受けて、ユーザによりアクター情報を修正するための入力があったか否かを判定する(S144)。修正するための入力があった場合、情報処理装置100は、処理をステップS143に進める。一方、修正するための入力がなかった場合、情報処理装置100は、一連の処理を終了する。【0074】  以上、情報処理装置100の動作、及び本実施形態に係る顔クラスタリング方法について説明した。但し、予選/決勝方式に係るクラスタリング方法(第1クラスタリング方式、第2クラスタリング方式)については詳細な説明を省略していた。そこで、以下では、本実施形態に係る第1クラスタリング及び第2クラスタリング方式について説明する。【0075】  (1−2−1:第1クラスタリング方式)  まず、図16〜図20を参照しながら、本実施形態に係る第1クラスタリング方式について説明する。なお、第1クラスタリング方式に基づくクラスタリングは、アクタークラスタリング部106に含まれる第1クラスタリング部1061の機能により実現される。【0076】  図16に示すように、第1クラスタリング方式は、クラスタリングの対象となる全てのアクター情報に含まれた各顔情報の類似度に基づく方式である。なお、初期に与えられる各アクター情報は、例えば、特開2010−3021号公報に記載の判別器を用いた顔認識手法や顔トラッキング手法に基づいて検出された類似の顔情報を集めたものである。【0077】  顔トラッキング手法を用いると、向きの異なる同一人物の顔情報を同じアクター情報に含めることが可能になる。しかしながら、同一人物の顔情報であっても、大きく向きの異なる顔情報同士の類似度は低い。そのため、同一人物に対応するアクター情報であっても、顔の向きが互いに異なる顔情報で構成されたアクター情報同士の類似度は低くなる。そこで、第1クラスタリング方式は、アクター情報に含まれる顔情報をばらばらに扱う。【0078】  図15の例において、アクターAを含む解析区間の中にアクターB、Cが含まれる。そのため、クラスタリングの対象となるアクター情報は、人物A、B、Cのアクター情報となる。この場合、第1クラスタリング方式においては、図16に示すように、人物A、B、Cのアクター情報に含まれる顔情報の全てがクラスタリングの対象になる。以下では、具体的に、上記の人物A、B、Cのアクター情報をクラスタリングの対象とする場合について説明する。なお、図16に示すように、人物Aのアクター情報は、顔情報A1、A2、…、A5を含むものとする。また、人物Bのアクター情報は、顔情報B1、B2、…、B8を含むものとする。そして、人物Cのアクター情報は、顔情報C1、C2、…、C9を含むものとする。【0079】  アクター情報A、B、Cが与えられると、第1クラスタリング部1061は、アクター情報A、B、Cに含まれる顔情報A1、…、A5、B1、…、B8、C1、…、C9を各アクター情報から抽出する。次いで、第1クラスタリング部1061は、各顔情報の類似度を算出し、図17に示すように、類似度の高い顔情報を集約してクラスタを生成する。なお、各顔情報の類似度は、例えば、各顔画像を特徴付ける特徴量ベクトル間のユークリッド距離に基づいて算出される。【0080】  次に、第1クラスタリング部1061は、各顔情報に含まれる顔の向きに基づいて各顔情報を分類する。図17には、クラスタ(1)を分類する例が示されている。図17の例では、顔情報A2、A5、B1、C7、C8、C9が「顔の向き=正面」に分類され、顔情報B3、B6が「顔の向き=右向き」に分類されている。また、この例では、「顔の向き=左向き」には顔情報が分類されていない。【0081】  次に、第1クラスタリング部1061は、顔の向き別に重み係数を生成する。この重み係数は、クラスタ(1)における各顔の向きの重要度を表す。例えば、この重み係数は、各顔の向きに分類された顔情報の数に基づいて算出される。クラスタ(1)の例では、左向きに分類された顔情報の個数が0、正面に分類された顔情報の個数が6、右向きに分類された顔情報の個数が2である。そこで、個数が最大の向きに対応する重み係数を1とし、他の向きに対応する重み係数は顔情報の個数に応じて決める。例えば、クラスタ(1)の場合、正面に対応する重み係数は1、左向きに対応する重み係数は0、右向きに対応する重み係数は2/8=0.25と算出される。【0082】  さらに、第1クラスタリング部1061は、算出した重み係数に基づいて各アクター情報のスコアを算出する。このスコアは、各アクター情報に対応する顔情報の個数×重み係数の和で算出される。例えば、人物Aのアクター情報に対応するスコアは、(左向き)重み係数0×個数0+(正面)重み係数1×個数2+(右向き)重み係数0.25×個数0=2となる。同様に、人物Bのアクター情報に対応するスコアは、(左向き)重み係数0×個数0+(正面)重み係数1×個数1+(右向き)重み係数0.25×個数2=1.5となる。そして、人物Cのアクター情報に対応するスコアは、(左向き)重み係数0×個数0+(正面)重み係数1×個数3+(右向き)重み係数0.25×個数0=3となる。【0083】  上記のスコアは、仮代表となるアクター情報を選出するために用いる。例えば、クラスタ(1)の場合、人物Aのアクター情報に対応するスコアは2、人物Bのアクター情報に対応するスコアは1.5、人物Cのアクター情報に対応するスコアは3であるから、人物Cのアクター情報が仮代表に選出される。この仮代表は、そのクラスタ(この場合はクラスタ(1))に対応する人物の推定値を表す。つまり、クラスタ(1)は、人物Cの特徴を表す顔情報の集合であると推定されるのである。第1クラスタリング部1061は、クラスタ(2)(3)についても同様にアクター情報のスコアを算出し、その算出結果から各クラスタの仮代表を選出する。【0084】  図17に例示したクラスタ(1)〜(3)に対しては、図18に示すように、それぞれ仮代表C、C、Bが選出される。そこで、図18に示すように、各クラスタを構成する顔情報に仮代表を表すラベルを付して表記することにする。つまり、仮代表Cのクラスタ(1)に含まれる顔情報A2には、仮代表Cを示すラベルcを付して顔情報A2cと表記する。この表記法を用いると、クラスタ(1)〜(3)に含まれる各顔情報は、図18の中段に示すような形で表現される。さらに、この表記のまま、各人物に対応する元のアクター情報に仕分け直すと、図18の下段に示すような形で表現される。【0085】  図18の例では、人物Aに対応するアクター情報は、顔情報A1c、A2c、A3c、A4b、A5cを含むことになる。同様に、人物Bに対応するアクター情報は、顔情報B1c、B2b、B3c、B4b、B5b、B6c、B7b、B8bを含むことになる。そして、人物Cに対応するアクター情報は、顔情報C1c、C2c、C3c、C4c、C5c、C6c、C7c、C8c、C9cを含むことになる。【0086】  つまり、人物Aに対応するアクター情報には、仮代表Bに対応する顔情報が1個、仮代表Cに対応する顔情報が4個含まれることになる。また、人物Bに対応するアクター情報には、仮代表Bに対応する顔情報が5個、仮代表Cに対応する顔情報が3個含まれることになる。そして、人物Cに対応するアクター情報には、仮代表Cに対応する顔情報が9個含まれることになる。【0087】  各アクター情報について、仮代表毎に算出した顔情報の個数が最大となる仮代表の種類を抽出すると、人物Aに対応するアクター情報は仮代表C、人物Bに対応するアクター情報は仮代表B、人物Cに対応するアクター情報は仮代表Cである。この結果から、人物Aと人物Cは同一人物の可能性が高いと推定される。そこで、第1クラスタリング部1061は、人物Aのアクター情報を人物Cのアクター情報にマージする。そして、第1クラスタリング部1061は、後述するマージ後判定の処理に進む。【0088】  なお、仮代表を選出する処理において、スコアが最大になる人物のアクター情報を仮代表に選出したが、スコアの最大値が所定の閾値を越えない場合には仮代表なしとして処理する。また、仮代表毎に算出した顔情報の個数が最大となる仮代表の種類を抽出する処理において、その個数が所定の閾値を越えない場合にはマージしない。【0089】  さて、アクター情報をマージした第1クラスタリング部1061は、次に、マージ後判定の処理を実行する。ここで言うマージ後判定の処理とは、実際には起こりえない状況を想定して、マージ結果が正しいか否かを判定する処理である。例えば、図18の例では人物Aと人物Cとが同一人物と仮に判定されたが、この結果が正しければ同じ動画フレームの中で同時に人物Aと人物Cが登場することはない。そこで、第1クラスタリング部1061は、人物Aのアクター情報を構成する顔情報の登場時間と、人物Cのアクター情報を構成する顔情報の登場時間とを比較し、同じ時間に人物A、Cが登場しているか否かを判定する。【0090】  例えば、図19の例では、人物A、Cの登場時間に重なりがない。従って、人物Aが人物Cと同一人物であることを否定できない。そこで、第1クラスタリング部1061は、人物Aのアクター情報を人物Cのアクター情報にマージする。一方、図20の例では、人物A、Cの登場時間に重なりがある。従って、人物Aが人物Cと同一人物ではないと考えられる。そこで、第1クラスタリング部1061は、人物Aのアクター情報を人物Cのアクター情報にマージしない。また、人物A、Cの性別や年齢などの属性情報が予め分かっている場合、第1クラスタリング部1061は、その属性情報から得られる人物A、Cの同一性について矛盾がある場合には人物Aのアクター情報を人物Cのアクター情報にマージしない。【0091】  このように、マージ後判定を行うことによって誤判定を未然に防止し、クラスタリングの精度を高めることができる。また、さらにクラスタリングの精度を高めるために、第1クラスタリング部1061は、マージ結果を用いて再びアクター情報のマージを行う。例えば、上記の例で人物A、Cのアクター情報がマージされた場合、第1クラスタリング部1061は、上記説明した手順でマージ後のアクター情報に対応する仮代表を選出し、他のアクター情報とマージするか否かを判定する。マージされた場合、第1クラスタリング部1061は、再びマージ後のアクター情報に対応する仮代表を選出し、他のアクター情報とマージするか否かを判定する。このように、第1クラスタリング部1061は、このマージ処理を所定回数又はマージが起こらなくなるまで繰り返す。この繰り返し処理により、さらにクラスタリングの精度が向上する。【0092】  以上、本実施形態に係る第1クラスタリング方式について説明した。【0093】  (1−2−2:第2クラスタリング方式)  次に、図21を参照しながら、本実施形態に係る第2クラスタリング方式について説明する。なお、第2クラスタリング方式に基づくクラスタリングは、アクタークラスタリング部106に含まれる第2クラスタリング部1062の機能により実現される。【0094】  図21に示すように、第2クラスタリング方式に基づくクラスタリングは、各アクター情報同士の類似度に基づいて行われる。つまり、第1クラスタリング方式とは異なり、第2クラスタリング方式は、各アクター情報を構成する顔情報をばらばらにしない。【0095】  まず、第2クラスタリング部1062は、比較対象とするアクター情報を選択する。図21の例では、人物Aのアクター情報と人物Bのアクター情報が選択されている。比較対象のアクター情報を選択した第2クラスタリング部1062は、選択したアクター情報間で各顔情報同士の類似度計算を実行する。例えば、人物Aのアクター情報にn個の顔情報が含まれており、人物Bのアクター情報にm個の顔情報が含まれている場合、n×m通りの組み合わせについて顔情報の類似度が算出される。なお、顔情報の類似度は、特徴量ベクトルで表現される顔特徴量間のユークリッド距離などを算出することにより得られる。【0096】  このとき、第2クラスタリング部1062は、各顔情報に含まれる顔の向きを考慮し、同じ顔の向き(例えば、「正面」)に顔特徴量を変換してから顔情報の類似度を算出する。次に、第2クラスタリング部1062は、算出した類似度を加重平均し、各アクター情報同士の組み合わせに対応する類似度スコアを算出する。そして、第2クラスタリング部1062は、類似度スコアが所定の閾値を越えるアクター情報をマージ候補のアクター情報として選出する。次いで、第2クラスタリング部1062は、マージ候補のアクター情報について、第1クラスタリング方式と同様にマージ後判定(図19、図20を参照)を行う。【0097】  例えば、第2クラスタリング部1062は、マージ候補のアクター情報を構成する顔情報に時間的な重なりがある場合、或いは、属性情報に基づいて同一人物であることが否定される場合、マージ候補のアクター情報をマージしない。一方、第2クラスタリング部1062は、マージ後判定により同一人物に対応することが否定されなかったマージ候補のアクター情報をマージする。さらに、第2クラスタリング部1062は、比較対象とする他のアクター情報を選択し、上記説明した方法と同様にして類似スコアの算出、閾値判定、マージ後判定を実施し、マージするか否かを判定する。そして、第2クラスタリング部1062は、全てのアクター情報の組み合わせについてマージするか否かを判定し、マージすべきと判定されたアクター情報をマージする。【0098】  以上、本実施形態に係る第2クラスタリング方式について説明した。【0099】  (1−2−3:適用ステップについて)  ここで、図2〜図11に示した本実施形態に係る顔クラスタリング方法の処理ステップの中で、上記第1及び第2クラスタリング方式に基づくクラスタリング処理が適用される処理ステップについて説明を補足する。上記第1及び第2クラスタリング方式に基づくクラスタリングは、図2のステップS109(詳細は図7など)、図3のステップS129(詳細は図7など)、図4のステップS142(詳細は図11など)に適用される。つまり、図15に示した予選/決勝方式における各階層でのクラスタリングに適用される。どの処理ステップで、いずれのクラスタリング方式を採用するかは、例えば、図2のステップS101における初期設定で予め決めておくか、自動選択する仕組みを設けておく。【0100】  自動選択する仕組みの例としては次のようなものがある。なお、自動選択の処理は、アクタークラスタリング部106により実行される。また、後述するシーンの判定には、既存のシーン検出技術を適用すればよい。【0101】  (1)コンテンツデータが動画であり、複数のシーンを跨ぐようなアクター情報同士のマージには、第1クラスタリング方式が適用されるようにする。複数のシーンを跨ぐような場面では、撮影環境の変化が大きく、顔の特徴が大きく変化してしまう。そのため、同一人物に対応するアクター情報同士でも、類似スコアが低下してしまう傾向にある。そのため、複数のシーンを跨ぐようなアクター情報同士のマージには第2クラスタリング方式は適さず、上記のように第1クラスタリング方式が適用される。【0102】  (2)コンテンツデータが動画であり、同一シーン内の顔情報を含むアクター情報をマージする場合には、第1クラスタリング方式が適用されるようにする。同一シーン内では、同じ人物が様々な時間区間で登場する可能性が高い。そのため、本来は同一人物に対応するものであるが、複数のアクター情報として検出されてしまう。そこで、複数のアクター情報を構成する顔情報の全体に基づいてアクター情報のマージを行う方が効率的である。特に、同一人物に対応するアクター情報が3つ以上存在するような場合には、第2クラスタリング方式よりも第1クラスタリング方式の方が適当である。そのため、同一シーン内の顔情報を含むアクター情報をマージする場合には、上記のように第1クラスタリング方式が適用される。【0103】  (3)第1クラスタリング方式に基づくアクター情報のマージ後に、アクター情報の数が所定数を越える場合には、さらに第2クラスタリング方式が適用されるようにする。個々の顔情報に基づくクラスタリングではアクター情報の絞り込みが十分に行われない可能性が否定できない。このように絞り込みが十分に行われない場合、アクター情報を構成する顔情報の全体を用いてクラスタリングする第2クラスタリング方式をさらに適用することで、アクター情報の十分な絞り込みが可能になると考えられる。そのため、第1クラスタリング方式に基づくアクター情報のマージ後に、アクター情報の数が所定数を越える場合には、さらに第2クラスタリング方式が適用されるようにする。【0104】  以上説明したように、第1及び第2クラスタリング方式は、シーンの特徴や絞り込み状況に応じて適宜自動選択されるようにすることができる。もちろん、初期設定により、どの階層のクラスタリングに対し、いずれのクラスタリング方式を適用するかを予め設定しておいてもよい。【0105】  ［1−3:性能改善策］  ここで、図22〜図25を参照しながら、本実施形態に係る顔クラスタリング方法の更なる性能改善策について説明する。【0106】  (1−3−1:性能改善策1)  まず、図22を参照しながら、第1の性能改善策(以下、性能改善策1)について説明する。先に説明した通り、各アクター情報には、特徴量スロットが設けられている。そして、アクター情報を生成する際、特徴量スロットの空きスロットには、検出時間の早い順に顔情報が割り当てられる。また、特徴量スロットが全て埋まった後は、検出時間の早い順に顔情報の更新が行われ、最適な顔情報が特徴量スロットに割り当てられる。【0107】  しかしながら、連写写真や近傍の動画フレームなど(以下、近接区間)から顔情報を検出した場合、顔情報の特徴が近い。そのため、こうした近接区間で検出された顔情報が特徴量スロットを埋めてしまうと、離れた区間で検出された顔情報は、その特徴量スロットに対するスコアが低いものとなり、顔情報の更新が妨げられてしまう。このように、一部区間で検出された、似た特徴を持つ顔情報で特徴量スロットが占有されてしまうと、アクター情報の特徴が1つの顔情報が持つ特徴と同程度の価値(情報量)になってしまう。その結果、アクター情報を単位とするクラスタリングの利点が失われてしまう。【0108】  そこで、性能改善策1として、特徴量スロットに割り当てる顔情報を離れた区間から抽出するようにアクター生成部105の機能構成を改良する。まず、アクター生成部105は、顔情報の出現区間を分割し、各出現区間の顔情報数を算出する。さらに、アクター生成部105は、顔情報数に応じた重みを算出し、算出した重みに応じて特徴量スロットに割り当てる顔情報を選択する。このような構成にすると、ばらばらに離れた区間から、近接区間の長短も考慮した適切な顔情報を特徴量スロットに割り当てることが可能になる。【0109】  (1−3−2:性能改善策2)  次に、図23を参照しながら、第2の性能改善策(以下、性能改善策2)について説明する。図19、図20を参照しながら既に説明したように、第1クラスタリング部1061は、マージ後判定として、マージ対象とされるアクター情報に対応する人物の登場時間に重なりが無いかを判定する。そして、第1クラスタリング部1061は、図20に示すように人物の登場時間に重なりがある場合にはマージをしない。【0110】  図23の例は、人物A、Cのアクター情報に、仮代表Bに対応する顔情報が多数含まれる場合における顔情報の検出時間を示したものである。なお、太線で表示された顔情報は、仮代表Bに対応する顔情報である。この場合、人物A、B、Cは同一人物の可能性があり、人物A、B、Cのアクター情報がマージ候補となる。但し、図23の例では、人物Aの登場時間と人物Bの登場時間には重なりがある。そのため、マージ後判定において、人物A、Bは同一人物ではないと判定される。同様に、人物Aの登場時間と人物Cの登場時間には重なりがある。そのため、人物A、Cは同一人物ではないと判定される。【0111】  一方、人物Bの登場時間と人物Cの登場時間には重なりがない。そのため、図19、図20を参照しながら説明したマージ後判定によれば、人物B、Cのアクター情報はマージされる。しかしながら、人物A、B、Cは、仮代表に基づく判定の結果、同一人物と仮定されていた。そこで、人物A≠C、人物A≠Bという、マージ後判定に基づく上記の結果を受けて、間接的に人物B≠Cと判定する。このように、仮代表に基づく人物の同一性判定結果と、登場時間に基づくマージ後判定の結果とを併せて考慮することにより、よりクラスタリングの精度を向上させることが可能になる。【0112】  (1−3−3:性能改善策3)  次に、図24を参照しながら、第3の性能改善策(以下、性能改善策3)について説明する。時間的・空間的に近い人物の顔情報ほど纏まりやすい傾向がある。例えば、時間的に近い画像には同一人物の顔画像が含まれている可能性が高い。また、連続する動画フレームにおいて、同一人物の顔画像の空間的な位置は大きく変化しない。そのため、時間的・空間的に近い人物の顔情報を含むアクター情報ほどマージされやすくなる。しかしながら、図15を参照しながら説明した予選/決勝方式の場合、下位の階層において、比較的短い解析区間により解析対象となるアクター情報が分断されてしまう。そのため、解析区間の境目付近にあるアクター情報の類似性が下位階層で検討されない可能性がある。【0113】  そこで、下位階層において第2クラスタリング方式に基づくクラスタリングを実行しておき、図24に示すように、その結果を上位階層に反映される。例えば、図24の例では、下位階層にて第2クラスタリング方式に基づくクラスタリングを実行した結果、人物Bと人物Dとが同一人物と判定されている。例えば、下位階層において第1クラスタリング方式に基づくクラスタリングを実行した場合に、上位階層においてアクター情報A、C、D、Eが得られるものとする。この場合、下位階層において人物B、Dが同一人物と判定されているから、下位階層の人物Dに対応する上位階層のアクター情報Dは、下位階層の人物Bに対応する上位階層のアクター情報Aにマージされる。このように、下位階層におけるアクター情報の類似性を考慮することにより、よりクラスタリングの精度を向上させることが可能になる。【0114】  (1−3−4:性能改善策4)  次に、図25を参照しながら、第4の性能改善策(以下、性能改善策4)について説明する。先に説明したように、ある2つのアクター情報がマージされると、これらアクター情報に含まれる顔情報の一部が失われる。図25には、人物Aのアクター情報と、人物Bのアクター情報とをマージする例が示されている。この例では、人物Aのアクター情報に顔情報A1、A2が含まれ、人物Bのアクター情報に顔情報B1、B2、B3、B4が含まれている。さらに、マージ後のアクター情報(以下、マージアクター情報)には、顔情報A1、B2、B3、B4が含まれている。つまり、マージの結果、顔情報A2、B1が失われてしまう。【0115】  このような情報の欠損を防ぐには、階層構造、及び下位階層のアクター情報を保持しておけばよい。また、マージする際、顔情報とアクター情報との間の対応関係を操作するのではなく、顔IDとアクター情報との間の対応関係を操作するようにすればよい。このように、階層構造や顔情報を残しておくことにより、下位階層の顔情報を欠損することがなくなり、下位階層の顔情報を利用した追加的な処理が可能になる。つまり、下位階層の顔情報を適宜利用することにより、クラスタリングの精度を向上させることができる。【0116】  以上、本実施形態に係る性能改善策について説明した。【0117】  ［1−4:ハードウェア構成例］  上記の情報処理装置100が有する各構成要素の機能は、例えば、図26に示す情報処理装置のハードウェア構成を用いて実現することが可能である。つまり、当該各構成要素の機能は、コンピュータプログラムを用いて図26に示すハードウェアを制御することにより実現される。なお、このハードウェアの形態は任意であり、例えば、パーソナルコンピュータ、携帯電話、PHS、PDA等の携帯情報端末、ゲーム機、又は種々の情報家電がこれに含まれる。但し、上記のPHSは、Personal  Handy−phone  Systemの略である。また、上記のPDAは、Personal  Digital  Assistantの略である。【0118】  図26に示すように、このハードウェアは、主に、CPU902と、ROM904と、RAM906と、ホストバス908と、ブリッジ910と、を有する。さらに、このハードウェアは、外部バス912と、インターフェース914と、入力部916と、出力部918と、記憶部920と、ドライブ922と、接続ポート924と、通信部926と、を有する。但し、上記のCPUは、Central  Processing  Unitの略である。また、上記のROMは、Read  Only  Memoryの略である。そして、上記のRAMは、Random  Access  Memoryの略である。【0119】  CPU902は、例えば、演算処理装置又は制御装置として機能し、ROM904、RAM906、記憶部920、又はリムーバブル記録媒体928に記録された各種プログラムに基づいて各構成要素の動作全般又はその一部を制御する。ROM904は、CPU902に読み込まれるプログラムや演算に用いるデータ等を格納する手段である。RAM906には、例えば、CPU902に読み込まれるプログラムや、そのプログラムを実行する際に適宜変化する各種パラメータ等が一時的又は永続的に格納される。【0120】  これらの構成要素は、例えば、高速なデータ伝送が可能なホストバス908を介して相互に接続される。一方、ホストバス908は、例えば、ブリッジ910を介して比較的データ伝送速度が低速な外部バス912に接続される。また、入力部916としては、例えば、マウス、キーボード、タッチパネル、ボタン、スイッチ、及びレバー等が用いられる。さらに、入力部916としては、赤外線やその他の電波を利用して制御信号を送信することが可能なリモートコントローラが用いられることもある。【0121】  出力部918としては、例えば、CRT、LCD、PDP、又はELD等のディスプレイ装置、スピーカ、ヘッドホン等のオーディオ出力装置、プリンタ、携帯電話、又はファクシミリ等、取得した情報を利用者に対して視覚的又は聴覚的に通知することが可能な装置である。但し、上記のCRTは、Cathode  Ray  Tubeの略である。また、上記のLCDは、Liquid  Crystal  Displayの略である。そして、上記のPDPは、Plasma  DisplayPanelの略である。さらに、上記のELDは、Electro−Luminescence  Displayの略である。【0122】  記憶部920は、各種のデータを格納するための装置である。記憶部920としては、例えば、ハードディスクドライブ(HDD)等の磁気記憶デバイス、半導体記憶デバイス、光記憶デバイス、又は光磁気記憶デバイス等が用いられる。但し、上記のHDDは、Hard  Disk  Driveの略である。【0123】  ドライブ922は、例えば、磁気ディスク、光ディスク、光磁気ディスク、又は半導体メモリ等のリムーバブル記録媒体928に記録された情報を読み出し、又はリムーバブル記録媒体928に情報を書き込む装置である。リムーバブル記録媒体928は、例えば、DVDメディア、Blu−rayメディア、HD  DVDメディア、各種の半導体記憶メディア等である。もちろん、リムーバブル記録媒体928は、例えば、非接触型ICチップを搭載したICカード、又は電子機器等であってもよい。但し、上記のICは、Integrated  Circuitの略である。【0124】  接続ポート924は、例えば、USBポート、IEEE1394ポート、SCSI、RS−232Cポート、又は光オーディオ端子等のような外部接続機器930を接続するためのポートである。外部接続機器930は、例えば、プリンタ、携帯音楽プレーヤ、デジタルカメラ、デジタルビデオカメラ、又はICレコーダ等である。但し、上記のUSBは、Universal  Serial  Busの略である。また、上記のSCSIは、Small  Computer  System  Interfaceの略である。【0125】  通信部926は、ネットワーク932に接続するための通信デバイスであり、例えば、有線又は無線LAN、Bluetooth(登録商標)、又はWUSB用の通信カード、光通信用のルータ、ADSL用のルータ、又は各種通信用のモデム等である。また、通信部926に接続されるネットワーク932は、有線又は無線により接続されたネットワークにより構成され、例えば、インターネット、家庭内LAN、赤外線通信、可視光通信、放送、又は衛星通信等である。但し、上記のLANは、Local  Area  Networkの略である。また、上記のWUSBは、Wireless  USBの略である。そして、上記のADSLは、Asymmetric  Digital  Subscriber  Lineの略である。【0126】  <2:まとめ>  最後に、本発明の実施形態に係る技術内容について簡単に纏める。ここで述べる技術内容は、例えば、PC、携帯電話、携帯ゲーム機、携帯情報端末、情報家電、カーナビゲーションシステム等、種々の情報処理装置に対して適用することができる。【0127】  上記の情報処理装置の機能構成は次のように表現することができる。当該情報処理装置は、次のような顔検出部、顔向き検出部、顔識別部、単位グループ設定部、クラスタリング部により構成される。上記の顔検出部は、画像に含まれる顔を検出するものである。また、上記の顔向き検出部は、前記顔検出部により検出された顔の向きを検出するものである。そして、上記の顔識別部は、前記顔向き検出部により検出された顔の向きを考慮し、特徴が近い顔を検出して当該顔の特徴を表す顔情報の集合を形成するものである。【0128】  また、上記の単位グループ設定部は、前記顔識別部により形成された各顔情報の集合について、前記顔向き検出部により検出された顔の向きに基づいて顔の向き毎に予め設定された数まで顔情報の数を絞り込み、数が絞り込まれた各顔情報の集合を単位グループに設定するものである。さらに、上記のクラスタリング部は、前記単位グループ設定部により設定された単位グループを単位として、当該各単位グループに含まれる顔情報に基づくクラスタリングを実行するものである。このように、単位グループ設定部により顔情報が絞り込まれることにより、多数の顔情報が検出されるような動画などを対象とする場合でも、少ないメモリ容量で効率良く顔クラスタリングを実行することが可能になる。【0129】  (備考)  上記の顔認識部104は、顔検出部、顔向き検出部、顔識別部の一例である。上記のアクター生成部105は、単位グループ設定部の一例である。上記のアクタークラスタリング部106は、クラスタリング部の一例である。上記の第1クラスタリング部1061は、第1マージ部の一例である。上記の第2クラスタリング部1062は、第2マージ部の一例である。上記のアクター情報は、単位グループの一例である。【0130】  以上、添付図面を参照しながら本発明の好適な実施形態について説明したが、本発明は係る例に限定されないことは言うまでもない。当業者であれば、特許請求の範囲に記載された範疇内において、各種の変更例または修正例に想到し得ることは明らかであり、それらについても当然に本発明の技術的範囲に属するものと了解される。【符号の説明】【0131】  100    情報処理装置  101    表示部  102    記憶部  103    データ取得部  104    顔認識部  105    アクター生成部  106    アクタークラスタリング部  1061  第1クラスタリング部  1062  第2クラスタリング部
【特許請求の範囲】【請求項1】  画像に含まれる顔を検出する顔検出部と、  前記顔検出部により検出された顔の向きを検出する顔向き検出部と、  前記顔向き検出部により検出された顔の向きを考慮し、特徴が近い顔を検出して当該顔の特徴を表す顔情報の集合を形成する顔識別部と、  前記顔識別部により形成された各顔情報の集合について、前記顔向き検出部により検出された顔の向きに基づいて顔の向き毎に予め設定された数まで顔情報の数を絞り込み、数が絞り込まれた各顔情報の集合を単位グループに設定する単位グループ設定部と、  前記単位グループ設定部により設定された単位グループを単位として、当該各単位グループに含まれる顔情報に基づくクラスタリングを実行するクラスタリング部と、を備える、  顔クラスタリング装置。【請求項2】  前記単位グループ設定部により設定された単位グループを第1の単位グループ、第k(k=1〜N)の単位グループに基づいて設定された単位グループを第(k+1)の単位グループと表現すると、  前記クラスタリング部は、前記第1の単位グループのうち、所定の第1時間T1で区切った各区間内に存在する単位グループを対象にし、特徴が近い単位グループをマージして第2の単位グループを設定し、前記第kの単位グループのうち、所定の第k時間Tk(Tk>Tk−1)で区切った各区間内に存在する単位グループを対象にし、特徴が近い単位グループをマージして第(k+1)の単位グループを設定するステップをk=2〜Nについて順次実行する、  請求項1に記載の顔クラスタリング装置。【請求項3】  前記クラスタリング部は、  全ての前記単位グループに設定された顔情報を対象に、当該各顔情報の類似度に基づいて前記特徴が近い単位グループをマージする第1マージ部と、  個々の前記単位グループに設定された顔情報を用いて、当該各単位グループの類似度に基づいて前記特徴が近い単位グループをマージする第2マージ部と、を有し、  前記第i(1≦i≦N)の単位グループを対象にして、特徴が近い単位グループをマージするステップを前記第1マージ部が実行し、前記第j(j≠i)の単位グループを対象にして、特徴が近い単位グループをマージするステップを前記第2マージ部が実行する、  請求項2に記載の顔クラスタリング装置。【請求項4】  前記クラスタリング部は、略同一時間に対応する2つの単位グループをマージしない、  請求項3に記載の顔クラスタリング装置。【請求項5】  前記第1マージ部は、前記第i(1≦i≦N)の単位グループを対象にして、特徴が近い単位グループをマージするステップを実行する際、マージが起こらなくなるまで当該ステップを繰り返し実行する、  請求項3に記載の顔クラスタリング装置。【請求項6】  前記単位グループ設定部は、離れた時間に対応する顔情報が同じ単位グループに設定されやすいように顔情報の数を絞り込む、  請求項1に記載の顔クラスタリング装置。【請求項7】  前記第2マージ部は、少なくとも前記第1の単位グループを対象にして、特徴が近い単位グループをマージするステップを実行する、  請求項3に記載の顔クラスタリング装置。【請求項8】  前記クラスタリング部は、特徴が近い単位グループをマージする際、マージ前の単位グループに設定されている顔情報、及びマージ前の単位グループとマージ後の単位グループとの対応関係を表す階層情報を保持する、  請求項1に記載の顔クラスタリング装置。【請求項9】  画像に含まれる顔を検出する顔検出ステップと、  前記顔検出ステップで検出された顔の向きを検出する顔向き検出ステップと、  前記顔向き検出ステップで検出された顔の向きを考慮し、特徴が近い顔を検出して当該顔の特徴を表す顔情報の集合を形成する顔識別ステップと、  前記顔識別ステップで形成された各顔情報の集合について、前記顔向き検出ステップで検出された顔の向きに基づいて顔の向き毎に予め設定された数まで顔情報の数を絞り込み、数が絞り込まれた各顔情報の集合を単位グループに設定する単位グループ設定ステップと、  前記単位グループ設定ステップにより設定された単位グループを単位として、当該各単位グループに含まれる顔情報に基づくクラスタリングを実行するクラスタリングステップと、を含む、  顔クラスタリング方法。【請求項10】  画像に含まれる顔を検出する顔検出機能と、  前記顔検出機能により検出された顔の向きを検出する顔向き検出機能と、  前記顔向き検出機能により検出された顔の向きを考慮し、特徴が近い顔を検出して当該顔の特徴を表す顔情報の集合を形成する顔識別機能と、  前記顔識別機能により形成された各顔情報の集合について、前記顔向き検出機能により検出された顔の向きに基づいて顔の向き毎に予め設定された数まで顔情報の数を絞り込み、数が絞り込まれた各顔情報の集合を単位グループに設定する単位グループ設定機能と、  前記単位グループ設定機能により設定された単位グループを単位として、当該各単位グループに含まれる顔情報に基づくクラスタリングを実行するクラスタリング機能と、をコンピュータに実現させるためのプログラム。 
顔クラスタリング装置、顔クラスタリング方法、及びプログラム
