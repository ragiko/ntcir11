
第IV部〜テキスト編集を極める!!
正規表現について
正規表現について
秀丸だけでなく、高度で自由度の高い検索をするには必須の「正規表現」。
ここでは実用上重要な例をとりあげながら、わかりやすく解説します。
今日からあなたの「検索」が変わります。
正規表現に関する話題は、
次の「【0】いんとろだくしょん」に続く
以下の5章から構成されています。
【1】 基本編 〜表記のルールと意味〜
【2】 実践編 〜正規表現による置換の実際〜
【3】 まとめ
【4】 参考文献
【5】 (補足) 秀丸上での複数行にまたがる検索について
※以下の内容は、秀丸ヘルプの「検索系コマンド検索正規表現」の
内容についての補足です。
よってヘルプを参照しながら読まれる事を想定して書かれています。
【0】 いんとろだくしょん
いきなりですがここでクイズです。
文書に検索を行って、ヒットしたものを全て抜き出す作業に
grep 機能 を使うのは前提として、
ここで問題なのは どういう検索を行えばよいか という事です。
単に "明日は" や "でした。" を検索すると、
正しい文までヒットしてしまうのは言うまでもないでしょう。
とりあえずそれらで検索した後、
該当部分だけ抜き出せばいいというのも、
せっかく「こんぴゅーた」を使っているのに
何とも口惜しい…。
まぁ
「こんぴゅーた」なんてのは与えた命令しか実行しない無粋なモンだ
と言ってしまえばそれまでですが、逆に言えば、
こんぴゅーたに「何を探したいか」を適切に教えてやれば、
ちゃんと仕事をしてくれるはずです。
この例の場合、探したいものは
「明日は」で始まり、途中に何か文があって、「でした。」で終わる
という 文字の並び方のルール
として表現できますが、
このようにルールとして与えてやれば、
ルール通りに物事を運ぶことにかけては右に出るものはない
こんぴゅーたのことですから、きっとうまいこと(笑)やってくれるはず。
…前置きが長くなりましたが、こういう
文字の並びのルールを
コンピュータが理解できるように表現したものが
『正規表現』
です。
ちょっと先走ってしまいますが、
言葉で表現した文字の並びのルールを正規表現を使って表現すると、
^明日は.+でした。$
となります。
上の正規表現には、"明日は" や "でした。" などのような
探したい文字そのもの の他、
"^" や ".+" や
"$" という 記号 が含まれています。
すぐ後の【1】基本編 で説明しますが、
これらの記号は文字の並び方のルールを表現するための特別な意味
を持っていて、
上の例でいうと
「〜で始まり」「何か文があって」「〜で終わる」といった
ルールに対応しています。
このように、正規表現は文字の並びのルールを言葉ではなく
(普通の)文字 + 
(文字の並びのルールを表現するための)記号
で表します。
なお、上の例のように正規表現を使って表した文字の並びのルール自体を正規表現、
または パターンと呼ぶことがあります。
用語の混乱を避けるために、
以下の説明では「パターン」と呼ぶことにします。
途中で脱線してしまいましたが、
探したいものをコンピュータにもわかるようにパターンとして表わすことができたら、
あとは検索文字列に上のパターンを書き込んで、
それいけー!!
というかけ声と共に検索を実行すれば、
望み通り変な文だけを検索することができます。
では、以下の章でこれらの記号の意味と使い方について説明していきます。
【1】 基本編 〜表記のルールと意味〜
[1-1] メタキャラクタとエスケープシーケンス
まず前章の例の真ん中辺りにあった「.+」ですが、
これは言葉で表現した文字の並びのルールの
「何か文があって」という部分に対応しています。
この記号は「. (ピリオド)」と
「+ (プラス)」との組み合わせで、
それぞれ
. (ピリオド)
… 任意の1文字
+ (プラス)
… 直前の文字の1回以上の繰り返し
という意味を持っています。
ピリオドは、 MS-DOS のワイルドカード(懐かしい(笑))では
「?」と表現していたもので、
どんな1文字にもマッチ(*1)します。
例えば "あ.た" というパターンは、
"あんた" にも "あいた" にも "あした" にも、
果ては
"あ#た" という 謎のダイイングメッセージ
にもマッチします(笑)。
(*1)
プラス記号の方はちょっと注意が必要で、
これ単独では意味を成しません。
必ず直前に文字 があって、
その1回以上の繰り返しにマッチします。
例えば "痛て+" というパターンは
"痛て" という軽い痛みから
"痛てててててて"
という悶絶するような痛み全てにマッチします。
正規表現を使わないと "痛て" と "痛てて" と
"痛ててて" と…と全ての可能性をいちいち検索する必要がある所を、
このように
一発!
で指定できるわけです。
今説明したピリオドやプラス記号のような、
正規表現の中で特殊な意味を持つ記号のことを
メタキャラクタと呼びます。
メタキャラクタはこれらの他にも下記の表にあるようにいっぱい(笑)あります。
第IV部〜テキスト編集を極める!! 正規表現について
