［形式を選択して貼り付け］ダイアログの、［行列を入れ替える］チェックボックスを利用して、行と列を入れ替えられることをご紹介しました。
元の表とはリンクなどされていない独立した表を、もう一つ作ることで簡単に表の向きを変更でる便利な機能です。
実務では、データ的には同じで連動しているんだけれども、向きの違う表が必要ということもあります。
そしてその表のデータが頻繁に更新される可能性のある場合、［形式を選択して貼り付け］ダイアログを使って行列を入れ替えるというのでは、いまいちよろしくありません。
［形式を選択して貼り付け］ダイアログで行列を入れ替えた場合、データが更新されるたびに向きの異なる表を作らなければいけないからです。
そのため
「行列の入れ替わった連動した表を簡単に作成することはできないのでしょうか?」
というご質問をいただくことがあります。
もちろん元になる表を作成してから、セルを一つ一つリンクしつつ、向きの違う表をもう一つ作成することも可能です。
しかし、データ量の多い表でそんなことをするのは、とてもとても手間がかかってしまいます。
そんなときには、行と列を入れ替えてくれるTRANSPOSE関数を利用すると、とても便利です。
サンプルファイル(002499.xls 14KByte)ダウンロード
サンプルファイルでは、
A1:C2セルに、2行3列
に元の表が作成してあり
A11:B13セルに、3行2列の
行列を入れ替えた表が作成してあります。
A1:C2セルのデータを変更するとA11:B13セルのデータが変更され、二つの表が連動していることをご確認いただけるはずです。
また、A11:B13セルには
「{=TRANSPOSE(A1:C2)}」
というちょっと変わった数式が入力されていることも、まずはご確認ください。
一番のポイントは、
［Ctrl］+［Shift］+［Enter］キーを押して確定する点です。
［関数の引数］ダイアログ・［関数パレット］を利用する場合は、［OK］ボタンを押すときに、［Ctrl］キーと［Shift］キーを押しっぱなしにしておいてください。
［Ctrl］+［Shift］+［Enter］や［Ctrl］+［Shift］+［OK］は、配列数式を入力するときに必ず必要となる操作で、この操作をすると「{=TRANSPOSE(A1:C2)}」のように中括弧「{}」の中に数式が作成されます。
はじめて配列数式をご覧になった方の場合、［Ctrl］+［Shift］+［Enter］を押すということを、まずは、とにかく、しっかり、覚えていただくといいと思います。
もう一つのポイントは、
範囲選択を間違えないことです。
行列を入れ替えた後の表を作成する箇所(上記の例ではA11:B13)を正しく選択しておいてから、引数に元の表(上記の例では、A1:C2)を間違えないよう入力して、［Ctrl］+［Shift］+［Enter］キーを押してください。
関数で行と列を入れ替える−TRANSPOSE関数・配列数式:Excel(エクセル)の関数・数式の使い方-検索・行列
