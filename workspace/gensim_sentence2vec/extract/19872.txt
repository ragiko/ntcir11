
統計学の主な目的の1つは、標本データを用いて母集団の性質を推測することである。同じ母集団から抽出した標本であっても、無作為であるため標本を構成する要素、標本のサイズが異なると、それらの統計量(比率、平均、分散など)は異なる。従って、標本データを用いて母集団の性質を推測する際には常に誤差が伴う。
正規分布N(μ,σ2)の母集団から抽出した大きさnの無作為標本の平均はN(μ,σ2/n)に従うことが知られている。σは一定の条件のもとでは標本の不偏標準偏差を用いることも可能である。このように正規分布、t分布、x2分布などの確率分布を用いて母数やモデルの推定およびその推定の誤差を計算することができる。しかし、問題によっては確率分布を仮定できないケースも少なくない。そこで、1970年代にエフロン(Efron)は確率分布の性質に頼らないブートストラップ(bootstrap)という方法を提唱した。ブートストラップの語源に関しては、インターネットでも検索できる。
データサイエンスの分野では、1つの標本から復元抽出を繰り返して大量の標本を生成し、それらの標本から推定値 を計算し、母集団の性質やモデルの推測の誤差などを分析する方法をブートストラップ法と呼ぶ。
ブートストラップ法では母数 の推定量は標本から生成したブートストラップ標本の推定量 を用いて推定する。1つの標本からリサンプリングを繰り返して生成する標本をブートストラップ標本と呼ぶ。図1にブートストラップ法のイメージを示す。
ブートストラップ標本の生成には幾つかの方法が提案されているが、確率分布型を仮定するパラメトリック・ブートストラップ法と確率分布型を仮定しないノンパラメトリック・ブートストラップ法に大別される。そのアルゴリズムの例を次に示す。
パラメトリック・ブートストラップ法
(1)標本サイズがnである標本データ{x1,x2,…,xi,…,xn}の平均、標準偏差sを計算する。
(2)n個の正規乱数z1,z2,…,zi,…,znを生成し、で新しい標本{x1*,x2*,…,xi*,…,xn*}を生成する。この標本による推定値を (例えば、平均)とする。
ノンパラメトリック・ブートストラップ法
(1)区間(0,1)をn等分した各区間の値を標本データ{x1,x2,…,xi,…,xn}に1対1で対応させる。
(2)n個の一様乱数u1,u2,…,ui,…,unを生成し、uiの値が含まれる区間に対応するxkをxi*とし、新しい標本データ{x1*,x2*,…,xi*,…,xn*}を生成する。この標本から得られた推定値をとする。
両方法ともステップ(2)をB回繰り返し、B個の標本の推定値を求める。その推定値、標準偏差、バイアスはそれぞれ次の式で求める。
Rとブートストラップ
