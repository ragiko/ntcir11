Windows のタスク・スケジューラを利用した、Movable Type のスケジュール・タスク実行方法を紹介します。スケジュールタスクを実行することで、MT4 であれば指定日投稿・迷惑コメント(トラックバック)削除・公開キュー等のスケジュール処理が可能になります。
MT3 も同じ設定方法です(公開キューはMT4のみ)。
この設定は自宅サーバで Windows XP 等を利用している場合の設定方法です。レンタルサーバの場合は Linux 上で同様の設定を行います。
以下、設定手順です。
「スタート」「設定」「コントロール パネル」「タスク」「スケジュールされたタスクの追加」を選択。
タスク ウィザードで「次へ」をクリック。
「参照」をクリック。
perl プログラム(ここでは C:&yen;usr&yen;bin&yen;perl.exe)を選択して「開く」をクリック。拡張子を表示しない設定の場合は「perl」を選択。
日単位を選択して「次へ」をクリック。
開始時刻を設定し、このタスクの実行から「毎日」を選択して「次へ」をクリック。
表示されたユーザーのパスワードを設定して「次へ」をクリック。
「[完了]をクリックしたときに詳細プロパティを開く」をチェックして、「完了」をクリック。
ここからの設定が重要です。開いたプロパティ画面で
実行するファイル名:C:&yen;usr&yen;bin&yen;perl tools&yen;run-periodic-tasks
開始:アプリケーション・ディレクトリのパス(例はC:&yen;web&yen;mt)に書き換える
を設定し、「OK」をクリック。実行するファイル名の tools&yen;run-periodic-tasks の前には半角空白を入れてください。「開始」のアプリケーション・ディレクトリとは、mt.cgi があるディレクトリです。
とりあえずこれで「OK」をクリックすれば設定完了です。
ただしこのままでは日に1回しか実行されないので、実行周期を短くする場合は「スケジュール」タブの詳細設定をクリック。
オプションの詳細設定で「タスクを繰り返し実行」で間隔を設定します。継続時間は間隔より長く設定してください。
スケジュールを変更するとパスワードの設定が求められる場合があります。
作成したタスクは最初の「スタート」「設定」「コントロール パネル」「タスク」「XX」で起動することができます。
小粋空間: Movable Type のスケジュール・タスク実行(Windows 編)
