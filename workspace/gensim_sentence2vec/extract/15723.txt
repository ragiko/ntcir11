
Gauss Noise Average(ガウス雑音の平均電力計算時の平均回数)
First Release:2004Jan04
ガウス雑音の電力を求める際に、入力サンプルを2乗平均する回数について調べました。
NFの測定時などに、受信機から出力される信号の電力を求めるのに、実際に何サンプルを平均すれば良いかを検討しました。
ガウス雑音
ガウス雑音は別名正規分布で、平均値が0、分散がσ2で表されます。
受信機のアンテナ端子にダミーロードが接続されていて、受信機の音声出力からは熱雑音出力が出ているというモデルを考えます。
ダミーロードの代わりに雑音発生器を接続しても同じです。
受信した信号をサンプリングした振幅をr(k)とします。r(k)はガウス分布に従います。
r(k)の平均電力をσr2とします。σrはガウス分布の標準偏差と言います。σr2を分散といいます。
分散は平均電力に一致します。
簡単のため、
s(k)=r(k)/σr     (式1)
とし、s(k)の平均電力σs2=1になるように正規化されているとします。
s(k)の平均電力の分布関数p(y)を求める
s(k)の2乗平均をy(N)とします。y(N)は真の平均電力σs2(=1)に近い値です。
理論的にはNを無限大にするとy(N)はσs2(=1)に一致します。
Nが小さいと、足す個数Nが同じでも、平均yを計算する度に結果がばらつきます。
Nが大きい程このばらつきは小さくなり、すなわち小さい誤差で平均電力を求めることができるわけです。
ではNはいくつに選べばよいのでしょうか。
理論的にyの確率密度関数p(y)を求めてみます。
s(k)がガウス分布のとき、ss(k)=s(k)*s(k)は次の確率密度関数に従います。
p(ss)=exp(-ss)     (式2)
指数分布により非常に簡潔に表現されます。
これをN個足してNで割った値yは、次の確率密度関数に従います。
p(y)=N*(N*y)(N-1)/(N-1)!*exp(-N*y)    (式3)
かなり複雑になります。Nの(N-1)乗をN-1の階乗で割って、あとyの(N-1)乗と指数関数が入っています。
yは0〜∞の範囲をとりますが、この関数p(y)はyが小さいと0に近付き、yが大きいとやはり0に近付きます。
y=(N-1)/Nで極大になります。
Nが∞であれば、p(y)がy=1で鋭く立ち上がるδ関数δ(y-1)になることはお分かりいただけると思います。
yの誤差のN依存性
ガウス雑音の電力をサンプルをN個使って計算するとき、毎回の計算結果yが、真の電力からどれだけずれるかという確率密度関数がp(y)でした。
そこで、Nはいくつに選べばよいかという先ほどの問題の答えを求めるために、Nによってyの誤差がどれだけばらつくかを計算します。
y=1になれば、正解です。y=1.1だったとすると、1割の誤差であったということになります。
Prob(y > Y)は、yがYよりも大きい確率のことで、p(y)をY〜∞まで積分した値です。不等号の向きを変えた
Prob(y 
そこで、yが1割以上の誤差を持つ確率Pは、
P= Prob(y  1.1)
= [p(y)を0〜0.9まで積分]+[p(y)を1.1〜∞まで積分]    
= ∫00.9p(y)dy + ∫1.1∞p(y)dy  (式4)
で表されます。
計算すると、例えばN=100の場合、第1項= 0.157であり、第2項= 0.160で、合計P=0.317です。
この結果から言えることは、
「N=100だと、32%の確率で1割以上の誤差となる」
ということになります。
NFの測定ではちょっと誤差が大きすぎます。
N=8000だと、1割も誤差を持つことはまずありません。
そこで、例えば0.1dB以上の誤差(y1.023)になる確率を求めました。
Y=0.977とY=1.023として数値計算した結果は、
「N=8000だと、4.0%の確率で0.1dB(2.3%)以上の誤差となる」
となりました。
Nが大きいと計算には工夫が要りますので、桁落ちなどで計算誤差があるかもしれません。
ADで取り込んでyの誤差を確認する
請うご期待!
なお、ADで取り込んだデータs(k)が、式3の分布になるためには、s(k)はガウス分布をしていることが条件となります。
そのためには、
・入力信号が適切に帯域制限されていること(BW 
・サンプルs(k)が互いに独立であること
・ADへの入力振幅が適切であること(大きすぎず、小さすぎず)
である必要があります。
注意点としては、
fsが高すぎると、s(k)が互いに独立にならず、等価的にNが小さくなったことになりますので、
fsが入力信号の帯域幅BWと比べて非常に大きいときは、サンプリング間隔1/BW以上離れたサンプルを使うようにします。
ADへの入力振幅が大きすぎるとADの量子化範囲を超えてしまい、振幅がスライス(リミット)されます。逆に小さすぎると量子化雑音が増加します。雑音発生器のON,OFFの両方で問題ないようにする必要があります。
また、必ずしもs(k)は等間隔の時間でサンプルする必要はありません。
参考文献:奥村・進士 移動通信の基礎 電子情報通信学会 (p166 式7.6 で Γ=1/Nとおきます。)
Back to TOP     
Back
(C)Tak 2004
Gauss Noise
