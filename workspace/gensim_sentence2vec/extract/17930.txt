いやーすっかり寒くなりましたね。日本語っていやですね。IT人にとって。なぜなら、英語だったらあり得ないほど表記ゆれがあります。でも、MS AccessもExcelも西洋のものなので、日本語の奥ゆかしさなんかには対応してくれません。というわけで二つの文字列(テキスト)を引数で照合させて、照合率(マッチング率)を戻り値する関数を作ってみました。その名もstrConp・・・あんまり意味は無いです。使い方strConp(文字列A,文字列B)です。そうすると、少数型でマッチング率を返します。どこぞのどなたかのお役にたちますように。Public Function strConp(strA As String, strB As String)    Dim intA As Integer    Dim intb As Integer    Dim strLong As String    Dim intLong As Integer    Dim strShort As String    Dim intPoint As Integer    Dim strLetter As String    Dim intLoop As Integer    Dim intTarget As Integer    '2つの文字列のバイト数を測り長い方を選択    strLong = strA    intLong = Len(strA)    strShort = strB    intshort = Len(strB)        If Len(strA) < Len(strB) Then        strLong = strB        intLong = Len(strB)        strShort = strA        intshort = Len(strA)    End If    intTarget = 1    '長い方から短い方へ照合する    For intLoop = 1 To intLong    '長い方から一文字拾う    strLetter = Mid(strLong, intLoop, 1)    'Debug.Print InStr(intTarget, Right(strShort, intshort), strLetter)    If InStr(intTarget, strShort, strLetter) Then    '一致したらポイントを 1なかったらそのまま        intPoint = intPoint + 1        intTarget = InStr(intTarget, strShort, strLetter) + 1    End If    'intTarget = InStr(intTarget, Right(strShort, intshort), strLetter) + intPoint    Next        strConp = Round(intPoint / intLong * 100, 2)End Function
照合率 : VBのTips
