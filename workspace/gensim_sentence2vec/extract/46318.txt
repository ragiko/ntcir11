リストの中から条件を指定して計算
たとえば、次のような表があります。
このようなリストの中から、肉屋だけの合計と魚屋だけの合計を出したいわけです。
いくつか方法はあります。Sum関数の引数を自分で選んでもよいでしょう。また、単純に足し算していってもよいと思います。
しかし、膨大なリスト -たとえば売り上げ一覧など- になるとそれは不可能に近いですし、間違える可能性もあります。そして、間違えても気づかないものです。
Excelには便利な関数があります。ここで使うのはSumIfという関数です。
SumIf関数
この関数の引数は三つです。
検索条件:計算したい条件を指定します。
範囲:検索条件を探す範囲を指定します。
合計範囲:計算する範囲を指定します。
関数を実行すると、「範囲」から「検索条件」に該当するものを選び、「合計範囲」にある数値を計算(加算)します。
「範囲」と「合計範囲」は必ずしも横並びでなくてもよいようです。 上から何番目があっていれば良さそうな感じです。
しかし、人間が見るものですので出来るだけ隣り合わせにしたほうがよいでしょう。
配列数式
配列数式はちょっと難しいです。
そもそも「配列」の意味がわからないとつらいかと思います。プログラマは嫌というほどお世話になっていますが、一般の人は理解に乏しいと思います。
配列というのは「数列」に近いものだと私は理解しています。要は、「セル」が「並んでいる」のです。
プログラマには説明不要ですが、かじった程度の人であれば「変数が並んでいる」と考えてください。今回の変数はセルです。
とりあえず、みてみましょう。
さっきのSUMIFの変わりに配列変数で計算してみました。結果は同じです。
紫と青で囲まれた範囲がいわゆる「配列」となっています。並んでますよね。大きさも同じであることに注目してください。大きさも同じでなければいけません。相互に連携しあって計算をしているからです。
配列数式の場合、IF関数と組み合わせることが多いようです。つまり、IF関数で計算するセルをチョイスし、SUMで計算します。SUMIFではありませんよ。
また、配列数式にするときは「Ctrl + Shift + Enter」キーを押します。そうすると、{}で囲まれます。これが配列数式の証です。
さて、実際の中身を見てみましょう。
数式は、{=SUM(IF(D3:D7=B10,C3:C7,""))}
となっています。色分けしてみました。
青のIF関数で計算できる範囲をチョイスしています。
IF関数はIF( 数式, 成り立つとき, 成り立たないとき)です。
つまり、D3:D7の中でB10に相当するものを選択しているわけです。
いま、B10は"肉屋"ですので二箇所該当します。一番目と三番目です。
条件に当てはまる複数のセルの合計を計算する
