特定のレコードの検索 ADO には、Recordset 内で特定のレコードを検索するための Find メソッドと Seek メソッドがあります。Find メソッドは多くのプロバイダがサポートしていますが、検索基準を 1 つしか設定できません。Seek メソッドは複数の検索基準をサポートしていますが、多くのプロバイダはサポートしていません。 フィールドのインデックスを使うと、新しい Recordset オブジェクトの Find メソッド、Sort プロパティ、および Filter プロパティのパフォーマンスを大幅に向上できます。Field オブジェクトの内部インデックスを、ダイナミック Optimize プロパティを設定することによって、作成することができます。このダイナミック プロパティは、CursorLocation プロパティが adUseClient に設定されたときに、Field オブジェクトの Properties コレクションに追加されます。ただし、このインデックスは、ADO 内部でのみ使用できます。このインデックスは、外からアクセスしたり、ほかの目的に使用することはできません。このインデックスは、Recordset オブジェクトの Index プロパティとは別のものです。 Find メソッドは、Recordset の列 (フィールド) 内ですばやく値を検索します。Optimize プロパティを使って列のインデックスを作成すると、多くの場合、その列に対する Find メソッドの処理速度が速くなります。 Find メソッドでは、1 つのフィールドの内容しか検索できません。Seek メソッドの場合はインデックスが必要で、その他にも制限があります。インデックスのベースになっていない複数のフィールドを検索する必要がある場合や、プロバイダがインデックスをサポートしていない場合には、Recordset オブジェクトの Filter プロパティを使って結果を絞り込む必要があります。 Find Find メソッドでは、指定した条件を満たす行を Recordset から検索します。必要に応じて、検索の方向、開始行、および開始行からのオフセットを指定できます。条件が一致すれば、カレント行の位置は、検出されたレコードに設定されます。条件を満たす行がない場合は、カレント行の位置は検索する方向によって Recordset の最後または最初に設定されます。 基準には単一列の名前のみを指定できます。言い換えれば、このメソッドでは複数列の検索はサポートしていません。 基準の比較演算子には、">" (より大きい)、"<" (より小さい)、"=" (等しい)、">=" (以上)、"<=" (以下)、"<>" (等しくない)、または "LIKE" (パターン マッチング) を使用できます。 基準の値には、文字列、浮動小数点数、または日付を使用できます。文字列の値は単一引用符または "#" (シャープ記号) で囲みます。たとえば、「state = 'WA'」または「state = #WA#」のように指定します。日付の値は "#" (シャープ記号) で囲みます。たとえば、「start_date > #7/22/97#」のように指定します。 比較演算子に "like" を使用する場合、文字列値にアスタリスク (*) を含めると、1 つまたは複数の文字または部分文字列を検索することができます。たとえば、「state like 'M*'」と指定すると、Maine や、Massachusetts が該当します。また、文字列の先頭と末尾にアスタリスクを使用して、その間に含まれる部分文字列を検索することもできます。たとえば、「state like '*as*'」と指定すると、Alaska、Arkansas、および Massachusetts が該当します。 前の例のように、アスタリスクは、検索文字列の末尾のみに使用するか、または検索文字列の先頭と末尾の両方で使用することができます。ただし、先頭のみのワイルドカード ('*str') または文字列中のワイルドカード ('s*r') としてアスタリスクを使用することはできません。この場合は、エラーが発生します。 Seek および Index 基になるプロバイダが Recordset オブジェクトのインデックスをサポートしている場合は、Index プロパティと連動する Seek メソッドを使用してください。基になるプロバイダが Seek をサポートしているかどうかを判別するには、Supports(adSeek) メソッドを使用します。プロバイダがインデックスをサポートしているかどうかを判別するには、Supports(adIndex) メソッドを使用します。OLE DB Provider for Microsoft Jet は、Seek および Index をサポートしています。 Seek メソッドで求める行が見つからない場合、エラーは発生せず、行の位置は Recordset の最後になります。このメソッドを実行する前に、必要なインデックスを Index プロパティに設定してください。 このメソッドは、サーバー側のカーソルでのみサポートされます。Recordset オブジェクトの CursorLocation プロパティの値が adUseClient の場合、Seek はサポートされません。 このメソッドは、Recordset オブジェクトが、CommandTypeEnum 値の adCmdTableDirect で開かれている場合にのみ使用できます。  
特定のレコードの検索
