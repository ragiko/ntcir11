ぴいこは研究で、類似度を求める機能をシステムに組み込んでいます。そこで、どうしたら人間の思う「似ている」に機械が近づけるかな?と思って試行錯誤しているのですが、似ているといえばコサイン類似度以外にもN-gram(えぬぐらむ)というやり方があるということにたどり着きました。
今回は、こちらのページを大いに参考にしています!研究のソースでも、ベースにこちらのプログラムを利用させてもらって、カスタマイズして組み込んでいます。やりたいことから技術を得るのにわかりやすいページでした
NEO INSPIRATION – Ngramを利用したページ類似度チェッカー+Ngram計算のphpクラス
N-gramのNには、1(ユニグラム)とか2(バイグラム)とか3(トリグラム)とか、Nは好きな数字にできますが、一般的には1～3が有効です。私のシステムには2-gramを取り入れています。今回はそのN-gramについて、なんとなくこんなかんじで類似度を出しているんだろうなーというのを書きます。
Nに分ける
まず、N-gramでの類似度を求めるためには、Nに分けることが重要になってきます。以下に「私は猫が好きです」という文章を用意しました。とりあえず、2-gramと3-gramに分けてみます。
1字ずらしでN文字ずつ配列に分けていくイメージです。2-gramの最後、「す」だけになったのは、一つ前の要素である「です」がこれ以上2文字で分けられないから。同様に、3-gramでも「きです」「です」「す」になります。とりあえず最後までN文字ずつ分けていきます。
2つの文を比べてみる
では、「私は猫が好きです」と、「私は犬が好きです」の文章を比べてみたいと思います。類似度とかシステムとか関係なしに、2つの文章を見比べてください・・・「猫」「犬」だけが違っていて、あとはあんまり変わらないですよね?てことは、これ、直感的に似ていますよね。(犬と猫という違いはおいといて・・・文としては似ている!ウンウン)
犬が好きの文も2-gram、3-gramで分かち書きしてみます。
では、2-gram同士、3-gram同士で同じ要素ってどのくらいあるでしょうか?
2-gramのときは、8つの要素の内6つがまったく同じ要素だったので、6/8で0.75の一致率でした。
3-gramのときは、8つの要素の内5つがまったく同じ要素だったので、5/8で0.625の一致率でした。
このように、N-gramでは分かち書きした要素のうち、2つの文がどれだけ一致しているかを見ます。この結果を見ても分かるとおり、0.5～0.7以上あればだいたい同じ!っていうかんじです。
コサイン類似度・N-gramの使いどころ
コサイン類似度は、比較したいものに付加してある要素で類似度を測るときに使えそうです。例えば・・・
音楽ファイルについているタグ「悲しい曲」「楽しい曲」等で、似ている曲を調べる
プロフィール情報についている情報で、似ている人を調べる
長い文章を形態素解析して、出てくる単語の一致率で「内容の」似た文章を調べる
コサイン類似度は「内容」だったり「タグ」など、ある程度項目を限定できるようなものに効果を発揮しそうです。
では、N-gramはどうでしょうか。N-gramは文章を単純に分かち書きし、その要素がどれだけ同じかで類似度を測っていますので、こんなときに使えそうです。
文章の作りがにているものを調べる
N-gramでは、文章を分かち書きにしたときの、前後のつながりしか見ていません。なので、内容が似ているかどうかまでは見ることができません。先ほどの例でも、「犬が好き」と「猫が好き」では、文のつながりはほとんど同じでしたが、内容として犬と猫では大違いだと思います。これが、鳥が好きでもイグアナが好きでもある程度似ていると出てしまうので、意味的に同じものを探すのには向かないですね。
冒頭のリンク先にもあるように、ページの文章がぱっと見/文字的に/文章的にどのくらい似ているかにすごい効果を発揮します。
N-gramってなんだ
