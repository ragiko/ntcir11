
前回扱った、「広告費と売上高の関係」、「値引き率と売上高の関係」といったような因果関係モデルを、標本データを用いて検証する手法を「回帰分析」といいます。
回帰分析には、これらの例ように検証する原因がひとつである単回帰分析のほか、検証する原因が複数ある(たとえば「両親の身長」「子供の身長」の因果関係モデル)重回帰分析があります。
ひとまずここでは前者についての説明をします。
回帰分析では、原因となる変数を独立変数(説明変数)、結果となる変数を従属変数(目的変数)と呼びます。
回帰直線をひこう!
回帰分析は、変数をXY平面にプロットした散布図に、回帰直線をひく作業からはじめます。
散布図はすでに前回描きました。たとえば「広告費」「売上高」の散布図は下のようでした(今回はExcelではなくSPSSで描いています)。ここでは、比較的はっきりとした正の相関関係が見られますね。
ここに下のように、全ての点から最も近くなるような直線をひきます。これが回帰直線です。
回帰直線はSPSSなどを使うとあっという間に引けてしまうのですが、どのような理論で求められるのかを理解しておきましょう。
回帰直線は、各点から直線に向かって「Y軸と平行に」のばした距離(残差といいます)の合計が最も小さくなるように引きます。これを「最小2乗法」といいます。
「最小2乗法」
回帰直線の式をy=ax+bとすると(これを回帰式と呼びます)、最小2乗法では傾きa(回帰係数と呼びます)は次のようにして求められます。
(この授業ではこれらの計算はSPSSで自動的に出すことになると思いますが、求め方もできるだけ理解しておいてください。)
回帰直線は、必ずxとyの平均値(,)を通るので、aが決まるとbも自動的に決まります。
ちなみに、上の広告費と売上高の例についてSPSSで計算すると、回帰係数は30.997、切片は1.766となり、上の図で見たような回帰直線(y=30.997x+1.766)が求められます。
決定係数(寄与率)
回帰式を求めて回帰直線が引けても、その回帰式がきちんとデータを説明しうるものであるか(=説明力があるか)を確かめなければなりません。そこで、得られた回帰式が実際どの程度データ全体に近いのかを示す決定係数(寄与率ともいいます)を計算します。
今までのことから、回帰直線の位置関係は、次の図のようにまとめられます。
とくに、右で拡大して示した、残差、回帰の成分、偏差という用語とその位置関係をよく覚えておいてください。それぞれy軸方向における、「データから回帰直線までの距離」、「回帰直線と平均値との距離」、「データから平均値までの距離」を意味しています。(また、残差+回帰の成分=偏差です。)
決定係数の考え方としては、こうです。
「回帰の成分」とは、「回帰直線を引くことによって、平均値で推定した場合よりもどれだけ本来のデータに近付くか(ズレが小さくなったか)。」を表していると言えます。ですから、偏差のうちの回帰の成分が大きくなるほど(=残差が小さくなるほど)、回帰直線は各データのとても近くを通っていることになり、その説明力やありがたみ(?)が増すわけです。
さて、これらのデータ全体としての値をとる場合、ここでは「距離」を知りたいので、それぞれについて平方和をとります。それぞれ下のようにあらわされます。
決定係数を求めるには、「回帰の成分」が、「偏差」のうちどのくらいの割合を占めているのかを見たいのですから、
計算は  となります。
また、  なので、上の式にもうすこし継ぎ足して、まとめると、
のようになります。
決定係数は0から1の値をとり、全データが回帰直線の近くにあるほど1に近づきます。「寄与率」はそれをパーセント表示にしたものです。
決定係数が1(寄与率が100%)に近いほど、回帰直線はデータの傾向をうまくとらえた、説明力の高いものということができます。
上の2つの例だと、左の決定係数は0.73(寄与率73%)、右は0.21(寄与率21%)です。
=左の回帰直線のほうが全体のデータにより近く、説明力が高い!
F検定
最後に、以上の回帰モデルが成立するか、その妥当性を検証する「F検定」を行います。質的データのときの「X2検定」と考え方も手順も似ており、まず「帰無仮説」を立て、それを棄却することで、モデルの妥当性を検証します。
帰無仮説:「回帰モデルが成立しない」(=独立変数は従属変数を説明しない or 回帰式を用いて説明できない)
F検定では、SPSSの「分散分析表」の値を用います。たとえば先の広告費と売上高の例では、次のような値が出ます。
この表からは、「F値は61.86となり、自由度1、23のF分布において非常に小さい確率(0.01=1%以下)のもとで起こる値の範囲に含まれる。したがって、5%有意水準のもとで帰無仮説は棄却でき、母集団において回帰モデルは成立する」、と言うことができます。
授業ではF検定について詳しい説明をしませんでしたが、必要に応じて、後でこちらに書き足すかもしれません。

