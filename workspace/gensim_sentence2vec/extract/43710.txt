
HOME
»  
Excel・エクセル
»  
関数・計算
»  
VLOOKUP関数と絶対参照
VLOOKUP関数と絶対参照
(解説記事内の画像はExcel 2003のものですが、操作方法はExcel 2007・2010・2013でも同じです)
Excel 2003用 練習ファイル (vlookup-absolute.xls 28.0KB)
Excel 2007・2010・2013用 練習ファイル (vlookup-absolute.xlsx  10.2KB)
下の図のB3番地には、
A3番地に入力された商品Noを、
A11番地からC17番地まで(以降「A11:C17」と書きます)の商品マスタから探し出し、
その商品Noに対応する商品名を表示させる数式が入力されています。
そうです、VLOOKUP関数です!
セルを選択し、数式バーを見ると、そのセルに入力されているものが確認できるので、B3番地を選択し、数式バーを見ると、
B3番地の数式は
=VLOOKUP(A3,A11:C17,2,0)
となっています。
B3番地では、VLOOKUP関数を使って、下記のような処理を行いたいわけですから、
検索値
これを
A3
範囲
この一覧表から探し出し
A11:C17
列番号
対応したものの左から何列目のデータを
2
検索の型(検索方法)
キッカリ検索で探し出して、答えとして表示してね
0
設定されている数式自体には、間違いはありません。
ところがこの数式をオートフィルでコピーすると・・・
エラーが出ておかしいことに!
これはオートフィルで数式をコピーすることを前提に数式を入力しなかったことが原因。
早速原因をつきとめてみます。
B3番地、B4番地、B5番地に入っている数式を確認してみます。
数式の確認は、先程と同じように、各セルを選択すると数式バーに表示されますヨ。
B3番地の数式
=VLOOKUP(A3,A11:C17,2,0)
B4番地の数式
=VLOOKUP(A4,A12:C18,2,0)
B5番地の数式
=VLOOKUP(A5,A13:C19,2,0)
そうなんです、オートフィルで数式をコピーすることで
VLOOKUP関数の引数［範囲］が1つずつズレてしまったことが原因です。
ということは、オートフィルをしてもいつでもA11:C17の範囲を参照するよう、
範囲がズレないように絶対参照をかければOK。
早速下記で、正しい数式を入れてみます!
練習用ファイルを操作しながらご覧いただいている方は、
実際に正しい数式を入力し直してみますので、B3からB5番地に現在入力されている誤った数式を、消しておいてください。
まずは数式を入力したい先頭のセル、B3番地を選択し、
VLOOKUP関数を選びます。
VLOOKUP関数の引数自体の考え方は、最初から間違いないので、
下の表のように、順番に引数を設定していくことになるわけですが、
設定途中にポイントがありますので、
下の表を頭に入れたら、表の下にある図で、ポイントを押さえながら1つずつ操作していくことにしましょう!
検索値
これを
A3
範囲
この一覧表から探し出し
A11:C17
列番号
対応したものの左から何列目のデータを
2
検索の型(検索方法)
キッカリ検索で探し出して、答えとして表示してね
0
1つ目の引数［検索値］を指定後、［範囲］にカーソルを移します。
［範囲］の欄にカーソルがある状態で、A11番地からC17番地のセルをマウスで範囲選択すると
［範囲］の欄に選択したセル番地が表示されます。
セル番地が表示されたら［F4］キーをポンッと押すと、
「A11」「C17」にそれぞれ絶対参照の$マークがつきます。
あとは残りの引数を指定して［OK］ボタンを押せば完了です!
引数［範囲］には絶対参照がかかっていますので
数式をオートフィルしても、
ちゃんと答が表示されます!
B3番地、B4番地、B5番地の各セルをそれぞれ選択し、数式バーで入力された数式を確認してみます。
B3番地の数式
=VLOOKUP(A3,$A$11:$C$17,2,0)
B4番地の数式
=VLOOKUP(A4,$A$11:$C$17,2,0)
B5番地の数式
=VLOOKUP(A5,$A$11:$C$17,2,0)
［範囲］となるA11:C17に絶対参照をかけたので、オートフィルで数式をコピーした他のセルでも、
ズレることなく、A11:C17を参照することができています!
名前を利用
さて、オートフィルをしても［範囲］がズレないよう、
先程は［F4］キーで絶対参照をかけましたが、
実はもう1つ方法があるんです。それが名前を利用する方法。
練習用ファイルを操作しながらご覧いただいている方は、
これからご紹介する方法も練習できるよう、B3からB5番地に現在入力されている数式を、消しておいてください。
まずは数式を入力する前に［範囲］となるセル範囲に名前を定義しておきます。
そして、B3番地にVLOOKUP関数を入力していくわけですが、
引数［範囲］には定義しておいた名前を入力すればOK。
この時、名前を数式で使おう!のように［F3］キーを使えば入力する必要もありません。
今回は［範囲］となるA11:C17に「商品一覧」という名前を定義しておきました。
「商品一覧」という範囲は常にA11:C17を指すわけですから、
オートフィルしても［範囲］がズレていくということは起こりません。
［範囲］となる部分は別シートにあってもOKです。
こういった場合は特に、名前を使う方が引数［範囲］を指定するときに楽ですし、
入力した数式もパッと見て分かりやすくなっていることが実感できますヨ。
VLOOKUP関数【キッカリ検索編】
VLOOKUP関数【あいまい検索編】
VLOOKUP関数で#N/Aエラーを回避!
VLOOKUP関数で#N/Aエラーを回避【ISERROR関数編】
スポンサードリンク
VLOOKUP関数と絶対参照--Excel・エクセル
