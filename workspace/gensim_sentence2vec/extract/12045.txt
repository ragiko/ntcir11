
----------------------------------------------------------事後確率と尤度——系統推定における最尤法とベイズ法の最前線----------------------------------------------------------尤度(likelihood)とはある仮説(モデル)のもとで観察されたデータが生じる確率を意味しています.以下では,この尤度が「ベイズの定理」と呼ばれているもののパーツを構成していることを示します.これは,系統推定の業界で「最尤法」に代わるものとして最近用いられ始めている「ベイズ法」を理解する要になります.------------------------「ベイズの定理」の導出------------------------いま,観察データDが与えられたとして,それを説明する対立仮説がHi(i=1,2,...,m)であったとします.このとき,仮説Hiの尤度L(Hi)=P[D｜Hi]と定義されます.言葉で言えば「仮説Hiのもとで観察Dが生じる確率」が尤度L(Hi)ということです.この定義式には条件付き確率P[・｜・]が含まれています.一般に条件付き確率P[A｜B]は:P[A｜B]=P[A&B]/P[B]すなわち,「世界をBに限定したときにAが生じる確率」と定義されます.したがって,積事象P[A&B]とは異なる概念であることに注意してください.上の式を移項するとP[A&B]=P[A｜B]・P[B]となりますが,左辺に対して別の変形:P[B&A]=P[B｜A]・P[A]と等価であることから,右辺どうしを等置し:P[A｜B]・P[B]=P[B｜A]・P[A]∴P[A｜B]=P[B｜A]・P[A]/P[B]が導かれます.
ここでA,BをそれぞれHi,Dと置き換えると:P[Hi｜D]=P[D｜Hi]・P[Hi]/P[D] (*)となります.左辺P[Hi｜D]をデータDが与えられたときの仮説Hiの事後確率(posterior probability)と呼び,対する右辺のP[Hi]を仮説Hiの事前確率(prior probability)と呼びます.右辺のP[D｜Hi]はすでに定義した尤度です.分母P[D]は仮説Hiに依存しない定数です.この式(*)は「ベイズの定理」として知られています.言葉で言えば,ある仮説Hiの事前確率と尤度の積がHiの事後確率になるということです.(*)式の分母P[D]を変形します.条件付き確率の定義により:P[D]=P[(D&H1)or(D&H2)or...or(D&Hm)] Hiの排反事象に分割      =Σ[i=1〜m]P[D&Hi]    総和記号で表記      =Σ[i=1〜m]P[D｜Hi]・P[Hi]   条件付き確率に展開したがって,ベイズの定理(*)式は:P[Hi｜D]=P[D｜Hi]・P[Hi]/Σ[i=1〜m]P[D｜Hi]・P[Hi] (**)と変形できます.この式は,事後確率が事前確率と尤度の関数であることを示しています.------------------------最尤法とベイズ法の関係------------------------系統推定法としての最尤法は尤度P[D｜Hi]を目的関数とし,それを最大化する樹形を探索します.一方,最近になって使われ始めたベイズ法による系統推定では事後確率P[Hi｜D]を目的関数とし,それを最大化する樹形を求めます.両方法では目的関数が異なっているので,得られる系統樹はもちろん異なることがあります.ベイズの定理の式(*,**)を見ると,尤度の大小は必ずしも事後確率の大小と相関しません.たとえ尤度P[D｜Hi]が大きくても事前確率P[Hi]が小さければ,事後確率P[Hi｜D]の値はそれに比例して小さくなるからです.数理統計学では頻度主義(frequentism)とベイズ主義(Bayesianism)をめぐる大論争が今も続いています.系統推定における最尤法は頻度主義,対するベイズ法はベイズ主義を背景にしている手法であり,たとえ両者が尤度関数を共有しているという類似点を挙げたとしても,方法論として協調できるとはかぎりません.もっとも大きな対立点は「事前確率」をどのように設定するかという問題です.データがなければ系統樹の生じる確率については何も言えませんので,事前確率P[Hi]には等確率を置くのがふつうです.このとき:
(*)P[Hi｜D]=P[D｜Hi]・P[Hi]/P[D]の右辺の比部分P[Hi]/P[D]は定数となり,最尤推定とベイズ推定の結果は必ず等しくなります.一方,事前確率として等確率ではない確率分布を設定すると,両方法は異なる系統樹を導く可能性が生じます.論争が生じるのは,どのように事前確率を設定すればいいのかという点です.ベイズ主義は「主観的確率」(信念の程度としての確率)をも許容するという点で,頻度主義とはげしく対立してきました.系統推定においても同様の主観的確率(すなわち特定の系統樹に対する個人的な思い入れ)を事前確率としてもちいるケースが生じたならば,同様の論争がきっと生じるでしょう.最尤法とベイズ法にはそれぞれ論争を招く原因があるということです.私は現時点は開戦前夜であるとみなしています.------------------------------------------------経験ベイズとMCMC——ブレークスルーとしての------------------------------------------------事前確率にまつわる論議に加えて,従来のベイズ法では「計算量の負担が大きい」という実際的な問題もありました.ベイズの定理の(**)式:P[Hi｜D]=P[D｜Hi]・P[Hi]/Σ[i=1〜m]P[D｜Hi]・P[Hi]を見ると,分母の計算がいかにたいへんであるかが納得できます.「m」とはすべての系統樹の個数ですが,系統樹の末端点(OTU)の数を「n」とすると:m=1×3×5×・・・×(2n−3)となり,膨大な数の系統樹に関する総和を求める必要があります.さらに言えば,尤度計算にはパラメーターごとの数値積分が要求されます.当然,解析的に事後確率を計算することは不可能です.この点のブレークスルーとなったのが1990年代半ばに開発された「経験ベイズ法(EB)」と「マルコフ連鎖モンテカルロ法(MCMC)」です.これらの方法は,ベイズ法のネックになっていた事前確率をデータから推定する方策(EB)を与え,併せて大量の計算をマルコフ連鎖に基づく数値最適化の手法(MCMC)を投入するということで,現実のデータに基づく事後確率の計算を可能にしました.系統推定におけるベイズ法(たとえばMrBayesのようなソフトウェア)もこのMCMCを用いた計算をします.MCMCのポイントは,初期系統樹の樹形を撹乱することで,より事後確率の高い系統樹を発見的に探索していくということ.この探索過程(定常マルコフ連鎖)を繰り返すことにより,しだいに収束していくならば,最終的に事後確率分布が得られます.参考文献とオンラインサイト【書名】Markov Chain Monte Carlo in Practice【編者】W.R. Gilks, S. Richardson, and D.J. Spiegelhalter【刊行】1996年
【出版】Chapman & Hall, Boca raton【頁数】xviii+486 pp.【ISBN】0-412-05551-1Introduction to Bayesian Epistemology Elliott Sober January 31, 2000 http://philosophy.wisc.edu/sober/bayes.pdfReverend Bayes meets Darwin:Bayesian inference of phylogeny and its impact on evolutionary biology (Supplemental Material) John P.Huelsenbeck ,Fredrik Ronquist ,Rasmus Nielsen  and Jonathan P.Bollback 2001 http://www.sciencemag.org/cgi/data/294/5550/2310/DC1/1プログラム「MrBayes」と参考書【書名】Phylogenetic Trees Made Easy:  A How-to Manual for Molecular Biologists.【著者】Barry G. Hall【刊行】2001年03月【出版】Sinauer Associates, Sunderland【頁数】xii+179 pp.【価格】US$ 24.95【ISBN】0-87893-311-5 (paperback)---
likelihood
