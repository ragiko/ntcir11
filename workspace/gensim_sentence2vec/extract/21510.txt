ガウシアン・フィルタ
オシロスコープの目的は波形の観測にあります。 その測定帯域上限での減衰特性や、帯域制限のフィルタを入れる時の特性は、波形の崩れを最小限にするように設計します。 オーバーシュートを持ち込むことはもってのほかです。
ところが、振幅特性の良いバタワースや、Brickwall に近い切れの良いチェビシェフでは、右の図のようにオーバシュートが持ち込まれます。 それだけではなく、立ち上がりに時間遅れがあり、かつ傾斜もゆるくなってしまいます。 このような問題は(ガウシアン特性ではない)チェビシェフやバタワースでは逃れることができませんが、ガウシアン特性を持つ後述のフィルタを使うとある程度解決できます。  (この図は 6 次の低域フィルタを ω=1rad/sec で -3dB にそろえて比較したものです。 Gaussian と書いたものは理論的なガウス特性です。
Chebyshev0.5 はリップルが 0.5dB の第 1 種チェビシェフです。)
光通信や同軸を使ったパルス伝送では、その中で使うアンプはビットレートの 0.75 倍程度の帯域が要ります。 ここでも同様に波形の崩れない減衰特性を選ばないとアイパターンが狭くなってしまい、BER
(bit error rate) が上昇します。
まったく同じ事が、ハードディスクや光ディスクの読み出し信号処理でもいえます。 
AD 変換ではエリアスを避けるためにフィルタを必ず使いますが、オーバシュートしたところでサンプリングすると、誤差を持ち込みます。
これらは、周波数領域で信号選択に使用するフィルタとは違う基準です。 従来の周波数ドメインでの考え方に対し、パルス信号ではタイムドメインでの設計が必須になってくるわけです。
インパルス入力に対して、オーバシュートが無く、かつ時間軸で左右対称な出力が得られるフィルタを総称して、ガウシアンフィルタと呼んでいます。 理論的なガウシアン特性は LCR では実現できないため、近似して実現します。 ですから実際には
1.周波数応答がガウシアンに近いものか、
2.群遅延時間がフラットなものか、
3.群遅延時間が equiripple なもの
をいいます。 高次の Bessel もこの条件を満足させますからガウシアンと呼んでもよさそうですが、人によって、ガウシアンの範疇に入れる人と、入れない人がいます。 上のグラフでもほとんどくっついていますね。 これについては後述します。
それでは、いくつかのガウシアンのフィルタ形式を取り上げて比較しましょう。 すべて6次です。 7-8 次でも同じような結論になります。 グラフの凡例に出てくるものは以下の6つと、理論値のガウシアンです。 すべて
ω=1 で -3dB にそろえました。 いずれも、 「7次までの楽々フィルタ設計」に掲載したエクセルファイルにフィルタ係数を載せており、サレンキー形式の回路を設計できます。
1から5までがガウシアンの例で、エクセルファイルに係数を載せてあります。 6は参照用のバタワースで、ガウシアンではありません。
1.SER6-5: 対称遅延誤差チェビシェフ特性フィルタ 
(Linear Phase, Symmetrical Chebyshev Equiripple Error Filter)、
遅延特性誤差 5%。
2.SER6-1: 対称遅延誤差チェビシェフ特性フィルタ 
(Linear Phase, Symmetrical Chebyshev Equiripple Error Filter)、
遅延特性誤差 1%。
3.ER6-0.5: 遅延誤差チェビシェフ特性フィルタ 
(Linear Phase, Chebyshev Equiripple Error Filter)、
位相誤差 0.5度。
4.TBT6-6: 振幅平坦遅延平坦混合フィルタ、転換点 -6dB 
(Transitional Butterworth Thomson Filter, Gaussian to -6dB)
5.Bessel6: 遅延最平坦特性フィルタ  (Bessel Thomson Filter)。
6.Butterworth6: 最平坦特性フィルタ (Butterworth Filter).。 参考用で、ガウシアンではない。
上記中の「遅延誤差チェビシェフ特性」というのは注意してください。 振幅応答のチェビシェフ特性ではありません。 群遅延の誤差がチェビシェフになるように設計してあるものです。
周波数応答
SER6-5、SER6-1、ER6-0.5、Bessel6 が右の方まではみ出しており、切れが悪くなっています。
TBT6 は途中 -6dB までそれにつきあっていますが、切り替え点から切れをよくしています。 赤い丸印です。 (-12dB で切り替えることもできます。)
よくみると -6dB 以上の周波数では Butterworth よりも傾斜が急で、Chebyshev (e=0.1dB)
に近い特性です。 もっと上では同じ 36dB/oct になります。
群遅延特性
群遅延時間のグラフですが、遅延の数値ではなく、フラットにどれだけ右に伸びているかを見てください。
SER6-5、SER6-1、ER6-0.5 はベッセルよりも右側に伸びていて、できるだけ帯域外でも一定の遅延時間を確保しようとしています。 これがガウシアンフィルタと呼ばれるものの特性です。
ベッセルをガウシアンの範疇に入れない人は、たぶんこれが理由です。
SER6 はリップルを持たせていますが、それは ω=0 の時の値に対し上下両方に振らせるようにしています。 振幅は 1% と 5% のものをサンプルにとりました。
それに対し、ER6 はチェビシェフ特性を採用しており、偶数次ですから上方向の振れだけになっています。 量は、このサンプルでは位相角にして 0.5度です。
ガウシアンフィルタの特徴は、遅延特性が右の方まで伸びていて、十分ストップバンドまでカバーしていることです。 ディレイラインとして使えます。 赤い丸で示した3つは、ω=2
を超えたところまでフラットですね。 ここで周波数特性の方は -15dB を割り込んでいます。 この点ではベッセルではちょっと不十分かもしれません。
ステップ応答
SER、ER、Bessel の4つが左側に寄っており、理想特性に近いカーブです。
ベッセルをガウシアンに含める人はこれを根拠にしています。
ベッセルは「ガウシアン」という名前で騒がれる以前から存在していましたから、「新しい特性のフィルタ」という意味でのガウシアンと切り離して議論したことが、含めない理由かもしれません。
TBT はバタワースにみられた大きなオーバシュートを押さえて、ベッセルとの中間をねらったことが分かります。
SER6-5 は、目をこらしてよく見ると Bessel よりも遅延が大きくて右にありますが、傾斜は Bessel よりも良くて、ガウシアンに近い立ち上がりになっています。
セトリング
ステップ応答の上がりきったあたりを拡大してセトリングの様子を見てみましょう。 右図です。 AD 変換に使うときはこの特性が重要です。
速さなら Bessel、誤差なら SER6-1 ということが分かります。 (あまり差はないか、、、)
ガウスカーブ
右に、インパルス応答の例として、ガウスカーブそのものを描いてみました。 このベルカーブは標準偏差を 0.5 とし、中心を 2.668 としています。 
上のグラフ中の理想ガウシアンのステップ応答はこのカーブを積分して作りました。
ガウシアンの周波数応答
ガウスカーブの図の中に書いた関数式は時間を軸にとっていますから、これをフーリエ変換することによって、周波数を軸にした応答を出すことができます。 実はガウス関数をフーリエ変換したら、答えもガウス関数になります(下記参照1)。
中心を 0 にして実際にやってみると右のようになります。 負の周波数まで入っていますね。 中心の周波数は 0 である必要はなく、高い周波数に持っていってバンドパスとして見ることもできます。
その図を、周波数と出力をともに対数にして、見慣れた表示にすると、右のようになります。 ただし ω0 を 1 にとったままでは、ω=1 での減衰が
1 Np(ネーパ: -8.69dB)になってしまいます。 そこで -3.0103 dB になるように ω0 を 1.69864 に動かして正規化してあります。 その結果、群遅延の値(π/(2*ω0))は
2.66822 になっています。
この関数の分母は ω の有限次数の多項式ではないので LCR では実現できません。 ですから近似したもので代用します。 近似したものであっても、便宜的に「ガウシアン・フィルタ」と呼びます。 厳密に実現したいときはディジタルフィルタの
FIR を使います。
こうして各種の比較をやると、高次のベッセルの特性はなかなか捨てたものではないことがわかります。 今回は LC を使ったフィルタ、特に高周波でのパルスの取り扱いの具体例に踏み込みませんでしたが、考え方はそのまま延長できます。 SAW
など使ったガウシアンのバンドパスフィルタの形も、上のローパスフィルタの形を左側へも折り返したものになります。
次数が変わるとどうなるかも検証したいところですが、長くなりますのでこの辺でペンを置きます。
一次フィルターを多段重ねる
ちょっと主題から離れますが、一次のフィルターを多段重ねるとどうなるでしょうか。
ラダー接続ではなくて、間にアンプが入っているケースです。
全ての段が同じカットオフを持っているとして、各タップ位置での周波数特性と群遅延を計算してみました。 そのままではタップが右に行くほど ω=1
での減衰はどんどん大きくなりますから、ω=1 で -3dB になるように補正しました。 (つまりグラフを右に寄せる) また群遅延も段数分だけ増えますから1で正規化しました。
右のグラフがそれです。
タップ位置が右に行くほど理想ガウシアンに近づくことが分かります。 群遅延についても同じ事が言えます。 まあ、無限個の同じ周波数の1次フィルタを重ねるとガウシアンになる、ということです。
オシロスコープの増幅はたいていこの原理を使っています。
しかし、たとえば群遅延では 15 段入れても80% の位置で ω=2.2 で、この場所でゲインの減衰は 15dB ほどしかありません。
同じ尺度で見てみますと、SER6-5 ではたった6次なのに群遅延の 80% 点はω=2.6 程度まで伸びており、その場所での減衰は 20dB
以上あります。 ですから、ガウシアンフィルターを構成することは意義があります。
［関連記事］
ガウシアンフィルターの次数の影響
KK Linear Phae Filter
［参照］
1. "フーリエ解析と関数解析学" 新井仁之、培風館、ISBN978-4-563-00645-7 の第3.4章
2. http://www10.pcbcafe.com/book/phdThesis/Appendix-3.php
3. http://mathworld.wolfram.com/FourierTransformGaussian.html
4. http://www.picosecond.com/objects/AN-07a.pdf
［参考］
下に、カットオフが 1 rad/sec (0.16 Hz) の3次のベッセルとチェビシェフのフィルタに、5種類のビットレートのインパルス(単発のパルス)が入ってきたときの応答を描いてみました。 R
が周波数比です。 比が 0.6 から 0.8 ほどあれば高さが 1 まで上がることが分かります。 上の記事で 0.75 としたのはこれが根拠です。 また、R
が小さいときに、ベッセルの方が高く上がっていることも分かります。 なお、信号は NRZ を想定しており、ビットレートはクロックの2倍です。 どちらも
-3dB 点をカットオフとしています。
[余談]
おもしろ半分にアイパターンを作ってみました。 カットオフをビットレートの 0.75 倍にして、3次の Chebyshev 1dB でステップ応答を 30
波作り、NRZI の様々なビット順列を想定して、それに合うようにずらしながら重ねてみました。 なんか見慣れた絵になりました。
この程度の崩れならそれほど影響は大きくないですね。 でも、カットオフ点をうまく選ばないと、リンギングの下側(内側)の振れが 「目」 の中に入ってくることが予想されます。
また、オーバシュートがジタの一因であることも分かります。
[余談2]
20 年以上前に、ある人から、ハードディスクの信号チャネルのフィルタパラメタの質問を受けましたが、その当時はあまり詳しくなくて答えることができませんでした。 (設計担当者さん、ごめんなさい。 いまなら答えられますが、、、)
［お断り］
このページの絵はすべて計算で出したものです。 実験結果ではありません。
［ついでに］
代表的なガウシアンフィルタとベッセルフィルタの係数を掲げておきます。 AutoFil-1-7.htmで紹介したものです。
コメントはこちらへ==> 
サイトの最初のページに行く
(5/18/2007)
The Art of Analog Circuits, Gaussian Filter
