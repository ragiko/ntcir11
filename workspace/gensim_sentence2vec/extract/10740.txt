尤度関数と最尤推定値
池に何尾魚がいるかを調べるために、ある日100尾を捕獲し目印を付けてから放し、しばらく間をおいてからまた100尾を捕獲してみたところ、その中に先日目印を付けた魚が10尾見つかりました。このデータから池には何尾の魚がいると推定できるでしょうか。この問題を解くには「超幾何分布」を応用するのがよいと思われますが、そのために、この問題を一般化することにします。すなわち
のようにしますと、この標本の確率変数の確率は次のような超幾何分布にしたがって
のようになります。この式から池の魚の全数を求めたいわけが、確率の値がわからない限り求まりそうにもありません。そこで、ここから推定をしなければなりません。まず、いま現在わかっているだけの状況を考えると
の合計の数だけの魚が池には最低限いることになります。したがって、その数は
となります。それでは、この魚の数だけ池にいたとすると、確率はどれくらいになるか計算してみましょう。求める確率は
となりますが、このままでは大変な計算になるので、スターリングの近似公式
を使って計算すると
となります。この確率の値はいくら推定値とはいえあまりにも小さ過ぎて現実味に乏しいと思われます。そこで、任意のある観測値に対して確率を最大にする母数の推定値を求めようとする方法「最尤法」(あるいは「最尤推定法」(method of maximum likelihood estimation)とも言います)がフィッシャーによって提案されています。この方法では推定値のことを特に「最尤推定値」(maximum
likelihood estimate)と呼んでいます。意味は最も尤もらしい推定値ということです。この方法ではを固定して母数を変数とするわけですから、をあるいはと書き直すことにします。すなわち、対象とする関数は
で、この関数のことを「尤度関数」(likelihood function)と呼んでいます。最尤法では通常尤度関数を最大ならしめるためにの偏微分方程式(尤度方程式)を解けばいいのですが、この例の場合は母数が整数であるため、尤度方程式を解いて求めることができません。
そこで、次のような比
を考えると、となるような最尤推定値は
となるような関係を満たす最大の整数であることがわかります。
したがって、この条件式を上の比に代入すれば
となり、これを変形すれば
となります。したがって、
となる整数が求める母数(池の魚の全数)の最尤推定値となります。最後の数式のの記号はガウスの記号で、左辺の値はカギ括弧内の数を超えない最大の整数を表すものとします。
そこで、本題の条件
を最尤推定値に代入すれば、求める池の魚の最尤推定値は
となります。このようにして、求められた池の魚の最尤推定値を使って、その確率を求めてみますと
のようになります。
(参考)最尤法
「最尤法」あるいは「最尤推定法」は、母数の点推定をする一つの方法であるが、これは母集団の分布の形がわかっているがその母数が未知であるときに、標本値からその母数を決めようとする方法です。
いま母集団から大きさの標本を無作為抽出したとき、その標本の値がであったとします。すなわち、これは母集団分布に従う確率変数が実現値としてそれぞれという値をとったことを意味します。ところで、標本変量の確率密度関数(分布が離散型の場合は確率関数)は、母集団分布がで与えられ、確率変数が互いに独立であるならば、一般に
のような確率密度関数の積の形で与えられます。ここでは確率変量の実現値であり変数ですが、は一般に母数のような特性値ですから未知の定数です。しかしながら、いったん母集団から標本が抽出されてしまえば、実現値は定まった値として固定されてしまうことになり、一方、は未知数のままです。したがって、母数の推定量を求めるためには、をの関数と考えて
というが固定でが変数となる新しい関数を考えます。この関数のことを「尤度関数」(likelihood function)あるいは単に「尤度」(likelihood)と呼び、この関数を用いて、固定の条件の下で、母数の最も尤もらしい点推定により母数の推定量あるいは推定値であるを求めようとするのが「最尤法」です。
この尤度関数を最大にする推定値のことを「最尤推定値」(maximum
likelihood estimate)と呼び、のことを「最尤推定量」(maximum
likelihood estimator)と呼び、最尤法はこのを求める方法になります。ここで、あるいはのは「統計量」(statistic)を意味します。したがって
を解けば最尤推定値あるいは最尤推定量であるが求められることになります。尤度関数は積関数で計算が面倒なので、尤度関数の対数をとった新しい関数、すなわち
を定義し
を解いた方が便利なことが多いと考えられます。このような偏微分方程式のことを「尤度方程式」と呼ぶこともあります。
(例題1)正規母集団から大きさの標本を無作為抽出したときの標本値がでした。母分散が既知であるときの母平均の最尤推定量を求めてみましょう。ただし、正規母集団の確率密度関数は
です。
標本値は互いに独立なので、の積をとることにより、標本変量の確率密度関数は
のようになります。そこで、標本値と母分散が一定で母平均を変数とする尤度関数は
となります。ここで、計算を簡単にするため上式の対数をとれば
となるので、このを最大にするを求めるには
となる尤度方程式を解けばよい。したがって
すなわち
となり、最尤推定値が求まりました。したがって、最尤推定量は
となります。すなわち、母分散がわかっている場合の母平均の最尤推定値は不偏推定量に等しくなります。
(例題2)正規母集団から大きさの標本を無作為抽出したときの標本値がでした。母分散が未知であるときの母平均の最尤推定量を求めてみましょう。ただし、正規母集団の確率密度関数は
です。
標本値は互いに独立なので、の積をとることにより、標本変量の確率密度関数は
のようになります。そこで、標本値を固定して母平均と母分散を変数とする尤度関数は
となります。ここで、計算を簡単にするため上式の対数をとれば
となるので、このを最大にするとを求めるには、連立方程式
を解けばよい。したがって、最初の尤度方程式より
が求められるので、これと第2の尤度方程式により
が得られます。よって、母平均と母分散の最尤推定量とは、それぞれ
および
となります。この尤度法で得られた最尤推定量は母平均の不偏推定量であるが、最尤推定量は母分散の不偏推定量とはなっていません。すなわち
なので、最尤推定量を母分散の不偏推定量とするためには、
のように分母をにする必要があります。もちろん標本の大きさがかなり大きいときは、尤度法でも母分散にきわめて近い(偏りがない)推定量が求められることになります。
尤度関数と最尤推定量(maximum likelihood estimato
