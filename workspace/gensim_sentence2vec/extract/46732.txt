						4個(数値) から3個抜き出す場合の組合せを配列返しするユーザー関数をEXCELで作りたい
>
例えば 1234 >> {1,2,3;1,2,4;1,3,4;2,3,4} と返される機能を有します
>
呼出形式は シートから =CC3(A1) 又は CC3(A1,3) 
CC3は関数名, A1はセル(range) 3=抜出個数 
そこでネット検索した結果,発見はしましたが
C言語対応 かつ, 3行を消した(下記部分)ソースコードでした
C言語についてはカジる程度ですが,「組合せ論理」について100%に近いほど理解できません
恐縮ですが リストの3行を教えて頂ければ幸いです
<考え方> 転記
1.樹形図に従い,1番目の要素から決定して行く
2.要素が昇順になっているものを選び,他のものは削除する
3.[n]になっている中のnは未決定の要素とする
4.点線部分は辿らない
<ソースの1部> 全体がPDFでテキスト化出来ず,主要部分のみ転記
-----------------------------------------------------------
#include <stdio.h>
#define N 50; /*集合の最大要素数*/
int a[n+1],n,r; /*組合せ保存配列, n=集合要素数=4, r=取り出す個数=3*/
double count; /*組合せ個数*/
int main() {
int i;
while(1) {
scanf("%d%d",&n,&r);
if ( (n<=0) || (n>N) || (r>n)) {break;}
for (i=0;i<=n;i++) { a[i]=i:}
count=0;
comba(1);
printf("n=%d r=%d count=%16,0f\n",n,r,count);
}
}
void comba(int k) {
int i,w;
if (k > r) {
/*組合せ表示*/
count++;printf("%6.0f: ", count);
for (i=1;i<=r;i++){printf("%2d ",a[i]);}
printf("\n");
}
else{
w=?????; /*1*/
for (i=k; i<=n; i++) {
a[k]=a[i];a[i]=w;
if( ?????) { comba(k+1);) /*2*/
a[i]=a[k];
}
a[k]=????? /*3*/
}
}
-----------------------------------------------------------
動作結果(転記) n=4, r=3 の場合
4 3
1,2,3/1,2,4/1,3,4/2,3,4 の4通り
添付画像は 500X900 pic で相当縮小されると思いますが,掲示しました (上>>樹形図, 下>>ソースイメージ)
補足dia_fifteenさま,ありがとうございます, 前回は<順列>でした(^^)
1.コードを見まねでVBAに直し検証中ですが, sub(4) で subへ入った時
disp[4-cnt-1]のINDEXが (-1)になりエラーになりませんか? ( "C" と "VBA"は違うかも?!)
2.当方 xp sp3 , VC++6.0,VC++2005,VC#2005,はテスト可能なのですが
Cベース(打ち込む)でもテスト可能なのでしょうか? メイン関数が int main(引数0個) -> WinMain(引数4個) で
違うから無理ですね
//
(前回の回答は重複を許してた(笑))
直接の回答ではないが、以下のソースが機能を満たしているはず。
#include "stdio.h"
int data[4] = {1,2,3,4} ;
int flg[4] = {-1,-1,-1,-1} ;
int disp[4] = {0,0,0} ;
void sub(int);
void main()
{
int i ;
sub(4) ;
}
void sub(int cnt)
{
int i ;
if(cnt == 1)//3個抽出されたら表示して終了
{
printf("disp = %d %d %d\n",disp[0],disp[1],disp[2]) ;
return ;
}
for(i=0;i<4;i++)//使用していない数字を検索
{
if((flg[i] == -1)&&(disp[4-cnt-1]<data[i]))//未使用且つ前より大きい
{
flg[i] = 0 ;//使用済みに
disp[4-cnt] = data[i] ;//数字を表示エリアに
sub(cnt-1) ;//次の数の抽出に
flg[i] = -1 ;//未使用に
}
}
}
結果
disp = 1 2 3
disp = 1 2 4
disp = 1 3 4
disp = 2 3 4
[補足]
VBAは1始まりだっけ?(Cは0始まり)
そこは調整して(笑)
VCでも拡張子をCにすれば、main()のCは開発可能のはず。
[補足2]
3度目の正直?
#include "stdio.h"
int data[4] = {1,2,3,4} ;
int flg[4] = {-1,-1,-1,-1} ;
int disp[4] = {0,0,0,0} ;
void sub(int,int);
void main()
{
// int i ;
sub(4,0) ;
}
void sub(int cnt,int val)
{
int i ;
if(cnt == 1)//3個抽出されたら表示して終了
{
printf("disp = %d %d %d\n",disp[0],disp[1],disp[2]) ;
return ;
}
for(i=0;i<4;i++)//使用していない数字を検索
{
if((flg[i] == -1)&&(val<data[i]))//未使用且つ前より大きい
{
flg[i] = 0 ;//使用済みに
disp[4-cnt] = data[i] ;//数字を表示エリアに
sub(cnt-1,data[i]) ;//次の数の抽出に
flg[i] = -1 ;//未使用に
}
}
}
ゴメンナサイ(笑)
4個(数値) から3個抜き出す場合の組合せを配列返しするユーザー関数をEX... - Yahoo!知恵袋
