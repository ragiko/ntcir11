みんな大好きはてなブログのアドセンスの話題。よく、記事の文中にアドセンス入れてる人いるじゃないですか。
あれって結構効果あるようなイメージですが、手動でやってるんですよね?面倒ですよね?もし広告をつけ変える場合、いっこずつ全部書き換えなきゃだし。
ということで、それを自動化するコードを紹介します。
設定方法
ダッシュボードデザインカスタマイズ記事上下のカスタマイズ「記事ページのプレビュー」を設定記事下
<script>// <![CDATA[
addEventListener("DOMContentLoaded", function() {
var $target = $('.entry-content > p + h3,h4,h5');
$target.eq(Math.floor($target.size() / 2)).before($('.insentence-adsense'));
}, false);
// ]]></script>
<div class="insentence-adsense">
<p>広告</p>
<!--ここに自分のアドセンスのコード-->
<p> </p>
</div>
諸注意など
本文中で大見出し、中見出し、小見出しの数を数えていって、真ん中に当たる部分の見出しの前に挿入します。
大見出し、中見出し、小見出しのどれもない場合は何もしません(そのまま記事下に表示される)
挿入対象はinsentence-adsenceのdivなので、アドセンスコードの周りのスタイル等適宜調整してください。上記例では、コードの上に「広告」という文字、下に空行を入れています。
「もっと読む」の下に広告入れている例が多いようなのですが、はてなブログは「もっと読む」の位置がソース的に記載されていないようなのでできませんでした。
スマホで320pxのAdsenseとlinkwithinがはみ出る問題の対処決定版(2014/8版) - UXエンジニアになりたい人のブログこれで320pxに拡大した広告を文中挿入しようとした場合、余白部分が広告にかかってしまい、ポリシー違反になってしまいます。z-indexもoverrideも効かず・・・。どうやら、親要素に子要素を挿入する場合、親のコンテンツ領域からはみ出せないような動きです。そういうもんでしたっけ?
はてなブログで「文中にアドセンス広告を入れる」を自動化する方法 - UXエンジニアになりたい人のブログ
