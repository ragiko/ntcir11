先日、あるお客様がエクセルで作成した住所録を持ってこられました。そのデータを使って抽出をしたり、同窓会のあて名を差し込み印刷したいんだけど・・・とのご相談です。
さて、データを拝見してみると、1件のデータが2行に分けて入力されていたり、1つのセルに郵便番号と住所をまとめて入力されていたりしています。
印刷したときの見栄えを考えて、このように入力されることは実際、多いのですが、このままだと並べ替えや抽出のデータベース機能が使いづらく、差し込み印刷をされるにも、難しいようです。
まず、郵便番号と住所は左の図のように、1つのセルに入力されていて、しかもAlt+Enterで改行してあります。
この改行をまずは削除していきましょう、ということで作業を開始しました。
セル内での改行を1件ずつ削除して編集するにはとても時間が足りません。
こんなときには置換機能を使います。以下の手順で行います。
①Ctrlキーを押しながら［H]キーを押します。(置換ダイアログボックスが表示されます。)
②「検索する文字列」のボックスをクリックし、「Ctrl」キーを押しながら「J」を入力します。(画面には何も表示されません)
③「置換後の文字列」には空欄のまま何も入れません。
④オプションの、置換対象には、この方の場合、ブック内の複数のシートでの作業でしたので、「シート」をブックに切り替えます。
⑤「すべて置換」をクリックします。
で、左図のように、1行のデータになりました。
あとは、ここから、郵便番号のデータを別のセルに取り出す作業が必要です。
でも、このように桁数が決まっているデータであればLEFT関数を使えば簡単です。
MOS2007のExcelを勉強された方は、勉強されたことがありますね。
セル内の文字の左から一定の文字数分を切り取って別のセルに取り出す、という関数です。ここでは、8文字分にすれば、郵便番号(ハイフンを含む)を別のセルに取り出すことができます。
長くなりますので、LEFT関数の使い方はここには記載しませんが、興味のある方はぜひやってみてください。
セル内の改行を一度に削除するには(エクセル): パソコンのある風景
