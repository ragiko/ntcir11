ぶんさんぶんせき
分散分析 analysis of variance にまつわるノート。
入門者向けではなく,統計学にユーザとして接する院生向けです。
これまでに相談を受けた内容から集めました。多分に誤記の可能性があるので,発見次第ビシビシご指摘ください。
(ただ,厳密には誤りだと認識しつつ,説明の平易さのためにあえて大まかな記述をしている部分もあります。)
since 2003-04-06
updated on 2011-05-02
このノートでは,同じ意味でも様々な語を使っていることがあるので,その対応を挙げておきます。
統計基礎用語集(英和編)を参考に。
factor  要因,因子
design  デザイン,計画
component  成分,構成要素,コンポーネント
parameter  母数,パラメタ
analysis  分析,解析
model  モデル,模型
control  コントロール,制御,統制
balance  バランス,釣り合い
sample  サンプル,標本
分散分析と因果
分散分析は実験計画法に密接に結びついた統計解析であるため,
それが適用されるのは実験データであることがほとんどで,また,
分析結果から導かれた結論として因果関係に言及するケースが多い。
しかし他の解析手法,例えば重回帰分析などと同様に,分散分析であっても
それは相関関係の分析,統計的結論妥当性 (statistical conclusion validity) の確保に過ぎない。
すなわち,この分析法自体の力によって因果関係についての知見がもたらされることはない。
分散分析で結論され得るのは「偶然とは言えないような変数間の関係性がある(要因水準間の違いがある)」
ということであり,それ以上ではない。
データを分散分析にかければ(そして有意な結果を得れば)因果が結論できると考えるのは大きな誤りである。
因果関係を結論できるかどうかは分析法ではなくデータの収集法に依存する。
これを常に心に留めておくこと。
ランダム サンプリング
これは分散分析だけに限らない話であるが,分散分析も含めて,
検定統計量に関する確率分布を利用した検定をするということは,母集団についての推論を行っている。
すなわち,その場にある被験体群(標本)のみに関するものではない。
標本から母集団について統計的に正確な推測を行うためには,ランダムサンプリングが欠かせない。
ランダムサンプリングとは,母集団のどの要素もゼロでない既知の確率で標本に含まれうるような,サンプリング方法である。
たとえば単純ランダムサンプリングでは,母集団(実践的にはサンプリングフレーム)の可能なすべての標本(要素のすべての組み合わせ)が等確率で選ばれる。すなわち抽出確率は既知。
ランダムサンプリングをしていなければ母集団についての正確な統計的推測はできないから,
分散分析などを適用しても母集団について正しい結論を得ることを一定の範囲で保証することができない。
ただし,心理学や医学などでの通常の適用場面では,ランダムサンプリングはしていないが,ランダム割当て(random assignment)を行っていることがある。
このような場合,一番適切なのは randomization test (無作為化テスト) であるが,
分散分析などの方法を適用しても,randomization test による正確なp値の近似値を得ることができる。
よって,ランダムサンプリングをしていなくても,ランダム割当てされたデータへの近似的な方法として
分散分析の適用は認められるのである。
ただし,近似であるという点を忘れてはいけない。このような近似的な方法の適用が行われてきたのは,
randomization test を実行とすると莫大な量の計算が必要で,実行が難しかったからである。
ところが,近年は計算機の性能も飛躍的に上昇してきたから,
randomization test を実行して正確なp値を得ることは難しくない。
そうすると,そのような場合の分散分析はお払い箱なのである。
分散分析は,母集団からランダムサンプリングをした場合という正当なケースや,
サンプルサイズが非常に(randomization test ができないほど)大きいときの近似的代用法として
などで適用されるべき。
理論的前提と平方和の分解
分散分析の根底にある基本中の基本。
あるいくつかの仮定の下で,全体の平方和は各コンポーネント(成分)に分解できる
(=全体変動を各変動成分の単純な和として表せる)。
その仮定の一つが,線型性(linearity)。
もうひとつ,基本的な仮定として注目しておくべきなのは,直交性(orthogonality)。
そして三つ目に,なぜだか教科書でこれだけが強調されている(それゆえ有名な),誤差に関する諸々の仮定。
線型性
言わずもがな,分散分析モデルは線型モデルの一種である。
分散分析がこの線型性の仮定に乗っかっているということは,
モデルの線型性が前提できない現象へ分散分析を根拠なく適用してはいけない
ということ。これはとっても忘れられがち。
もう少し実践的に言うと,線型モデルを当てはめるのがマズイと,事前に,あるいはデータの分布を見て,わかる場合は,
もっと適切な分析モデルを当てはめるべきである,ということだ。
これは「何でもかんでも分散分析するな」の根拠の1つである。
ここで言っている線型性とは,独立変数と従属変数の関係の話ではなく,母数(parameter)についての線型性であることに注意。
式で書けばこういうこと。
分散分析のノート
