§クエリーを使ってみよう§
さて、実際にできたかどうか、入力して確かめてみようか。
入出庫明細に次の事柄を入力してみよう。
----------------------------------
1月5日に商品番号1000110のサイズ番号7の「25」が5個入ってきた。
1月5日に商品番号1000110のサイズ番号7の「25」が2個売れた。
1月5日に商品番号1000110のサイズ番号7の「25」が10個入ってきた。
----------------------------------
すると、下のような画面になるね。一辺に収まりけれなかったから、
二段に分けてみたんだ。すると、
あっ。「サイズ番号」を入力しただけで、サイズがでてきたよ。
それと、入荷数を入力したら、仕入値合計が計算されているね!わーなんかすごーい。
でも、自分で計算式を入力したからこうなった。
という経験みたいなものがあるから、データベースを自分で設計することは非常に大事なんだ。
あとでいろいろと自由にデータを加工できるからね。
でも確かに計算はいいかもしれないけれど、これは一件一件でしょう?
私の知りたいのは、売り上げの合計なの。それと、最後の在庫の数なんだけど、
確かに、5個入ったら「5」2個売れたら「2」と数字が出てくるけど、
私が欲しい数字は、合計の在庫数、すなわち、
「5個入荷」−「2個売れた。」+「10個入荷」=15-2=13
そう、「13」という数字が知りたいのよ。これはもしかして自分で計算するわけ?
まあまあ、みきさん落ち着いて。君のいうことは本当だ。
合計金額だけ、また、その日その日の在庫数だけ記録したところで
何もならないよね。そう、ここで、出てくるのが集計という作業なんだ。
あっそっか。何か、クエリーを作るところで、「集計クエリー」とかう項目があったわね。
するどい。そのとおり。次に、このデータの集計方法を勉強していくことにしようか。
いよいよこのシステムのメイン部分に入ろう。
前のページで紹介した「集計クエリー」を作成しよう。
まず、クエリーの画面から「新規作成」を選択して、
「クロス集計クエリー」をクリックしてみよう。
なんか変な画面がでてきたよ。なんか長い文章でよくわかんな～い!
うん。ようするに、集計表の縦の項目と横の項目を決めなさいということなんだ。
みきさんは、どんな集計表をイメージしているのかな?
そうねえ。やっぱり、縦軸には商品、横軸にサイズが出てきて表の中には、
売上合計だったり、在庫数だったりすればいいわね。
入出庫記録は、先程つくった「Q_入出庫明細」から取ってこよう。
「Q_入出庫明細」を選んで、「次へ」のボタンをクリックすると、
下の画面が登場するよね。
まずは縦軸から設定しよう。「商品番号」は縦軸に設定するから、
「選択したフィールド」に「商品番号」を選ぶんだ。
そうすると、表に自動的に商品番号が縦軸に入力されてるよね。
次に横軸ね。これはサイズが入るから、上の画面の
ようにすればいいのね。それと、表の中の項目は表中のデータが入るから、
最後は残在庫数、つまり、残っている在庫の個数の合計が入ることになるのね。
さて、これで完成だ。この最後の画面に、「売上合計」を入力すればサイズごとの売上、
「仕入値合計」を入力すればサイズごとの仕入れ値の合計が入力されるよ。
それぞれ別の名前で新しくクエリーをつくってもいいよね。
とりあえず、今回のクエリーの名前は下のようにしてみようか。
は～い!
在庫管理システムを作成しよう
