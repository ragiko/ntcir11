中途失明者のためのオンライン日本語入力システム
江崎 修央†   清田 公保††   滝沢 穂高‡   山本 眞司‡
†鳥羽商船高等専門学校 〒517-8501 三重県鳥羽市池上町1-1
††熊本電波高等専門学校 〒565-0456 熊本県菊池郡西合志町須屋2659-2
‡豊橋技術科学大学 知識情報工学系 〒441-8580 愛知県豊橋市天伯町雲雀ヶ丘1-1
E-mail: 
†ezaki@toba-cmt.ac.jp, ††kkiyota@tc.knct.ac.jp, ‡{takizawa, yamamoto}@parl.tutkie.tut.ac.jp
あらまし  本研究は,中途失明者向けの日本語入力システムの開発を目的とする.提案するシステムは,これまで情報機器の操作が困難であった中途失明者を対象とし,キーボードや点字キー入力に代わる日本語入力手段としてペン入力を採用した.中途失明者は視覚情報を失った後も,漢字や平仮名などの字形を覚えていることを利用して,従来のキー入力操作なしで日本語入力を可能とする環境をオンラインペン入力システムにより構築している.これまでの被験者実験の結果より本システムの視覚障害者に対する有効性を確認しているが,実際の文章作成時には平仮名や英数などの低画数文字が多く含まれており特徴量不足から認識精度の低下が見られた.本報告では,3種類の認識処理系のVoting手法と文字トライグラムを利用した誤り訂正処理による文字認識精度の改善効果について述べる.さらに,移動端末として機能するPDAへの本システムの実装結果について報告する.
キーワード  視覚障害者,オンライン文字認識,Voting,誤り訂正処理,トライグラム,PDA
Pen-based Japanese
character input system for Blind Persons
Nobuo EZAKI†   Kimiyasu KIYOTA††  Hotaka TAKIZAWA‡  and  Shinji
YAMAMOTO‡
†Toba National College of Maritime Technology  1-1 ikegami-cho, Toba, 517-8501 Japan
††Kumamoto National
College of Technology 2659-2 suya, nishi-koushi, kikuti, Kumamoto, 861-1102
Japan
‡Toyohashi
University of Technology  1-1
hibarigaoka, tenpaku, Toyohashi, 441-8580 Japan
E-mail: 
†ezaki@toba-cmt.ac.jp, ††kkiyota@tc.knct.ac.jp, ‡{takizawa,
yamamoto}@parl.tutkie.tut.ac.jp
Abstract   We have developed an on-line
character input system using handwritten character recognition technology for
blind persons (particularly persons with acquired
blindness). A blind user of this system is able to
directly input Japanese characters instead of a keyboard. We also confirmed
that a novice blind user was able to send an e-mail using our proposed system
without well training. However, since many characters having a small number
of strokes (such as Hiragana and Katakana) were contained in the mail
documents, the character recognition accuracy was significantly decreased in
the system. Therefore we propose an improvement method of the recognition
accuracy by combining the voting method with our original recognition method
and two conventional methods. In addition, a phrase unit order recognition
method based on a tri-gram probable language model is added to the
system. This improvement recognition system is installed on a PDA with voice
synthesizer software. We have addressed the issue of using the proposed PDA to
use in sending, receiving and managing users electronic mail document by
wireless LAN.
Keyword  Blind person, On-line character
recognition, Voting method, Error correction, Tri-gram, PDA
1. はじめに
視覚障害者の日本語入力に対する一手法として,筆者らは高齢者や中途失明者にも有効なオンライン文字認識技術を用いることを提案し,視覚障害者用ペン型日本語入力システムを開発した［1］.この方式は,キー位置を学習するなどの事前学習が不要であり,ペンで紙に文字を書く要領で日本語文書を直接パソコンで作成できるシステムである.しかし,市販の認識処理系を視覚障害者に直接適用しても,視覚情報のフィードバック無しで筆記される文字は予想以上に変形が大きく,認識精度が極端に低下し実用上十分な認識結果が得られなかった［2］.
このため新たに視覚情報欠如によって筆記された文字に対して頑強なオンライン文字認識技術のアルゴリズムを構築するため,視覚障害者から採取した文字入力データを収集し,様々な変形度の評価を行った.視覚障害者の筆記による手書き文字変形分析の結果,全体でのストローク位置のずれは晴眼者のものと比較すると遙かに大きいものの,①筆順に沿った隣接するストローク間の相対位置は安定,②個人内では筆順や画数は比較的安定という二つの見解を得た.そしてこの2つの特徴を用いた2種の独立した文字認識手法を提案し,これらの認識手法を組み合わせることで,お互いの特徴を補完することにより認識精度の向上を図った.この認識アルゴリズムは随時,文字種の拡大を行い,現在はJIS第一水準漢字をはじめ3,216文字種まで認識可能としており,この認識系を利用して視覚障害者用のペン型電子メールシステムを開発した.
実際にプロトタイプを視覚障害者に利用してもらい,実用性の評価実験を行った結果,日常で利用される日本語文章には平仮名や片仮名などの低画数の文字が非常に多く含まれ,漢字などの認識に比べて特徴量が不足するために正解文字を上位候補として常に出力することが難しいことが新たに判明した. 
一方,晴眼者を対象とした文字認識手法も,続け字や筆順変動の文字に対応したものや, HMMを利用し確率論に基づいた文字認識手法を適用したものなど,実用化に向けた柔軟な認識改善が試みられている[3][4].視覚障害者による筆記文字についても続け字や筆順変動などは,晴眼者と同様に生じるため,これらの晴眼者向けの認識手法を視覚障害者用にも適用することで,これらの変形には一部対応できる可能性がある [5].また,オフライン文字認識(OCR)の分野[6]やオンライン数式入力システムの開発[7]などにおいては,様々な認識手法の認識結果の多数決をとることにより,大幅な認識率の向上を図った試みが報告されており,低画数文字などの特徴量が不足する文字に対しては有効と考えられる. 
本稿では,これまでに筆者らが開発してきた視覚障害者用認識アルゴリズムを基本にして,従来手法で十分な認識精度を上げることが出来なかった低画数の文字における認識の改善を以下に示す2つの方法によって行う.第1に,これまでに提案している視覚障害者用認識手法に加えて,従来の一般の晴眼者向けに開発されている2種の文字認識手法を導入し,1文字単位の認識処理系の精度向上を図る.この場合,複数の認識処理系から候補文字がそれぞれ独自に出力されるため,候補文字の順位付けに着目した投票制を採用することにより上位候補として出力することとした.第2に,文字トライグラムを用いた誤り訂正処理を実装することにより,文節入力時における前後の文字情報の生起確率情報を用いて認識精度の改善を図る.
さらに,今回はディスクトップ用パーソナルコンピュータ上で実現していた本システムをPDA上に実装することを検討する.このために,新たにボタンの配置やシステム設計を見直し,本システムの携帯端末への応用の可能性について報告する.
2. ディスクトップ型のシステム構成
図1に開発した視覚障害者用ペン型日本語入力システムの全体構成を示す.本システムは視覚障害者のコマンド命令を伝達するコントロールボードと認識処理系や音声出力支援を行うパーソナルコンピュータから構成される.
視覚障害者は,コントロールボード上のタブレットに作成したい文章の文字を1文字ずつ筆記し,コマンドボタンの操作により,パーソナルコンピュータ内部で文字認識処理,誤り訂正処理が行われ,最終段階で候補文節が音声出力される.
図1 システム構成
2.1. コントロールボード(ディスクトップ用)
コントロールボードは,文字入力のためのタブレットとコマンド処理を行うためのハンドコントローラから構成される.本システムでは,全ての文書編集操作をこのコントロールボードを用いて行う.また,コマンド操作を左手系,文字入力を右手系というように役割分担を明確にさせ,両手を常に定位置に添えた状態でボタン操作を可能にすることにより,入力作業を円滑に行えるように考慮した.視覚障害者は日常でも触覚情報を有効に使うことが多いが,このシステムのように常に利用するキーに触れているという状態は,操作性以上に筆記者に安心感をもたらす効果を与えることが被験者実験より得られている.
コントロールボードには8つのコマンドキーがあり,1つのダイヤル式ボタンと7つのプッシュ式ボタンから構成される.ダイヤル式ボタンはカーソルキーとして,既入力文章でのカーソル移動と各モードにおけるメニュー選択の機能を割り当てている.ダイヤル式ボタンの採用は,視覚障害者が手の感触だけでカーソル移動やメニュー選択を感覚的に把握できるようにとの配慮による.7つのプッシュ式ボタンは,ペン入力処理の操作に割り当てられた大ボタン4つと文書編集やメール操作の各モードに移行するための小ボタン3つから成る.2種類の大きさのボタンを用意した理由は,視覚障害者が触手によって区別し易くすることと,互いに隣接していることによる誤入力を未然に防ぐためである.又,各キーの指の腹が触れる部分にはキーの意味が分かるように点字シールを設けた.
親指にダイヤル式の[カーソル]キーを配置し,以下,人差し指から順に[確定],[キャンセル],[リピート],[シフト]のプッシュ式キーをそれぞれに割り当てている.[カーソル]キーは文章中のカーソル移動やメニュー選択,[確定]キーは文字入力の終了や処理実行,[キャンセル]キーは処理の中止や一つ前の階層に戻るアンドゥ機能,[リピート]キーは前回出力された音声をもう一度出力する再音声出力機能を持ち,[シフト]キーはそれぞれのキーとの併用により,他のキーに付加機能を割り当てられている.以上のように,大ボタン4つはシステムを操作するため,小ボタン3つは各モードに移行するキーとして区別することにより,機能を明確にすることで操作性の統一を図った.
図2 コントロールボード
2.2. 文章作成方法
一般に従来の晴眼者向けオンラインペン入力方式では,1文字入力ごとに候補文字を出力し,候補文字群の中から正解文字を選択するという入力作業となる.しかし,思考を妨げない文章作成という観点から考えると,1文字入力ごとに候補を選択する方式は,思考を中断されやすい.特に視覚障害者の場合は,音声出力により候補文字の選択を行うため,1文字読み上げの際,逐次「詳細読み」により正解文字を選択しなければならない.このことは,余分な処理が加わるだけでなく,音声出力の頻度が増えるために,ユーザの音声出力への集中力の負担も増大している.
そこで,本システムでは複数の文字入力を優先させた後に候補文節を音声出力として提示する方法を採用した.これにより,候補文節選択の際にも特別な読み上げ法を必要とせず,滑らかな文章作成が可能になると考えられる.ただし,この方法では,ペン入力後の認識処理の精度を高度化する必要があるが,今回は4.で述べる最適候補文節を抽出するための誤り訂正処理を新たに導入することにより,この問題を解決した.
1文字入力から文章選択までの一連の流れは,以下のとおりである.入力待ちの状態からペンダウンを行うことで1文字入力が開始される.ユーザは1文字入力後,コントロールボードの[確定]キーを押してシステムに対して1文字の区切りを告げる.すると直ちに,バックグラウンドで認識処理系において入力文字に対する認識処理が行われる.このとき,文字認識結果はすぐには出力されず,候補文字を内部に保持したまま再び文字入力待ちの状態となる.そこで,再度ペンダウンを行うことで次の1文字入力状態となる.この作業を繰り返すことにより文節入力が可能となる.1文字入力終了を告げた後,もう一度[確定]キーを押すことで文節入力終了と判断され,自動的に誤り訂正処理が行われる.評価関数を用いて候補文節の確信度の高いものから順位がつけられ,第1候補文節が音声出力される.これが正しい文節であれば,[確定]ボタンを押すことで,この文節が登録されて入力待ち状態に移行する.違っていれば[カーソル]キー(左手親指に対応)により第2候補以下が順に音声出力され,正解文節かどうかの判定を行う.第3候補でも正解文節が得られない場合は,ユーザが最も正解に近いと思う候補文節を選択し,編集処理を行うことにより修正を行う.
文字入力モード中は,常時[キャンセル]キーを押す事により,各処理の前段階に戻ることができる.例えば,「1文字入力」中に[キャンセル]キーを押せば「文字入力待ち」状態に戻る.これは,文字を書き間違えた場合や過ってタブレットにペンが触れた場合に利用する. 
2.3. システムにおける各種モード
本システムでは文章作成機能以外にも,一般的な文章編集に必要な基本機能を設けている.また,メール機能により晴眼者との電子メールの送受信も可能となっている.
システム起動から各処理の実行までの流れを図3に示す.本システムはコンピュータ起動後,自動的にペン入力モード状態に移行する.この入力待ちの状態から,コントロールボードの小ボタン操作によりファイル管理モード(ファイル保存,読み出しなど),編集モード(カット,コピー,ペーストなど),メールモード(電子メール送受信)への各種モードへの移行が可能である.さらに視覚障害者にとって特に重要な現在の状態を示す状態確認と音声リピート機能による音声出力は,リピートキー操作によって常時実行できるように配慮した.また,カーソル移動に伴いカーソルの通過した文字を音声出力により読み上げる機能により,現在の編集箇所を視覚障害者は確認することができる.
図3 システムの状態遷移
3. 文字認識制度の改善
3.1. 投票制による文字認識
既に視覚情報欠如の状況下で筆記された文字に対して頑強な文字認識手法として,ストローク代表点移動ベクトル法と,ストローク等分割法を提案し,この2つを併用する文字認識手法を開発した.しかし,前述のとおり一般文章の作成時において特徴量の不足により低画数文字の認識精度の低下が確認された.
そこで,これまでに筆者らが開発した認識手法(以下,豊橋手法と称する)のほかに,他の研究機関が晴眼者向けに開発した2つの認識手法を並列利用し,画数の少ない文字の特徴量不足を補う改善法をとる.すなわち,3つの処理系でそれぞれ独立に候補文字の順位をつけて多数抽出し,その順位に応じて投票を行う投票制の導入を試みる.但し,それらの統合手法には,特徴量の評価値を直接用いるのではなく,候補文字の出現順位に主眼をおいた投票制とした.
今回利用した2つの認識手法のひとつは,2次元イメージの統計的マッチングに基づいたオフライン認識と,特徴点の非線形伸縮マッチングに基づいたオンライン認識とを併用したハイブリッド型文字認識方式(以下,手法A)である.またもう一つは,ストローク形状を続け書き部分を分断するように要素化(構成)して,それぞれの文字における構成要素により文字認識を行う方法(以下,手法B)である.
図4に3手法を利用した投票制の具体的な手順を示す.図では,一例として「い」という文字が入力された時を想定している.この文字に対して,豊橋手法,手法A,手法Bの3つの各認識処理系で上位10候補までを認識得点順に出力する.各候補に対し順位に応じて第1位候補から第10位候補までに,10点〜1点を1点刻みで投票点を与える.図4における手法Bの認識候補のように1位候補文字が3つあるような場合は,1〜3位までの投票点の合計27(10+9+8)を同位候補数3で割った9をそれぞれの投票点とし,それ以降の候補には4位以降の投票点を与えていく.このように与えた投票点を候補文字毎に集計し,得票数の高い順に順位付けして出力する. 
このように特徴が異なる2手法を新たに導入することにより,従来の豊橋手法では識別が困難であった文字に対しても正解文字を候補文字の上位として出力することが期待できる.
図4 1文字認識における投票制
3.2. 文字トライグラムによる誤り訂正処理
文字トライグラムとは,確率的言語モデルであるNグラムモデルの一種である.Nグラムモデルとは,文字列中のある文字の発生が直前の(N-1)文字にのみ依存すると考える言語モデルである.
Nグラムモデルを仮定したとき,あるn文字からなる文字列中の文字の生起する確率は次式によって求めることが出来る.
(1)
確率の乗法定理より,文字列の生成確率は各文字の生起確率の積であるから, Nグラムモデルにおける文字列の生成確率は,次式で求めることができる.
(2)
今回誤り訂正処理を実現するにあたって,文字バイグラムによる実装も行ったが,予備実験による比較で,文字トライグラムの方が良好な結果を示したので,文字トライグラムを採用することとした.
文字トライグラムの遷移確率は,新聞記事データ5年分(CD毎日新聞データ5年分)から最尤推定で学習した値を用いている.ただし,新聞記事から文字トライグラムの遷移確率を求めても発生しない組み合わせが多いため,トライグラムの確率値が0になる場合は,低次のバイグラム確率を利用するものとした.
3.3. 候補文字列の評価
投票制による1文字認識結果と文字トライグラムによる誤り訂正処理については下式による評価値が高いものから順に3候補文節を出力する.
(3)
右辺第一項は,文字列のもとで入力パタン列が発生する確率で投票制による1文字認識の結果から最大類似度正規化法[8]により確率値に変更された値を利用する.右辺第二項は,文字列の生成確率で,ここには(2)式で示した文字トライグラムモデルにおける文字列生成確率を利用する. 
4. 評価実験
実験には手紙例文集のサンプルより,任意に抽出したものを例文として入力してもらい評価を行った.今回の実験では,出来る限り多くのサンプル文字を収集する必要があったので,被験者として目隠し状態の20代の晴眼者10名を選んで採取した.これは目隠し状態の晴眼者が筆記する文字は,視覚障害者の筆記文字に近い挙動を示すことが実験によって確認されていることによる[2].筆記してもらった文字の総数は14,576文字である.また,中途失明された視覚障害者2名にも同様の手紙例文サンプルを入力していただいた.被験者は50代後半の男性(緑内障により6年前に1種1級障害認定)と40代前半の男性(網膜色素変性症により5年前に1種1級障害認定)である.失明後,5年程が経っているにも関わらず日常で使用される手紙文程度の漢字や平仮名の字形は殆ど覚えておられ,2,3文字のスタイラスペンによる筆記練習の後,直ぐに実験を行ったが,1文字目から問題なくデータ入力をスムーズに行うことが出来た.入力された文字数は被験者の負担を考え2名で1,078文字である.
表1に晴眼者筆記文字における各認識手法単独と投票制における認識率を示す.表から,豊橋手法が視覚情報欠如の文字に対しては他の2手法に比べ認識率が高いことが分かる.ここでの第n候補の意味は,1文字ずつ入力した際に正解候補がn番目に出力されることを意味する.一方,晴眼者用の文字認識処理系の手法A,手法Bにおいても,続け字や画数・筆順変動に強いアルゴリズムを採用していることで比較的高い認識率を示した. 
表1 1文字認識結果の比較(晴眼者筆記文字)
電子情報通信学会ワードテンプレート (タイトル)
