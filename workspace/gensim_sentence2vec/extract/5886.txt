PCを複数台使用する為にCPU切替器を使用してるのですが
モニタを接続していない状態でPCを起動すると、解像度が低くなってしまう現象が発生してしまいます。(デバイスマネージャ上でモニタを再認識させると直ります。)
液晶モニタの方は1680x1050まで対応していますが、CPU切替器のEDID(Extended Display Identification Data)が1280x720までの対応として情報を返すのが原因です。
対処方法を検索すると、CPU切替器のEDIDをハード的に書き換える方法で対処されている例がいくつか見つかりましたが、ちょっとハードルが高かったのでソフト的に対処する方法を探してみました。
まずはMSの公式手順でモニタのEDIDをオーバーライドする方法を参照します。
この方法でINFを作成すると、レジストリに入力したEDIDを強制的に使用することができます。
本来はEDIDが異常な値になっているモニタを救済するための手法ですが、これを応用してみます。
レジストリエディタを開いて「HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\DISPLAY」のキーを開くと「DELD015」と「KVM2004」という二つの項目がありました。
「DELD015」がDELLのモニタで、「KVM2004」がCPU切替器(corega)となります。
「Device Parameters\EDID」の中に実際に機器から取得したEDIDの値が格納されていますので、DELLのモニタの値をコピーします。
先程のMSの手順書にしたがってモニタ用のINFファイルを作成し、「MON1234」となっている箇所を「KVM2004」に修正し、上書きするEDIDの値をDELLのモニタと同じ値にします。
カラープロファイルもメインモニタと揃えるために、DELLからダウンロードしたファイル「E228WFP.icm」を「KVM2004.icm」にリネームして、先程のINFファイルに指定します。
(作成例)「KVM2004.inf」
CPU切替器でモニタから表示されない状態に切り替えてからOSを起動し、デバイスマネージャで「標準ディスプレイ」として認識しているデバイスのドライバを作成したINFファイルで更新します。
カタログファイルは作成していませんので、途中で警告が表示されますが無視して進めます。
一度電源を落とし、再度モニタから表示されていない状態でOSを起動すると解像度を1680x1050まで変更できる状態となります。
解像度を実際に使用したい値に変更すると、以降はモニタをサブに切り替えたままでOSを起動しても任意の解像度のままにすることができました。
上記の方法で私の環境では、TV録画用のサブ機の電源状態を気にせずにCPU切替器が使える様になりました。
<追記:2011.07.07>
この状態でしばらく運用していましたが、たまに失敗していることがある様子です。
モニタを表示せずに起動すると、50%程度の確率で解像度が低い状態で起動していました。
ソフト的に誤魔化すだけでは上手く認識しない場合があるのかもしれません。。。
残念!
仕方が無いので、モニタのEDIDを記憶して裏起動に正式に対応しているCPU切替器に買い換えることにしました。
コンパクトで、欲しいと思っていた機能をほぼ網羅していますのでなかなかよさそうです。
EDIDの変更(CPU切替器): さこログ
