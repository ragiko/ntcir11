
前回記事でVLOOKUP関数の可変性を持たせる組み合わせに触れました。
VLOOKUP関数の可変性を持たせる組み合わせまとめ | Excelを制する者は人生を制す ～No Excel No Life～
今回はその中で「列番号」を可変にするテクニックの中の一つ、「セル番地を参照する」について解説していきたいと思います(・∀・)
セル番地を参照することで列番号を可変にする方法
VLOOKUP関数は普通に使うと、絶対参照・相対参照を駆使しても列番号のところだけは手入力で直すなどの手間がかかります。
その手間を解決する方法の中でもっともお手軽なのが、セル番地を参照することです。
具体例でご紹介していきます。(下図参照)
主な使いどころ・シチュエーション、メリットなど
今回のセル番地参照の使いどころやメリットの一例は以下の通りです。
VLOOKUP関数の参照範囲の中から連続する列から値を返したい場合にオートフィルなどで一括でコピー&ペーストできる
VLOOKUP関数の参照範囲内に列の挿入や入れ替えをした場合に修正が簡単
サンプル前提条件
A列の出席番号が検索キー
参照範囲はA3:G7
関数自体はA12セルを「検索値」として、B12～G12セルそれぞれを参照範囲から表示したい
サンプル処理手順
予めA1～G1セルに列番号を割り振っておく
B12セルにVLOOKUP関数を組む
B12セルの数式をもとにオートフィルでC12～G12セルまでコピー&ペーストすることを念頭におき、「検索値」は列のみ絶対参照、「セル範囲」は列・行ともに絶対参照、「列番号」は行のみ絶対参照にする
B12セルの数式をもとにG12セルまでオートフィルでコピー&ペースト
オートフィルの部分はB12セルをコピー([Ctrl]+C)後にC12:G12に形式で貼り付け(数式)でもOKです。
まとめ
Excelで作業効率をアップさせる一つの王道として、関数に可変性を持たせた上で、1つのセルに組んだ数式をもとに複数セルへ一括でコピー&ペーストすることが挙げられます。
今回の方法は簡単であるものの、数式の中にそれぞれ手直ししていくよりも断然効率的です。
つくづくExcelの作業は、地道な単純作業を繰り返す前に、頭に汗をかいて作業手順を減らす方法を模索することに時間を要した方が、結果として効率的だと実感します。
次回以降は、VLOOKUP関数の別の応用テクニックをご紹介したいと思います(・∀・)
Sponsored link
VLOOKUP関数の「列番号」を可変にするテクニックその1【セル番地を参照する】 | Excelを制する者は人生を制す ～No Excel No Life～
