
ログインが失敗する場合
Management Studio にログインができない場合は、以下の理由が考えられます。
ログインしようとしているWindowsユーザを、インストール時に管理者として登録していない
インストール時の設定でSQLServerの管理者としてWindowsユーザを登録する際、今操作しているユーザをSQLServer管理者として登録していなかった場合はログインできません。
インストール時に「Windows認証のみ」を選択してインストールした場合は、インストール時に登録したWindowsユーザにて、再度ログインを試みてください。「混合認証モード」を選択していた場合は、下の方で紹介している「SAでログインする」を試してください。
サーバー名の入力を間違えている
サーバー名(コンピュータ名)を正しく入力してください。インストール時の設定で「規定のインスタンス」ではなく「名前付きインスタンス」を選択してインストールした場合、サーバー名のところは「サーバー名(コンピュータ名)\インスタンス名」を入力するようにしてください。たとえば、コンピュータ名がPC01でインスタンス名が”SQL2008″の場合は「PC01\SQL2008」となります。
SQLServerサービスが起動していない
SQLServerにManagement Studioでログインする為には、SQLServerのプログラム自体が稼働している必要があります。これを、SQLServerのサービスが起動していると表現しますが、このエラーはそのSQLServerのサービスが起動していない状態でログインした際に出るものです。
インストール時の設定で「SQLServer Database Engine」の「スタートアップの種類」を[自動]にしていた場合は、SQLServerサービスが自動で起動するのですが、[自動]以外を選択していた場合は、手動で起動してあげる必要があります。
「スタート」メニュー  「すべてのプログラム」  「SQLServer 2008」  「構成ツール」  「SQLServer 構成マネージャ」をクリックし、「Sql Server Configuration Manager」を起動します。
左側の「SQL Server のサービス」をクリックし、右側に表示された「SQLServer(MSSQLSERVER)」の状態が[停止]になっている場合は、サービスが起動していない為、ログインできません。
この場合は、「SQLServer(MSSQLSERVER)」を右クリックして「開始」を選択すると、サービスが起動します。
「SQLServer(MSSQLSERVER)」をWクリック、もしくは右クリック「プロパティ」を選択することで表示される画面からも操作が可能です。
もし開始モードが「自動」になっていない場合は、このプロパティ画面から変更することができます。「サービス」のタブをクリックし、表示された画面の「開始モード」というドロップダウンから[自動]を選択すれば、次からはWindows起動時に自動的にSQLServerのサービスも起動するようになります。
1-2 sa(SQLServer認証モード)でログインする
上の例は「Windows認証」でのログインでしたが、これは今操作しているWindowsにログインしているIDをそのまま使用してログインする(SQLServer側でもWindowsのユーザIDでもって認証する)やり方でしたが、SQLServerインストール時に「混合認証モード」を選択していた場合は、SQLServer専用の管理者ユーザIDを使用してログインすることができます。そのユーザIDが「sa」です。
それでは「sa」でログインしてみましょう。ログイン画面上の「認証」というドロップダウンを[SQLServer 認証]を選択します。すると、「ログイン」に[sa]と表示されますので、「パスワード」にインストール時に指定したパスワードを入力して「接続」をクリックします。
ログインに成功すると、Windows認証の時と比べてログインしたユーザIDの表示だけが変わっていることが確認できます。
2.データベースを作成する
SQLServerの構造は、SQLServerの中に複数のデータベースがあり、一つのデータベースの中に複数のテーブルが存在するようになっています。利用者が実際にデータを格納するのはテーブルの中になります。
インストール直後はSQLServerが稼働する為に必要な「システムデータベース」だけが存在していますが、このデータベースは基本的に触ってはいけません。開発者が操作する為に、まずはデータベースを新規作成しましょう。
「データベース」を選択して右クリックし、「新しいデータベース」をクリックします。
「新しいデータベース」という画面が開くので、「データベース名」を入力します。(ここでは「TestDB」と入力しています)下の方にある「データベースファイル」に表示されているのは、一つはテーブルに格納したデータが保存されるデータファイル(拡張子は .mdf)と、もう一つはデータベースに対する変更履歴が保存されるトランザクションログファイル(拡張子は .ldf)です。データベースの実態はこの2つのファイルで構成されています。
初期サイズはそれぞれ3MBと1MBですが、「自動拡張」の列を見ていただくと分かりますが、サイズが増えてくると自動的にファイルが拡張されるように設定されています。「パス」の列にはこれらのファイルが格納されるパスが表示されており、変更することも可能ですが変更しないでおきましょう。
「OK」をクリックすると、データベースが作成されます。オブジェクトエクスプローラより、データベースが追加されていることが確認できます。
3.テーブルを作成する
次は、今作成した「TestDB」にテーブルを作成しましょう。テーブルには以下の表のデータを格納します。
この表はエクセルで作ったのですが、SQLServerではこれがそのままテーブルになります。エクセルの表 = SQLServerのテーブル と思って大丈夫です。それではTestDBの中の「テーブル」を選択して右クリックし、「新しいテーブル」をクリックします。現れた画面ではテーブルの構造である列の情報を、一列 = 一行 のデータとして入力します。エクセル表は6列あった為、このテーブルの構造は6行分入力することになります。
「データ型」は画面のとおり入力し、「NULL を許容」は全てチェックを外しましょう。
入力ができたら「Ctrl + S」で保存しましょう。テーブル名は「Table_Syain」を入力しました。
3-1 データ型とは
データ型とは、エクセルでいうところのセルの表示形式みたいなものです。「文字列」「数値」「日付」などを指定します。エクセルと違ってSQLServerの場合は、データ型で指定した型は強制されますので、例えば「数値」型の列に文字列を入力することはできなくなります。
表にするとこんな感じです。
データ型
格納できるデータの種類
備考
【初級編③】Management Studio を使った SQL Server の基本的な操作方法(1/2) | SQLServer2008虎の巻
