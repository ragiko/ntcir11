ヘッダを分断して起こす「レスポンスヘッダインジェクション」
例えば、「ヘッダ値」の部分に改行が挿入されると、ヘッダ値は改行の直前で終了し、改行後の文字列は次のヘッダとして解釈される。そのため、ヘッダ値に改行の挿入が可能な状態であると、任意のヘッダを追加することが可能となってしまう。この問題をレスポンスヘッダインジェクションと呼ぶ。
任意のレスポンスヘッダを挿入されてしまうことによって、ユーザーのCookieが汚染されてしまったり、悪意のあるサイトへの誘導をされてしまったりする恐れがある。またWebサーバとブラウザの組み合わせによってはクロスサイトスクリプティングが発生する場合もある。
仮にヘッダへ改行が入ってしまい、この攻撃が成功してしまう予兆があったとしても、HTTPレスポンスヘッダを意識せずにWebアプリケーションを開発している場合、気付くことはかなり難しいといえる。
しかし、プロキシツールなどを利用している場合、受け取ったパラメータがレスポンスヘッダ上でどのように反映されるかが容易に分かるため、攻撃を行う側から見た場合、レスポンスヘッダインジェクションは決して難しい脆弱性とはいえない。
また、レスポンスヘッダとレスポンスボディの境界は改行のみの行により区切られるため、連続して改行が挿入できる場合は、レスポンスヘッダだけでなくレスポンスボディも改ざんすることが可能となる(ただし、レスポンスボディの改ざんが可能か否かは環境に依存する)。
実際にヘッダ値にユーザーの入力が入ることは特別なことではなく、入力パラメータや、ユーザーの状態を引き継ぐ際に利用されることが多くある。以下に一例を挙げる。
もいちどイチから! HTTP基礎訓練中(5):レスポンスヘッダ+改行コード=脆弱性?! (3/3) - @IT
