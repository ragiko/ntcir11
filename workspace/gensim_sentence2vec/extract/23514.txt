
固有値を求めるためには固有方程式を解くことが直接的な方法だが、行列の次数が5以上となれば、定まった解法はない。したがって数値計算に持ち込んで、近似値から解に接近することとなる。多項式の数値計算手法はまたどこかで紹介したいと思うが、固有値については行列を前面に据えた計算法がいくつか考えられている。行列の分解と固有値問題が関連し、そしてなにより実務では有用な話題となるので簡単に紹介しておこう。
繰り返しも多いが、いくつかの準備をしておくことが分かりやすいだろう。まず相似な行列の固有値は不変であることを確認しておこう。このことは固有方程式を調べておけば容易にわかる。A=QBQ-1と相似関係が成り立っているとしよう。まぎらわしいけれどこれは対角化でも、対角化でなくても相似であればよい。Aの固有方程式は、
|A-&lambda; I|=|QBQ-1-&lambda; I| 
=|QBQ-1-&lambda; QIQ-1|  
=|Q||B-&lambda; I||Q-1| 
=|B-&lambda; I|
となって、Bの固有方程式に等しいから、それぞれの解となる固有値は等しいものとなる。固有値は相似変換に対して不変といわれる。固有値を計算で求める上では、行列を相似変換して、どれだけ方程式を取扱いやすく簡単なものにしてもよいことを覚えておこう。相似変換で固有方程式を単純なものにすることができれば、難しいことを考えなくても直接計算に持ち込むことができる。
次に行列Aのn乗を作用させた任意のベクトルxが固有ベクトルvと適当なスカラーciによって、
Anx=c1&lambda;1nv1+・・・+cn&lambda;nnvn  
と表すことができることをみておこう。後のために固有ベクトルviはいずれも正規化されていることとしておく。もちろん前提は行列Aが対角化可能であって、固有ベクトルが空間の次元だけとれることである。固有ベクトルは一次独立であるから、任意のベクトルxは、
x=c1v1+・・・+cnvn=Qc  
と表される。ここでc=(c1,・・・,cn)t、Q=(v1,・・・,vn)と書き直している。Aは対角化されて、A=QBQ-1だから、なんどもやったように、
An=QBnQ-1 
である。したがって、
Anx =QBnQ-1x 
=QBnQ-1Qc 
=QBnc 
=(v1,・・・,vn)(c1&lambda;1n,・・・,cn&lambda;nn)t
となって、求める式が得られる。
べき乗法
次数の大きな行列の固有値を求める手法の根幹となっているべき乗法はこの式を利用する。n個の固有値の中で、最大の固有値を&lambda;nとする。式を変形すれば、
となる。ci/cnはどれもこれもたかだかの値であるから、|&lambda;i/&lambda;n|<1なので、次元のnと重なってまぎらわしいけれどべき数nを大きくすれば、括弧内の第一項はゼロに近づく。したがって、
{Anx}/{&lambda;nn} cnvn   (n &infin; ) 
となることが期待できる。
もちろん&lambda;nの値は事前に分からないのだけれど、どうにかして近い値を見つけることができれば、Aのべき乗を大きくして任意のベクトルxに作用させると、Anx/&lambda;nnは最大の固有値に対応する固有ベクトルvnに収束することになる。もともと固有ベクトルに係数は意味が無いから、cnは無視して考えればよい。
これは不思議な感じがするかもしれないが、うまい除数を見つけることがポイントとなるので、実際はどうしたらいいのかという疑問が大きいだろう。具体的にはいつも正規化を行って計算を進める方法が取られている。つまり、u0=x/|x|としておいて、
wn=Aun-1,  un=wn/|wn| vn  
である。最大固有値は未知であるから、そのかわりに常に計算途中のベクトルを正規化してノルムを1としていくのである。つまりこの式は、
u0 = x/|x| 
u1 = Au0/|Au0|=Au0/|A|=Ax/|Ax| 
u2 = Au1/|Au1|=A2u0/|A2|=A2x/|A2x| 
u3 = Au2/|Au2|=A3u0/|A3|=A3x/|A3x|
・・・
un = Anx/|Anx|
と逐次計算していく。&lambda;nnの代わりに|Anx|を利用する。初めのほうの式を使えば、
であるから、&lambda;nnの代わりに|Anx|を使っても収束はおおよそ構わないのである。
そしてこの方法ならば、|ui|=1が保証できるので、最終的にcnの値を気にする必要もない。さらに収束を速めるために正規化ではなく最大値ノルムをとる方法もある。
上の説明ではcn>0でなければならないが、たとえcn=0の場合でも計算の上では二番目に大きい固有値に収束してうまくいくこともあるし、べき数をさらに大きく取ると誤差項が成長して当初の最大固有値の固有ベクトルに収束することもある。重複度が2以上となるケースは現実の計算ではレアだろうが本来は議論しておかなければならないし、収束しなくて行き詰まる場合も、収束しなくてもうまくいく場合もあり、どこで計算を打ち切るかということを含めて精密な数値計算の議論はなかなか難しく、次々と紹介することもできないが、いろんな工夫が考えられている。
そして近似的に求められた固有ベクトルvnによってy=Avnを求め、
(yの要素の最大値/vnの要素の最大値)〜 &lambda;n  
とする。この推定値を支える評価法の証明は省略するが、コラッツ(Collatz)の定理として知られている。標準内積を使って、
&phi;(vn,Avn)/&phi;(vn,vn)〜&lambda;n  
と近似することもできる。この左辺はレイリー商とよばれる。行列Aが対称行列であるなら、これは見慣れた2次形式であって、微分してゼロとすれば真の固有値によって最小となり、2次曲線の底になっていることがわかっている。
数値計算は説明だけではますますピンとこないだろうから、例題をやって近似の具合を確かめておこう。べき乗法は要素が疎な行列でないと計算も大変となるし、うまう収束しないこともあるのでお薦めできない。そこでここまで例題で取り上げた行列のなかでは比較的疎な、
A1=(1 0 1)  
A2=(0 1 1) 
A3=(1 1 0)  
をとりあげよう。この行列の固有値は、
&lambda;=-1,1,2  
で、最大固有値2に対応する正規固有ベクトルは、
v3=(1/&radic;3, 1/&radic;3, 1/&radic;3)t 
である。数値計算なので、近似的に固有ベクトルを小数点付きの数値とすれば、
v3=(0.577350269, 0.577350269, 0.577350269)t 
となる。任意のベクトルxは特別な事前情報がないものとして、
x=(1,0,0)t  
ではじめれば、
となり、ほぼv3への収束が確認できた。
収束の速さは、ひとえに&lambda;i/&lambda;nの大きさによることは先の式で分かるだろう。任意のベクトルxを目標とする固有ベクトルと同一の方向の要素を持つようにすれば収束が速くなることも予想できよう。それで、事前情報がない場合は上と異なりふつう、
x=(1,1,1)t   
が選ばれることが多い。上の例では単位ベクトルとしたので、こちらのベクトルに切り替えてどれほどのものか確かめられるとよいだろう。
最大固有値の推定値は、推定ベクトルにAを作用させて、
y=A(A16x/|A16x|)=(1.154700539, 1.154700537, 1.154700539)t   
なので、
1.154700539/0.57735027=1.999999997 〜 2 
となり、相当の精度にはなっている。
べき乗法は最大固有値と対応する固有ベクトルを求める方法となっているのだが、この逆を考えて、最小固有値と対応する固有ベクトルを求めるのが、逆べき乗法である。固有値問題を解いて、Ax=&lambda; xの関係が見つかっていれば、
A-1x={1/&lambda; }x  
の関係が成り立つことは明らかだろう。ここでA=QBQ-1ならば、A-1=QB-1Q-1となるので、基底変換行列Qは影響を受けないことがわかる。するとべき乗法の入り口で説明したと同様の組み立てで、
となる。したがって、最小の固有値を&lambda;nとすれば、1/&lambda;nはA-1の最大固有値となるので、べき乗法を使って最後に逆数を取れば、最小固有値を得ることができる。
u0=x/|x|とすることは同じで続けて進めればよいが、A-1やそのべき乗を計算することが大変ならば、計算の量を減らす工夫として、A=LU分解を利用して、
A-1=U-1L-1 
としておき、
r=L-1un-1
としてrを求め、
wn=U-1r 
によってwnを得る操作を間に挟む。二つの操作は三角行列であるから、Lr=uあるいはUw=rの連立方程式と見て後退処理すれば直ちに解けるので逆行列の積を計算する必要がない。毎回この操作を含めることで、
wn=A-1un-1,   un=wn/|wn| vn  
とすることが行われる。
さらにべき乗法を応用して、2番目に大きい固有値を求める方法や、特定の値に近い固有値を求める方法などが考案されている。
数理ファイナンス[MathematicalFinance]
