現在位置 : 統計WEB | コラム | 2009年4月
コラム 『統計備忘録』 バックナンバー
2008年 ｜ 2009年 1-2月｜3月｜4月｜5月｜6-7月｜9-10月｜11-12月 ｜ 2010年  
第66話 「m の分布 − 標本平均と中心極限定理」
第67話 「正規分布の発見 − 統計学史(4)」
第68話 「t 分布か正規分布か − 平均値の差の検定」
第66話 「m の分布 −標本平均と中心極限定理−」
統計学のテキストでは母集団の平均を母平均といってギリシャ文字の μ(ミュー)で表します。一方、母集団から抽出した標本集団の平均を標本平均といってアルファベットの小文字の m や X(エックスバー)で表します。
推測統計学(統計的仮説検定や推定のこと)の立場では母平均は1個しか存在しません。通常、母集団のすべてを調べることはできませんから、標本のデータを使って母平均を推測することになります。標本平均は余程の偶然でもない限り、サンプリングをしなおす度に値が異なります。このように都度異なる標本平均から、たった1つの母平均をどのように推測できるのでしょうか。この問題を解決してくれるのが中心極限定理 central limit theorem です。
皆さんの中には、t 検定をするとき、サンプリングしたデータが正規分布に従っているか心配で仕方がないという人がいるかもしれませんが、実のところそれほど心配する必要はありません。中心極限定理によって母集団がどんな分布であっても「標本平均の分布は正規分布に従う」ことが分かっているからです。「標本平均の分布」とは、同じ母集団から何度も無作為抽出(実験の場合は無作為化)を繰り返して、その度に計算しなおした場合の標本平均のバラツキ具合です。この標本平均の分布は、母平均 μ を中心とし母標準偏差を標本の大きさ n の二乗根で割った値(母標準偏差/√n )を標準偏差とする正規分布になります。標本の大きさ n が大きくなるほど正規分布に近づき、n が30にもなればほぼ正規分布に一致します。なお、母標準偏差/√n  のことを標準誤差というのは以前に書いたとおりです。
例えば、次のように、母平均 μ が1,927、母標準偏差 σ が 925 で平均よりも中心が左に偏った分布をしている 1万件の母集団があったとします。
この母集団から無作為に 30 件を取り出すということを何度も繰り返し、その度に標本平均 m を求めると、m の分布は、母平均 μ を中心として標準偏差が 169(=925/√30 )の正規分布に似たものになります。ということは、抽出を 100 回繰り返すと、そのうちの95回の標本平均は、1,927±169×1.96 の範囲におさまるだろうということです。標本平均が母平均とまったく同じということはまずないでしょうが、母平均から遠い値よりも近い値になる方が確率的には高いのです。
n を大きくしていくと標本平均の分布は狭まります。次のグラフは n が 30(黒線)と n が 100(赤線)の場合の標本平均の分布を示しています。n を大きくしたほうが誤差が小さくなるのも、中心極限定理で説明できます。
n が小さくなるにしたがって、標本平均の正規分布は崩れていきます。崩れの程度は、母集団の分布が正規分布に近いほど緩やかです。したがって、n が小さく、かつ、母集団が正規分布すると仮定できないときには、対数変換などによって正規分布に近づくように、データを変換してから t 検定や分散分析を行うかデータ変換をしないでノンパラメトリック検定を行う事も考えましょう。
2009.4.1
第67話 「正規分布の発見」
今年はガウス(Johann Carl Friedrich Gauss、1777-1855)が『天体運行論』を出版してからちょうど200年になります。多くの統計学の本では、ガウスが正規分布を発見したと書かれています。ガウスが『天体運行論』の中で、天体観測によるデータの誤差はある基本的な法則に従うという理論を確立したからです。ある基本的な法則というのが正規分布であることから、正規分布のことをガウス分布(Gaussian distribution)ともいいます。正規分布の名前はガウスではなく、それより後に、ゴールトンによって付けられました。
今日、正規分布を発見したのは、ガウスよりも前、フランスの数学者、ド・モアブル(Abraham de Moivre, 1667-1754)の功績とされています。1730年代に、ド・モアブルは、二項分布の n を大きくしていくと分布の形が正規曲線で近似できることを発見しました。これを精密化させたのがラプラス変換でも有名なラプラス(Pierre-Simon Laplace、1749-1827)です。正規分布と中心極限定理の歴史はここから始まります。
中心極限定理がどのような条件下に成立するか厳密な証明に取り組んだのは、19世紀のロシアの数学者、チェビシェフ(Pafnuty Lvovich Chebyshev、1821-1894)や彼の弟子のマルコフ(Andrey Andreyevich Markov、1856-1922)です。彼らは証明に至らず、研究はチェビシェフのもう1人の弟子、リアプノフ(Aleksandr Mikhailovich Lyapunov、1857-1918)に引き継がれました。最終的にこの問題に決着をつけたのはフィンランド人のリンデベルグ(Jarl Waldemar Lindeberg)とフランス人のレヴィ(Paul Levy、1886-1973)です。2人は、ほぼ同時期に条件を発見し数学的に証明しました。ド・モアブルの正規分布の発見から200年後のことです。この条件は、リンデベルグ条件という名前で知られています。
前回、中心極限定理によって母集団がどんな分布であっても標本平均の分布は正規分布になると書きましたが、実はどんな分布でもというのは正しくなく、リンデベルグ条件を満たさず中心極限定理が成立しない分布があります。コーシー分布と言います。コーシー分布には平均も標準偏差も存在しないのです。コーシー分布に従う母集団から標本抽出をすると、極端に大きな値や小さな値が含まれる可能性が高く、標本平均がある値の付近に集中するということがないのです。どのような分布かというと、自由度 1 の t 分布が標準コーシー分布になります。
参考書籍
清水 良一 『中心極限定理 (シリーズ新しい応用の数学 (14))』 教育出版, 1976.
マイケル・カプラン、エレン・カプラン(対馬妙訳) 『確率の科学史—「パスカルの賭け」から気象予報まで』 朝日新聞社, 2007.
デイヴィッド・サルツブルグ(竹内恵行・熊谷悦生訳) 『統計学を拓いた異才たち(日経ビジネス人文庫)』 日本経済新聞社, 2006.
2009.4.13
第68話 「t 分布か正規分布か」
平均値の差の検定を行うには、t 分布を用いる方法( t 検定)と正規分布を用いる方法( z 検定)とがあります。どう使い分けたらよいのでしょう。結論から先に言うと、迷わず t 検定を使ってください。
平均値の差の検定をするには、検定統計量として「平均値の差/標準誤差」を求めます。この検定統計量が、確率分布における有意水準(α)に設定したパーセント点を越えていると有意差があると言います。
このとき確率分布にt分布を使用すると t 検定ということになります。
t 分布も、正規分布と同じようになだらかな山の形をしていますが、正規分布と違い、自由度によって分布の形状が異なります。自由度が小さいくなるほど(≒データの個数が少なくなるほど)、山の頂上は低くなり裾拡がりになります。
右の表は、両側検定で有意水準が 5%のときの、自由度とパーセント点の対応をまとめたものです。
自由度が 1桁のところでは、自由度によってパーセント点が大きく異なりますが、自由度が 20 を過ぎたあたりからとパーセント点は変化はかなり小さくなり、自由度が 60でパーセント点が 2.000 となったあとは殆ど変わらなくなります。
表に載っていない自由度を試したければ、Excelに次のように入力してみてください。
=TINV(0.025,25)    t 分布から自由度が 25 で片側確率が 2.5%のパーセント点を求める式
自由度が∞(無限大)のところを見るとパーセント点は 1.960 です。これは正規分布のパーセント点とまったく同じ値ということになります。Excelに次のように入力して確認してみてください。
=-NORMSINV(0.025)    標準正規分布から片側確率が 2.5%のパーセント点を求める式 
t 分布は自由度が大きくなると、どんどん正規分布に近づいていくのです。つまり、自由度が大きいとき、t分布を使おうが正規分布を使おうが検定結果に殆ど差が無いということです。
昔は、手計算で検定統計量を求め、統計数値表のパーセント点と比較するという手順で検定していました。ほとんどの統計数値表では、自由度が30までは自由度1刻みでパーセント点が載っていますが、30を超えると、40、60、120、∞の4つぐらいしかありません。
その為、自由度が無いところのパーセント点は前後の値から補間計算をして求めていたのです。そうでなければ、正規分布を使った検定を用いていました。表を見れば分かるとおりデータの個数が数十あれば、正規分布の方が若干パーセント点が小さく有意になりやすいものの、両者の結果に殆ど違いはなかったからです。
現在では、ソフトウェアが検定統計量から P 値を求めてくれますから、データが何個あろうが t 検定を使用し、P 値と有意水準を比較すれば良いのです。
=TDIST(1.96,10000,2)   検定統計量が1.96、自由度が10000の両側確率(P値)を求める式
2009.4.23
確率分布についてのコラム 
第41話 「正規分布,カイ二乗分布, t 分布, F 分布」へ
次のコラムへ 最新のコラムへ
タイトル一覧へ  タイトル一覧(カテゴリー別)へ
統計WEB | コラム『統計備忘録』 | 2009年4月
