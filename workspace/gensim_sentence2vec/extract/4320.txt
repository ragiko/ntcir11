
k近傍識別法によるパターン識別
課題内容
ソース
考察
(3-1) パラメータの値を変更するとどのようになるか?
識別器
kの値   (1-2) 近傍の数の増減と識別性能の関係は?
パラメータ
近傍の数:1〜35(識別される評価用パターンは近傍のパターンベクトルにすることができないため,近傍の数は最大で35となる.)
分割数:6
図1 近傍数別平均正答数+平均拒否数
※ 実験結果の数値は,近傍の数が1から35までの各場合において,グループの構成を変えて行った10回分の実験データから正答数と拒否数の平均を求めたものである.なお,各1回分のデータは,36個のパターンベクトルを6個のグループにランダムに分割し,すべてのパターンベクトルが評価用パターンとして用いられるように繰り返した(この場合は6分割なので6回)データの正答数と拒否数の平均を求めたものである.
まず,正答数のみに関して見ると,近傍の数が奇数個のときは正答数が比較的高いのに対し,偶数個の場合は低くなっている.近傍の数が奇数個の場合,たとえば1のときは,選ばれたある1つの学習用パターンが属するクラスが赤であれば識別される未知パターンが属するクラスは赤であると決定される.また,近傍の数が3のときは,ある3つの学習用パターンのクラスが赤が2つ,青が1つであれば識別されるクラスは赤であると決定される.一方,近傍の数が偶数個の場合には,たとえば2であれば,選ばれた2つの学習用パターンが属するクラスが赤が1つ,青も1つとなるなど,識別する未知パターンが属するクラスがどちらであるのかが決定できない場合が起こり得る(図1では,判定不能であった評価用パターンの数を「拒否数」としている).したがって,正答数のみに関しては,近傍の数が偶数個の場合よりも奇数個の場合のほうが,正答数はよいということができる.
また,判定不能の評価用パターンの数(拒否数)は近傍の数が32以上(偶数)ではみられない.これは,パターンベクトル集合のクラスは赤が20個,青が16個であるため,近傍の数が32(青が最大の場合でも,赤16個,青16個となる)を超えると赤のクラスに属する近傍のパターンベクトルのほうが多くなり,どの位置にあるパターンベクトルが評価用パターンとして選ばれたとしても,赤という識別結果がでるためであると考えられる.また,近傍の数が31以上では,正答数に大きな差はみられないが,これも同様に,赤のクラスに属するパターンベクトルのほうが多いことによるものであると考えられる.
しかし,識別する未知パターンが属するクラスを判定できなかったとしても,自分の持っているデータから考えて,正しいと思える答えを引き出せないので拒否をする,というのは正しい選択の一つであると考えられる.したがって,「わからない」ことを「わからない」というのは正しい,ということであり,識別性能が悪いということにはならない.
識別性能(正答数+拒否数)は,近傍の数が全パターンベクトルの数の半分(18前後)あたりまでは徐々に減少する傾向がみられる.これは,識別する際には,近傍の学習用パターンには距離が遠いパターンベクトルをできるだけ用いないほうが,識別性能がよいということを表していると考えられる.一方,半分を超えたあたりからは,識別性能に大きな差はみられない.これは,赤と青のクラスに属するパターンベクトルが左右対称に位置しているため,近傍の数が全パターンベクトルの数の半分を超えると,距離が近い学習用パターンを選んで未知パターンが属するクラスを決定するという,近傍の本来の意味が薄れてしまうためと考えられる.
以上より,未知パターンが属するクラスを識別する際には,近傍の学習用パターンのなかに未知パターンとの距離が遠いパターンベクトルが多く含まれるほど,識別性能は悪くなり,また,近傍の数がある一定の数(この場合は全パターンベクトルの数の約半数)を超えると,識別性能に大きな差はなくなるということができる.
(3-2) (2-1)では,パターンベクトル集合が6つに分割されているが,12,18,36に分割するとどうなるか?
パラメータ
近傍の数:3(奇数個の近傍の中から任意の3を選んだ.)
分割数:6,12,18,36
表1 分割数別平均正答率
パターンベクトル集合を6つに分割した場合よりも,12,18,36に分割した場合のほうが正答率が良くなる.分割数を増やすということは,各評価用パターンの数が減るということであり,近傍のパターンベクトル(この場合は3つ)のなかに評価用パターンが含まれる確率も低くなる.近傍のパターンベクトルのなかに評価用パターンが含まれる場合は,識別性能が悪くなる(詳細は(4-2)で示す)ため,分割数を6つから12,18,36に増やすと正答率が良くなると考えられる.
また,分割数が6つの場合の正答率は,88.9%であるのに対し,分割数が12,18,36の場合の正答率はそれぞれ93.9%,94.7%,94.2%と,大きな差はみられない.パターンベクトル集合を6つに分割した場合は,各グループのパターンベクトルの数は6つずつとなるが,12,18,36の場合には,それぞれ3つ,2つ,1つとなる.つまり,分割数が6と12の場合の各グループのパターンベクトルの数の差は3つであるのに対し,分割数が12と18および18と36の場合には,その差はそれぞれ1つずつとなる.これは,前述のように,12,18,36の場合には近傍のパターンベクトルのなかに評価用パターンが含まれる確率に大きな差がないため,識別性能にも大きな差がみられないということを示している.
以上より,分割数が6の場合よりも12,18,36の場合のほうが,近傍のパターンベクトルのなかに評価用パターンが含まれる確率は低くなるため,パターンベクトル集合の分割数を6つから12,18,36に分割すると,正答率があがると考えられる.
(3-3) 上記のほかに,評価がグループ分けに左右されないようにするための方法が何か考えられるか?
本課題では,近傍の学習用パターンを識別する未知パターンとの距離が近い順(距離が同じ場合はランダムに選ぶ)に選んでいるが,ある一定の距離内の学習用パターンのうちからランダムに近傍のパターンベクトルを選ぶという方法も考えられる.
結果報告
(4-1) 正答数の平均
パラメータ
近傍の数:3
分割数:6
表2 正答数の平均
(4-2) ある評価用グループを用いたときの識別曲線と評価用パターンの正誤状況
パラメータ
近傍の数:4
分割数:6
評価用グループ:5
正答数:4,拒否数:1
図2 ベクトルのグループ構成              図3 識別曲線と評価用パターンの正誤状況
まず,下から2行目左から2列目および一番右上の評価用パターンは,最も近い距離をもつ学習用パターンのうち3つのパターンベクトルのクラスがいずれも同じクラスであるので,識別されるクラスはそれぞれのクラスに決定される.
次に,下から4行目の最も左の列と左から2列目の評価用パターンは,いずれも近傍の4つの学習用パターンのなかに評価用パターンが含まれている.したがって,最も左の列の評価用パターンの場合は,真上とその横および真下とその横のパターンベクトルが近傍の学習用パターンとなり,それらが属するクラスは赤2つと青2つで識別するクラスを決定することはできない.また,左から2列目のパターンベクトルの場合には,最も近い距離をもつ学習用パターンのうち赤が2つ青が1つであり,残りの1つの近傍のパターンベクトルは,左下・右下・左上・右上のいずれかの学習用パターンからランダムに選ばれることになる.この場合は青のクラスに属する左下の学習用パターン以外のパターンベクトルのいずれかが選ばれたために,赤のクラスであるという誤った識別がされたと考えられる.
一方,一番右下とその上の評価用パターンであるが,これらのパターンベクトルも近傍の学習用パターンのなかに評価用パターンが含まれている.しかし,いずれにせよ近傍の学習用パターンは属するクラスが青のパターンベクトルの方が多いので,識別されるクラスは青であると決定される.
以上より,評価用パターンがクラス間の識別境界線付近に属する,あるいは,近傍のパターンベクトルのなかに評価用パターンが含まれる場合は,識別性能が悪くなると考えられる.
back
All rights reserved by Chisato Kojima
Chisato Kojima_seminar_Classifier
