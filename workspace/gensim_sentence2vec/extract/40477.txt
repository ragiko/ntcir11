こんにちは。遅れてきたAWS新人、@yokatsukiです。
弊社ではRedshiftに格納したビッグデータを手軽に分析するツールとして、Tableau DesktopおよびServerを使用しています。私もこの間講習を受講し、早速Tableau使いとして案件に携わっています。その中で、Excelで使われる"集合縦棒グラフ+折れ線グラフ"がTableauでも表示できないか、という相談を頂き、調べてみました。
ちなみに集合縦棒グラフ+折れ線グラフというのはこういうものを指しています。
結論から行くと、下記リンク、Tableauのコミュニティの議論にあるように、Excelと同じものはできなさそうです…。
Side-by-Side Bar Chart combined with Line Chart
※記事内で引用されているグループバーチャートは、同じ列の値を種類毎に別の棒グラフで表示する機能なので、元データが異なる列にあると対応できないので、望んでいる形式ではないんです。
しかし棒グラフを横に並べる代わりに重ねる形であれば表示できる、というチュートリアルがありました。
Tableau Tip: 7 easy steps to create a combination chart with overlapping bars & a line
今回こちらの内容を改めて実施してみました。紹介画面はTableau Desktop Version 8.2 for Macを使用していますが、Windows版でも同様の動作を確認しています。
準備
今回の操作ベースとして、Tableau界ではお馴染みのSuperstore Salesを使用します。せっかく日本語版もありますので、今回は日本語版を使いましょう。Tableau社のページから、xlsファイルをダウンロードして下さい。
操作
Tableau DesktopでExcelファイルを開く
Tableau Desktopを起動し、先程ダウンロードしたSample - Superstore Sales Japan.xlsxをTableau Desktop内で開きます。複数のシートが含まれていますが、今回はOrdersを選択します。
データの配置
受注日を列シェルフにドラッグ&ドロップします。
宣伝費を行シェルフにドラッグ&ドロップします。
売り上げをグラフビュー左側の軸にドラッグ&ドロップします。宣伝費と同じ軸上に売り上げが追加表示されます。
利益は折れ線グラフで表示したいので、グラフビューの右端にドラッグ&ドロップして、別の軸で表示させます。
デザインの変更
マークカードより、受注日と宣伝費を合わせたメジャー バリューを選択し、グラフの表示形式を棒にします。
もし、利益(合計)が折れ線グラフでなかった場合は、同様にマークから利益(合計)を選択し、グラフの表示形式を線にします。
現在の状態では、売り上げと宣伝費の棒グラフが積み上げになっているので、それぞれを比較することができません。そこで、上部ビューメニューから[分析]-[スタック マーク]-[オフ]を選択します。これで売り上げと利益が同じ軸上で重なって描画されます。
ちなみにスタック マークについての説明はこちらのヘルプをご覧下さい。
今回のデータは、売り上げよりも宣伝費がより大きな値ですので、ドラッグ&ドロップした順序によっては、売り上げのグラフが宣伝費のグラフに完全に被さって見えなくなっているかもしれません。その時には、メジャー バリューカード内の合計(売り上げ)と合計(宣伝費)の上下を入れ替えて、合計(売り上げ)が手前に来るよう調整します。
メジャー ネームをマークカードのメジャー バリュータブ内のサイズプロパティにドラッグ&ドロップします。メジャー ネームの構成要素である合計(売り上げ)と合計(宣伝費)グラフの太さを変更することができるようになります。
メジャー ネームの太さを示したカードの右上のをクリックして、サイズの編集を選択します。
スライダーを使って、重なったグラフの太さを適度に調節します。
後はお好みで色を変えたり、数値ラベルを追加すると良いでしょう。
まとめ
集合縦棒グラフと折れ線グラフをまとめて表示する方法についてご紹介しました。
Tableau Desktop自身、とんでもなく使いやすいのですが、今回のように「ExcelではできたんだけどTableauではできるの?」という話はやはりちょっと知恵を絞って試してみるところがあったりします。無償評価版に関する弊社ブログ記事もありますので、是非皆さんご自身の環境でお試しください!
[Tableau]集合縦棒グラフ+折れ線グラフの代替案 ｜ Developers.IO
