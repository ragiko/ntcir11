Oracle Fusion Middleware Oracle Application Development Framework Fusion開発者ガイド 11gリリース1(11.1.1) B52028-01
15.1 ビュー・アクティビティへのパラメータ渡し
ビュー・アクティビティ入力ページ・パラメータは別名として使用できます。別名を使用すると、タスク・フロー定義入力パラメータをページ・パラメータにマップできるようになります。ビュー・アクティビティ入力ページ・パラメータは、コール元のタスク・フローで使用可能なマネージドBeanおよび情報をページ自体のマネージドBeanにマップします。ビュー・アクティビティから値を渡すには、値をpageFlowスコープまたはマネージドBeanに格納する必要があります。(タスク・フローでのビュー・アクティビティの使用方法の詳細は、14.2項「ビュー・アクティビティの使用」を参照してください)。
たとえば、ページはページ・パラメータとして#{pageFlowScope.empno}を指定し、タスク・フロー定義は入力パラメータ定義の値として#{pageFlowScope.employeeID}を指定するとします。
ビュー・アクティビティ入力ページ・パラメータのfrom-valueは#{pageFlowScope.employeeID}であり、to-valueは#{pageFlowScope.empno}です。これにより、ページ定義とタスク・フロー定義のそれぞれが使用されているコンテキストごとにパラメータを再定義する必要がなくなるため、両方とも再利用が可能になります。
タスク・フロー内に含まれている他の値は、タスク・フロー定義の入力パラメータ定義値のみでなく、入力ページ・パラメータにもマップできます。
次の手順の例では、図15-1のEmployeeビューに入力ページ・パラメータ・マッピングを指定する方法について説明しています。これを設定すると、pageFlowscope値またはマネージドBeanの値として、Employeeアクティビティにパラメータを渡すことができます。Employeeアクティビティでは、to-valueに指定したEL式に基づいて、pageFlowScope内に配置することによって値を、またはマネージドBeanをTargetアクティビティに渡すことができます。
入力ページ・パラメータ値を設定して取得する手順:
エディタで、タスク・フロー・ダイアグラムを開きます。
タスク・フロー・ダイアグラムで、ビュー・アクティビティを選択します。
プロパティ・インスペクタで、「ページ・パラメータ」をクリックします。
「入力ページ・パラメータ」セクションで、+アイコンをクリックします。
評価時に、渡す入力ページ・パラメータがある場所、たとえば、#{pageFlowScope.EmployeeID}を指定するEL式を使用して、from-valueを入力します。
図15-1のタスク・フローは、ビュー・アクティビティが取得できる入力パラメータ定義値を設定できます。パラメータ値を取得するために、ADFバインド・タスク・フロー入力パラメータ定義に対して指定された「値」に一致するビュー・アクティビティについてfrom-valueを指定できます。
評価時に、ビュー・アクティビティに関連付けられたページが入力ページ・パラメータの値を取得できる場所、たとえば、#{pageFlowScope.EmployeeNo}を指定するEL式を使用して、to-valueを入力します。
to-valueは、ビュー・アクティビティ入力ページ・パラメータの2番目の部分です。ビューに関連付けられたページが、ビュー・パラメータの値を取得できる場所を指定します。
バインド・タスク・フローに入力パラメータを渡すには、次のものを1つ以上指定する必要があります。
タスク・フロー・コール・アクティビティの入力パラメータ。コール元のタスク・フローがパラメータ値を格納する場所を指定します。
コール先のバインド・タスク・フローの入力パラメータ定義。コール先のバインド・タスク・フローがパラメータ値を取得できる場所を指定します。
タスク・フロー・コール・アクティビティではなくURLを使用してバインド・タスク・フローをコールする場合は、URL自体にパラメータと値を渡します。詳細は、14.6.3項「別のWebアプリケーションにあるADFバインド・タスク・フローのコール方法」を参照してください。
前述の各オプションに指定された入力パラメータのnameは、入力パラメータ値をコール先のバインド・タスク・フローに再度マップして戻すため同一になります。それぞれの「value」は、コール元で値が取得される場所とコール先のタスク・フロー間のマッピングに対応します。
入力パラメータの値を指定しない場合、値はデフォルトで#{pageFlowScope.parmname}に設定されます。parmnameはパラメータ名です。
コール先のバインド・タスク・フローの入力パラメータ定義に対して、入力パラメータが必要かどうかを指定できます。必要な入力パラメータを受け取らない場合は、エラーが発生します(これらのエラーには設計時および実行時にフラグが立てられます)。必要ではないと識別された入力パラメータ定義は、タスク・フロー・コール・アクティビティ作成時は無視できます。
デフォルトでは、すべてのオブジェクトは参照渡しされます。タスク・フロー・コール・アクティビティ入力パラメータは、個々の値ではなく、マネージドBeanオブジェクトが渡される場合にのみ、参照渡しできます。デフォルトでは、プリミティブ・タイプ(int、long、booleanなど)は値渡しされます。
値渡しチェック・ボックスが適用されるのはオブジェクトに対してのみで、プリミティブには適用されません。また、このチェック・ボックスを使用して参照渡しのデフォルト設定を上書きします。ただし、2つを組み合せると、パラメータが相互に参照する場合は予期しない動作につながる可能性があります。タスク・フロー・コール・アクティビティの、入力パラメータAが値渡し、入力パラメータBが参照渡しされて、Aへの参照がBにある場合、結果はAとB.A.の異なるインスタンスとなる可能性があります。
例15-1は、バインド・タスク・フローのタスク・フロー定義に対して指定された入力パラメータ定義を示しています。
タスク・フローのパラメータの使用
