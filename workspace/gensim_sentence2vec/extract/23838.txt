
京都市郊外、京都府京田辺市に広がる同志社大学理工学部キャンパス。同学部情報システムデザイン学科の土屋隆生教授は、日本でも有数のGPU計算のスペシャリストである。研究対象は計算音響学や超音波工学——すなわち目に見えない"音"の計算工学を専門としている。
日本でも有数と書いたのは決して誇張ではない。現在、土屋教授が運用するシステムは実に32基のGPUによるGPUクラスタ。高速演算用のNVIDIA Tesla M2075を1台に4基搭載したGPUコンピューティングサーバーを計8台導入し、自身の研究に役立てている。
このクラスタで土屋教授が実現するのは「コンサートホールの音響を完全にシミュレートする」という壮大なものだ。教授自らが「シリコンコンサートホール」と名付けたこの構想が実現すれば、例えば家にいながらにして、圧倒的な臨場感のある音響を体感できるようになる。
実際、研究棟内には22台のスピーカーを配置した音響室が設けられている(スピーカーが並ぶ写真を参照)。取材後、幸運にもその効果を聴く機会に恵まれたのだが、結果は驚くべきもの。大げさではなく、まるで目の前でオーケストラが演奏しているかのような感覚に見舞われた。目を閉じると、本当にステージの様子が浮かんでくるかのようであった。
システム導入は2011年末からエルザ ジャパンが2回に分けて行い、サーバー納入はG-DEPが担当した。今回の取材にはエルザ ジャパンの担当者・高山良文氏に加え、土屋先生のもとでCUDAプログラミングを実践する学生の石井氏も同席。これまでの経緯や今後の展望などを座談形式で話してもらった。
現在のGPUクラスタなら、恐らく世界中のどんな規模のホールでもシミュレーションできるでしょう
—— 先生は具体的に、GPUを用いてどのような計算を行なっているのでしょうか。
土屋氏:「コンサートホールの音響を完全にシミュレーションして再現するというもので、私自身は『シリコンコンサートホール』と呼んでいます。32基のGPUを搭載した現在のGPUクラスタを用いれば、恐らく世界中のどんな規模のホールでもシミュレーションできるのではないでしょうか。シミュレーション能力は1万立方メートルを超えていて、この規模の計算は世界でも例を見ないものだと自負しています。さまざまな論文に目を通しても、せいぜいが1,000～2,000立方メートルぐらいで、小ホールに毛が生えた程度しか計算できていないようです。」
—— ご自身の研究にGPUを利用しようと思われたきっかけは?
土屋氏:「いくつかのステップを経ています。まずはCPUクラスタによる手法から始まり、その後にLSI(集積回路)によるシミュレーションであるFPGAの存在を知り、そこからFPGAに取りかかりました。さらにその成果をいくつか学会で発表しているうちに、『土屋先生の研究内容ならGPU計算のほうが高速化できますよ』という話を聞いたのがきっかけですね」 
—— タイミングとしてはGPU計算の黎明期でしょうか。
高山氏:「今ならGPUを組み込める専用筺体がありますが、当時は先生たちがオリジナルで組み上げるという形でしたよね」
土屋氏:「そうなんです。さまざまな文献を見ながら見よう見まねでマザーボードを選んだりしましたよ(笑)。一方で、以前からCPUクラスタを手がけていた関係もあり、新しいハードウェアに対するハードルは低かったと言えます。ですから、これまでのシミュレーション手法の変遷はすべて、常に『より速い計算』を求めてきた結果なのです」
—— 先生は早い段階からGPUに意識的で、各世代のGPUを導入されているとお伺いしました。
土屋氏:「とはいえ、初期の演算型GPUであるNVIDIA Tesla C1060(2008年発売)などは、価格の問題もあってすぐには導入できませんでした。実験用に1、2基は購入していましたが、価格がこなれてきてから徐々に導入枚数を増やしてきた形ですね。実際のところ、C1060を4基搭載したマシンで1年半ほどシミュレーションしていたんです。それだけのGPUでも相当なスケールの計算ができることがわかったので、そこから現在のNVIDIA Tesla M2075のGPUサーバー(4基搭載)を8セット、合計32GPUの導入に踏み切りました」
—— 現在のシステムを導入されたのはいつ頃ですか。
土屋氏:「2011年末から2回に分けて導入しました。ただし、現在では十分に自分の研究テーマの計算は高速化できてしまったので、そのリソースを使って次に何をやろうかという段階まで来ているのも確かです。その成果として、マルチスピーカー(22台のスピーカーシステム)で、いかに立体的かつリアルに音が聞こえるかという環境を構築しました。録音物から音響をシミュレートして、最もリアルに聞こえる音をスピーカーから出すというものです。面白いもので、シミュレートした結果を学生に聞かせると、あまりにも自然に聞こえるため『この音は何が凄いのですか?』と尋ねてくるぐらいです(笑)」
極端な話、一ヵ月以上かかっていた計算が、クラスタ化することによって一週間程度に縮小されました
—— CUDAを利用するようになったのはいつ頃でしょう。
土屋氏:「CUDA 2.0(2008年)がリリースされてから一気に使うようになりました。これは先ほどお話したように、最初にCgでプログラムしてしまったという当方側の都合のためです。とりあえずCgに一旦区切りをつけ、そこからCUDAという整備された開発環境を利用し始めたんです。現在も基本的にプログラムは内製コードしか使用しません。チューニングに関しては石井くんに結構任せています」
石井氏:「まだまだフルチューニングとまでは行かないんですが、少しでも高速化できるように努力しています。私自身、ハードウェアのシステム構成にも興味があります。CUDAの場合、プログラムを書いただけで終わりではなく、どこをどう関連づければより一層速くなるのかがハードウェアと密接に関わっています。そこが非常に面白いところですね。それに、この32GPUのクラスタであれば、より最適化を図ることでもっと早くなる可能性があると思います」
土屋氏:「極端な話、一ヵ月以上かかっていた計算が、クラスタ化することによって一週間程度に縮小されたわけです。今では学会の時などにもよく声をかけられます。論文にGPU計算を活かされている方たちも増えてきましたしね。さすがにクラスタ化されている方はまだあまりいませんが」
高山氏:「大学研究室のレベルでは、この32GPUクラスタは間違いなく全国でもトップレベルです」
土屋氏:「ただ、学会などでも『GPUは難しいんですか?』とはよく聞かれます。難しいというのは正確ではなくて、ハードとしてのGPUを導入しただけでは速くならないということ。CUDAも含めたプログラミングによるチューニングや最適化など、計算の高速化に対するテクニックが必要ということなんです」
—— 現在は、FDTD法(時間領域差分法)を用いて計算されているとお聞きしました。
土屋氏:「2011年に発表されたFDTD法の高精度版を利用しています。この方法だと圧倒的に精度が高くて速い。精度が倍程度良くなるので、その分メモリの使用量が減ります。メモリの使用量が少ないということは、転送量が減る。だから速くなるという図式です。FDTD法を用いてのメリットは高速化と実用的な規模のシミュレーションができるようになったということ。やはり私は、いかに高速化するかということを常に考えているのだと思います。GPU計算に着手してからは、ますますその傾向が強まりました。もはやCPUクラスタの時代には戻れませんね(笑)」
今後は実習を伴ったGPUの講義を積極的に行なっていきたいですね
—— GPU計算の第一人者として、裾野を広げるために心がけていることはありますか。
土屋氏:「現在、大学院で自らのカリキュラムの数回を当てて、GPUの講義をしているところです。40～50人ぐらいの聴講者数がいますよ。ただしまだ実習が伴っていないので、今後は実習を伴った講義をぜひやってみたいですね」
高山氏:「土屋先生のレベルですと、すぐに講習会やセミナーはいっぱいになると思います。今、企業の方たちは非常に積極的で、GPU関連のセミナーをどんどん受講されますから」
—— 新アーキテクチャーのKepler導入は考えているのでしょうか。
土屋氏:「もちろんです。現在はKepler導入も視野に入れており、GeForce GTX 680を試験的に使っています。また、2013年にマルチGPU対応を予定しているFemtet(ムラタソフトウェアによる電磁波解析ソフト)にも期待を寄せています。仮にFemtetが現在の32GPUに対応したら、大規模な振動の解析をやってみたいなと考えています。GPU計算を取り巻く今後の進化が今から楽しみですね」
32基のGPUクラスタが切り開く音響シミュレーションの未来		| G-DEP
