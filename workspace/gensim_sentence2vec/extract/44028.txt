MRTGの設定ファイル
ここまででMRTGが動作するようになったはずですが、よりMRTGを使いこなすために、ここで設定ファイルの主要な項目を紹介します。
主なグローバル設定項目
多くの設定項目が「設定項目名[識別子]」のように表記され、「識別子」で表される情報ごとにMRTGの設定項目を定義する必要があります。この識別子は、MRTGによって作成される一連のファイル群(識別子「.html」「.log」など)のファイル名に利用されます。前述したように、cfgmakerを利用した場合は「監視対象ホスト_I/F番号」が識別子として利用されています。
以下の4つの項目はMRTGの設定ファイルに必須の項目なので、必ず記述してください。
Target[識別子]:監視対象となるイーサネットポートの「ポート番号:コミュニティ名@アドレス」MaxBytes[識別子]:そのポートの転送許容量(byte表示)Title[識別子]:MRTGで出力されるページにおいて?の間に入る文字列PageTop[識別子]:MRTGで出力されるHTMLページにおいて、グラフの前に表示される文字列
設定ファイルに複数の識別子を設定することで、複数の異なるデータを扱うことが可能です。また、識別子には特殊文字を指定できます。例えば、「_」を指定すると、各設定値に対するデフォルト値を設定することになります。そのため、以下のように記述すれば、すっきりとした設定ファイルを作成可能です。
MaxBytes[_]: 12500000
Title[_]: MRTG
PageTop[_]: <H1>Traffic Analysis</H1><HR>
Options[_]: growright,bits
Target[router1]: 2:public@192.168.0.1
Target[router2]: 2:public@192.168.1.2
Target[router3]: 2:public@192.168.2.2
また、「^」という特殊文字も利用可能です。前述の「_」を指定した場合、以下のように同じキーワードを使うと設定が完全に上書きされます。
Options[_]: growright
(略)
Options[xxx]: bits
一方、「^」を指定した場合は、同じキーワードを利用しても設定を追記することになります。
Options[^]: growright
(略)
Options[xxx]: bits
グラフ描画の制御
YLegend/ShortLegend/LegendI/LegendO
MRTGを利用するとトラフィック以外のさまざまな情報もグラフ化できますが、トラフィック以外の統計情報を記録する場合は取得するデータに応じて、グラフに付随する凡例やデータの単位などを書き換えたいことがあります。その際に設定ファイル中に指定できるキーワードを示しておきます。
キーワード
説明
YLegend[識別子]
Linux管理者への道(最終回):MRTGによるサーバ監視システムの構築 (2/3) - @IT
