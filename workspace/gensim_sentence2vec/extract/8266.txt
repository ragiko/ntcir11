 Excelで効果的なグラフを作成するコツを身につけると、企画書やプレゼンテーション資料を作る時に大いに役立ちます。 今回(本連載の第3回)学ぶのは、データの推移を把握するのに適した「折れ線グラフ」の作成法。 線やマーカーの見栄えを整える基本操作から、「移動平均」を描く実用ワザまで、しっかりと身に付けましょう。 (本連載ではExcel 2007/2010の操作を解説します)
折れ線グラフは、データの移り変わりを示す目的で使われることが多い。 線の傾きによって、値の増減が一目瞭然になるからだ。
図1 折れ線グラフでは、注目させたいポイントを色や数値で強調するテクニックや、
データの傾向を正しくつかむための「移動平均」グラフを描く方法などを押さえよう。
また、今回は横軸に日付をうまく配置する方法や、表のデータが欠けている場合に線が途切れるのを防ぐワザも解説する 
そこで今回は、データの推移をより分かりやすく伝えるための定番ワザを紹介しよう。 まずは数量が最大になったポイントの色を変え、数値を表示させるテクニックをマスター。 そして、一定区間の平均値を求めて瞬間的な値の増減を平準化する「移動平均」グラフの作り方など、ビジネスの現場で役立つ実用ワザを身に付けたい。 そのほか、「データの欠けた部分で折れ線が途切れてしまう」などのトラブルも解決する(図1)。
折れ線を選択して色を変更
最初に、折れ線の見栄えを整えるための基本操作から確認しよう。 線の色などを変えるための操作は、棒グラフのときと同様だ。 書式を変更したい対象をクリックして選択し、リボンに現れる「グラフツール」や、そこから開ける書式設定画面を使って設定する。
例えば、折れ線の色を変えるには、折れ線をクリックして系列全体を選択(図2)。 「書式」タブで「図形の枠線」ボタンをクリックし、一覧から色を選ぶ(図3)。 棒グラフの場合、棒の色は「図形の塗りつぶし」ボタンで変更するが、折れ線の色は「図形の枠線」ボタンで変更するのがポイントだ。
折れ線全体の色を変える
［上］図2 赤い折れ線が青い折れ線より目立つので、赤を緑に変える。
棒グラフと同様、折れ線上を1回クリックすると、その折れ線全体(系列)が選択された状態になる
［下］図3 折れ線全体が選択された状態(図2)で、「書式」タブにある「図形の枠線」ボタンをクリックし、
開いた一覧で色を選べば、その折れ線全体の色を変えられる 
Excel   2007/ 2010 で複数の系列を持つ折れ線グラフを作ると、標準では青、赤、黄緑、紫の順で色が付く。 そのままでは2番目の赤が最も目立ってしまうので、グラフの内容に合わせて、注目してほしい折れ線が目立つように色を変えるとよい。
なお、折れ線上の各値(要素)に「」「」「」などの「マーカー」を付けている場合は、マーカー内部の色を別途「図形の塗りつぶし」ボタンで変更する必要がある。
「マーカー」を個別に設定
次に、マーカーのない折れ線グラフに対して、最大値の部分にだけ赤く四角いマーカーを付け、強調してみよう。 マーカーの上には、そのときの具体的な数値(データラベル)を表示させて明示する。
これも棒グラフのときと同様に、「系列」と「要素」の選択方法の違いを意識して操作する。 まず、最大値を含む折れ線を1回クリックすると、折れ線全体、すなわち1つのデータの連なりであるデータ系列全体が選択される(図4左)。 この状態で、最大値の部分をもう1回クリックすると、その頂点だけ、すなわち1つのデータ要素だけが選択された状態になる(図4右)。 こうして最大値となっている要素だけを選択した状態で、「選択対象の書式設定」ボタンを押し、設定画面を開こう。
図4 青い折れ線の最大値を赤いマーカーで目立たせ、数値を表示させてみよう。 
まず、青い折れ線をクリックして、青い折れ線全体を選択(左)。
最大値を示すポイントをもう1回クリックして、その要素だけを選択した状態にする(右)。 
この状態で「レイアウト」タブまたは「書式」タブの「選択対象の書式設定」ボタンを押す
「データ要素の書式設定」画面では、まず左側で「マーカーのオプション」を選択。 右側に表示される「マーカーの種類」欄を「組み込み」に変更し、一覧から「」の形を選ぶ(図5)。 必要に応じて「サイズ」欄も変更しよう。 マーカーの形とサイズが決まったら、左側で「マーカーの塗りつぶし」を選択。 右側で「塗りつぶし(単色)」を選び、「塗りつぶしの色」欄で赤を選択する(図6)。 これで最大値を示す頂点部分に赤く四角いマーカーが表示される。
［左］図5 左側で「マーカーのオプション」を選び、右側で「組み込み」を選択。
「種類」欄のをクリックして「」を選ぶ。 さらに、「サイズ」欄を適当な大きさに変更する
［右］図6 続けて、左側で「マーカーの塗りつぶし」を選び、右側で「塗りつぶし(単色)」を選択。
「塗りつぶしの色」欄で「赤」を選んだら、「閉じる」ボタンで画面を閉じよう 
この上に具体的な数値を表示させるには、最大値のデータ要素が選択された状態のまま、「レイアウト」タブの「データラベル」ボタンをクリック。 開いたメニューから「上」を選べばよい(図7)。
図7 最大値を示すポイントが赤い四角に変わった。
次に、この要素が選択された状態のまま、「レイアウト」タブの「データラベル」をクリック。 
開いたメニューで「上」を選ぶ(上)。 これで、マーカーの上に数値が表示される(下) 
なお、今回は最大値となる1カ所だけにマーカーを付けたが、折れ線の全ての要素にマーカーを付けるには、「デザイン」タブで「グラフの種類の変更」ボタンを押し、グラフの種類を「マーカー付き折れ線」に変えてしまうのが手っ取り早い。
「移動平均」が簡単に描ける
続いて、移動平均のグラフを描く方法を見ていこう。 Excelのグラフには、さまざまな「近似曲線」を自動的に描く機能が備わっている。 難しい統計計算を自分で行わなくても、データ分析用の近似曲線を簡単に追加できるのだ。 折れ線の系列を選択した状態で、「レイアウト」タブにある「近似曲線」ボタンを押してみよう。 すると、追加できる近似曲線の種類が表示される(図8)。
図8 「移動平均」のグラフを描く機能もExcelは標準で備える。
具体的には、系列全体を選択し、「レイアウト」タブにある「近似曲線」ボタンをクリック。
「2区間の移動平均」を選んでもよいが、さらに細かく設定するため「その他の近似曲線オプション」を選ぶ 
今回は、一定区間の平均値を求めてデータを平準化する移動平均グラフを追加したい。 これには図8のメニューにある「2区間の移動平均」を選んでもよいが、「その他の近似曲線オプション」を選ぶと、平均を求める区間(データ数)を自由に設定できる(図9左)。 ここでは3区間の移動平均を表示させてみた(図9右)。 データが少しずつ下降した後に上昇に転じた傾向が、滑らかな線で表現されている。
図9 左側で「近似曲線のオプション」を選択し、右側で「移動平均」を選択。
さらに、「区間」欄で平均を求める区間数を指定する(左)。
今回は「3」区間とした。 設定画面を閉じれば、移動平均線が表示される(右) 
頻出の2大トラブルを解決
最後に、折れ線グラフでよくある2つのトラブルを解決しておこう。
一つは、横軸(X軸)の日付を等間隔に並べる方法だ。 折れ線グラフはその性質上、横軸が日付となることが多い。 そこで発生するのが、飛び飛びの日付から成る表をグラフ化する際のトラブル。 Excelは横軸が日付だと認識すると、連続した日付となるように元表にはない日付を勝手に追加して時系列に並べる。 そのためデータ要素が等間隔に並ばなくなってしまうのだ(図10)。
図10 元の表の通り、6つの日付を等間隔に並べたグラフに直すには、
横軸をクリックして選択し、「レイアウト」タブの「選択対象の書式設定」ボタンを押す 
時間軸に沿ってデータの推移を見たいときには、このように時系列に日付を並べる機能が役立つかもしれない。 しかし、日付の間隔に特に意味がなく、それぞれの日付を単なる項目名として使いたい場合は、横軸が等間隔に並ばないとグラフとして見にくい。
これを解決するには、横軸の設定を変更する。横軸を選択し、「レイアウト」タブの「選択対象の書式設定」ボタンをクリック。書式設定画面の「軸のオプション」で、「軸の種類」を「テキスト軸」に変える(図11)。 これで横軸のデータは、日付ではなく単なる文字列として扱われ、日付が等間隔に並ぶようになる。
［上］図12 元の表データに空白があると(ここではB5セル)、標準ではそこで折れ線が途切れてしまう。
これを補間して、直線でつなぐこともできる
［下］図13 グラフエリアまたはグラフ内のいずれかのパーツをクリックして「グラフツール」を表示させ、
「デザイン」タブにある「データの選択」ボタンをクリックする 
もう一つのトラブルは、表のデータが欠けていると、標準では折れ線が途切れてしまうことだ(図12)。 このような場合、途切れた部分を直線で結んだ方がグラフが見やすくなり、データの傾向もつかみやすい。
途切れた部分を直線で結ぶには、グラフエリア全体かいずれかのパーツを選択した状態で、「デザイン」タブの「データの選択」ボタンを押す(図13)。 「データソースの選択」画面が開くので、左下隅の「非表示および空白のセル」ボタンをクリック(図14左)。小さな設定画面が開いたら、「空白セルの表示方法」として「データ要素を線で結ぶ」を選ぶ(図14右)。 こうして設定画面を閉じれば、途切れていた折れ線が直線でつながる(図15)。
図14 「データソースの選択」画面が開いたら、「非表示および空白のセル」ボタンをクリック(左)。
小さな設定画面が開くので、「データ要素を線で結ぶ」を選び、「OK」ボタンを押す(右)。
「データソースの選択」画面も「OK」ボタンで閉じる 
図15 これで空白データが補間され、途切れていた部分が直線で結ばれる。
見栄えが良くなるほか、推移の傾向が分かりやすくなる 
(フリーランスライター 岡村秀昭)
[日経パソコン2012年5月14日号の記事を基に再構成]
<< Return to Page Top
Excel Graph
