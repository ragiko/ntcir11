いきなりエラー
Setup.exeを起動するといきなりこんな。
このプログラムには既知の互換性の問題があります。
オンラインで解決策がMicrosoft Webサイトから利用可能かどうか確認します。
解決策が見つかると、実行できる手順を表示するWebサイトが自動的に表示されます。
プログラム: Visual Studio
発行元: Microsoft
場所: D:\SETUP.EXE
Visual Studioには、このバージョンのWindowsとの互換性に関する既知の問題があります。
ですって……。で、「オンラインで解決策の有無を確認する」を選択してみると……はいはい。駄目ですね。そのまま「プログラムを実行する」を押してみましょう。
インストール続行
めっちゃ懐かしい画面が出てきました。インストール、したなぁ何度も何度も。98年～99年頃。で、シリアルナンバーなどを入れた後……これ。これどうすりゃいいんだろ。そのまま突っ切ってみようか。で、また警告画面が2回ほど出ますが、どちらも「プログラムを実行する」で突っ切りましょう。そうすると最後にこんな不安になるメッセージボックスが……。……お、おう。OKを押してみよう。
インストール続行(2)
で、続き。ここでCDを抜いたりするといろいろ問題が出ますので、CDは入れたままで再起動しましょう。そうすると続きが自動実行されます。この画面が表示されたら、「Visual Studio 6.0 Professional Editionのセットアップ」を選択して「次へ」を押します。で、次がインストール先フォルダの指定なんですが……これどうしましょうね。そのままで大丈夫かな。とりあえず32bit版なのでProgram Filesフォルダの名称もそのままで行けそうだし、初期状態のまま(画面に出てるまま)次へで先に進めてみましょう。……うっわ。また出ますねこれ。めげずに「プログラムを実行する」で強行します。さて、この先は昔懐かしい、緑色背景のセットアップ画面になるわけですが、その中でインストール物の選択が可能です。今使いたいのはVisual Basic 6.0だけなのでC++とか要らないのですが、実験も兼ねてそのまんま(初期状態のまんま)インストールを進めてみるとしましょう。次に表示される環境変数の登録も、チェックをONにして進めてみます。あとはファイルのコピー画面です。懐かしいですねこの画面。当時、Visual Studio 97から6.0に移行するかどうかとかで結構議論になっていたのを思い出します。まさか15年経ってもこの画面をみることになるとはねぇ……。しばらくして…完了。インストールできたっぽい。
サービスパックを適用する
当時ですらサービスパック適用でだいぶ不具合が消えたという状況だったので、さすがにサービスパック無しで使うとかってのはあり得ません。手元にあるSPのディスクはSP 5なので、これをインストールしてみましょう。サービスパックはオートプレイ設定にはなっていないようで、ディスクを入れると中身を表示するかどうかを聞いてきます。ディスク内のJAPANESE/VS60SP5フォルダにある「SETUPSP5.exe」を実行してみましょう。あ、また出ますね。そのまま突っ切りましょう。……あぁ、MDAC(Microsoft Data Access Component)が必要、とな。たしかこれは昔の環境(当時だとWindows 2000とか98)でも出てきてたような気がする。Readme.htmの内容を見てみましょうか。Readme.htmの記述によると……2.5についてはなにやら記載があるのですが……インストーラーと思わしきプログラムを実行しても何も起きない。というわけで、仕方ないのでダウンロードしてみましょう。検索すると、Microsoftのサイトから今でもダウンロードできるようですね。MDAC 2.6には無印、SP1、SP2があるようですが、とりあえず最新版を入れておきましょうか。
Universal Data Access 関連ダウンロード
http://msdn.microsoft.com/ja-jp/data/dd162300.aspx
…っと、MDAC 2.6 SP2のダウンロードリンク……っと……もう無いのですか……。調べてみると、かつてのMDACは、今は「Windows DAC」という名称に変わって存続しているようです。さらに、VistaからOS標準ライブラリになっており、既に導入されているとのこと。
MDAC/Windows DAC を利用するアプリケーションの開発/動作環境
http://msdn.microsoft.com/ja-jp/data/gg607260.aspx
インストールされているDACのバージョンは、レジストリの「HKEY_LOCAL_MACHINE\SOFTWARE\Microsfot\DataAccess\」の下にある「FullInstallVer」で調べられるようです。んー……ということはMDAC相当品はインストールされているものの、Visual Studio 6.0のSP5インストーラーはそれを認識できず、相変わらず「MDAC 2.5以上が必要」というメッセージを出しているということか……なんとかしてこれをだませないものかな。
とりあえず今晩はこの辺で中断しておきます。
Windows 7にVisual Studio 6.0を入れてみるテスト - misc.log
