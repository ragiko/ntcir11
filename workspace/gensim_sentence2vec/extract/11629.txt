
「こんなグラフ (下図) が作りたい」と、ご質問をいただきました。
2 つの範囲を選択して、横棒グラフを作ったけれど、セル範囲が離れているので、
[行/列の切り替え] ボタンが使えなかったり、とにかくうまくいかないのだそうです。
2 つの表を元に 1 つのグラフに表現して、項目ごとの違いを比較したいのですね。
表を下図のようにしたほうが早いのでは?と伝えたら、それではダメなんだそうです。
見た目がよろしくないのなら、C 列は非表示にして、非表示の列のデータもグラフに
表示されるように設定する、という選択肢もあると思うけれど、いろいろと事情があるのでしょう。
ということで、後からデータ範囲を修正する方法でグラフを作ってみます。
1つ目のデータ範囲 (第1回の集計データ) だけを選択して、横棒グラフを作ります。
1. グラフ化するセル範囲を選択して、リボンの [挿入] タブの [グラフ] グループの
[横棒] をクリックして、[100% 積み上げ横棒] をクリックします。
2. 回答数のデータ部分の範囲が 1 つ (1 列) なので、項目ごとに棒グラフの棒が表示されます。
データの行と列を切り替えるには、[グラフ ツール] の [デザイン] タブの [データ] グループの
[行/列の切り替え] をクリックします。
3. 横棒グラフができあがります。
作成したグラフに、第2回のデータも表示されるように、データの範囲を編集します。
1. [グラフ ツール] の [デザイン] タブの [データ] グループの [データの選択] をクリックします。
グラフを右クリックして、ショートカット メニューの [データの選択] をクリックしてもよいです。
2. [データ ソースの選択] ダイアログ ボックスが表示されます。
[グラフ データの範囲] に、グラフを作成するときに選択していたセル範囲が指定されていることがわかります。
3. この時点では、それぞれの項目 ([たいへん満足] などのデータ系列) の値のセルが
1つだけなので、「第2回」の表の該当するセルを追加します。
[凡例項目 (系列)] で編集するデータ系列を選択し、[編集] をクリックします。
4. [系列の編集] ダイアログ ボックスの [系列値] ボックスに指定されている値を消して、
1 つ目のセルをクリックし、[Ctrl] キーを押しながら 2 つ目のセルをクリックします。
(ミスを防ぐためにも、[系列値] ボックスに指定されている値は、全部消してから、
指定しなおしたほうがよいです。)
5. [系列の編集] ダイアログ ボックスの [OK] をクリックします。
6. グラフに表示するデータ系列の値が追加されます。
7. ほかの系列 (ここでは、[満足]、[ふつう]、[やや不満]、[不満]) も、
「第1回」と「第2回」の欠課の 2 つのセルの値が表示されるように編集します。
これで終わりにする場合は、[データ ソースの選択] ダイアログ ボックスの [OK] を
クリックします。
「1」「2」と表示されている横軸のラベルを編集して、「第1回」「第2回」と表示されるようにします。
1. [データ ソースの選択] ダイアログ ボックスの [横 (項目) 軸ラベル] の [編集] を
クリックします。
2. [軸ラベル] ダイアログ ボックスが表示されます。
[軸ラベルの範囲] ボックスをクリックして、「1」の代わりにラベルに表示する値 (第1回) が
入力されているセルをクリックし、
[Ctrl] キーを押しながら「2」の代わりに表示する値 (第2回) が入力されているセルを
クリックします。
3. [軸ラベル] ダイアログ ボックスの [OK] をクリックします。
4. [データ ソースの選択] ダイアログ ボックスの [横 (項目) 軸ラベル] に、
指定したセルの値が表示されます。
[OK] をクリックします。
5. グラフ化するデータ範囲が編集され、グラフができあがります。
積み上げ横棒グラフの場合、一般的には、凡例は表示せずに、値を棒グラフの上に表示するのだと
思いますが、そのあたりはお好みに合わせて編集してください。
また、普通は、第1回が上部に表示されるようにしたいですね。
こちらは次回、別途ご紹介します。
石田かのこ
クリエのちょこテク » 100% 積み上げ横棒グラフで結果を比較する
