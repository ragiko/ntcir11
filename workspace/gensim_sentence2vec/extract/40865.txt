FTIR TALK LETTER vol.10(2008)
今回は,FTIRでスペクトルに対して使用する,各種のデータ処理のアルゴリズムのうちいくつかについてご紹介します。これらはIRsolutionソフトウェアで採用されているものです。
スムージングは,スペクトルの形状をより滑らかにする処理です。
例えば,S/Nの良くないスペクトルに対してこの処理を行うと,ノイズを小さくすることができます。これにより,ピークの分解は劣化しますが,ピークの有無やスペクトル全体の形状などがはっきりするため,未知試料分析などで定性情報を得る際に効果があります。
スペクトルをスムージングするということは,データ点ごとのスペクトル強度変化の度合いをやわらげるということに相当します。従って最も簡単には,スペクトルの各データ点の強度を,両隣のデータ点を含めた3点の強度の平均値で置き換えるというような方法でも,ある程度まで実現できます。下の図の点線グラフは,実線グラフの3点の強度平均で真ん中の点を置き換えたものですが,点ごとのスペクトル変化が小さくなっています。
IRsolutionではもう少し複雑なアルゴリズムを採用しています。3点で平均をとる代わりに,指定したスムージング点数だけのデータ点において,点ごとに重み付けをしたファクターを掛けて合計した数値を使用しています。このファクターは,3次のSavitzky-Golay係数と呼ばれるもので,中心の対象データ点では大きく,周辺の点に対しては中心から離れるに従って減少する関数により決められます。スムージング点数は,IRsolutionのスムージングコマンドの画面で指定できますが,この値を大きくすると,広い範囲のデータ点の重み付けした平均をとることになるため,一般にはより滑らかで凹凸の少ないスペクトル形状となります。
もともとデータ点の存在しない箇所のスペクトル強度を,付近のデータ点から内挿して求める処理です。最初のスペクトルよりデータ点は増加します。
この処理は,例えば,異なった分解で測定したためにデータ点間隔が異なるデータ同士を比較するときに使用します。適当な補間を行うことにより,それらのデータ間隔を等しく揃えることができるわけです。
補間のアルゴリズムには,データのある2点を直線で結び,その上に新しい点を作るという単純なものもありますが,IRsolutionでは,Laplace_Everett法というアルゴリズムで計算しています。これは周辺の何点かの強度を用いて新しい点を作るという補間アルゴリズムです。つまり,求めようとする点の隣接する点だけでなく,その周りの点の強度も考慮に入れて,広い範囲での曲線の傾向を見て新しいデータ点を決めようとするものです。IRsolutionでは周辺4点を使用しています。
具体的には,スペクトル上にデータ点P0,P1,P2,P3が順番に並んでいて,それぞれの強度がI0,I1,I2,I3であるときに,点P1とP2を t:1-tに内分する点をPとすると,単純な補間では,その点の強度Iは
FTIR TALK LETTER vol.10 FTIRでのデータ処理の アルゴリズムについて : 株式会社島津製作所
