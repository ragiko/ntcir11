リンク キャパシティの増量: 圧縮の有効化と調整
WAN リンク キャパシティの増量および圧縮オプションの調整によるパフォーマンスの最適化を行うための手順 
PacketShaper の Xpress は、厄介な管理上のオーバーヘッドを必要とすることなく WAN リンク スループットを改善します。これにより、WAN リンクが実際よりも多くの帯域幅を提供しているかのようになります。具体的には、Xpress は次の機能を持ちます。
トラフィックを圧縮して、品質を落としたりデータを失うことなく、限られた WAN リンクを介してより多くのデータを送受信します。
WAN を介して取得するビット数を少なくし、取得を高速化することで、アプリケーションのパフォーマンスを高速化します。
圧縮と帯域幅の割り当てを調整して重要アプリケーションのパフォーマンスを最適化するために、リアルタイムのパフォーマンスと遅延データを評価します。
背景についての詳細は、「Xpress 概要」を参照してください。
圧縮を設定して有効にするには、いくつかの手動設定が必要です。有効にすると、PacketWise は自動的に圧縮トンネルを作成、設定、維持します。 
圧縮の結果を確認します。 
結果を最適化するための圧縮の調整
圧縮を使用または設定して圧縮による帯域幅節約の利点を得るために、明示的な調整は必要ありません。Xpress 圧縮は圧縮トンネルを確立して維持し、適切なデフォルト設定を使用します。そのため、デフォルト設定を無期限に使用し続けることができます。
ただし、PacketShaper の使用経験があり、調整によってより優れた圧縮ゲインが得られるかどうかを確認する場合には、次の調整候補の一部またはすべてを調整することができます。
ポリシーおよびパーティション設定の検討 
アプリケーションのパフォーマンスは、適切なシェーピング ポリシーと効率的な圧縮設定の組み合わせにより高めることができます。Xpress は既に用意されているポリシーとパーティションを基に圧縮ゲインを最適化するように設計されています。そのため、通常は新しく圧縮するトラフィックのためにシェーピング ポリシーを調整する必要はありません。
PacketShaper Xpress を使用してシェーピングを設定するときは、次のガイドラインに従ってください。
ポリシーは圧縮前ベースで帯域幅を割り当てます。圧縮を行うかどうかを問わず、ポリシー内では同じレートを使用します。
レート ポリシーの例
Citrix フローが正常に動作するために 10 Kbps の非圧縮トラフィックが必要となり、これに応じてレート ポリシーが設定されるとします。また、Xpress が通常は 10 Kbps を 4 Kbps まで圧縮するとします。Citrix レート ポリシーの保証レートを調整して同様に下げることは、必要ではなく、推奨されず、利点がありません。 
パーティションは圧縮後ベースで帯域幅を割り当てます。パーセント形式で指定したパーティション サイズを確実にそのまま残します。明示的な最小および最大パーティション サイズを残したまま同じ帯域幅からより多くのスループットを得ることや、サイズを調整して予想される利得を考慮することができます。
パーティションの例
HTTP トラフィックが固定パーティションにより 150 Kbps に制限されているとします。Xpress が 2:1 の圧縮率を提供する場合、300 Kbps は 150 Kbps のパーティションに圧縮されます。設定を変更することなく、同じ帯域幅で 2 倍の HTTP トラフィックを送信できます。または、実際に元の非圧縮コンテンツの 150 Kbps に対する HTTP トラフィックが含まれるようにするときは、それまで一貫して 2:1 の結果を維持してきた場合、パーティション サイズを 75 Kbps に軽減することもできます。
大きな、重要なトラフィック クラスに独自の圧縮プログラムを用意する 
Xpress が圧縮のために使用するルールと設定を調整することで、得られる結果に影響を与えることができます。それぞれの変更には、トレードオフの関係があります。そのため、圧縮アルゴリズムと圧縮プログラムについて少し学習し、賢明な決定を行えるようにすることが最善です。変更を行うには、次の手順に従います。
大きなボリュームを備えた重要な送信トラフィック クラスを選択します。暗号化されたアプリケーションやストリーミング アプリケーションなどの圧縮できないトラフィックのクラスは避けます。
このユニットの圧縮からは送信トラフィックのみが恩恵を受けます。圧縮する受信トラフィック クラスがある場合、トラフィックが発生する場所である圧縮トンネルの反対側で PacketShaper を設定する必要があります。そこでは、トラフィックは送信クラスで表示されます。(ただし、このユニットがトラフィックを圧縮しなかった場合でも、実際には受信圧縮結果がこのユニットの受信 [Compression Summary] に表示されます。)
上位 10 の円グラフや上位 10 のトラフィック クラスのリストを表示したり、利用可能な上位 10 スタイルのグラフを確認して役立たせることができます。 
選択したトラフィックを考慮しながら「圧縮アルゴリズムと圧縮プログラム」を参照してください。適切なアルゴリズムを選択します。
選択したクラスに独自の圧縮アルゴリズムを割り当てます。CLI にアクセスし、tunnel class set algorithm コマンドを使用します。
たとえば、
tunnel class set algorithm  outbound/Oracle Pred2 1 
と入力すると、送信 Oracle トラフィックに Pred-2 アルゴリズムを使用することができます。「1」は新しい圧縮プログラムの ID です。独自の圧縮プログラムが必要な以降のトラフィック クラスには、「2」、「3」を順に使用します。それぞれのクラスが異なるアルゴリズムを使用する場合は、それぞれのクラスが同じ ID 番号を使用することができます (「Pred2-1M 1」、「Pred2-2M 1」、「Pred2-4M 1」など)。
もちろん、目的と前の手順で得た背景知識に応じて異なる設定を選択することができます。たとえば、高い圧縮スループットを備えるものの圧縮ゲインが小さい、とても迅速な圧縮が必要な場合には、Pred1 アルゴリズムを試します。少し時間をおいてから、圧縮結果を評価します。または、ICNA アルゴリズムを試すこともできます。 
トラフィックの内容が似ている 2 つの送信クラスがあり、圧縮が必要な場合、同じアルゴリズムとグループ ID を使用して同じ圧縮プログラムに 2 つ目のトラフィック クラスを割り当てることができます。これは次の 2 つの点で節約に繋がります。
既に短縮されディクショナリ内に置かれているデータを異なる同様のトラフィック クラスのトラフィックのために再度処理する必要がなくなるため、圧縮の時間が節約されます
クラス固有の圧縮プログラムのインスタンスが 2 つではなく 1 つだけ必要になるため、メモリが節約されます。圧縮プログラムとメモリは共有されます。
たとえば、営業部のトラフィック用に 2 つの Oracle トラフィック クラスがあり、1 つは WestUS データベースを使用する Oracle トラフィック用、もう 1 つは EastUS データベースを使用するトラフィック用とします。次の 2 つの CLI コマンドを入力することができます。
tunnel class set algorithm outbound/Oracle/SalesWest Pred2 5
tunnel class set algorithm outbound/Oracle/SalesEast Pred2 5 
変更を確認するには、tunnel class show <tclass> CLI コマンドを使用します。
特別なトラフィック クラスに分類される一部のトラフィックを通過させます。圧縮プログラム (Pred2_5) が初期化されて使用されます。その後、いくつかの圧縮関連グラフを作成して、結果の確認を開始することができます。 
圧縮トンネルの両端で PacketShaper の同じクラスに対して同じ圧縮設定の変更を適用するかどうかを検討します。 
受信方向と送信方向の両方でトラフィックの傾向が同じ場合には、両端に変更を適用します。ただし、圧縮トンネルの一端のみが大量の送信トラフィックを扱う場合には、一端のみを変更することが適切です。 
パッキング 設定の調整 
パケット パッキングとは、複数の小さなパケットを 1 つの大きなパケットに選択的にまとめる、または連結させる処理のことです。パッキングによりヘッダーや確認応答などのオーバーヘッドが軽減され、圧縮で得られる利得が向上します。 
トラフィックの負荷が大きいときは、PacketWise はパッキングが必要な複数のパケットを用意するために通過する追加のパケットを待機する必要はありません。ただしトラフィックの負荷が小さい場合は、PacketWise は追加することができるトラフィックがさらに送られてくるどうかを確認するために、不十分な大きさのパケットを転送する前に少しの時間待機します。この待機時間により保留中のパケットの遅延が増える可能性があります。この場合には、圧縮率を高めてトラフィックの量を少なくするために、応答時間を可能な限り速くすることをあきらめることになります。 
Xpress ではアプリケーションに応じて待機時間を適用することができます。たとえば、Telnet と ICMP は時間に対して敏感なため、これらのサービスのパッキング待機時間は 0 ms です。一方、POP3-Clear と SMTP-Clear は遅延の影響を受けないため、これらの電子メール サービスのパッキング待機時間は 100 ms です。 
PacketWise が常にパケット パッキングを行うかどうかを選択することができます。また、行う場合には、まとめる追加のトラフィックを待機するときに保留中のパケットを遅延させることができる最大時間を選択することができます。
すべてのパケット パッキングを行わないようにするには、[Xpress] タブでグローバル パッキング機能を無効にするか、CLI の tunnel packing コマンドを使用します。また、トンネルごとにパッキングを無効にすることもできます ([Xpress] タブ、CLI)。この機能は静的トンネルにのみ適用されます。 
パケット パッキングの利点を維持しながら PacketWise がまとめるパケットを探して待機する時間を軽減するには、tunnel holdtime global コマンドを使用してデフォルトのパッキング待機時間を 1 または 2 ms に調整します。(グローバル パッキングを有効にする必要があります。) 
応答時間を短くすることよりも転送されるバイト数を軽減することを優先する場合には、デフォルトのパッキング待機時間を調整して 15 ～ 40 ms などの大きな値にします。(グローバル パッキングを有効にする必要があります。)
クラスまたはサービスごとにパッキングを無効にすることができます。「tunnel class set packing」および「tunnel service set packing」を参照してください。 
クラスまたはサービスごとにパッキング待機時間を調整することができます。「tunnel class set holdtime」および「tunnel service set holdtime」を参照してください。 
問題がある場合
圧縮が予想したとおりに動作しない場合には (確認には「圧縮結果の評価」を参照)、「圧縮のトラブルシューティング」を参照してください。
圧縮の有効化と調整
