XMLTypeデータの索引付けの概要
データベース索引では、表データに対するアクセスを高速化することにより、パフォーマンスが向上します。索引の使用は、更新が少ないオンライン・トランザクション処理(OLTP)環境に特に適しています。
XMLデータを索引付けする基本的な方法は、XMLIndexを使用することです。Oracle Text CONTEXT索引を使用して、XMLIndexの使用を補完することもできます。
XMLIndexによるXMLデータのファイングレイン構造の対処
表の1列または複数の列、またはファンクション式に対して索引を作成できます。XMLデータには独自のファイングレイン構造がありますが、その構造は、XMLデータが格納されるデータベース表の構造に必ずしも反映されるとはかぎりません。このような理由から、XMLデータに効果的に索引付けする方法は、他の大部分のデータベース・データに対する索引付けとは多少異なります。
構造化XML記憶域では、要素や属性などのXMLオブジェクトは、オブジェクト・リレーショナル列および表に対応しているため、これらの列および表に対してBツリー索引を作成する方法は、対応するXMLオブジェクトに効果的に索引付けする場合に最適です。この場合、記憶域モデルはXMLデータのファイングレイン構造を直接反映するため、構造化XMLデータの索引付けにおいて特別な問題は生じません。「オブジェクト・リレーショナル形式で格納されたXMLTypeデータの索引付け」を参照してください。
非構造化、ハイブリッドおよびバイナリXML記憶域では、標準的な索引(Bツリー、ビットマップ)を使用してデータベース列に索引付けすると、多くの場合、XML文書の特定部分にアクセスする際に問題が生じます。XML文書を含むXMLType列がCLOBインスタンスとして格納されると、その文書内の細部が列の索引にアクセスできなくなります。つまり、列の索引に関しては、文書全体が単独のユニットとして機能することになります。ハイブリッド記憶域では、XML文書の一部が分割され、オブジェクト・リレーショナル形式(構造化記憶域)で格納されますが、1つ以上のXMLフラグメントがCLOBインスタンス(非構造化記憶域)として格納されます。このような場合は、通常、XML SchemaのcomplexTypeまたは複合要素をCLOB記憶域にマッピングします。これは、通常はフラグメント全体が1つの単位としてアクセスされるためです。標準的な索引の場合、索引付けの単位としても機能します。
XMLIndexは通常のXML固有の索引により、XMLデータの内部構造に索引付けします。その主な目的の1つとして、非構造化、ハイブリッドおよびバイナリXML記憶域によって課される索引付けの制限を克服することがあげられます。
非構造化コンポーネントを含むXMLIndex索引では、文書のXMLタグに索引付けし、それをターゲットとするXPath式に基づいて文書のフラグメントを識別します。また、スカラー・ノードの値に対して索引付けすることで、単独の値または値の範囲に基づく高速参照も可能にします。さらに、索引付けする各ノードに対し、文書の階層情報(親と子、祖先と子孫、および兄弟の関係)を記録します。この索引コンポーネントは、構造が少ない文書または可変構造を持つ文書からXMLフラグメントを抽出する問合せで特に便利です。
構造化コンポーネント含むXMLIndex索引では、ほとんどの部分が構造化されていないXMLデータでも、高度に構造化された予測可能な部分に索引付けします。この索引コンポーネントは、構造化コンテンツのアイランドを投影および使用する問合せで特に便利です。
Oracle Text索引
要素や属性などのXMLノードにアクセスする以外にも、XMLテキスト・ノード内の特定の節に対して高速アクセスを提供する必要があることがあります。Oracle Text索引は全文文字列に対して索引付けすることで、この目的を達成します。Oracle TextのCONTEXT索引では、XMLの全文検索を実行するためのOracle SQL関数containsを使用できます。構造化記憶域では、XPathリライトにより、ora:contains XPath関数を使用する問合せが、contains SQL関数を使用する問合せにリライトされることが多いため、このようなケースでもOracle Text索引が使用されます。
全文索引は、特に、XML要素とテキストノード・コンテンツが混在する、文書中心のアプリケーションにおいて有用です。全文検索は、構造化XML検索と組み合せる(XPath式によって識別されるXML文書の一定部分に対して検索を限定する)ことによってさらに強力に、焦点を絞って行えるようになります。
XMLTypeデータの索引付け
