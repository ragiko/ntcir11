データが登録されている最終行を取得する。
Excelが認知しているセル情報を取得する方法です。最終行の他にも「計算式のあるセル」「表示されているセル」などいろいろ使えます。
これを実行すると、
(画像をクリックすると、このサンプルがダウンロードできます)
となり、最終セルが取得できることが解ります。このサンプルでは「Address」を取得していますが、「Row」とすれば最終セルの行番号が取得できます。
但し、登録したり消去したりを繰り返しているシートでは、最大でデータが収容された時点の最終セルが認知されていることがあり、現時点での最終セルとは違う場合がありますので、ここで取得した最終セル(最終行)から左上に向かってブランクでないセルを探すようにすると現時点の最終セルが正しく取得できます。
「SpecialCells」メソッドの指定は「最終セル」を特定するだけの機能ではありません。
カッコ内の定数指示子はVBEでこのように列挙表示されるので、簡単に指定ができます。内容は「最終セル」の他、「コメントのセル」「計算式のセル」「同じ書式のセル」「同じ入力規則のセル」などがいろいろ指定できます。
なお、これらの指定では戻り値は複数のセル範囲が返ってきますので、これを「For Each 〜」でセルに分解して操作する必要があります。(「ダウンロード」の「計算式一覧」ではこの「計算式のセル」を取得してから各セルの計算式を参照しています。)
※ご注意!!
VBA応用(Excelが認知している最終行を取得する。)
