表計算ソフトウエアExcelは
・表の形のデータを処理するのに大変便利である。
・また、Visual Basicによるプログラムも組み込める。
・グラフィックスも備わっている。
欠点としては、
・2次元的なデータ構造以外は扱いにくいことと、
・Visual Basicがプログラミング言語としては高度な使用に適さないことである。
Excelの概要
Excelを起動すると、次のようなシートが現れる。
・この図を見てわかるように、このWindowの名前がMicrosoft Excel-Book1となっている。すなわち、Book1という名前がデフォルトでついている。また、一番下にコマンド書かれている部分のすぐ上にSheet1, 
Sheet2, Sheet3というタグが見れる。
・このように、呼び出した状態では3つのシートから構成されるBookという単位がExcelの基本的な構成となっている。ファイルはこのBook単位で記録される。
・シートは65536行256列から構成されている。
・各マスはセルと呼ばれる。
Excelで図を画く
では、Excelで関数のグラフを画くことを考えよう。
基本的なデータ構造として、Excelは行と列および表がある。数学的には、行と列はベクトル、表は行列に対応する。
ここでは、列を縦ベクトル、行を横ベクトルと考える。物理ではブラとケットに対応する(ディラックの呼び名)。以下、当面、ベクトルといったら縦ベクトル(列)のこととしよう。さて、関数
のグラフを画くことを考えよう。具体的には、[a,b]=[0,2]とし、f(x)=exp(x)とする。Excelを始めとして、ソフトウエアによりf(x)を画くには、基本的にはベクトル
に対する
を出力する。ただし、
とする。また、
である。ここで、
とする。ここで、Excelにベクトルxを入力することを考えよう。a=0,b=2,h=0.1とする。
この図のようにセルA1とA2にそれぞれ0と0.1を打ち込む。これはh=0.1に対応する。そして、上図のように、A1とA2をマウスでドラックして、マウスの位置をセルA2の右下のコーナーに置きます。すると、マウスの形が+になります。そして、マウスのポインタが+になったまま、Aiの右側のラインに沿ってドラックをA21まで行いますと、図のように、0.1刻みで、2までの数値がセルAiに代入されます。
これをExcelのオートフィル機能といい、ベクトルの入力に便利な機能です。つぎにベクトルxであることを表示しておくために(後でグラフを画くときに軸の名前となる)Aをクリックして挿入をクリック、そして行をクリックします。すると無入力の行が一行最初に追加されますので、新しいA1にxと新しいB1にyと入力しておきます。
そして、B2の欄に
=exp(A2)
と書いて、
更に、リターンを押します。すると、exp(0)が計算されてつぎの表を得ます。
ここで、B2をドラックします。そしてマウスをセルB2の右下に置きます。
そしてそのままドラックをBiの右端を通ってB22まで続けます。ドラックを離すと、つぎの表を得ます。
ここで、A0からA22またはB0からB22までのどこかのセルを一つクリックします。
そして、グラフウイザード
をクリックして、ポップアップメニューの散布図を選びます。
そして、次へをクリックすると、
というグラフを得ますので、更に、次へをクリックします。ここでグラフタイトルとx軸、y軸の名前を入力します。
更に次へをクリックすると次を得ます。
ここで完了を押すと、図が得られます。
後は、図の縦横の比を調整したり、軸や曲線をダブルクリックして太さを調整して
最終的に次の図を得ます。
これで指数関数のグラフの完成です。以上のExcelのファイルを保存しておこう(exp.xls)。
sin(x)の描画
ここで、sin(x)を[0,2]上で画いてみましょう。先ほどの図を画いたExcelをファイルとして保存してあるとしてこれを、exp.xlsとしよう。exp.xlsを開き、名前をsin.xlsと別の名前で保存します。
sin.xlsにおいて、セルB2をクリックして=sin(A2)と入力します。
ここでリターンをして、expの関数値を計算したときのように、Bの列をドラックしていきます。すると、sin(x)の計算値にBの各セルの値が変更されます。
するとグラフは自動的にsin(x)のグラフに変更されます。あとは図題を三角関数sin(x)という風に変更します。(sin.xls)
次にxの範囲を広げ、関数値を計算しなおして、グラフを書き直します(このときは自動的にグラフが変更にはなりませんでした)。
2変数関数のグラフ
では、つぎに、2変数関数
のグラフを画くことを考える。具体的には[-5,5]x[-5,5]上で関数
のグラフを画くことにする。
上図のように、入力する。そして、A2B2のセルに=(($A2)^4)*sin(B$1)と数式を書く。ここで、$は絶対番地でセルを指定するために用いている。ここで、リターンしA2B2をクリックして図のようにまず列方向にオートフィルする。
ついで、この状態で、右方向にオートフィルする。
ここで、グラフウィザードを開き、等高線を選択する。
ここで、次へを選択し、後は1次元関数のグラフを画くときと同様にして次の図を得る:
ExcelのBookはつぎである(fig2.xls)
尚、本節の関数のグラフを画くの記述には次の書籍を参考にした。
参考書 酒井恒: Excelでわかる数学の基礎、日本理工出版会(2002)
Excelによる数値計算
ここで更に進んでExcelによる数値計算について学んでいこう。
テキストで書かれたデータを読み込んで図示する
つぎは酒井 敏先生(京都大学総合人間学部自然環境学科生物地球圏環境論講座)によるExcel入門である:
Excel 入門 テキストで書かれた地震の観測データをExcelに取り込み、図示してみる方法などが具体例に基づき書かれており大変参考になる。
Visual 
地球科学 微分方程式をExcelで解くことなど、地球科学を学ぶことを目的として、Excelの使い方が説明されています。上のExcel入門もその一章です。
ニュートン法
非線形方程式の解法としてニュートン法が極めて有力である。この方法をExcel上で実行することを考えよう。まず、1変数関数
f(x)=0
の解を求める問題を考える。ニュートン反復の公式は
で与えられる。ここで、例として
の零点を求めることを考えよう。この場合、
となる。これに基づき、ニュートン法をExcel上で実行してみよう。セルA1に初期値2を代入し、セルA2に
=A1-(A1^3-5*A1+3)/(3*A1^2-5)
と打ち込む。これはニュートン反復の一回である。
ここでリターンを押す。
これでニュートン法の1反復が終了する。そして、上の図のようにセルA2の右下コーナーにポインターをおき(+という字にポインターが変形したのを見て、反復の回数をnとしてセルAnまでドラックするとニュートン反復が繰り返される。
このExcelのBookはつぎである(newton.xls)。
問 この方程式は3つ根がある。他の2根をニュートン法で求めてみよ。
他の例
ここで、つぎの方程式の解を求めることを考えよう。
解のだいたいの位置を調べるために関数f(x)のグラフを画いてみよう。
この図から、解はおおよそ3.8付近にあることがわかる。そこで、3.8を初期値としてニュートン法を適用してみる。
である。Excelで解くと
となる。(newton2.xls)
Solverを使って非線形方程式を解く
ExcelにはSolverがあり、準ニュートン法がインプリメントされている。これを使って、非線形方程式を解く方法を説明する。方程式として
を解くことを考える。そのためにSolverを使う。Excelを立ち上げ、次のように打ち込む:
ここで、ツールをクリックしソルバーを選択する。そして、つぎのように目的セルに方程式が書いてあるセルの絶対番地を書き込む。今は$B$2である。また、変化させるセルには初期値が書いてあるセルを選択する。ここでは、$C$2である。また、目標値には値を選択する。
この状態で実行をクリックすると
と解が求まったことが表示され、解が
とセルC2に表示される。すなわち、x=-0.58307が解の近似となる。
ゴールシークを使って非線形方程式を解く
上とまったく同じ方程式をゴールシークを使って解いてみよう。
まず、前と同じように目的の方程式をB2に書き込む。つぎに、ツールをクリックし、更にゴールシークをクリックする。そして、つぎのように値を設定する。
ここでOKをクリックすると
と解が求められる。
腕試しの問題
1.つぎの関数のグラフをExcelで画け。
2.つぎの方程式の根を求めよ。
f(t)=-56.123exp(2.231-0.103t)-73.987t+731.523=0
Excelのweb上の解説
英語での解説
University of South Dakota でのExcelの解説 
(基本的な事柄を丁寧に解説。読まれることを勧める) 
NCSUでのExcelとMapleの解説 
日本語での解説
Excelの基本操作 (表計算ソフトの歴史など参考になる)
&copy;大石進一
2002/9/4(作成)、2002/9/26,27(追加(グラフの画き方)),28(ニュートン法),2002/10/18(修正)
Excelの使い方
