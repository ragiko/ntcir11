【課題】既定の歌唱メロディに合った歌詞の音節数をユーザに対して提示する。【解決手段】歌唱メロディの楽譜情報を入力し(S010)、その楽譜情報に基づき楽曲の区分け構造の解析及び音符の解析を行い、個々の音符ごとに歌唱の容易性に関する各種特徴量を算出する(S110,S120,S210)。算出した特徴量の基づき、個々の音符ごとにその特徴量に応じた複数種類の音節数スコアをそれぞれ算出する(S310)。そして、算出した複数種類の音節数スコアを重み付けパラメータで加重平均化し、整数への丸め処理をすることで、音符単位の歌詞の音節数を算出する(S320)。その算出した各音符の音節数を楽譜情報の演奏順に表示する(S410)。
【発明の詳細な説明】【技術分野】【0001】  本発明は、歌唱メロディに適した歌詞の音節数を提示する技術に関する。【背景技術】【0002】  従来、予め用意された楽曲に歌詞を割当てる場合、楽譜に含まれる音符1つに対して歌詞の音節(syllable)を1つずつ割当てる手法が知られている。例えば、特許文献1では、ガイドメロディを構成する音に対して、音長に応じた歌詞を対応させていく技術が開示されている。この技術では、ガイドメロディの1音に対して、その音長にあった1つのかな文字(1音節)を割当てるようになっている。【0003】  一方、楽曲に対して歌詞の割当てる作業を支援する技術として、特許文献2に記載の歌詞作成装置等が知られている。特許文献2に開示されている技術では、楽譜をピアノロール譜に表示し、音符を示すノートバーに対応する位置に拍数に応じた長さの歌詞の入力セルを表示することで、音符に対応付けて歌詞を割当て易くできるとされている。【先行技術文献】【特許文献】【0004】【特許文献1】特開2008−20621【特許文献2】特開2004−206153【発明の概要】【発明が解決しようとする課題】【0005】  ところで、予め用意された楽曲に対してユーザが作詞をする作業を支援するための装置を提供する場合、特許文献1に記載のように1音につき1音節の歌詞を割当てることしか考慮されていない仕様であると、作詞できる歌詞の音節数がメロディの音符の数に決められてしまうことになる。その結果、音符の数に対して音節数が多い(あるいは少ない)歌詞を割当てることができず、歌詞の表現内容が制限されてしまうといった不便さがある。【0006】  一方、特許文献2に記載の技術によれば、音符の位置に対応付けて歌詞を割当て易くなっているものの、1つの音符につき推奨される歌詞の音節数は提示されておらず、1つの音符に対して歌詞の音節をいくつ割当てるのかはユーザ自らが判断する必要がある。しかしながら、作詞に不慣れなユーザにとってメロディの音符数に完全に一致した音節数の歌詞を作成することは難しく、かといって1つの音符に対して複数の音節を割当てようとしても、どの音符にどれだけの数の音節を割当てれば歌い易い歌詞になるのかを判断することも難しい。また、1音符に対して無暗に多くの音節を割当てしまうことで、メロディに合わない歌唱しづらい歌詞になってしまうことも考えられる。【0007】  本発明は、上記問題を解決するためになされたものであり、既定の歌唱メロディに合った歌詞の音節数をユーザに対して提示するための技術を提供することを目的とする。【課題を解決するための手段】【0008】  上記目的を達成するためになされた本発明の歌詞音節数提示装置は、楽譜分析手段と、音節数算出手段と、提示手段とを備えることを特徴とする。このうち、楽譜分析手段は、歌唱メロディの楽譜情報を分析し、個々の音符ごとに演奏に関する所定の特徴量を特定する。音節数算出手段は、楽譜分析手段により特定した特徴量に基づき、個々の音符ごとにその特徴量に応じた歌詞の音節数をそれぞれ算出する。提示手段は、音節数算出手段により算出した各音符の音節数を、楽譜情報の演奏順にユーザに対して提示する。【0009】  なお、ここでいう音節とは、言語において通常一まとまりの音として意識され、発音される単位のことを指しており、日本語であれば仮名1字が1音節に相当する。  本発明の歌詞音節数提示装置によれば、歌唱メロディの特徴から算出した音符単位の歌詞の音節数をユーザに提示することで、ユーザの作詞作業を支援することができる。これにより、ユーザは、提示された音節数を参考にして歌唱メロディに合った歌詞を作成することができる。特に、音符単位で歌詞の音節数が提示されるため、作詞に不慣れなユーザにとって有力な支援となる。また、楽譜情報から分析した特徴に基づいて、1音符に対して複数の音節を割当てることも可能になり、従来のように1音符につき1音節を割当てるだけの歌詞の割当て方法に比べて、表現力の高い歌詞の作成が可能となる。【0010】  ところで、歌唱メロディの特徴から歌詞の音節数を特定するにあたっては、歌詞の歌い易さを基準にして1音符に割当てる音節数の多少を決定することが考えられる。具体的には、歌唱メロディの中で局所的に歌い易い部分があれば、その部分では1音符につき複数の音節を割当て、歌い難い部分では1音符につき1音節のみを割当てるようにすることで、歌い易い歌詞を作成できる。【0011】  そして、歌唱メロディの局所的な歌い易さは、その歌唱メロディを構成する音符の長さ(時間長)、音符の直前の休符の長さ(時間長)、直前の音符との音高差、あるいは歌唱メロディの区切りの有無といった様々な特徴が関係しているものと考えられる。そこで、歌唱メロディの楽譜情報を分析して、局所的な歌い易さの指標となるこれらの特徴量に基づいて音節数を決定することで、歌唱し易い歌詞の音節数を的確に算出できる。以下、その具体的内容について説明する。【0012】  (音符の時間長に応じて音節数を特定する場合)  歌唱メロディにおいて、音符の時間長が比較的長い箇所であれば、歌詞の発音に要する時間に余裕があるため、歌詞音節が多めに割当てられていても無理なく歌唱できると考えられる。そこで、音符の時間長に関する特徴に基づいて音節数を決定するように構成することで、歌唱し易い歌詞の音節数を的確に算出できる。具体的には、請求項2に記載のように、それぞれの音符の時間長に基づく特徴量を特定し、その特徴量に応じて、時間長が長いほど音節数が大きくなるように、個々の音符ごとに歌詞の音節数を算出するように構成するとよい。【0013】  なお、ここでいう音符の時間長に基づく特徴量とは、例えば、その音符の絶対的な時間長を示す値や、同じ歌唱メロディ内の他の音符との相対的な時間長の比を示す値等、音符の時間長に関する様々な指標を指す。【0014】  また、音符の時間長に基づく特徴量に応じて歌詞の音節数を決定するにあたっては、例えば、前の音符の時間長との比や、その歌唱メロディ内で最長の音符長との比に応じて相対的に決定してもよいし、その音符の絶対的な時間長に比例するように音節数を決定してもよい。【0015】  (音符の直前にある休符の時間長に応じて音節数を特定する場合)  歌唱メロディにおいて、音符と音符の間にある休符の時間長が長い程、前の音符に対応する歌詞を発音してから次の音符に対応する歌詞を発音するまでに時間的な余裕があるため、後の音符に対応する歌詞の発音が容易になっていると考えられる。つまり、音符の直前にある休符の時間長が比較的長い箇所であれば、その音符に歌詞音節が多めに割当てられていても無理なく歌えると考えられる。【0016】  そこで、音符の直前にある休符の時間長に関する特徴に基づいて音節数を決定するように構成することで、歌唱し易い歌詞の音節数を的確に算出できる。具体的には、請求項3に記載のように、それぞれの音符の直前にある休符の時間長に基づく特徴量を特定し、その特徴量に応じて、直前の休符の時間長が長いほど音節数が大きくなるように、個々の音符ごとに歌詞の音節数を算出するように構成するとよい。なお、ここでいう音符の直前にある休符の時間長に基づく特徴量とは、例えば、その休符の時間長を示す値等の指標を指す。【0017】  (直前の音符との音高差に応じて音節数を特定する場合)  歌唱メロディにおいて、連続する音符の間の音高差が大きい箇所では歌唱時に音程を切り換えるのが難しい。そのため、前の音符との音高差が大きい音符に相当する歌詞は歌い難く、そのような箇所に多くの歌詞音節を割当てると結果的に歌い難い歌詞なってしまう。逆に、前の音符との音高差が小さい箇所であれば、その音符に歌詞音節が多めに割当てられていても無理なく歌えると考えられる。【0018】  そこで、直前の音符との音高差に関する特徴に基づいて音節数を決定するように構成することで、歌唱し易い歌詞の音節数を的確に算出できる。具体的には、請求項4に記載のように、それぞれの音符の直前にある音符との音高差に基づく特徴量を特定し、その特徴量に応じて、直前の音符との音高差が小さいほど音節数が大きくなるように、個々の音符ごとに歌詞の音節数を算出するように構成するとよい。なお、ここでいう直前にある音符との音高差に基づく特徴量とは、例えば、その音符の直前にある音符との音高の差を示す値等の指標を指す。【0019】  (歌唱メロディの区分け構造に応じて音節数を特定する場合)  日本の歌謡曲等では、いわゆるAメロ、Bメロ、サビといった具合に、1つの楽曲が複数の区間のメロディに分けられている構造を持つものが多い。このような区分け構造を持つ楽曲の場合、各区間の間には歌唱の伴わない間奏が挟まれていることが多い。また、1つの区間内にも、演出上歌唱の伴わない間奏時間が挿入されることもある。このように、楽曲において歌唱の伴わない間奏時間がある場合、歌唱パートのメロディにおいてはその間奏時間は長い休符区間となる。【0020】  歌唱メロディにおいて、区分け構造に係る長い休符区間(間奏区間)がある場合、休符区間開けの最初の音符については、歌詞を発音する事前に十分な準備期間があるため、歌詞の発音が容易になっていると考えられる。また、区分け構造に係る長い休符区間が始まる直前の音符については、次に発声をするまでに時間が空いているため、歌詞の発音が容易になっていると考えられる。つまり、間奏に相当するような十分に長い休符区間の直前や直後にある音符であれば、歌詞音節が多めに割当てられていても無理なく歌えると考えられる。【0021】  そこで、歌唱メロディの区分け構造に関する特徴に基づいて音節数を決定するように構成することで、歌唱し易い歌詞の音節数を的確に算出できる。具体的には、請求項5に記載のように、歌唱メロディを特定の休符区間ごとに区切ったメロディ区間に区分けして、各メロディ区間を特定するための情報を特徴量として特定し、その特徴量に応じて、各メロディ区間の最初又は最後の少なくとも何れかの音符に所定の音節数加算分を計上して、個々の音符ごとの歌詞の音節数を算出するように構成するとよい。【0022】  (複数の音節数算出方法から総合的に決定する場合)  以上までで、音符の長さ、音符の直前の休符の長さ、直前の音符との音高差、及び歌唱メロディの区切りの有無といった、それぞれ異なる特徴量を用いて歌詞の音節数を算出する事例について説明した。これらの各種特徴量は内容こそ違うものの、歌唱メロディの局所的な歌い易さを示す指標であることについては共通しているため、これら複数の特徴量に基づいてそれぞれ算出した音節数指標(この値が大きいほど割当てる音節数が大きくなるという指標)から、最終的にユーザに対して提示する音節数を複合的に決定するように構成してもよい(請求項6)。【0023】  なお、請求項6に記載の(a)〜(d)の各特徴量については、全てを採用して複合的な音節数を特定してもよいし、一部(2つ以上であればよい)のみを採用して複合的な音節数を特定してもよい。また、1つの音符について異なる特徴量に基づいて複数算出した音節数指標に対しては、所定の重み係数を加味して加重平均値を算出してやればよい。このとき、より重要な特徴量に基づいて算出された音節数指標に対しては、より大きな重み係数を割当てるようになっているとよい。【0024】  さらに、請求項7に記載のように、音節数指標の加重平均の算出に用いる重み係数をユーザが指定できるようになっていると、ユーザの作詞意図に沿った音節数を提示できるようになり好適である。【0025】  つぎに、請求項8に記載の歌詞音節数提示装置は、歌唱メロディの楽譜情報に基づいて楽譜を表示すると共に、その表示した楽譜の各音符に対応付けて、それぞれの音符に対して算出された歌詞の音節数を表示する。このように構成することで、出力結果を見るユーザにとって、楽譜の音符とその音符に割当てられた歌詞の音節数との対応付けが一目瞭然となり、便利である。【0026】  なお、本発明は、コンピュータに実行させるプログラムとして構成されたものであってもよい。その場合、本発明のプログラムは、歌唱メロディの楽譜情報を分析し、個々の音符ごとに演奏に関する所定の特徴量を特定する楽譜分析手順と、楽譜分析手順で特定した特徴量に基づき、個々の音符ごとにその特徴量に応じた歌詞の音節数をそれぞれ算出する音節数算出手順と、音節数算出手順で算出した各音符の音節数を、楽譜情報による演奏順にユーザに対して提示する提示手順とをコンピュータに実行させるような構成になっていればよい(請求項9)。【0027】  このように構成されたプログラムを様々な記憶媒体に記録し、これをコンピュータ装置で実行させることで、そのコンピュータ装置を請求項1に記載の歌詞音節数提示装置として機能させることができる。【図面の簡単な説明】【0028】【図1】歌詞音節数提示装置の概略構成を示すブロック図である。【図2】音節数提示処理の手順を示すフローチャートである。【図3】歌唱メロディの構成を示す説明図である。【図4】音符に付与した区間フラグの系列を示す説明図である。【図5】歌詞音節数の表示例1,2を示す説明図である。【図6】歌詞音節数の表示例3を示す説明図である。【図7】歌詞音節数の表示例4を示す説明図である。【発明を実施するための形態】【0029】  以下、本発明の一実施形態を図面に基づいて説明する。  ［歌詞音節数提示装置の構成の説明］  まず、実施形態の歌詞音節数提示装置1の概略構成について、図1を参照しながら説明する。歌詞音節数提示装置1は、記憶部11と、メロディデータ入力部12と、表示部13と、操作受付部14と、制御部15とを備えている。【0030】  記憶部11は、歌詞音節数提示装置1が動作するために必要な各種データやプログラムを記憶するための記憶装置(例えば、ハードディスクドライブ)である。メロディデータ入力部12は、歌詞音節数提示装置1による処理対象となる歌唱メロディの楽譜情報を制御部15へ入力するための入力インタフェースである。具体的には、歌唱メロディの楽譜情報を記憶した可搬型記憶媒体(例えば、光ディスクやフラッシュメモリ等)からデータを読み取る入力装置や、ネットワークを介して通信可能に接続された外部の情報処理装置から歌唱メロディの楽譜情報をダウンロードする入力装置等で構成される。【0031】  表示部13は、ユーザに対して画像により情報を提示するための表示装置であり、例えば液晶ディスプレイ等が用いられる。操作受付部14は、ユーザからの指示を入力するための入力装置であり、例えば、キーボードやポインティングデバイス等が用いられる。【0032】  制御部15は、ROM15a、RAM15b、CPU15c及びこれらの構成を接続するバスライン等を中心に構成されたコンピュータ装置であり、ROM15aや記憶部11に記憶されたプログラムに従って各種演算処理を行い、歌詞音節数提示装置1の各部構成を制御する。本実施形態では、制御部15は、メロディデータ入力部12を介して入力された歌詞メロディの楽譜情報を分析し、その分析結果に基づいて推奨する歌詞の音節数を音符単位で算出し、その算出結果を表示部13に表示する処理(以下、音節数提示処理と称する)を実行する。この音節数提示処理の詳細な内容については後述する。【0033】  ［音節数提示処理の説明］  つぎに、制御部15が実行する音節数提示処理の手順について、図2のフローチャートに基づいて説明する。【0034】  制御部15は、まず、音節数提示処理による処理対象となる歌唱メロディの楽譜情報を読み込み、歌唱メロディの分析に必要な各種データを取得する(S010)。  なお、本実施形態では、処理対象とする楽譜情報としてMIDI(Musical Instrument Digital Interface)形式のデータを想定している。MIDI形式の楽譜情報では、楽曲のメロディ(ここでは、歌唱パートのメロディ)を形成する各構成音の音符として、それぞれの音高(ノートナンバー)及び時間長が示されている。音符の時間長(以下、音符長とも称する)は、楽音出力開始(Note-on)タイミングと楽音出力終了(Note-off)タイミングとによって表される。なお、Note-onタイミングは、楽曲の演奏開始からその音の出力が開始するまでの時間であり、Note-offタイミングは、楽曲の演奏開始からその音の出力が終了するまでの時間である。【0035】  また、本実施形態では、処理対象の歌唱メロディが所定の規則性を持った区分け構造を有することを想定している。具体的には、図3(a)に示すとおり、楽曲の開始から終了までに、Aメロ,Bメロ、サビ1,2といったメロディ区間が何度か繰り返されるようになっている。ちなみに、このような演奏形式は、多少のバリエーションを含め、日本の歌謡曲等において多く見られる。【0036】  本実施形態では、上述のAメロ,Bメロ、サビ1,2といった楽曲全体を区分けした大局構造を大区間と定義する。一般的に、大区間同士の間は歌唱を伴わない間奏期間になっており、この間奏期間は歌唱メロディにおいては無音区間となっている。【0037】  さらに、図3(b)に示すように、1つの大区間が複数の小規模のメロディ区間に区分けされている構成も想定している。本実施形態では、大区間を更に区分けした小規模の音符群を小区間と定義する。小区間同士の間には、大区間の間にある間奏区間より小規模な間奏期間があり、この間奏期間は歌唱メロディにおいては無音区間となっている。【0038】  図3(c)は、歌唱メロディの小区間内における楽譜情報を、ピアノロール形式で模式的に表したものである。このピアノロール譜は、縦軸がピアノの鍵盤に見立てた音階を表し、横軸が時間を表し、音符をその時間長に応じた長さを持つノートバーで表す表示形式である。【0039】  図3(c)に示すとおり、楽譜情報における各音符には、演奏順序を示すインデックス番号kが割当てられている。kは、楽曲の最初の音符から順に全ての音符に割当てられた順序数｛1,2,3,…,K0(K0は楽曲の全音符数)｝を示す変数である。また、インデックス番号kに該当する音符のノートナンバー(音高)をNN(k)、Note-onタイミングをON(k)、Note-offタイミングをOFF(k)とする。【0040】  すなわち、音節数提示処理のS010では、歌唱メロディの楽譜情報(MIDIデータ)から、各音符のノートナンバーNN(k)、Note-onタイミングON(k)、Note-offタイミングOFF(k)のデータを取得する。【0041】  図2のフローチャートの説明に戻る。つぎに、S010で取得したノートナンバーNN(k)、Note-onタイミングON(k)、Note-offタイミングOFF(k)のデータに基づき、(1)の曲構造解析block及び(2)の音符解析blockの各ブロックで歌唱メロディの特徴を解析し、その解析結果に基づいて、(3)の音節数推定blockで音符ごとに推奨する歌詞の音節数を算出する。以下、上記(1)〜(3)の各blockの処理内容について説明する。【0042】  (1)曲構造解析blockについて  (1−1)大区間推定  S110では、歌唱メロディにおける大区間の区分け構造を特定する。それには、まず、隣接する2つの音符のNote-onタイミング及びNote-offタイミングから、各音符の隣接無音時間長NML(k)を次式により算出する。NML(k)=ON(k)−OFF(k−1)  隣接無音時間長NML(k)は、直前の音符の出力が終了してから次の音符の出力が開始するまでの無音時間(すなわち、休符期間)を示す値である。このNML(k)のヒストグラムを用いて、隣接無音時間長が所定の下限値より大きい特大領域を特定する。このとき、下限値の特定する方法は、NML(k)の大きい方から極小点を見つける方法でもよいし、ヒストグラムの2次微分を計算し、1次微分の変曲点を見つける方法でもよい。【0043】  特定した特大領域に該当するNML(k)のインデックス番号kを用いて、大区間開始フラグLPS(k)及び大区間終了フラグLPE(k)を、次式のように設定する。LPS(k)=1LPE(k−1)=1  また、極大領域に該当するインデックス番号k以外については、LPS(k)及びLPE(k)を、次式のように設定する。LPS(k)=0LPE(k−1)=0  なお、Aメロ、Bメロ、サビ等の大局構造を定義したメタデータが楽譜情報に付属する場合や、楽譜情報自体に大局構造が定義されている場合、そこで定義されている大局構造に従って各音符に対応する大区間開始フラグ及び大区間終了の値をセットすればよい。【0044】  (1−2)小区間推定  つぎに、S120では、歌唱メロディにおける小区間の区分け構造を特定する。まず、S110の大区間推定(1−1)で計算した隣接無音時間長NML(k)のヒストグラムにおいて、隣接無音時間長が中程度の領域(S110で特定した特大領域を除いた領域のうち、所定の下限値より大きい領域)を特定する。このとき、下限値の特定する方法は、NML(k)の大きい方から極小点を見つける方法でもよいし、ヒストグラムの2次微分を計算し、1次微分の変曲点を見つける方法でもよい。【0045】  特定した中程度領域に該当するNML(k)のインデックス番号kを用いて、小区間開始フラグSPS(k)及び小区間終了フラグSPE(k)を、次式のように設定する。SPS(k)=1SPE(k−1)=1  なお、LPS(k)=1又はLPE(k)=1となっている音符、すなわち、大区間の最初と最後に該当の音符に対しても、それぞれ、SPS(k)=1及びSPE(k)=1をセットする。【0046】  中程度領域に該当するインデックス番号k以外については、SPS(k)及びSPE(k)を、次式のように設定する。SPS(k)=0SPE(k−1)=0  なお、Aメロ、Bメロ、サビ等の大局構造内をさらに区分けした音符群(小区間)を定義したメタデータが楽譜情報に付属する場合や、楽譜情報自体に小区間が定義されている場合、そこで定義されている小区間に従って各音符に対応する小区間開始フラグ及び小区間終了フラグの値をセットすればよい。【0047】  図4は、S110及びS120で各音符に対して設定した区間フラグの系列を示す説明図である。この図に示すとおり、各インデックス番号kに対応する音符ごとに、LPS(k),LPE(k),SPS(k),SPE(k)の各区間フラグにそれぞれ値が設定されている。具体的には、大区間開始位置(インデックス番号1,39)では、LPS(k)が1に設定されている。また、小区間開始位置(インデックス番号1,9,20,28,39)では、SPS(k)が1に設定されている。小区間終了位置(インデックス番号8,19,27,38,44)では、SPE(k)が1に設定されている。また、大区間終了位置(インデックス番号38)では、LPE(k)が1に設定されている。なお、インデックス番号1,39の音符は、大区間開始位置と小区間開始位置の両方に該当しているので、LPS(k)及びSPS(k)が共に1に設定されている。また、インデックス番号38の音符は、大区間終了位置と小区間終了位置の両方に該当しているので、LPE(k)及びSPE(k)が共に1に設定されている。【0048】  (2)音符解析blockについて  図2のフローチャートの説明に戻る。S210では、音符のNote-onタイミング、Note-offタイミング及びノートナンバーから、個々の音符について演奏に関する複数種類の特徴量を特定する。演奏に関する特徴量には、音高差NND(k)、音符長NL(k)、音符長比NLR(k)、休符長RL(k)、最大音符長MNL、及び最大音高差MNNDの6種類がある。これらの特徴量を次式のように計算する。【0049】【数1】【0050】なお、max(n)は、変数nの系列の最大値を抽出する関数である。  NND(k)は、直前の音符との音高差を示す値である。NL(k)は、個々の音符の音符長を示す値である。NLR(k)は、直前の音符に対する音符長の比を示す値である。RL(k)は、音符の直前にある無音時間(すなわち、休符長)を示す値である。MNLは、全ての音符における音符長の最大値を示す値である。MNNDは、全ての音符における音高差の最大値を示す値である。【0051】  (3)音節数推定blockについて  (3−1)音節数スコアリング  つぎに、S310では、S110,S120,S210の各ステップで算出したフラグ及び特徴量に基づいて、個々の音符について複数種類の音節数スコア(この値が大きいほど割当てる音節数が大きくなるという指標)を算出する。音節数スコアには、音符長スコアNLSC(k)、休符長スコアRLSC(k)、音高差スコアNDSC(k)、及び構成スコアCSC(k)の4種類がある。これらの音節数スコアを次式のように計算する。【0052】【数2】【0053】なお、a,bはそれぞれ0<a<1,0<b<1の条件を満たす任意の値とする。  NLSC(k)は、音符長に応じた音節数スコアである。具体的には、最大音符長に対する音符長の比や直前の音符に対する音符長の比に応じて音節数スコアの加算分が計上される。つまり、音符長が長いほど音節数が大きくなるように計算される。【0054】  RLSC(k)は、音符の直前の休符長に応じた音節数スコアである。具体的には、最大音符長に対する休符長の比に応じて音節数スコアの加算分が計上される。つまり、直前の休符長が長いほど音節数が大きくなるように計算される。ただし、音符が大区間の開始位置に該当する場合(すなわち、LPS(k)=1のとき)、休符長に応じた音節数スコアの加算分はキャンセルされる。これは、大区間の開始位置に該当する音符の音節数スコアは別途計算されるためである。【0055】  NDSC(k)は、直前の音符との音高差に応じた音節数スコアである。具体的には、最大音高差に対する音高差の比に応じて音節数スコアの加算分が計上される。つまり、直前の音符との音高差が小さいほど音節数が大きくなるように計算される。ただし、音符が大区間の開始位置に該当する場合(すなわち、LPS(k)=1のとき)、音高差に応じた音節数スコアの加算はキャンセルされる。これは、直前の音符との間に長い間奏(無音)区間を挟む場合、直前の音符との音高差は歌唱の容易性に影響しないためである。【0056】  CSC(k)は、歌唱メロディの区分け構造(大区間、小区間)に応じた音節数スコアである。具体的には、音符が大区間の開始位置又は終了位置に該当する場合、あるいは小区間の開始位置又は終了位置に該当する場合、音節数スコアの加算分が計上される。つまり、大区間及び小区間の最初と最後の音符は音節数が大きくなるように計算される。【0057】  (3−2)音節数算出  つぎに、S320では、S310で算出した各音節数スコアに基づいて各音符に割当てる歌詞の音節数PN(k)を算出する。なお、音節数の算出に先がけ、操作受付部14を介してユーザから重み付けパラメータUP=｛α1,α2,α3,α4｝の設定するための指示を受け付けておく(S330)。この重み付けパラメータUPは、4種類の音節数スコアに対する重み付け(どの音節数スコアをどの程度重視するか)を定義する値であり、より重視する音節数スコアの重み付けパラメータを大きくすることで、音節数の算出結果におけるその音節数スコアの関与度合いを高めることができる。各音符に対応する音節数PN(k)を次式のように計算する。【0058】【数3】【0059】なお、round(n)は、変数nの整数への丸め関数である。最も一般的な例では、小数点以下の数値を四捨五入する端数処理が上げられるが、これに限らず、小数点以下の数値を切り上げするか切り捨てするかの境界については、設計者あるいはユーザの意図に応じて様々な値を採用できる。【0060】  音節数PN(k)は、4種類の音節数スコアに対して重み付けパラメータUPを加味して加重平均化し、それを整数に端数処理した値である。なお、重み付けパラメータUPの各値α1,α2,α3,α4を全て同じ値に設定することで、単純な相加平均にすることができる。【0061】  なお、本実施形態では、4種類の音節数スコア(音符長スコア、休符長スコア、音高差スコア、構成スコア)の加重平均をとって複合的な音節数を決定する事例について説明したが、これより少ない種類(2〜3種類)の音節数スコアから複合的な音節数を算出する構成であってもよい。【0062】  S320で算出された音節数PN(k)の系列は、(4)の表示インタフェース処理に提供される(S340)。  (4)表示インタフェースについて  つぎに、S410では、S320で算出された音符単位の歌詞の音節数を表示部13に表示する。具体的には、音節数を文字(テキスト)情報のみで表示してもよいし、楽譜情報(例えばピアノロール譜)と複合させてグラフィカルに表示してもよい。【0063】  表示インタフェースの処理内容の一例として、次のようなプログラムの制御構文を示す。【0064】【数4】【0065】上記の制御構文によれば、音符のインデックス番号順に音符単位の歌詞の音節数を同数の「〇」文字の羅列で表すことができる。また、音符間の区切りにはスペース(空白)が挿入されると共に、小区間の区切りでは改行、大区間の区切りでは空行が挿入されるようになっている。【0066】  図5(a)は、歌詞の音節数を「〇」文字の数で表すテキスト形式の音節数表示例1を示す説明図である。この音節数表示例1では、1行につき1小区間単位の音節数がまとめて表示され、小区間ごとに改行される。なお、この事例では音符間の区切りは入れられていない。大区間の区切りには1行分の空行が挿入され、大区間ごとの音節数のまとまりを視認できるようになっている。さらに、小区間ごとに音節数を小計した数値をその行の先頭(あるいは後尾でもよい)に表示するようにしてもよい。【0067】  図5(b)は、歌詞の音節数を「〇」文字の数で表すテキスト形式の音節数表示例2を示す説明図である。この音節数表示例2における上記音節数表示例1との違いは、音符単位の音節数を出力するごとにスペースが挿入され、音符ごとの音節数のまとまりを視認できるようになっていることである。なお、音符間の区切りには、スペース以外に「‐(ハイフン)」等の記号を用いてもよい。さらに、音符単位の音節数(数値)の系列をその行の先頭(あるいは後尾でもよい)に表示するようにしてもよい。このとき、音符間の区切りにはスペースやハイフンを用いるとよい。【0068】  図6(a)は、歌詞の音節数を楽譜(ピアノロール譜)の音符に対応付けて表示するビジュアル形式の音節数表示例3を示す説明図である。この音節数表示例3では、歌唱メロディの楽譜情報に基づいてピアノロール譜が表示され、そのピアノロール譜に配置された音符(ノートバー)に音節数(数値)が重畳して表示されている。【0069】  さらに、この音節数表示例3は、歌詞を入力するためのユーザインタフェースの機能を兼ね備えている。そのため、歌詞の音節数が表示されたピアノロール譜の下方に、ユーザが歌詞のテキストを記入するための歌詞入力ボックスが設けられている。この歌詞入力ボックスは、ピアノロール譜の音符の並びと対応する位置にそれぞれ配置され、対応する音符のノートバーと同じ幅を持っている。さらに、個々の歌詞入力ボックスには対応する音符に割当てられた音節の数と同数の「〇」文字が最初から記入されている。ユーザが操作受付部14を用いて歌詞入力ボックスを選択し、所望の文字を入力することで、その歌詞入力ボックスに対して歌詞を入力できるようになっている。【0070】  図6(b)は、歌詞入力例を示す説明図である。この図に示すとおり、ユーザの操作によって歌詞が入力済みとなった歌詞入力ボックスでは、入力された文字数に応じてその歌詞入力ボックス内の「〇」文字が入力された文字に書き換わるようになっている。【0071】  図7(a)は、歌詞の音節数を楽譜(ピアノロール譜)の音符に対応付けて表示するビジュアル形式の音節数表示例4を示す説明図である。この音節数表示例4における上記音節数表示例3との違いは、ピアノロール譜に配置されている音符のノートバーが、歌詞の文字を入力するための歌詞入力ボックスを兼ねている点と、1つのノートバーを割当てられた音節数に応じて仕切ることで歌詞の音節数を提示している点である。例えば、1音符につき1音節が割当てられた音符については、ピアノロール譜上のノートバーは仕切られておらず、これで1文字分の歌詞入力ボックスを形成している。一方、1音符につき2音節が割当てられた音符については、ピアノロール譜上のノートバーが中央で2つに仕切られ、これで2文字分の歌詞入力ボックスを形成している。ユーザが操作受付部14を用いてピアノロール譜に配置された音符兼歌詞入力ボックスを選択し、所望の文字を入力することで、その音符兼歌詞入力ボックスに対して歌詞を入力できるようになっている。【0072】  図7(b)は、歌詞入力例を示す説明図である。この図に示すとおり、ユーザの操作によって歌詞が入力された音符兼歌詞入力ボックスでは、入力された文字が個々の歌詞入力ボックスに1文字ずつ記入されるようになっている。【0073】  ［実施形態に記載の構成と特許請求の範囲に記載の構成との対応］  ここで、実施形態の歌詞音節数提示装置1の各部構成と、特許請求の範囲に記載の構成との対応について説明する。【0074】  実施形態の制御部15が、特許請求の範囲における楽譜分析手段、音節数算出手段、及び提示手段に相当する。より詳しくは、制御部15が実行する音節数提示処理(図2参照)におけるS110の大区間推定、S120の小区間推定、及びS210の音符解析の処理が、楽譜分析手段に相当する。また、S310の音節数スコアリング及びS320の音節数算出の処理が、音節数算出手段に相当する。また、S410の表示インタフェースの処理が提示手段に相当する。【0075】  また、実施形態の操作受付部14が、特許請求の範囲における指定手段に相当する。  ［効果］  実施形態の歌詞音節数提示装置1によれば、下記の効果を奏する。【0076】  歌唱メロディの楽譜情報から歌唱の容易性に関する特徴量(区分け構造、音符解析)を抽出し、その特徴量に基づいて算出した音符単位の歌詞の音節数を表示することで、ユーザの作詞作業を支援することができる。これにより、ユーザは、表示された音節数を参考にして歌唱メロディに合った歌詞を作成することができる。特に、音符単位で歌詞の音節数を提示可能なため、作詞に不慣れなユーザにとって有力な支援となる。また、1音符に対して複数の音節を割当てることも可能になり、表現力の高い歌詞の作成を期待できる。【0077】  歌唱メロディを構成する音符長や、音符の直前の休符長、直前の音符との音高差、歌唱メロディの区切りの有無といった、歌唱メロディの局所的な歌唱の容易性に影響を与える特徴量に基づき、歌い易い特徴を呈する音符に対してより多くの音節を割当てるように構成したことで、提示された音節数に基づいて歌い易い歌詞の作成を期待できる。【0078】  複数種類の音節数指標(音符長スコア、休符長スコア、音高差スコア、構成スコア)を重み付けパラメータで加重平均化して複合的な音節数を算出することが可能である。また、重み付けパラメータUPをユーザが指定できるよう構成したことで、ユーザの作詞意図に沿った音節数を提示できる。【0079】  楽譜情報に基づいてピアノロール譜を表示すると共に、そのピアノロール譜上の音符に対応付けて歌詞の音節数を表示可能としたことで(図6,7)、楽譜の音符とその音符に割当てられた歌詞の音節数との対応付けが一目瞭然となる。【0080】  ［変形例］  以上、本発明の実施形態について説明したが、本発明は上記の実施形態に何ら限定されるものではなく様々な態様にて実施することが可能である。【0081】  上記実施形態では、音符長スコアNLSC、休符長スコアRLSC、音高差スコアNDSC、構成スコアCSCといった4種類の音節数指標を重み付けパラメータで加重平均化した後、端数処理をして複合的な音節数を算出する構成となっている。これに限らず、音符長スコアNLSC、休符長スコアRLSC、音高差スコアNDSC、構成スコアCSCを個別に端数処理をして、それぞれ単独の音節数として出力するような構成であってもよい。すなわち、音符長スコアだけを考慮した音節数や、休符長スコアだけを考慮した音節数を単独でユーザに提示するような構成が考えられる。また、どの音節数指標を用いて音節数を算出するかをユーザが選択可能な構成であってもよい。【0082】  上記実施形態では、主に音符単位での局所的な歌い易さを考慮して音符ごとの歌詞音節数を特定する構成となっている。これに対し、音符単位での局所的な歌い易さに加え、更にメロディ区間単位(例えば、小区間又は大区間単位)での歌い易さを加味して音節数を特定するような構成であってもよい。具体的には、音符解析blockにより特定した音符の特徴量に基づき、個々のメロディ区間にそれぞれ属する音符の特徴量の統計的特徴に応じたメロディ区間単位の音節数倍率(メロディ区間単位での歌唱の容易性を示す指標)を算出し、その音節数倍率を各メロディ区間に属する音符に割当てられた音節数指標に乗じ、その結果を音節数として特定すればよい。メロディ区間単位の音節数倍率は、メロディ区間内における平均音符長や平均休符長が長い、あるいは平均音高差が小さいといった具合に、メロディ区間単位で歌い易い特徴を呈する場合に、その数値を高く設定することが考えられる。【0083】  図6(a),7(a)の音節数表示例3,4において、ユーザからの操作によって、画面上に表示されたピアノロール譜上の音符に対して音高を変更したり音符長を変更したりといった具合に、改変を行えるように構成してもよい。そのとき、改変された音符に係る特徴量の変化に応じて、制御部15がその音符の音節数を内部処理で再計算し、表示中の画面上で当該音符の音節数をリアルタイムに更新するようにしてもよい。【符号の説明】【0084】  1…歌詞音節数提示装置、11…記憶部、12…メロディデータ入力部、13…表示部、14…操作受付部、15…制御部、15a…ROM、15b…RAM、15c…CPU。
【特許請求の範囲】【請求項1】  歌唱メロディの楽譜情報を分析し、個々の音符ごとに演奏に関する所定の特徴量を特定する楽譜分析手段と、  前記楽譜分析手段により特定した特徴量に基づき、個々の音符ごとにその特徴量に応じた歌詞の音節数をそれぞれ算出する音節数算出手段と、  前記音節数算出手段により算出した各音符の音節数を、前記楽譜情報の演奏順にユーザに対して提示する提示手段とを備えること  を特徴とする歌詞音節数提示装置。【請求項2】  請求項1に記載の歌詞音節数提示装置において、  前記楽譜分析手段は、それぞれの音符の時間長に基づく特徴量を特定し、  前記音節数算出手段は、前記音符の時間長に基づく特徴量に応じて、その時間長が長いほど音節数が大きくなるように、個々の音符ごとに歌詞の音節数を算出すること  を特徴とする歌詞音節数提示装置。【請求項3】  請求項1に記載の貸し音節数提示装置において、  前記楽譜分析手段は、それぞれの音符の直前にある休符の時間長に基づく特徴量を特定し、  前記音節数算出手段は、前記休符の時間長に基づく特徴量に応じて、直前の休符の時間長が長いほど音節数が大きくなるように、個々の音符ごとに歌詞の音節数を算出すること  を特徴とする歌詞音節数提示装置。【請求項4】  請求項1に記載の歌詞音節数提示装置において、  前記楽譜分析手段は、それぞれの音符の直前にある音符との音高差に基づく特徴量を特定し、  前記音節数算出手段は、前記音高差に基づく特徴量に応じて、直前の音符との音高差が小さいほど音節数が大きくなるように、個々の音符ごとに歌詞の音節数を算出すること  を特徴とする歌詞音節数提示装置。【請求項5】  請求項1に記載の歌詞音節数提示装置において、  前記楽譜分析手段は、歌唱メロディを特定の休符区間ごとに区切ったメロディ区間に区分けし、各メロディ区間を特定するための情報を前記特徴量として特定し、  前記音節数算出手段は、前記メロディ区間に基づく特徴量に応じて、各メロディ区間の最初又は最後の少なくとも何れかの音符に所定の音節数加算分を計上して、個々の音符ごとの歌詞の音節数を算出すること  を特徴とする歌詞音節数提示装置。【請求項6】  さらに下記の特徴を有する請求項1に記載の歌詞音節数提示装置。  前記楽譜分析手段は、個々の音符に対して、下記(a)〜(d)の特徴量のうちの少なくとも2つ以上の特徴量を特定する。  (a)その音符の時間長に基づく特徴量。  (b)その音符の直前にある休符の時間長に基づく特徴量。  (c)その音符の直前にある音符との音高差に基づく特徴量。  (d)歌唱メロディを特定の休符区間ごとに区切ったメロディ区間を特定するための特徴量。  前記音節数算出手段は、上記(a)〜(d)の特徴量にそれぞれ対応する下記(A)〜(D)の音節数算出方法のうち、前記楽譜分析手段で特定された複数の特徴量にそれぞれ対応する音節数算出方法で歌詞の音節数指標を算出し、1つの音符について複数算出された音節数指標に対して所定の重み係数を加味して加重平均化した複合音節数指標を算出し、その算出した複合音節数指標を整数に端数処理した複合的な音節数を算出して、その複合的な音節数を当該音符の歌詞の音節数として出力する。  (A)音符の時間長に基づく特徴量(a)に応じて、その時間長が長いほど音節数が大きくなるように、個々の音符ごとに音節数指標を算出する。  (B)休符の時間長に基づく特徴量(b)に応じて、直前の休符の時間長が長いほど多くの音節を割当てるように、個々の音符ごとに音節数指標を算出する。  (C)音高差に基づく特徴量(c)に応じて、直前の音符との音高差が小さいほど音節数が大きくなるように、個々の音符ごとに音節数指標を算出する。  (D)メロディ区間に基づく特徴量(d)に応じて、各メロディ区間の最初又は最後の少なくとも何れかの音符に所定の音節数を加算して、個々の音符ごとの歌詞の音節数指標を算出する。【請求項7】  請求項6に記載の歌詞音節数提示装置において、  前記音節数算出手段が前記加重平均の算出に用いる重み係数をユーザが指定するための指定手段を更に備えること  を特徴とする歌詞音節数提示装置。【請求項8】  請求項1ないし請求項7の何れか1項に記載の歌詞音節数提示装置において、  前記提示手段は、前記歌唱メロディの楽譜情報に基づいて楽譜を表示すると共に、その表示した楽譜の各音符に対応付けて、それぞれの音符に対して算出された歌詞の音節数を表示すること  を特徴とする歌詞音節数提示装置。【請求項9】  歌唱メロディの楽譜情報を分析し、個々の音符ごとに演奏に関する所定の特徴量を特定する楽譜分析手順と、  前記楽譜分析手順で特定した特徴量に基づき、個々の音符ごとにその特徴量に応じた歌詞の音節数をそれぞれ算出する音節数算出手順と、  前記音節数算出手順で算出した各音符の音節数を、前記楽譜情報による演奏順にユーザに対して提示する提示手順とを  コンピュータに実行させることを特徴とするプログラム。
歌詞音節数提示装置及びプログラム
