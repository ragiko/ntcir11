A new node (Nx) intercepts encrypted packets (SP1a, SP2b, SP3c), extracts addresses for intercept source nodes (N1a, N2b, N3c), and sends a packet (PN) to a management server (101) via a mobile terminal (MT). The management server (101) extracts the addresses for the intercept source nodes (N1a, N2b, N3c) contained in the packet (PN) from the new node (Nx). The management server (101) specifies gateway addresses associated with the addresses for the intercept source nodes (N1a, N2b, N3c) from a node database (120), selects an encryption key (K3) to be set to the new node (Nx) from among encryption keys (K1-K3) associated with the specified gateways (G1-G3), and sends same to the new node (Nx) via the mobile terminal (MT). The new node (Nx) sets the selected key (K3) as the key to encrypt the packet or decode the encrypted packet.
複数のアドホックネットワークのうち通信圏内にあるアドホックネットワーク群からのパケットを受信可能なノードが実行する鍵設定方法であって、 A key setting method can receive node performs packet from the ad hoc network the group in the communication range of an ad hoc network multiple  前記アドホックネットワーク群の各アドホックネットワーク内の前記ノードの通信圏内にある各近隣ノードから、前記各アドホックネットワーク内のゲートウェイ固有の鍵を用いて暗号化された暗号化パケットを受信するパケット受信工程と、 From each neighbor in the communication range of the node for each ad-hoc network of the ad hoc network groups, and the packet receiving step of receiving the encrypted packet is encrypted using a key gateway-specific of each ad hoc network,  前記パケット受信工程によって前記各近隣ノードから受信された暗号化パケット群の各々の暗号化パケットの中から前記各近隣ノードのアドレスを抽出する抽出工程と、 An extraction step of extracting an address of the respective neighboring nodes from the encrypted packets of each encrypted packet group received from each neighbor by said packet receiving step,  前記複数のアドホックネットワークの各アドホックネットワーク内のゲートウェイ固有の鍵、ノード数および前記各アドホックネットワーク内の各ノードのアドレスを保持するサーバと通信可能な携帯端末との接続を検知する検知工程と、 Key gateway-specific in each ad hoc network in ad hoc networks of the plurality of nodes and a detection step of detecting a connection with the mobile terminal capable of communicating with a server that holds the address of each node of each of the ad-hoc network,  前記検知工程によって前記携帯端末との接続が検知された場合、前記携帯端末を介して、前記抽出工程によって抽出された前記各近隣ノードのアドレスを含むパケットを前記サーバに送信するパケット送信工程と、 When the connection with the mobile terminal is detected by said detection step, a packet transmission process via the mobile terminal, transmits to the server a packet containing the address of the each neighbor node is extracted by the extraction step,  前記パケット送信工程によって送信されたパケットから得られる前記各近隣ノードのアドレスから特定された前記各ゲートウェイが属する前記アドホックネットワーク群のうち、前記ノード数が最大ではないいずれかのアドホックネットワーク内のゲートウェイ固有の鍵を、前記携帯端末を介して、前記サーバから受信する鍵受信工程と、 Out of the ad hoc network the group each gateway identified from the address of the each neighbor node obtained from the packets transmitted by the packet transmission step belongs, gateway-specific ad hoc network either the number of nodes is not a maximum a key reception step through the mobile terminal, receiving from the server, the key,  前記鍵受信工程によって受信された鍵を、前記いずれかのアドホックネットワーク内でマルチホップ通信させるパケットを暗号化するための鍵に設定する設定工程と、 A setting step of setting keys for encrypting the packets to be multi-hop ad-hoc communications network of any of the foregoing, the keys that have been received by the key reception step,  を含むことを特徴とする鍵設定方法。 The key setting method which is characterized in that it comprises. 
前記複数の暗号化パケットを、前記設定工程によって設定された鍵で復号する復号工程と、 A decoding step for decoding the key that is set by the setting step, an encrypted packet of the plurality,  前記復号工程による復号結果を出力する出力工程と、 An output step of outputting the decoded result by the decoding step,  を含むことを特徴とする請求項１に記載の鍵設定方法。 The key setting method as claimed in claim 1, characterized in that it comprises. 
複数のアドホックネットワークで構成されるネットワークシステムの中の各アドホックネットワーク内のゲートウェイごとにゲートウェイ固有の鍵および配下のノード数を関連付けた第１のデータベースと、前記複数のアドホックネットワーク内のノードごとに所属ゲートウェイの識別情報を関連付けた第２のデータベースと、を有し、前記各アドホックネットワークの各ゲートウェイと通信可能なサーバが実行する鍵設定方法であって、 And the first database you associate the number of nodes and underlying key gateway-specific to each gateway of each ad hoc network in a network system consisting of ad-hoc network of multiple belonging to each node in the ad hoc network in the multiple A key setting method comprising, and a second database associated with the identification information of the gateway, the server can communicate with each gateway for each ad hoc network runs,  前記複数のアドホックネットワークのいずれのアドホックネットワーク内のゲートウェイ固有の鍵も未設定なノードに接続された携帯端末を介して、前記ノードから前記ノードのアドレスおよび前記ノードの近隣ノードのアドレスを含むパケットを受信する受信工程と、 Key gateway-specific ad hoc network in any ad hoc network of said plurality of even through a mobile terminal connected to a node not configured, the packet containing the address of the neighbor node of the node and the address of the node from the node a receiving step of receiving,  前記受信工程によって受信されたパケットに含まれている前記各近隣ノードのアドレスに基づいて、前記各近隣ノードの所属ゲートウェイを、前記第２のデータベースから特定する第１の特定工程と、 Based on the address of each of the neighbor nodes included in the packet received by the reception step, and identify a first step of identifying from the database of the second affiliation gateway of the each neighbor node,  前記第１の特定工程によって特定された前記各ゲートウェイが所属するアドホックネットワーク内に存在するノード数を、前記第１のデータベースから特定する第２の特定工程と、 A specific second step of identifying from the database of the first, the number of nodes that exist in the ad-hoc network where each gateway is identified by a particular step of the first one belongs,  前記複数のアドホックネットワークのうち、前記第２の特定工程によって特定された前記各ゲートウェイのノード数のうち最大でないいずれかのノード数であるいずれかのアドホックネットワーク内のゲートウェイ固有の鍵を、前記第１のデータベースにおける前記複数のアドホックネットワーク内の各ゲートウェイ固有の鍵の中から選択する選択工程と、 Among the ad hoc network of said plurality, and the second, key gateway-specific ad hoc network according to any one of a number of nodes in any not the maximum of the number of nodes of each gateway is identified by a specific second step and selection process to choose from among the key of each gateway-specific ad-hoc network of said plurality of database 1,  前記選択工程によって選択された選択鍵を、前記携帯端末を介して、前記ノードに送信する送信工程と、 A transmission step through the portable terminal, and transmits to the node, a selection key that is selected by the selection step,  を含むことを特徴とする鍵設定方法。 The key setting method which is characterized in that it comprises. 
Patent WO2012104976A1 - Key setting method, node, server, and network system - Google Patents
