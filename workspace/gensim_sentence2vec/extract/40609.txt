  近年、ソフトウェアやハードウェアなどのリソースをネットワーク経由で利用する形態である「クラウドコンピューティング」が流行っている。しかし、クラウドコンピューティングをビジネスに適用しようとした場合に、セキュリティの問題が指摘されてきている。このセキュリティを確保するために、データセンタ用機器において、レイヤ2レベルでメッセージの暗号化および認証を行うMACsec(Media Access Control Security Protocol)の実装が進んでいる。本報告では、このMACsecの概要とクラウド環境におけるセキュリティについて考察する。
MACsecは、暗号鍵インフラを用いて、イーサネットなどのレイヤ2プロトコルで流れている「フレーム」を暗号化するための技術である。IPsec(IP Security Protocol)やSSL(Secure Sockets Layer)/TLS(Transport Layer Security)などと異なり、レイヤ2レベルで暗号化されるため、スイッチやルータ、ファイアウォール、IPS(Intrusion Prevention System)などの中間ノードでのインスペクションが可能となる点が大きく異なる。
MACsecに関する仕様は、以下のふたつがある。MACsec本体の標準化は2006年に完了しているが、鍵管理プロトコルの仕様が長くドラフトのままであった。しかし、2010年2月に標準化承認が下り、MACsecの標準化が実質的に完了した。
IEEE 802.1AE-2006 Media  Access Control (MAC) Security
MACsec本体の仕様であり、2006年6月に標準化承認されている。
IEEE 802.1X-2010 Local and Metropolitan Area Networks - Port-Based Network Access Control
IEEE 802.1X-2004 (EAPOL:EAP over LAN)に、MACsecのサポートと、MACsecの鍵交換プロトコルの仕様として検討されていた IEEE P802.1afの内容をマージしたもの。2010年2月に標準化承認されている。
MACsecでは、以下のセキュリティ機能を提供するように設計されている。IPsecとの違いは表1の通りである。
コネクションレスデータ完全性確保
MACフレームに付加されるICV(Integrity Check Value)をチェックすることにより、フレームの内容が途中で改ざんされていないことを確認することが可能となる。
データ送信元の認証
ICVをチェックすることにより、データ送信元が正しい共通鍵を保持している、正当な相手であることを確認することが可能となる。この共通鍵は、鍵交換プロトコルによって、相手認証を行ったうえで共有される。
データの機密性確保
共通鍵暗号によって、MACフレームのデータ部が暗号化される。京津鍵暗号で使用される共通鍵は、鍵交換プロトコルによって、相手認証を行ったうえで共有される。
リプレイ防御
MACフレームに付加されるPacket Numberフィールドに、ユニークなIDを埋め込むことにより、同じIDを持ったMACフレームを受信することを防止することが可能となる。これにより、悪意を持った者が、ネットワーク上を流れているMACフレームをコピーして、再度送信するという「リプレイ攻撃」から防御することが可能となる。
受信遅延制限(Bounded receive delay)
MACフレームを受信する間隔を設定することにより、不自然に遅れたMACフレームの受信を拒否することが可能となる。
サービス妨害攻撃からの防御
上記の仕組みにより、ある一定のサービス妨害攻撃から防御することが可能となる。
※ 送信否認やトラフィック分析に対する保護は提供しない
表1 IPsecとMACsecの比較
IPsec
MACsec
IPA 独立行政法人 情報処理推進機構:情報セキュリティ技術動向調査(2010 年上期)
