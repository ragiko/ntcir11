 前々回の連載でPalo Alto Networksのセキュリティレポート「モダンマルウェアレビュー」のデータをもとに、ウイルス対策ソフトベンダーも発見できなかった未知のマルウェアについて解説しました。 
そこでFTPは4番目に未知マルウェアの侵入経路として利用されるアプリケーションであることと、FTPから進入するマルウェアの95%、つまりほとんどは、未知のマルウェアであることがわかりました。今回はなぜシグネチャベースのアンチウイルス製品はFTPから進入するマルウェアを苦手としているのかを見ていきます。
非標準ポートが多く使われている
FTPからの未知マルウェアの侵入についてくわしく見ていくと、ほとんどがFTPの標準ポートである20番や21番ではなく、それ以外の非標準ポートを利用していることがわかりました。今回の調査では全部で237の非標準ポートが使用されていました。セッション数(通信開始から終了までの通信の単位)で見ていくと97%のセッションは非標準ポートでのものでした。
では、未知マルウェアはFTP以外でも非標準ポートを多く使うものでしょうか。未知マルウェアによく使われる他のアプリケーションを見てみましょう。
こちらが他のアプリケーションとの比較です。
青色の棒グラフは未知マルウェアが使用された非標準ポートの数を示しています。FTPで使用された237の非標準ポートと比べてCustom-TCPは19,HTTP-Proxyは29と圧倒的に少ないことがわかります。Web Browsingは未知マルウェアの侵入経路の90%を占めているのに、90の非標準ポートしか使われていません。 
赤の線グラフは非標準ポートが使われたセッション数の割合を示しています。FTPの97%に対し、Custom-TCPは43%、HTTP-Proxyは29%、Web Browsingは10%と大幅に少ないこともわかりました。
多くのシグネチャベースのアンチウイルス製品では、すべてのポート(0-65535番)を検査するとパフォーマンスに悪影響が出るため、HTTPは80番、FTPは20番などと決め打ちして検査する場合がほとんどです。そのため非標準ポートを使用されてしまうと簡単にアンチウイルス製品を回避できてしまうのです。
非標準のポートを利用--成功率が最も高い、FTPを経由する未知のマルウェア - ZDNet Japan
