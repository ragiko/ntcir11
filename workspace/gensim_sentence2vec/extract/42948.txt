
主成分分析マクロ
1.主成分分析とは何か
多種類のデータが得られたとき、これらのデータを用いて全体の変動を説明したい場合がしばしばあ
る。しかし、経済・経営分野でのデータの場合、各データ間に相関関係のある(相関係数が1に非常に
近くなる)ことが多く、似た変動を示すデータを同時に使用することは意味がないことになる。
回帰分析の場合で言えば、説明変数相互間に相関関係(多重共線性)が存在することになり、最小二
乗法による推定結果が信用できないものとなる。
このようなとき、互いに相関のある多種類のデータのもつ情報を、互いに無相関な少数のデータに要
約する手法である主成分分析は、有効な手段になるであろう。
2.主成分分析の概念
k種類のデータがn組得られたものとする。
{x1i, x2i, ・・・, xki}		(i=1,2,・・・,n)
このとき、これらのデータの総合特性を与えるm(m<k)個の主成分zj (j=1,2,・・・,m)は、k種類のデー
タ xj (j=1,2,・・・,k) の加重平均により求められ、第j主成分は次式で表現することができる。
zj = pj1x1 + pj2x2 + ・・・ + pjkxk	(j=1,2,・・・,m)		(1)
ただし、係数pjiは各データが第j主成分に与える影響の割合を示しているので
pj12 + pj22 + ・・・ + pjk2 = 1		(j=1,2,・・・,m)		(2)
を満たすように定められるものとする。
主成分は、k種類のデータの変動を代表するものにならなければならないことから、各主成分は相互
に無相関であり、その分散が大きいものから順に選ばれなければならない。したがって、各主成分は次
のルールに従って導出される。
① 第1主成分 z1 の係数 {p11, p12,・・・, p1k} は、(2)式を満たし z1 の分散が最大となるように求め
る。
② 第2主成分 z2 の係数 {p21, p22,・・・, p2k} は、(2)式を満たし z1 と z2 が無相関になるとの条件
の下で、z2 の分散が最大となるように求める。
③ 同様にして、第j主成分 zj の係数 {pj1, pj2,・・・, pjk} は、(2)式を満たし z1, z2,・・・,zj が無相
関になるとの条件の下で、zj の分散が最大となるように求める。
3.主成分の導出方法
主成分の導出方法としては、分散共分散行列を用いる方法と相関行列を用いる方法の二種類ある。結
果として得られる主成分には違いがあるため、どちらを使用するかについて考慮する必要がある。しか
し、一般的な分析においては相関行列を用いる方法の方が望ましいとされているので、ここでは相関行
列を用いる方法について主に説明する。以下では証明を省略して手順を中心に説明する。
① k種類のデータの相関行列Rを求める。
② 相関行列Rの固有値と固有ベクトルを求める。
③ 相関行列Rは非負定行列であるので、その固有値もすべて非負となる。固有値を大きさの順に
λ1≧λ2≧・・・≧λk≧0
とし、それぞれの固有値に対応する固有ベクトルをv1, v2, ・・・, vkとする。このとき、第j主成分
zj の係数 {pj1, pj2,・・・, pjk} は
pj1 
pj2 
・    = vj
・   
・   
pjk 
となり、第j主成分zj の分散はλj となる。
④ 相関行列Rの固有値の和(すなわちRの対角和)はデータの個数kに等しくなり
第j主成分 zj の分散  λj
—————————— = ——
分散の総和     k
は、第j主成分 zj の寄与率と呼ばれ、寄与率を第1主成分から順に累計したものが累積寄与率と
呼ばれる。選ばれる主成分の個数mは、累積寄与率が90%ないし95%になるまでとされている。
以上のようにして求められる主成分は、元のデータの加重和であり、そのデータの具体的な意味は不
明なものである。したがって、主成分を用いて経済ないし経営分析を行ったとき、得られたモデル等の
解釈が難しくなる。しかし、予測を目的とする場合には、説明変数の将来値を予測する必要があり、
ARMA(自己回帰移動平均)モデル等で予測するのであれば、主成分を同様にして予測することが可能で
ある。
主成分導出マクロの作成
次表のように、Excelのワークシートに主成分を求めるべき系列を入力する。さらに、左上のデータ
の上のセルにデータの個数(この例の場合は15)、その右隣に系列数(この例の場合は5)を入力し、
データ個数を入力したセルをアクティブにして実行したとき、主成分及び寄与率を計算するExcelマク
ロを作成する。
ただし、別項「SUB固有ベクトル計算」で説明した3つのSUBプロシージャeigen、S1、S2が複写され
ているものとする。
主成分分析マクロ
