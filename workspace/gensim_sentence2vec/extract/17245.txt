
ロスレスモードは、カラー画像に対してはおおよそ2:1程度の圧縮率となる[3]。このモードは医療分野の画像に対してよく用いられるが、一般的にはそれほど広くは用いられていない。
JPEG-LS[編集]
JPEG-LSは、モデル化と符号化と呼ばれる2つの独立した段階から成る、低コストで高性能な基本アルゴリズムである。もともとはLossless JPEGよりも効率のよいアルゴリズムとして、ニアロスレス画像圧縮を提供するために開発されたものである。用いられている全体的な相関性消去によって、以前の規格で採用されていた方式による予測残差よりも遥かにエントロピーが低くなっている[4][5]。 JPEG-LSのPart1は1999年に完成し公開され、算術符号のような拡張はPart2として紹介された。アルゴリズムの中核はLOCO-I algorithmを元にしており、これは予測、誤差を用いたコンテキストモデリングによって成り立っている。また、予測残差が左右対称の幾何分布(離散ラプラス分布と呼ぶ)に従うと仮定し、そのような分布に対して有効なゴロム符号を用いることによって、低コストを実現している。その上、誤差の絶対値の最大をエンコード時に制御できるニアロスレスモードも提供している。大抵の場合、JPEG-LSはJPEG 2000よりも遥かに高速で、以前のLossless JPEGよりも圧縮率が高い。
LOCO-I アルゴリズム[編集]
モデル化には相関性消去(予測)とコンテキストモデリングの2つの重要な処理がある。
相関性消去/サンプル値予測[編集]
LOCO-Iアルゴリズムには、Fig. 3に示すX画素の近傍画素によって縦方向のエッジや横方向のエッジを検出する原始的なエッジ検出が使われており、縦方向の場合はBの画素、横方向の場合はAの画素を予測に用いる。この簡単な予測法はMedian Edge Detection(MED)[6]や、LOCO-I予測と呼ばれ、以下の式によってXの値を予測する。
この3種類の簡単な予測式は以下の条件を表している。 (1) Xの左に縦方向のエッジが存在する場合にはBを用いる (2) Xの上に横方向のエッジが存在する場合にはAを用いる (3) エッジが存在しない場合には A + B - C を用いる
コンテキストモデリング[編集]
JPEG-LSは、それぞれのコンテキストCtxに所属するサンプルの平均を用いて、予測誤差の条件付き期待値を見積もる。予測残差のコンテキストモデル化によって、テクスチャパターンや局所的に変動の激しい画像も対応できる。コンテキストは局所的な勾配のような、近傍サンプルの差分値によって決まる。
局所的な勾配は、サンプルの近傍の滑らかさや変動の激しさを反映している。また、これら近傍の差分値は統計的な性質が予測誤差に密接に関係していることに着目し、上の式で得られる差分値を量子化することでおおよそ似通った値をひとまとめにする。JPEG-LSの場合、g1, g2, g3を9つの値に量子化し、-4から4までのインデックスを振る。これによって、対象サンプル値との相関を検出できそうなコンテキストとの間で共通の情報を抽出できる。また、
という性質を持つと仮定し正と負のコンテキストをまとめると、コンテキストの総数はとなる。 各々のコンテキスト内の累積予測誤差をコンテキストに含まれる要素数で割ることによって、誤差分布の中心がどれほどずれているのかある程度推測することができる。そこでコンテキスト内で予測誤差の中心からのずれを補正する機構を追加することで、予測の精度を改善することができる。なお、LOCO-Iアルゴリズムでは、この手順に要する加減算の回数が減るように改善されており、さらに除算を不要にした計算手順が[2]に紹介されている。
予測誤差補正値の符号化[編集]
JPEG-LSは標準では非負のランレングスを符号化する際にゴロム・ライス符号(ゴロム符号参照)を用いる。この際に、パラメータとして2^kを用いることによりエンコード処理を簡略化する。
ランレングス符号[編集]
ゴロム・ライス符号は1シンボルあたり1bit未満にはならないため、画像の滑らかな部分などのエントロピーの低いデータに対しては圧縮率があまり高くない。この問題を回避するため、複数のシンボルをまとめて記述する方式を用いる。これがJPEG-LSの"ランモード"で、平らな領域や滑らかな領域でゼロ勾配として検出された部分で用いる。"a"シンボルのランモードは異なるシンボルが現れるか走査線の終端に至ったら終了し、ランの長さを符号化して通常のモードに戻る。
JPEG 2000[編集]
Lossless JPEG - Wikipedia
