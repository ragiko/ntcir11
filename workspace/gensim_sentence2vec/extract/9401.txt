・100回コイントスして表が最大5回連続して出る確率は26%
・100回コイントスすると、表が最大6回ぐらい連続して出る(逆に6回連続して表を出すには100回コイントスすればよい)
・100回コイントスすると、表または裏が最大7回ぐらい連続して出る (表だけの連続回数より1回多くなる)
次の図は321x321の画素を赤と青で半々に塗りつぶしたもので、左は交互に(均一に)、右は乱数で塗った例である。
これを見ると、ランダムに塗っているのに意外と均一でなく斑模様になる。乱数で塗るとは、例えばコイン投げをして表なら赤、裏なら青を塗っていくのと同じなので、斑の大きさは連続して表や裏がでる長さである。もちろん長いものほど出現確率は小さいのだが、同じ面が連続して出る確率は意外と高いようである。
では、
コイントスで表か裏が連続する長さはどれくらいだろうか
この計算が「世界でもっとも奇妙な数学パズル」(ジュリアン・ハヴィル)という本にのっていた。以下では
・表(Head)をH, 裏(Tail)をT
・n回コイントスして出るH,Tの列を、長さnの系列(sequence)
・連続k回Hが出ることを、長さkのHのラン(run)
と呼ぶことにする。
求めたいのは長さnの系列の中でHのランの最大長Rnがkである確率である。
この問題のポイントは、いきなり最大長がkである確率を考えるのでなく、k以上である確率を考えることである。
まず、n回目までに長さk以上のHのランが現れる場合は2つに分けられる
(1) n-1回目までに長さk以上のHのランが現れる場合
(2) n回目でちょうど長さkのHのランになる。すなわちn-k-1回目までには現れず、n-k回目にTがでてその後k回連続してHが出る確率だから
これらを足して次の漸化式が得られる。
(注:私が持っている本の第1版では漸化式が間違っていて、Rn-k-1のところがRn-kになっている)
またk=nのときは明らかに
n<kのときは
と見なす。
この確率を使ってHのランの最大長Rnがkに等しい確率が計算できる。
プログラム(VisualBasic)で計算すると
For n = 0 To nMax
For k = n +
1 To nMax
A(n, k) = 0
Next k
A(n, n) =
(1 / 2) ^ n
A(n, 0) = 1
Next n
For n = 1 To nMax
For k = 1
To n - 1
A(n, k) = A(n - 1, k) + (1 - A(n - k - 1, k)) / 2^(k + 1)
Next k
Next n
For n = 0 To nMax
P(n, nMax)
= A(n, nMax)
For k = 0
To nMax - 1
P(n, k) = A(n, k) - A(n, k + 1)
Next k
Next n
コイントスで表が連続して出る確率 (漸化式その1)
