 
回帰分析
x, y両座標ともに不確かさがある「重み付き回帰分析」(Deming法)については、本ホームページの「統計メモ」のページをご覧下さい。
直線回帰モデル
変数とからなる個の組について散布図を描き、それら変数の間に何らかの関数関係が想定される場合には、観測値と関数曲線の距離が最小になるようにして、任意に選んだ多項式
の係数を決定することにより、推定関数を見いだし、観測値の誤差分散を見積もることが可能であり、これを(曲線)回帰分析と呼び、このようにして得られる推定関数のことを「に対するの回帰曲線」と呼んでいます。そして、回帰曲線の中でも最も単純でしかも実践的によく用いられるものは回帰直線()で、そのようなモデルのことを「直線回帰モデル」と言います。
以下の直線回帰モデルでは、独立変数には不確かさはなく()従属変数にのみ不確かさがある()ものとします。またの誤差の分布は正規分布をしており、その誤差分散はの値によらず一定値をとるものと仮定します()。このような仮定は通常成立している場合が多く、直線回帰モデルとして一般的なものです。
そこで、いま任意の標本の組として
のような個の変数の組を考えることにします。ここで、は独立変数(指定変数あるいは説明変数とも言う)、は従属変数(結果変数あるいは目的変数とも言う)であり、実現値の確率変数が
となるような直線の構造式(線形モデル)をもつものとします。とはこの構造式の形を決める構造パラメータ(母数)であり、は確率変数ではない通常の変数です。また、は正規分布をする誤差の確率変数です。いま、確率変数に実現値を代入すれば
なる構造式が得られ、は直線(母回帰直線)
すなわち
からの観測値のずれ(誤差)に相当します。母回帰直線は、下図に見られるように、に対応する無数の対象のの値の平均値である母平均の軌跡となります。すなわち
となるような期待値と分散をもつ母回帰直線ということです。
観測値によって定義される標本回帰直線と母回帰直線
母回帰直線の構造パラメータ(母数)である(母切片)および(母回帰係数)の推定値とを点推定するためには、上述の観測値と母平均との偏差の平方和
を最小にするように、「Gaussの最小自乗法」を標本(標本回帰直線をとすれば観測値はとなります。ここでは観測値の推定値(真の値)です。)の偏差の平方和に適用して、
の極値条件
を求めることによって得られる連立方程式(正規方程式)
から、母数との最良推定値である不偏推定値とが得られます。すなわち
となります。また
と定義すれば、母数との推定値とは
と書くこともできます。
したがって、推定された「へのの回帰直線」(標本回帰直線)は、平均値を通る切片および傾きの直線
となります(下図参照。【注】この図および次図以下では、図中の大文字のは、変動の偏差平方和を表すのではなく偏差を表しています。したがって、たとえば、記号は本文中の誤差偏差に相当することになります。)。ちなみに、正規方程式を求めるのに使った観測値と回帰推定値(回帰式のにを代入して得られる推定値)との偏差
のことを「残差」(あるいは単に「誤差」とも言います)と呼び、またのことを「回帰からの変動の誤差変動」であり「残差平方和」(あるいは単に「誤差平方和」と呼ぶこともあります)と呼んでいます。残差は
の関係式より
で表されるように、偶然誤差と(母回帰直線と標本回帰直線との差)の和であることに注意する必要があります。
観測値は真の値
残差平方和は定義式
のに上で求めた
を代入して、変形すれば
となります。ただし
および
です。一方、
であるから
となり、総変動は「回帰による変動」と「回帰からの変動」の和になります。
の総変動に占める回帰平方和の割合を「回帰の寄与率」と呼びで表します。すなわち
あるいは
となります。したがって、がに近ければの変動の大部分がに対する回帰によって説明されることになり、がに近ければxの説明力はほとんどないことがわかります。このはととの「相関係数」に相当し、のことを「決定係数」と呼ぶことがあります。なお、相関係数の符号はの符号と同じにします。
観測値は真の値の周りに分布幅で正規分布していると仮定したので、偏差は中心値、一定幅で正規分布していることになります。したがって、の誤差、すなわち、測定値の誤差、すなわわち、「回帰推定の標準誤差」あるいは「残差標準偏差」は
となります。分母がではなくになっているのは独立な変数の全個数から誤差を算出するのにとと言う2つのパラメータ(に依存)を使っているので自由度がに減少しているのです。したがって当然ながら、2点のみからなる変数系では回帰直線を推定できないことになります。
母数との最良推定値との誤差(標準偏差)は、それぞれ
と定義されます。残差分散(誤差母分散)は一定値であるからの関数であるもの係数はのみの関数となっています。
また、母数との不偏推定値であるとの期待値は、それぞれ
となります。さらに、およびの期待値は、それぞれ
となります。ここで、は残差分散(誤差母分散)のことです。すなわち
です。これら分散と期待値の証明は以下の通りです。
は
と変形でき、は互いに独立であり、であるから
となります。これから
が得られます。
は
であるので
となります。一方、は
であるので
となります。したがって
となります。
観測値()に繰り返しのない場合の回帰直線
残差分散(誤差母分散)の正の平方根を回帰推定の標準誤差あるいは残差標準偏差と呼びの記号を使って表します。これを回帰を用いないときのの標準偏差と比べると
となるので、回帰で説明される部分を差し引くと、の標準偏差はほぼ倍になります。つまり、相関がなければであるからの残差標準偏差は回帰を用いないときのの標準偏差そのものになり、相関が強ければであるから、の残差標準偏差は限りなくに近づき、すべての観測値は標本回帰直線上のの推定値(真の値)に一致するようになることを意味しています。
ここで、観測値に繰り返しのない場合の回帰直線の分散分析表(ANOVA)を次に示します。
ようこそ、化学標準物質の不確かさへのいざない
