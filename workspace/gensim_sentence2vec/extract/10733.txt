
Windows ストア のアプリケーションで使用できるようになるデスクトップ アプリケーションで使用するための基本的な従来の COM コンポーネントを作成するために Windows ランタイム C++ テンプレート ライブラリ (WRL) を使用できます。
COM コンポーネントの作成については、WRL は ATL よりもコードを必要とする場合があります。  WRL サポートして Windows ランタイム C++ テンプレート ライブラリ (WRL)に参照する COM のサブセットについての情報を返します。  
ここでは、COM コンポーネントを作成するために WRL を使用する方法を示します。
各自のニーズに最適な配置機能を使用できますが、このドキュメントでは、デスクトップ アプリケーションから COM コンポーネントを登録して使用する基本的な方法を示します。  
Visual Studio では、[空のソリューション] のプロジェクトを作成します。
たとえば、プロジェクト、WRLClassicCOMという名前を付けます。  
ソリューションに [Win32 プロジェクト] を追加します。
たとえば、プロジェクト、CalculatorComponentという名前を付けます。  
[アプリケーションの設定] タブで、[DLL] を選択します。  
プロジェクトに [MIDL ファイル (.idl)] ファイルを追加します。
たとえば、ファイル CalculatorComponent.idlという名前を付けます。  
CalculatorComponent.idl に次のコードを追加する:
方法: WRL を使用して従来の COM コンポーネントを作成する
