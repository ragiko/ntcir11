						加重平均の標準偏差の公式について
実験で得た測定値x_iに重みp_iをつけた加重平均の真値に対する標準偏差の導出が知りたいのですが、どのような本やサイトを見ても結果のみが出ています。
標準偏差の導出過程について、詳しめに書かれているサイトや書籍をご存じないでしょうか?
ちなみに、今まで下のサイトのようなものを参考にしてました。
http://staff.aist.go.jp/t.ihara/weight.html
補足ymst_rintaさん ありがとうございます。
その標準偏差 s*√(∑p_i^2)の式までは理解出来るのですが、この式からリンク先の
σ=√((∑p_i δ_i^2)/(n-1)∑p_i)
は導出できますよね?
単純に計算すると、√((∑p_i^2 ∑δ_i^2)/(n-1)(∑p_i)^2)となって一致しないと思うんですがどうしてでしょうか??
普通の単純な平均についての標準偏差の導出は理解されていますか?そこが分かっているなら難しくない話だと思います。期待値の線型性等の単純な性質しか使わないので、わざわざ詳しく書いたりしないのではないでしょうか。
ここでは、p_iをp_i>0, ∑p_i = 1となるように定めることにします。すなわち、加重平均を∑(p_i*X_i)で定めることにします。
今、X_1, X_2,...., X_nが独立に同一分布に従うものとし、E(X_i)=m, V (X_i)=s^2などとすると、
E[∑(p_i*X_i)] = ∑[p_i*E(X_i)] = m*∑p_i = m
V[∑(p_i*X_i)] = ∑[(p_i)^2*V(X_i)] = s^2*∑p_i^2
よって標準偏差はs*√(∑p_i^2)ということになります。
例えば、普通の算術平均はp_i=1/nとしたものであることは直ちに分かると思います。
p_i=1/nとすると、∑p_i^2 = n * (1/n)^2 = 1/nより標準偏差はs*√(1/n) = s/√(n)というみなれた形になります。
[追記]
今の環境では実はリンク先のテキストしか見えなくて、画像=数式が全く見えないので想像を交えて書くことになりますが、複数のサンプルで推定された平均・分散から母集団の平均・分散を重みつきで推定するという話のように思われます。
今、2標本あってサイズがそれぞれn_1, n_2, n=n_1+n_2とします。
平均m_i = ∑X_ij / n_iについて、n_i/nで重み付き平均をとれば、それが∑∑X_ij / nになっていて、全部プールした平均になります。
計算の都合で分散をs_i^2 = ∑(δ_ij)^2 / n_iで推定しているとすると、全体をプールした分散∑∑(δ_ij)^2 / nは(n_1/n) * s_1^2 + (n_2/n) * s_2^2なので、分散につける重みの係数と平均につける重みの係数を同じにしてよいことが分かります。つまり平均への重みがp_iのときに、分散への重みをp_i^2にする必要はないです。
「重み付き平均」の標準偏差ではなくて、「重み付きで分布の平均を推定している場合における分布の標準偏差の推定」という話だとすると、最初のレスポンスは見当違いですので、忘れてください。最初のレスポンスは、「重みつき平均」の標準偏差が分布の標準偏差sに対してどの程度の大きさになるのか、という話でした。
加重平均の標準偏差の公式について実験で得た測定値x_iに重みp_... - Yahoo!知恵袋
