
クエリのレコード グループに対して合計、平均、カウント、その他の集計を行う
ここでは、事例のデータ(Orderテーブル) から、商品別に、各顧客の一つの受注オーダでの、最大発注数を表示してみましょう。
クエリーの新規作成で、Order を追加します。
上段のフィールドリストで、「商品」「数量」「得意先」の順に、項目をマウス左ダブルクリックして、下段のクエリーデザイングリッドのフィールドに登録します。(この順番が、後で並び替える時に重要です。ただし、クエリを実行した後のデータシートビュウでも、この順番を変更できます。)
クエリのデザイン ビューで選択クエリを作成し、演算に使用するレコードが含まれるテーブルを追加し、演算を実行するフィールドを追加し、グループを定義し、抽出条件を指定します。
ツールバーの  (集計) をクリックします。
デザイン グリッドに [集計] 行が表示されます。
グループ化するフィールドに対して、[集計] セルの [グループ化] はそのままにしておきます。
計算する各フィールドに対して、[集計] 行のセルをクリックし、[合計]、[平均]、[最小]、[最大]、[カウント]、[標準偏差]、および [分散] のいずれかをクリックします。
今の場合は、「最大」を選択します。
各集計関数の詳細も参照下さい。
First 関数と Last 関数を使用するときの注意事項の詳細については、 をクリックしてください。
必要に応じて、抽出条件を入力して表示する演算結果を制限します。
その方法は ?
必要に応じて、並べ替えを設定します。
その方法は ?
ツールバーの  (ビュー) をクリックして、結果を表示します。
クエリーのリストで、並び替えたいフィールドを選択します。この場合は、「商品」と「数量」です。
Accessでお仕事 クエリのレコード グループに対して合計、平均、カウント、その他の集計を行う
