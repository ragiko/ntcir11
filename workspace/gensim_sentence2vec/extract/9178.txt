10.4 変数選択法
(1) 変数選択法の種類
重回帰分析や判別分析と同様に、ロジスティック回帰分析にも各種の変数選択法が考えられています。
ロジスティック回帰分析は、重回帰分析において目的変数がロジットになったものに相当しますから、次のように変数の選択法にも同じような手法があります。
(7.3 変数の選択)
変数指定法
医学・薬学等の実質科学的理論や知識によって適当な変数を指定する。
総当たり法
全ての変数の組み合わせを計算し、最も良いと思われるものを選択する。
逐次選択法
一定の規則に従って変数を逐次選択していく。
これらの手法のうち最も多用されるものは、重回帰分析と同様に3番の逐次選択法です。
そしてこの方法は、変数の選択規則によってさらに次のように細分されます。
なお、重回帰分析では重寄与率の増減分を反映するF値を変数選択の指標にしましたが、ロジスティック回帰分析では、重寄与率の増減分を反映するスコア統計量を変数選択の指標にします。
そしてスコア統計量としては、偏回帰係数の検定に使用するワルドのχ2値を用いるのが一般的です。
変数増加法(前進的選択法、forward selection method)
最初に、全変数のうちロジットに対するスコア統計量が最大のものをロジスティック回帰式に取り込む。
そしてそれ以後は、すでに取り込まれた変数との共有部分を除いて、単独でスコア統計量が最大の変数を取り込んでいく。
これは、その変数を取り込んでロジスティック回帰式を計算した時、重寄与率の増加が最大になることを意味している。
その際、スコア統計量があらかじめ決めておいた値、すなわち取り込み基準未満になった時に変数の取り込みを終了する。
変数減少法(後退的選択法、backward selection method)
最初に全変数を取り込み、以後は取り込まれた変数のうち、単独でスコア統計量が最小のものを追い出していく。
これは、その変数を追い出してロジスティック回帰式を計算した時、重寄与率の減少が最小になることを意味している。
この際、スコア統計量があらかじめ決めておいた値、すなわち追い出し基準以上になった時に変数の追い出しを終了する。
変数増減法(stepwise forward selection method)
増加法と減少法を組み合わせたもので、まず増加法と同様に取り込み基準に従って変数を取り込む。
そして1つ変数を取り込むたびに、すでに取り込んだ変数の中に、減少法と同様の追い出し基準を満足するものがないか調べ、あればそれを追い出してから、さらに変数の取り込みを続ける。
そして取り込むべき変数も追い出すべき変数もなくなった時に、変数の選択を終了する。
この方法は、ロジットに寄与する割合が大きい変数を少数選択するという特徴を持ち、逐次変数選択法の中で最も多用されている。
変数減増法(stepwise backward selection method)
増加法と減少法を組み合わせたもので、変数増減法とは逆に、まず減少法に従って全ての変数を取り込み、追い出し基準を満足するものを追い出す。
そして1つ変数を追い出すたびに、すでに追い出した変数の中に、増加法と同様の取り込み基準を満足するものがないか調べ、あればそれを取り込み、さらに変数の追い出しを続ける。
増減法と同じく、取り込むべき変数も追い出すべき変数もなくなった時に変数の選択を終了する。
この方法は、ロジットに寄与する割合が少ない変数を少数除外するという特徴を持ち、効率的な変数の組み合わせが得られる可能性が逐次変数選択法の中で最も高い。
(2) 変数増減法の手順
変数選択法の中で最も多用されるのは、重回帰分析と同じく変数増減法ですので、この手法について順を追ってもう少し詳しく説明することにしましょう。
(注1)
1) 変数の取り込み
まず最初にスコア統計量が最大の変数、つまり単独でロジットに最も寄与している変数を探し、それが取り込み基準を満足するならロジスティック回帰式に取り込みます。
仮にそれをx1とすると、この時の状態は図10.7のようになります。
統計学入門−第10章
