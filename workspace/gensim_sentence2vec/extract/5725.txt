
このページはアーカイブです。記載されている内容は情報提供のみを目的としており、ページ内のリンクは有効でない可能性がありますが、これらの情報についてマイクロソフトはいかなる責任も負わないものとします。
トピック
SQL Server 2000への移行の理由
移行プロセスの理解
アーキテクチャの相違点
テーブルとデータの移行
Sybase T-SQL と Transact-SQL の相違点
データベース管理の相違点
移行チェックリスト
SQL ServerとSybaseの2つのリレーショナルデータベースシステムは、バージョン4.2までは、両社が共同で開発していました。このような共通性の背景があることから、SybaseのユーザーはSybaseのデータベースからSQL Serverへの移行を、簡単に、低コストで行うことが可能で、移行後はSQL Serverの新しい機能を利用することができます。
この章では、SybaseデータベースからSQL Server 2000へ移行する際の手順を示し、データベースアプリケーションの開発者が、移行時に発生する問題についての役立つ情報を提供します。本章の情報は、データベースアプリケーションをSQL Server 2000へ移行する計画を立てているSybaseのデータベース管理者(DBA:Database Administrator)および責任者向けの内容であり、ユーザーがSybaseデータベース(SQL ServerまたはAdaptive Server Enterprise)を普段使用していることを前提としています。
本章では、Sybase T-SQLステートメントと、SQL Server Transact-SQLステートメントの違いについて、および両者の管理プロシージャの違いについて説明しています。ただし、Open Client Library(通称CT-Library)アプリケーションからの変換、およびSybaseからSQL ServerデータベースへのODBCアプリケーションの移植についての説明はありません。
SQL Server 2000への移行の理由
SybaseアプリケーションからSQL Server 2000への移行を検討する理由として、次の点が考えられます。
Enterprise Editionのパフォーマンスの高さ
大規模なデータベースのスケーラビリティおよびパフォーマンス
動的な自己管理
使いやすさ
ビジネスインテリジェンスが利用可能
単一のスケーラブルなコードベース
Enterprise Edition
のパフォーマンスの高さ
SQL Server 2000は、Windows 2000オペレーティングシステム上で高いパフォーマンスを備えており、業界標準のベンチマークの記録を塗り替えました。2000年11月、SQL Server 2000(Windows 2000上で実行)は、TPC-Cベンチマークの総合パフォーマンスに関する世界記録を達成しました。その記録は、505,302 tpm/Cの総合レート、$19.80/tpmCのコストというものでした。当時、このパフォーマンスの総合レベルは、IBMのDB2による公表結果の最高記録よりも約15%も高く、Oracleによる公表結果の2倍以上のものでした。
32個以内のCPUを持つシステムを使用している会社ならば、最高のパフォーマンスと低コストという点で、SQL Server 2000のメリットを十分に活かすことが可能です。
大規模なデータベースのスケーラビリティおよびパフォーマンス
SQL Server 2000はTerraServer Webサイトで使用されています。TerraServerは1TB(テラバイト)に及ぶ世界の衛星画像にアクセスします。現在では、このサイトは10億件以上のヒット数があり、最高では、1日で2,900万件以上のヒット数と1,800万件のデータベースクエリがありました。
次の統計は、最初の21日間の操作から算出したもので、SQL Server 2000を使用することにより巨大なデータベース容量と抜群のトランザクションスループットが得られることを示したものです。
総ヒット数:317,670,000
1日当たりの平均ヒット数:15,130,000
1日当たりの最高ヒット数:28,940,000
1日当たりの平均データベースクエリ数:8,810,000
1日当たりの最高データベースクエリ数:17,760,000
動的な自己管理
DBAの共通タスクは、メモリとディスクの空き容量の使用状況を監視することです。モバイルアプリケーションなどの場合のように、リモートユーザーはDBAに対してアプリケーションのチューニングや監視を依頼できないこともあります。またほかのデータベースでは、必要なメモリやディスクの空き容量を確保するために、ユーザーがシステムの利用状況を慎重に監視する必要がある場合もあります。SQL Server 2000では、動的自己管理により、ディスク割り当てやメモリ割り当てにかかわる重大なエラーや、通常のエラーに対する作業を削減することができます。
使いやすさ
SQL Server 2000は使いやすさを追求しています。SQL Server 2000には、グラフィカルツール、タスクパッドがあり、DBAのルーチンタスクを自動化、およびスケジュール化するための30以上のウィザードを備えています。たとえば、インデックスチューニングウィザードを使用すると、アプリケーションが使用するテーブルのインデックスを調整し、最良のチューニング方法を決めることができます。クエリアナライザでは、データベースステートメントのグラフィカルな実行プランの提供により、パフォーマンスのボトルネックを特定できます。
SybaseにはSQL Server 2000のようにタスクを自動化、およびスケジュール化するためのツールや、問題の発生時にDBAに事前に警告するためのツールはありません。
ノートパソコン上で実行するアプリケーション(モバイルアプリケーション)の数はますます増えつつあります。モバイルを使用するユーザーは、データベースについて知らない場合が多く、ましてデータベースのチューニング方法などを知るはずもありません。さらに、年度末などの重要な時期には、DBAの仕事は忙しくなります。、メモリおよびディスクの空き容量の管理といった作業に、彼らの貴重な時間を割いてはならないのです。
Windows 2000
、
Office
、
.NET Enterprise Servers
との統合
SQL Server 2000およびExcel 2000についても、Microsoftはデスクトップ分析機能を提供しており、ExcelユーザーはSQL Server 2000を使用して、初めてGB単位またはTB単位のデータを分析できるようになりました。SQL Server 2000は、Windows NTのセキュリティおよび管理システムと統合するWindows 認証により、生産性が向上し、ユーザーが容易に使用できるようになります。Windows 認証 では認証を受けたユーザーがデータベースにアクセスする事が可能です。Windows NTイベントビューアにより、警告の自動発信が可能となります。たとえば、サーバーはポケットベルまたは電子メールに送信することができます。Transaction ServerはWindows NT Serverの一部ですが、これにより複数の層からなるアプリケーションを容易に構築することができます。SQL Serverは、Exchange Server、Systems Management Server、およびSNA Server(最新版の後継製品はHost Integration Server)とも密接に統合しており、これらの機能はシステム管理者が簡単に使用できます。
データウェアハウスのインターフェイスとしてユーザーの好きなデータ分析ツールを使用できれば、生産性はさらに向上するでしょう。
ビジネスインテリジェンスが利用可能
SQL Server 2000は、広範なデータウェアハウジング機能を備えています。たとえば、統合されたデータ変換サービス(DTS:Data Transformation Services)、SQL Server 2000 Analysis Services、さらにはユーザーのデータウェアハウスを作成するためのグラフィカルツールなどがあります。SQL Server 2000により、データウェアハウスの開発を簡単に、低コストで行うことが可能になり、Office 2000により、データの検索および分析の機能が簡単になります。データウェアハウジングに対応する製品を追加することにより、ユーザーはSQL Serverベースのアプリケーションをシームレスに処理し、より高度なデータウェアハウジングツールを統合することができます。SQL Server 2000により、ユーザーはデータリネージ機能を利用することができます。データが多くのソース(製造データベース、売上データベース、チャネルデータベースなど)から入力される場合、リネージ機能により元のデータを特定することができます。
データウェアハウスの作成はとても複雑な処理ですが、統合ツールを使用すると、データウェアハウスの開発をより直観的に、効率的に行うことができます。
1
つのスケーラブルなコードベース
Sybaseでは、エディションごとに異なるデータベースエンジンを使用しています。つまり、あるエディション用に書かれたコードは、別のエディションでは正常に動作しない場合があるということです。これに対して、SQL Server 2000は、Windows 95やWindows 98などのOSで実行するノートパソコンから、Windows 2000 Server Enterprise Editionで実行するマルチプロセッサを使用したクラスタまで、同一のコードから開発しています。したがって、アプリケーションには100%互換性があります。Microsoft Data Engine(MSDE)は、SQL Server 2000と互換性のある新しいデータエンジンであり、Office 2000に同梱されています。Office 2000では、Accessをインターフェイスとして、MSDEを強力なエンジンとして使用し、アプリケーションの開発、利用、管理を行います。あるアプリケーションが複数の異なるハードウェア環境で実行される場合、開発およびサポートするアプリケーションのバージョンは1つに限定する必要があります。このことが特に重要となるのは、異なる環境で実行するモバイルアプリケーションを作成する場合であり、ノートパソコン、デスクトップ、サーバーおよびクラスタサーバーの中のどの場所でアプリケーションを実行しても、同一の動作が保証されなければなりません。
移行プロセスの理解
これからの項目は、Sybase Adaptive Server EnterpriseからSQL Server 2000へデータベースを移行する際に検討が必要です。
データおよびオブジェクトの定義
Transact-SQLおよびシステムストアドプロシージャへの変更
管理上の変更
移行手順は次のとおりです。
SQL Server 2000と管理上の変更が必要なSybaseサーバーの間で、アーキテクチャの違いを調べます。
DTSを使用してデータおよびオブジェクトを移行します。
Sybaseのストアドプロシージャ、トリガ、SQLスクリプト、およびアプリケーションについて、言語変更の必要性を確認します。
クライアントコードに必要な変更を行います。アプリケーションの発行するSybase SQLステートメント中に、SQL Server 2000上で予約されたキーワードがある場合は競合するオブジェクト名を変更する必要があります。SybaseアプリケーションのSQLステートメントは、SQL Server Transact-SQL構文に準拠するように、必要な変更を反映する必要があります。
クライアントコードをテストします。
ユーザーの管理プロシージャに必要な変更を行います。
SQL Server 2000において使用できる新しい機能を調べ、これらの機能を利用するために必要な変更を行います。
アーキテクチャの相違点
移行処理を成功させるためには、SQL Server 2000に関する基本的なアーキテクチャおよび用語を理解する必要があります。さらに、データベースサーバー間のアーキテクチャの違いを知っておく必要があります。
クライアント構成と
Net-Library
CT-Libraryを使用しているSybaseアプリケーションを移行するには、DB-Libraryの使用に変更する方が簡単ですが、SQL Server 2000の機能を活用するため、SQL Serverベースとなるクライアントは、サーバーの接続にOLE DBプロバイダまたはODBCドライバを使用することを推奨します。Microsoftでは、Sybaseクライアントコンポーネントに代わるものとして2つのコンポーネントNtwdblib.dll(DB-Library)およびSqlsrv32.dll(ODBC driver)が利用できます。
SQL Serverベースのクライアントは、次の表に示すとおり、適切なSQL Serverネットワークライブラリコンポーネントを使用する必要があります。
Net-Library
Win32 DLL
Microsoft SQL Server 2000 リソースキット : 第 6 章 ‐ Sybase データベースから SQL Server 2000 への移行
