「ファイル種別コードに異常があります」のエラーメッセージが出ます。
「データファイルが壊れています」のエラーメッセージが出ます。
「項目属性がありません」のエラーメッセージが出ます。
「レコードチェインに異常があります」のエラーメッセージが出ます。
これらは、表ファイル(〜.tbl)が正常な状態ではないときに表示されるエラーメッセージです。
表ファイルを開くとき、あるいは(開くときには問題がなくても)操作中に表示されます。
メッセージの違いは、損傷している箇所の違いによるものですが、いずれも表ファイルが正常な状態ではないことを意味しています。
正常な状態に戻す方法として、次の2つがあります。
1.修復ツールを使用する
2.バックアップファイルを使用する
1.修復ツールを使用する
［ツール］メニューの［表の検査/修復］を選んで［表の検査・修復］画面を表示します。
［対象表］にエラーが出た表ファイルを指定し、［修復］ボタンを押します。
なお、エラーが出たファイルと同じ定義内容を持つ別ファイル(例えばバックアップのため保管しておいたtblファイル)がある場合、そのファイルを［参照表］に指定すると、表の定義情報が損傷しているケースでは正常に修復できる可能性が高くなります。
※この修復ツールは、表の損傷状態を完全にチェックまたは修復できるものではありません。 損傷状態によっては、その部分を切り捨てることにより修復を行ったり、あるいはまったく修復できない場合もあります。
表ファイル以外のファイルを修復することはできません。
2.バックアップファイルを使用する
桐が自動作成したバックアップファイル(拡張子「bak」)は、拡張子を「tbl」に変更することにより表ファイルとして利用することができます。
なお、bakファイルの内容は、tblファイルよりひとつ前に保存された状態であり、tblファイルと全く同じではありません。
ファイル名の変更は、桐ファイルパレットまたはWindowsのエクスプローラで行ってください。
桐ファイルパレットによる操作手順
桐ファイルパレットで［ファイル］をクリックする。
ファイル一覧より、拡張子bakのファイル名を選択する。
右クリックし、ショートカットメニューから［編集］［名前の変更］を選択する。
新しいファイル名(拡張子「tbl」)を入力し、［リターン］キーを押す。
拡張子を変えるための警告に［はい(Y)］をクリックする。
お客様がバックアップファイルを作成しないように設定された場合、または共有ファイルとして利用されていた場合は、bakファイルは作成されません。
※注意
拡張子「bak」を「tbl」に変更する場合、通常は同じ名前の「tbl」ファイルがすでに存在するのでエラーになります。
例えば、「住所録.bak」の名前を変更する場合、すでに「住所録.tbl」は存在しているはずですから、「住所録.bak」を「住所録.tbl」に変更しようとしても、「指定されたファイル名は既に存在します」のエラーメッセージが表示され、ファイル名を変えることはできません。
あらかじめ「住所録.tbl」を他のフォルダに移動しておくか、ファイル名を「住所録1.tbl」など、別の名前に変更しておきます。
質問と回答＿エラー関連
