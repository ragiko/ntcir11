
これまでも本ブログでお伝えしているように、bash に存在する脆弱性「Shellshock」を利用した攻撃が、世界で次々と確認されています。今回はトレンドマイクロが様々な攻撃から確認した攻撃の実態を報告します。調査を進める上で、ワーム活動を持つ不正プログラムや標的型攻撃での使用が確認されました。
「Shellshock」脆弱性を利用するネットワークワームトレンドマイクロではこの脆弱性により流布されている様々な不正プログラムを解析しています。その中で「PERL_SHELLBOT.SM」の一部の亜種が、自律的に脆弱性を持ったWebサイトを検索して侵入するネットワークワーム活動を行うことを確認しました。「Shellshock」脆弱性がネットワークワーム活動に利用されていることを確認したのは初めてです。
このワームは Web検索エンジンの Google を使って TLD(トップレベルドメイン)をキーに Webサイトを検索します。そして検索された Webサイトが「Shellshock」脆弱性の影響を受けるかどうかを調べ、脆弱性が存在する場合は攻撃を行います。この日本版ブログの読者にとっては幸運なことに、日本の TLD である jp は検索候補に入っていませんでした。しかし、当然今後は日本を狙う亜種が登場する可能性があり、警戒が必要です。
標的型攻撃での「Shellshock」脆弱性の利用をブラジルと中国で確認トレンドマイクロでは、標的型攻撃とみられる事例でこの脆弱性が使用されたことを、ブラジルと中国で確認しました。
中国で確認された攻撃は金融機関を狙ったものでした。攻撃者は、特定の金融機関が保有する複数の IP に対し、「Shellshock」脆弱性、特に「CVE-2014-06271」があるかを確認しようとしていたことが明らかになりました。さらに解析を進めていくと、解析した IP のうち 3つは、この脆弱性を抱えていることが判明しました。攻撃者は、脆弱性を利用してコマンド「/bin/uname –a」を利用しようとしていました。コマンド「uname」は、オペレーティングシステム(OS)や PC の種類、プロセッサといったシステムの情報を表示するコマンドです。 PC情報の収集だけならば、一見すると被害はないように思われます。しかし弊社が以前から述べているように、情報収集はより被害の大きい不正活動を行うための準備段階です。標的型攻撃では、攻撃対象組織の持つセキュリティ上の弱点を調べあげ、侵入時に使用します。特に中国の大型連休、国慶節が10月1日から始まることを考慮すると、攻撃を試みた時期は非常に興味深いです。この試みが攻撃の初期段階となり、連休中に実際の攻撃が発生するとの推測は非常に妥当なものと思われます。どこの国でも大型連休の際には IT管理者も休暇で不在なことが多く、発生した攻撃への対処が遅れがちになります。
また、ブラジルでは政府関連機関に対し、脆弱性攻撃による侵入が発生したことを確認しました。この攻撃は情報収集などの準備段階でトレンドマイクロのネットワーク監視ソリューション製品「Trend Micro Deep Discovery」により検知されました。この攻撃の中では「ELF_BASHWOOP.A」の侵入が試行されましたが、感染など具体的な被害には至らなかったことも確認されました。
C&Cサーバの調査から見る「Shellshock」脆弱性への攻撃の影響範囲本ブログでこれまで報告した攻撃は、いずれもバックドア型不正プログラムが流布させることが目的でした。これらの不正プログラムは、複数の共通のコマンド&コントロール(C&C)サーバに接続し、主に DDoS攻撃を行うボットです。
トレンドマイクロではこれらの不正プログラムが接続する C&Cサーバを解析することで、この脆弱性が与える影響の範囲の広さを明らかにすることができました。解析した C&Cサーバの 1つ(89[dot]238[dot]150[dot]154[colon]5)は英国に設置されているものでした。この C&Cサーバは「ELF_BASHLITE.SM」および「ELF_BASHLITE.A」に関連することが明らかになっていましたが、さらに「ELF_BASHWOOP.A」にも利用されていることが判明しました。C&Cサーバへの接続において、「ELF_BASHLITE.SM」との唯一の違いは接続先のポートだけです。「ELF_BASHWOOP.A」は port 9003 に接続しますが、「ELF_BASHLITE.SM」は port 5 に接続します。
同じ C&Cサーバを利用するということは、これらの不正プログラムの背景にいる攻撃者は同じグループであるという推測が成り立ちます。解析を行ったもう 1つの C&Cサーバ(162[dot]253[dot]66[dot]76[colon]53)は米国に設置されており、これについても「ELF_BASHLITE.A」および「ELF_BASHLITE.SM」で利用されていることが確認できました。下記は、主な C&Cサーバにアクセスした国別リストです。ボットは感染後、C&Cサーバへ接続を行うため、アクセス元の国にはこれらの不正プログラムに感染した端末があることが推測されます。
「Shellshock」脆弱性を利用する様々な攻撃を解析:ワーム活動、標的型攻撃、C&Cサーバ | トレンドマイクロ セキュリティブログ
