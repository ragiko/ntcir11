Web サーバーから Microsoft Office ドキュメントを開くと、認証の入力を求められます。 サポート技術情報記事 
838028 では、特定の技術的な理由を説明します。  ただし、その記事では、基になる問題は特定のアプローチの問題は、競合が発生する方法を提供しなくても説明します。 その資料の作成は、Office 2003 の動作について説明しますが、2007 Microsoft Office を基になると同じ動作が存在します。
このドキュメントは、問題は、問題を処理するためにさまざまなアプローチの概要を提供するものです。 現在、万能ではありません。 このため、最も適切な代替機能を対象に必要で、どのような構成を解決するのに依存します。ほとんどの場合、侵害的必要になります。
Internet Explorer は、Office ドキュメントを開くと、適切な Office アプリケーション、ドキュメントのパスが開始されます。 Office アプリケーション、サーバーから直接ドキュメントにアクセスしようとします。 これには、他のブラウザーやその他のファイルの種類からとは異なります。 ほとんどのブラウザーは、ファイルをダウンロードし、ローカル キャッシュからファイルを開くには、アプリケーションを呼び出します。 開かれたファイルが変更され、保存するとこれが発生すると、ただし、変更だけをローカル
コピーとサーバー側のコピーに行われます。
豊富な経験を確立するのには、Office アプリケーションは、まず、サーバーの種類とプロトコルを作成するどのような Web を利用するには、サーバーと通信ができます。アプリケーションは、このオプションは、要求がサーバーに直接行って行われます。 
新しいプロセスとして、サーバーへのアクセス、Office アプリケーションの認証を再交渉する必要があります。このメソッドは、新しいプロセスには、ブラウザーによって設定されて、既存の認証を使用して、メソッドよりも安全です。
この問題はほとんどのイントラネットの場合は、統合 Windows 認証を使用するサーバーを構成して、[自動ログオンを有効にするのには、クライアントを構成する最も簡単に解決です。 ユーザー名とパスワードは、現在ログオンした Windows ユーザーの [自動的に送信サーバーにメッセージを表示せず、ユーザー認証が要求されたときです。
自動ログオンを許可するように Internet Explorer を有効にするには、オプションが、サイトのゾーンを有効にする必要があります。 ローカル イントラネット ゾーンには、既定の構成を自動的にログオンすると、現在のユーザー名とパスワードがあります。 ローカル イントラネット ゾーンは、プロキシ サーバーを使用しない、またはこれらには、制限付きサイト] または [信頼済みサイト ゾーンに割り当てられていない限り、期間 (http://local])
などが含まれていない名前である Web サイトと UNC (汎用名前付け規則) パスを使用して確立されたすべてのネットワーク接続として定義されています。信頼済みゾーンを既定の構成を自動的にログオンする、イントラネット ゾーンでのみです。
Windows Vista 上またはそれ以降のバージョンの Windows 上で 2007 Microsoft Office を使用して Microsoft Office ドキュメントを開くと、アプリケーション、Web 分散オーサリングとバージョン管理 (WebDAV) 接続するには、Web サーバー、Web クライアント サービスを確立しようとします。開始する Windows Vista では、Web クライアント サービスは、WinHTTP ネットワーク プロトコルを使用し、ゾーン マネージャーを使用していません。のみ、次の条件のいずれかが満たされた場合、ログオンしたユーザーの資格情報が自動的に渡されます。
サイト (「ドット」URL ではありません)、NetBIOS 名です。 プロキシを検出すると、サイトの URL をプロキシ バイ パスの条件に一致する. サイトは完全修飾ドメイン名 (FQDN) が、サイトの URL は、Web クライアント サービス パラメーター レジストリ値に AuthForwardServerList が指定された条件と一致する webclnt.dll バージョン 6.0.6000.20729、以上です。(詳細についてはサポート技術情報記事
943280 を参照してください)。
Windows ログオン資格情報は、サイトで必要なものと一致する場合は、統合 Windows 認証はクライアントに自動的に Windows ユーザー名とパスワードを使用してログオンするように構成するようにします。インターネット接続経由で統合 Windows 認証を使用してサポートや推奨されるされていないことに注意してください。
現在ログオンしている-ユーザーの資格情報の場合の注意を内容としてとサーバーとワークステーションの信頼されたドメインでない) ドキュメントにアクセスする必要はありませんが、ユーザー資格情報を入力するように求められます。 一般的なガイドラインは、サイトにアクセスするのには、資格情報を提供する必要がある場合は、通常はドキュメントを開くには、資格情報提供する必要があることです。
統合 Windows 認証を解決できない場合、資格情報プロンプトの問題があることができます。 次の方法は、いくつかの選択肢とその欠点です。 
方法 1: すべての機能が、計算上のリスクで別の方法
を使用してフォーム ベース認証 (FBA) 永続的な Cookie を使用-直接編集機能を維持しても、Office アプリケーションで求めるメッセージが表示されるが、唯一の方法は、フォーム ベース認証を使用して、ISA Server または Forefront 脅威管理ゲートウェイ) などの永続的な Cookie には、プロキシまたはファイアウォール サーバーを実装することです。 ただし、永続的な Cookie が discriminating
いるし、意図しないアプリケーションも、共有の認証を利用することができますので注意ください。適切なのタイムアウト設定を構成してこの危険を減らすことができますが、リスクの要素を紹介します。
ISA 2006 では、永続的な Cookie には、HTML フォーム ベース認証を使用してアプリケーション (Office アプリケーション) など、ブラウザーの外部 Cookie 使用できます。 ただし、Cookie を固定しますです。ブラウザーや、Office アプリケーションを閉じると、ユーザーがインターネット cafe でまたは他の公共の場所で動作していた場合、アクセスできないために削除されません。 ただし、Cookie のタイムアウトは、インターネット
セキュリティとアクセラレータ (ISA) サーバーの設定で、タイムアウトの構成に基づいて適用されます。 
[プライベートのコンピューターでのみ、永続的な Cookie を使用するためのオプションは、この脆弱性が減少しますが、ユーザーが永続的な Cookie 機能を有効にするのには、FBA フォームでプライベートのコンピューターを選択してください。 (ユーザーがプライベートのコンピューターを選択する必要がありますだけが所有しているかを信頼するコンピューターを使用すると、)。
メモ既定では、Windows Vista で、Internet Explorer 7 で始まる永続的な Cookie インターネット エクスプ ローラーで [保護モード] 設定のための共有されません。 説明と問題を回避するには、サポート技術情報記事
932118 を参照してください。
方法 2: は、影響を軽減できるクライアント アプローチ 
アプリケーションを開いたまま – ものでは、直接編集機能を維持するを FBA を永続的な Cookie オプションではありません、ユーザーの複数のメッセージへの影響、最初のアクセスを行った後、アプリケーション開いたままで削減できます。 アプリケーションではなくドキュメントのみを終了して、同じアプリケーションで使用される別のドキュメント、ユーザーが、実行中のプロセスが既に認証されていないための資格情報を求めるメッセージが表示されることがなく開くことができます。まだ別のアプリケーションを必要とするさまざまな種類のドキュメントをプロンプトがサイトにアクセスする必要がある新しいアプリケーションごとにする必要は。
パスワードの保存を選択-の要求に資格情報、パスワードを保存するオプションを選択するより侵入こともできます。これだけ場合は、クライアント コンピューターがプライベートの信頼された環境では、あり公共のコンピューターで使用する必要がありますが行う必要があります。多くの企業のパスワードの保存を禁止するポリシーを設定します。パスワードの保存要求が削除されますが応答にのみ、1 つクリック/キーが必要なように、情報が事前されます。 この方法を使用する場合、サイトを信頼済みサイト
ゾーンに追加する必要があります。 
Preconfigure、オプションが: 情報以前取得され、Office プロトコル検索キャッシュでキャッシュする場合のサポート技術情報記事
838028 資料の前述のとおり、OPTIONS 呼び出しは実行されません。
重要 – はお勧め直接レジストリ キーまたは値を編集します。 情報を事前に設定するのには、最も簡単な方法はコピーし、テスト コンピューターで正常に設定されて後、情報を配布することです。 Office が定期的にキャッシュをクリアするために保存されている情報は一時的なものです。既定では、この制限時間を拡張することができますが、約 2 週間後に、有効期限です。更新プログラムが含まれて作成されたことにこの拡張子は Office
2003 Service Pack 3 (および 2007 Microsoft Office にも使用可能) で時間まで 10 年間。(サポート技術情報記事 
916658 を参照してください)。プロトコルまたはサーバーの種類の変更を作成して、Web、Office 2003 は古い情報が有効で想定する場合は、このレジストリ エントリを使用しての欠点です。
Office プロトコル探索キャッシュ:Office のプロトコルの探索キャッシュには Web フォルダーが開かれ、は、オプションの要求を正常に応答ごとのサブキーのエントリが含まれます。Office 2003 で使用されているレジストリ キーは次のとおりです。
HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Common\Internet\Server キャッシュ
メモ 2007 Microsoft Office のようなキーを使用してが「11. 0」の代わりに「2007」が含まれています。
キャッシュ エントリの最大数が同じサーバーのキャッシュ キーの下にある 
MaxCount レジストリ値を設定できます。オフィスの最大数に達した場合に使用可能な領域を増やすには、古いエントリを削除します。領域を消去する場合は、OPTIONS 呼び出しの結果はキャッシュされません。
オプションの応答を事前に資格情報のすべての要求がなくなる可能性がありますはありません。PROPFIND 要求も、要求の認証で可能性があります。
方法 3: 機能の有効な場合の代替構成
また、追加の資格情報をローカルにキャッシュされたドキュメントの使用を強制することでは必要ありませんので、サイトを構成する方法です。ただし、すべてのユーザー、特定の URL の構成に影響が、直接編集機能が無効になっています。そのため、ほかのサーバーに直接、Office アプリケーションを保存することができます。
ドキュメントがオフラインで編集して、サーバーにアップロードします。 最善の方法は、特定のシナリオと、目的の動作によって異なります。
使用してコンテンツのの種類 – と Internet Explorer が GET 要求を発行、Web アプリケーションが明示的にコンテンツを読み取りとしてマークできる場合があります-のみのダウンロード、ライブの編集セッションをすることはできません (.pdf または .txt ファイルなど) が確立します。 (サポート技術情報記事
899927 で説明されています。使用する方法について説明、「ハイパーリンクからインターネット エクスプ ローラーにアクセス」セクションを参照してください、"コンテンツの廃棄: 添付ファイル"ヘッダー。)
まず、サーバーの種類とはどのような種類のプロトコルを作成する Web を確認するには 、オプションを呼び出す匿名 (なし-SharePoint) を許可する – Office、OPTIONS 呼び出しを送信します。 オプションの呼び出しが成功する参照または一覧のアクセス許可が必要です。
2 番目の認証要求を防ぐには、オプションの応答を返すステータス コード「403」以外を設定する必要があります。Web サーバー、Web アプリケーション ファイルへのアクセスに使用している場合は、アプリケーションをオプションの要求を処理するのには変更できませんでした (などとは、"405: メソッドは許可されていません"メッセージ)。 ファイルのファイル システム Web サーバーにある場合は、ただし、不要な要求成功し、「200」の形式が正しく応答で発生するために、オプションの呼び出しを許可するアクセス許可を変更することによって回避できます。
インターネット インフォメーション サービス ベースのサーバーでは、このサイトでは、IIS マネージャーの [匿名アクセスを有効にすると実行できます。
メモ ネイティブ IIS WebDAV Web サービス拡張機能 WebDAV 機能を提供している場合のみこの回避策を使用します。 FrontPage Server Extensions を使用している場合は、この回避策を実装する必要があります。これは、制限されたアクセスのみを提供するサイトの counterintuitive に見える場合があります。 ただし、制限付きアクセス、ファイル システム レベルで適用できます。
内容の一覧表示アクセス許可 (通常は、サイトのルート) にのみ、オプションの要求をするため、拒否の読み取り と 書き込みの拒否 が (IIS マネージャーでことがあります「インターネット ゲスト アカウント」のフレンドリ名が定義されている匿名アクセスに使用されるアカウントに、フォルダーのアクセス許可を変更しなければなりません。 この、OPTIONS 呼び出しを満たすために必要なアクセス許可がまだすべてのコンテンツへのアクセスを拒否します。 Office アプリケーション、ドキュメント、インターネットのキャッシュから開きます。
[場合は、Web アプリケーションは WebDAV を使用するものではありません オプションおよび PROPFIND 動詞のサポートを無効にする-、WebDAV 機能を提供する Web サービス拡張
[禁止] に IIS を実行している既定のサーバーに設定することができます。(この WebDAV または FrontPage Server Extensions で可能性があります)。サイト別の拡張子を WebDAV の機能を提供する場合、その拡張子のプロバイダーは関連するはずです。たとえば、Windows SharePoint サービス (WSS) でこれを行うには、サイト、クライアントの統合、または、オプションを無効にするように構成する必要があります、PROPFIND 動詞を禁止する必要があります。(IIS
6 では、動詞、<httpHandlers> 登録行を web.config ファイル内から削除します。
Office ドキュメントを開くときの認証要求
