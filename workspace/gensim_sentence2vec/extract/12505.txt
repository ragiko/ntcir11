エクセル 回帰分析を簡単に解決しました。エクセル 分析をマスターしましょう!分析 には、エクセル excel が大変便利です! Homeへ回帰エクセル回帰分析1.エクセル 回帰分析とは身長と体重、景気と化粧の濃さ、アイスクリームの売上げと真夏の気温などは、お互いに強い関係があり、数式で表せそうです。「回帰分析」とは、このように2つの変化するものを数値で関連付け、数式で表すことを言います。また、式は、「回帰式」、直線として仮定した場合、この直線を「回帰直線」、と言います。2.エクセル 回帰分析の例回帰分析の例をEXCELヘルプから例を引用し、説明しました。既知の x   20 28 31 38 40既知の y   06 07 09 15 21主な解析手順は、次の通りです。(1) 行列を入替えて行うため、上記のテーブルを次のようにします。既知のx   既知のy20       628       731       938       1540       21(2)「分析ツール」を起動します。エクセル2003までは、「ツール」−「分析ツール」を選択します。エクセル2007の場合、「データ」−「データ分析ツール」を選択します。なお、「分析ツール」がメニューに表示されていない場合、「オプション」−「アドイン」−「分析ツール」を選びます。(3)「分析ツール」ダイアログボックスが開きます。(4)リストの後半から「回帰分析」を選択し、OKボタンを押し、「回帰分析」ダイアログボックスを開きます。(5)「入力元」−「入力y範囲」にラベルから選択し始め、列方向にマウスでドラッグして「既知のy」の範囲を選択します。(6)「入力元」−「入力x範囲」にラベルから選択し始め、列方向にマウスでドラッグして「既知のx」の範囲を選択します。(7)ラベルを解析結果に表示させるため、「ラベル」にチェックを入れます。(8) 必要がある場合「有意水準」にチェックを入れ、95%の値を 自然科学では99%, 社会科学では90%などと修正します。 (「有意水準」 Wikiより引用 ) ※ 有意水準とは、予め与える仮設である「帰無仮設」を偽として棄却してしまう誤りを犯す確率です。   回帰分析の場合、解析結果に表示される「p値」が(100−有意水準)/100の値より小さくなるかチェックします。(9)「出力オプション」、「残差」、「正規確率」−「正規確率グラフの作成」などに必要に応じてチェックを入れ、OKボタンを押します。 ※ 「正規確率グラフ」は、「残差」の百分位数のグラフを作成する場合にチェックします。   残差つまりエラーが正規分布になっている場合、グラフが直線となっているかどうか、簡単にチェックできます。(10)「p値」が「(100-有意水準)/100」と比較し、小さい場合、「帰無仮設」を棄却します。3.エクセル 回帰分析の検証(1)「偶然」との比較は、どこでなされているのでしょうか?  y = ax + b 式のa, b は、「回帰直線」から(x , y )点までのy方向の距離(y、残差)の二乗の総和が最小になるように計算されます。   a, b は、相関係数と言われています。  この計算は、t 分布の「標本平均」の計算と同じであり、標本サイズを考慮した確率に基づく計算であることが分かります。  この計算方法は、標本平均を数多く収集した場合、「偶然」を示す分布になる、としているのです。  また、(x , y )点の総数(標本サイズ)が大きくし、20〜30個以上にすると、「偶然」を表した「正規分布」に近づきます。(2)「ものさし」として使用されている確率分布は、どの分布でしょうか?  t分布です。(3)「目盛」は、どこにあり、「精度」は、どれ程でしょうか?  「p値」は、確率の「目盛」で、t分布の両側に広がる稀に起こる確率を示しています。  この値は、小さいほど、検定統計量がその値となることがあまり起こりえないことを意味しています。  また、「精度」と考えられる基準は、「有意水準」で、この基準以下の確率になった場合、仮説を棄却する必要があります。  (※ 「帰無仮説」、「H0」などの、「差がない」、という仮説を立て、その仮説を棄却します。)  Homeページで述べましたように、「t値」は、回帰分析で得られた相関係数 a b のt分布での横軸の「目盛」です。  p値の 0.05 と対応した  t値 として計算されます。  t値、p値は、既に説明した方法で、エクセル2003までは、「ツール」−「分析ツール」−「回帰分析」により計算できます。  エクセル2007の場合、「データ」−「分析ツール」−「回帰分析」を選択して計算できます。  なお、「分析ツール」がメニューに表示されてい場合、「オプション」−「アドイン」−「分析ツール」を選び、ツールを使用できます。  次に例を基に計算した、結果の一部を示しました。回帰統計重相関 R    0.904808094重決定 R2    0.818677686  (※ 決定係数と言われています。)補正 R2    0.758236915標準誤差    3.101962408観測数     5      係数      標準誤差    t        P-値     下限 95%    上限 95%     切片   -10.66589506 6.206915957 -1.718388832  0.18422077   -30.41907181  9.087281691 既知のx  0.709104938  0.192672189  3.680369967 0.034748296   0.095936042  1.322273835 残差出力観測値 予測値 : 既知のy  残差   (※ 回帰式により計算され結果と、既知のyとの値の差を示しています。)1   3.516203704   2.4837962962   9.18904321   -2.189043213   11.31635802   -2.3163580254   16.28009259   -1.2800925935   17.69830247   3.301697531この結果より 回帰式は、 y = 0.709104938x -10.66589506 、となることが分かります。tとは、t分布の横軸 t値です。 また、係数は、相関係数です。 また、決定係数 R2 は,1.0と差が無い 0.818677686 となったため、回帰式が有効であることを意味しています。1) 下限 95%は、その要因の95%信頼区間の「下限」です。2) 上限 95%は、その要因の95%信頼区間の「上限」です。  したがって、上限と下限のそれぞれの切片と相関係数(既知のx)を使用し、作成された2つの直線の間の領域が95%信頼区間です。3) 「p値」が、有意水準の0.05または、0.01、 0.1 などと比較し、より小さかった場合、検定結果を再チェックする必要があります。   「p値」の値が水準以下となり、仮説を棄却することになるからです。また、回帰式 y = ax + b により、特定の x に対してワークシート関数=FORECAST(x, xの配列, yの配列)より y を求めることができます。ここで、aは、直線の傾き、bは、y切片です。xには、例えば 30 などの値を引数として与えます。また、xの配列、yの配列にはそれぞれ 20 28 31 38 40、及び 06 07 09 15 21を配列としてセル範囲などで与えることができます。この場合、計算結果は、y = 10.60725 が返されます。4.エクセル 回帰分析に使用される関数(1) LINEST関数は、最小二乗法 を使って指定したデータに最もよく当てはまる直線を算出できます。   また、この関数は、この直線を記述する配列を返すことによって直線の補正項を計算します。(※ EXCELヘルプより引用)   「分析アドイン」は、このLINEST関数を使用し、解析を行っています。(2) TINV関数は、=TINV(確率,自由度)の書式で使用され、確率にP-値、自由度に「標本サイズー1」を入力して「t値」を返します。   A列に自由度(1,2,3,4,5・・・・・29,30)、B,C,D,E列にTINV関数の確率(0.1, 0.05, 0.02, 0.01)を入力します。A     B              C             D             E1  '=TINV(0.1, A1)     =TINV(0.05, A1)     =TINV(0.02, A1)    =TINV(0.01, A1)2  '=TINV(0.1, A2)     =TINV(0.05, A2)     =TINV(0.02, A2)    =TINV(0.01, A2)3  '=TINV(0.1, A3)     =TINV(0.05, A3)     =TINV(0.02, A3)    =TINV(0.01, A3)4  '=TINV(0.1, A4)     =TINV(0.05, A4)     =TINV(0.02, A4)    =TINV(0.01, A4)5  '=TINV(0.1, A5)     =TINV(0.05, A5)     =TINV(0.02, A5)    =TINV(0.01, A5)    ・・・・・・・・   このように自由度を約30まで作成し、信頼性90%、95%、98%、99%のt値の「t分布表」を得ることができます。エクセル 分析をマスターしましょう!分析 には、エクセル excel が大変便利です! Homeへ
回帰分析 には、エクセル excel が大変便利です!
