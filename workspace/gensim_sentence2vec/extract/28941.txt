
B.データの解析と統計的推論
8 標本統計量の確率変動分布
前章において母集団と無作為標本との関係を扱って、標本割合による母集団割合の推定誤差を評価したことからわかるように、標本から求められる指標である標本統計量は、多くの場合、母集団特性を推定するために用いられる。例えば標本平均は母集団平均の推定値として用いられ、同様に標本分散(または標本標準偏差)は、母集団分散(または母集団標準偏差)の推定値として使用される。この章では、各種の標本推定値の確率変動(=
推定誤差)を理解するために、基本的な標本指標である標本平均、標本分散、および
t 統計量の確率変動分布を扱う。
8.1 標本統計量の確率変動シミュレーション
実験の構成
母集団分布形(およびその平均 μ、標準偏差 σ)を決める。 
その母集団から無作為に抽出した 1 つの値が持つ確率変動にしたがう乱数を
n 個使って、独立なサイズ n の
標本: {
X1, X2,…, Xn }
を作る。(仮説的無限母集団から抽出された標本、有限母集団からの復元抽出標本、または非復元抽出標本で有限母集団修正項を
1 と見なし得るような標本に対応)
得られたサイズ n の標本から、標本平均
= 
1
——
n
n
Σ
i=1
Xi
… Excel関数 Average(データ範囲)
標本分散*
s2 = 
1
———
n - 1
n
Σ
i=1
(Xi - )2
… Excel関数 Var(データ範囲)
および t 統計量(後述)
t =
- μ
————
s / √n
を求め、得られた値を記録する。
手順 2, 3 を多数回繰り返して、得られた記録を頻度集計する。
_____
* このテキストでは、現在の統計的環境において一般的に使われている、標本平均からの偏差平方和を
(標本サイズ - 1) で割った(いわゆる)「不偏分散」によって、「標本分散」を定義した。この除数
n - 1 の定義は、t, χ2, F などの統計量を使う時の偏差平方和の自由度に対応している。
ただし母分散 σ2 の推定値として「偏差平方和 / (n -
1)」が、「偏差平方和 / n」より優れているということを、必ずしも意味するわけではない。
例えば、一般に「偏差平方和 / D」(D は任意の正の実数)と置くと、母集団が正規分布の時、母分散推定値として最小の平均平方誤差
E[{(偏差平方和 / D) - σ2}2] を持つのは
D = n + 1 の時であり、前二種の推定式の何れでもない。また「偏差平方和
/ (n - 1)」の期待値は母分散 σ2 になるが(この性質を「不偏(unbiased)」という)、その平方根を取った標準偏差推定値の期待値は母標準偏差
σ にはならない(母標準偏差の不偏推定値となる除数 D は n に依存するガンマ関数を含んだ複雑な値)。
そのため「不偏」を名称として使うことを避け、除数の調整は平方和の「自由度」によって説明している。
実験結果1: 標本平均
例えば、標準正規分布 φ(z: 0, 1) を持つ母集団から
1) サイズ n = 4 の標本を取り
2) 標本平均を計算する
を 1 回の試行として、この試行を 6万 5千回行った結果どのような値の標本平均が得られたかを見ると、
図8-1左 のようになる。また 図8-1右 は、標本サイズ n = 9 の時の結果を表す。
図8-1 標準正規母集団下での標本平均値の確率変動(6.5万回の実験)
図のオレンジ色の部分が、実験値を階級区分した密度であり、黒い曲線は、その理論分布である平均
μ 標準偏差 σ/√n (7.4参照)の正規分布の(階級内)平均密度を表す。
一見して明らかなように、標本平均値は、母平均 μ = 0 を中心とする狭い範囲に集中して出現しており、標本サイズ
n が大きくなると、母平均への集中はさらに顕著になる。 
この集中の程度を、逆に分布の「広がり」の尺度である「標準偏差
1/√n」で見ると、標本サイズ n = 4 の場合には
1/√4 = 1/2 になり、標本サイズ n = 9 の場合には
1/√9 = 1/3 になる。したがって単一標本に比べて、サイズ
4 の標本平均なら確率変動幅は半分に、サイズ 9 の標本平均なら 1/3 に縮小される。 
また「確率変動の集中度 = (推定値としての)精度の高さ」という意味において、「標準偏差の逆数
√n」を指標にして考えると、標本サイズ n = 4 では 2倍(=√4)、標本サイズ
n = 9 なら 3倍(=√9)の精度改善になっている。 
もしも母集団の分布が正規分布でなくとも、標本平均の分布は(ある弱い条件下で)標本サイズ
n が増加するにつれて正規分布に近づくことは、中心極限定理からわかっている(5
中心極限定理と正規分布)。したがって上のような標本平均の確率変動と正規分布との一致は、ある程度の標本サイズであれば、ほぼ任意の母集団分布下の標本平均についても成立していると近似的にみなすことができる。(他の母集団分布形を用いた実験結果から、歪みの強い母集団分布の下では、正規分布への収束が遅いことを確かめよ)
実験結果2: 標本分散
同じ実験条件下における標本分散の確率変動は、下の図のようになる。
図8-2 標準正規母集団の下での標本分散値の確率変動(6.5万回の実験)
標本分散は、0 から母分散 σ2 (= 1)の数倍の範囲を主として変動する。
標本サイズ n が大きくなるにつれて、母分散値 σ2
に集中して行く傾向を持つ。 
この理論分布は、カイ自乗(χ2)分布と基本的に同形であることが知られている(3節参照)。 
標本平均と同様に、標本分散についても中心極限定理が成り立ち、ほぼどんな母集団分布でも、標本サイズが大きくなるにつれて(上のような右歪みを持つ中間形状分布を経て)やがては正規分布に近づく。
8.2 標本平均の理論分布
平均 μ 標準偏差 σ の母集団から独立に取り出されたサイズ n の標本の標本平均
は、正規分布
標本平均 
〜 φ(: μ, σ / √n)
にしたがう確率変動を持つ。
この結果は、母集団分布が正規分布であれば正確であり*、母集団分布が他の分布形の場合には、(一部の例外的な理論分布を除いて)「標本サイズ
n が大きくなるにつれて正規分布に近づく」という意味において漸近的(asymptotic)である。
* 証明はこのテキストの範囲を超えるため省略。実験結果を観察せよ。
8.3 標本分散の理論分布と
χ2 分布
一般に、正規分布 φ(X: μ, σ) にしたがう n 個の独立な確率変数
X1, X2, …, Xn において、その標準化された値の自乗和:
u = 
n
Σ
i=1
(
Xi
- μ
———
σ 
) 
2
=
n
Σ
i=1
zi2
は、自由度 ν = n のカイ自乗(χ2)分布*にしたがう。
自由度 ν の χ2 分布の密度曲線**
χ2(u: ν) =
1
————
Γ(ν / 2) 
1
————
2 ν / 2
u (ν / 2) - 1
e - u / 2  (0 < u <
∞)
Excel関数 … ChiDist(u,自由度ν), ChiInv(確率,自由度ν)
χ2分布は、非負領域における右に歪んだ分布であるが、
自由度 ν が大きくなるにつれて、正規分布に近づく。
標本分散 s2 は、先の u において母平均 μ の代わりに標本平均を使った
w =
n - 1
——
σ2
s2 =
n
Σ
i=1
( 
Xi - 
———
σ
)
2
の形に変換すると、自由度 ν = n - 1 の χ2 分布
χ2(w: n - 1) にしたがう***。 w における
(n - 1) / σ2 は定数であり、w は s2
の 1 単位を (n - 1) / σ2 に縮尺変換した値にすぎないため、標本分散
s2 の分布曲線と χ2 分布曲線とは(分布形状として)基本的に同じになる。
この結果は正規母集団からの独立なサイズ n の標本については正確であり、母集団分布が他の分布形(一部の例外を除いて)の場合には、標本サイズが大きくなるにつれて近づくという意味において漸近的(asymptotic)である。
_____
* χ はギリシャ文字「カイ(chi)」の小文字であり、自由度を表す
ν は、ギリシャ文字「ニュー(nu)」の小文字。
** 式中で使われているガンマ関数 Γ(x) は、階乗(例えば
5! = 5・4・3・2・1)の実数への拡張になっており、m が自然数なら Γ(m + 1)
= m! に相当する。また、任意の s について Γ(s + 1) = sΓ(s)、Γ(1/2) =
√π。Γ関数の定義や性質については、解析学のテキストなどを参照。
*** 母平均を標本平均で置き換えた結果、自由度は1減少することに注意。これは、w
における変数 Xi (i=1,…,n) の一次変換を適切に決めると、w
は n - 1 個の互いに独立な標準正規変数 zi の自乗和に表せることによる。例えば
n = 2 の場合、w = [(X1 - X2)
/ (σ√2)]2
となることが簡単な式の変形により示せる。この場合 z = (X1
- X2) / (σ√2)
と置くと、z は標準正規分布にしたがう(6章)。つまり w = z2
であるから、w の確率変動は 1つの標準正規変数の自乗が持つ確率変動に等しいことがわかる。n
≧ 3 の場合については、実験において正規母集団下の n = 3 〜 5 程度の小さな標本サイズを設定し、実験結果の相対頻度と、対応する自由度の理論曲線(自由度が小さい場合には顕著に変化する)とが一致することから、経験的に理解せよ。
8.4 標本平均の標準化された推定誤差:
Student の t 分布
標本平均を母平均 μ の推定値として使う時には、その推定誤差 
- μ を評価する必要がある。標本平均の確率変動は、平均 μ 標準偏差 σ /
√n の正規分布になることから、母標準偏差 σ の代わりにその標本推定値
s を使って推定誤差を標準化(standardize)した値
t =
- μ
———
s / √n
を考える。
もしもこの統計量 t が持つ確率変動の分布形がわかっていれば、推定誤差変動の中心部が確率
β となる臨界点 t0 を
P{ |t| < t0 } = β  =>  P{
|  - μ | < t0・s
/ √n } = β
のように選んで、推定誤差の確率変動範囲 ±t0・s / √n
つまり「推定精度」を標本から計算できる。また同様に、母集団平均 μ
に関する統計的検定を行う場合も、推定誤差の確率変動を尺度とした判定を用いたい場合が多いため、この
t の分布がわかれば多くの統計的検定が容易に実行可能になる。
母集団分布が正規分布の時、上の t 統計量の分布は、自由度
ν = n - 1 の Student の t 分布*と呼ばれる分布形状を持つ。
実験結果3: t 統計量
下の 図8-3 は、標本平均および標本分散と同じ 6.5万回のモンテカルロ実験における
t 統計量の相対頻度を表したものであり、n = 4 のグラフは正規分布よりも両裾の広い独特の形状を示しているが**、n
= 9 のグラフはより標準正規分布に近いことがわかる。
図8-3 標準正規母集団の下での
t 統計量の確率変動(6.5万回の実験)
一般に、z が標準正規分布、u が独立に自由度 ν の χ2
分布にしたがうとき、
t =
z
—————
√(u / ν) 
は、自由度 ν の Student の t 分布にしたがう。
[ 自由度 ν の Student の t 分布の密度曲線 ]
t(t: ν) = 
Γ[(ν + 1) / 2]
——————— 
Γ(ν / 2) 
1
————— 
√(νπ) 
1
————————— 
(1 + t2/ν) (ν + 1)/2
(-∞ < t < ∞)
Excel関数 … tDist(t, 自由度, 片側両側確率の区別1or2)、
ただし t≧0 のみ有効。tInv(確率,自由度)
t 分布は、軸
t=0 を挟んで左右対称であり、標準正規分布よりも裾の広い形状を持つ。
また自由度 ν が大きくなるにつれて、標準正規分布に近づく。
自由度が大きい(例えば 25 以上の)場合は、標準正規分布で近似してもほとんどの場合問題は生じない。
先の標本平均と標本分散(の平方根である標本標準偏差)から構成される t
統計量
t = 
- μ
————
s / √n
は、以下のように標準正規変量 z とカイ自乗変量 w で表せることから、
=
- μ
————
σ / √n
σ
——
s
=
z
————————
√[w / (n - 1)]
分母の w とその自由度 n - 1 より、自由度 ν = n - 1 の Student
の t 分布にしたがうことがわかる***。
_____
* W.Gosset が「Student(一研究者、一学徒などの意味)」
というペンネームで、1908年に発表した論文において初めて導かれた。そのため伝統的に、このペンネームを冠して呼ばれる。ただし
W.Gosset が分布を導いた統計量は、現在の t とはわずかながら違った形式であり、現在使われている
t 分布の形式は、この理論を発展させ一般に広めた R.A.Fisher(1925) によるもの。
** 標本サイズ n = 2 の時、この t 統計量の自由度は
1 になり、自由度 1 の t 分布は 19 世紀中葉には知られていた古典的分布であるコーシー(Cauchy)分布になる。コーシー分布の密度曲線は
f(x) = (1 / π) [1 / (1 + x2)] (-∞ < x
< ∞) で表される。(現在コーシー分布と呼ばれることが多いこの分布を、初めて著作物で取り扱ったのは
Cauchy ではなく Poisson という説もある)
*** ただし z と w の統計的独立性は、このコースの範囲を超えるため証明を略す。
8.5 Bootstrap法による標本分布推定
母集団に関する知識と理想化から導かれる理論分布や、ある条件下での統計量の理論的性質などを用いると、分析において簡潔で強力な手法が利用可能になるが、これらの前提になる条件が常に成り立つわけではない。また統計量の種類によっては複雑な確率分布を持ち、その分布の確率計算が一般の環境において与えられて居ないものも多い。さらに現在は、急速に統計分析の利用が広がっており、以前は扱われなかったような複雑な推定値が求められ、その理論的性質が未だ充分に研究されていない状況もしばしば発生する。
一方、コンピュータの進歩によって、計算量の大きさや計算の複雑さは統計分析の障害ではなくなりつつあり、たとえ大量で複雑な計算が必要であっても、「ゆるやかな適用範囲を持った標準的な理論分布」ではなく、「個別データの特徴に即した確率計算」が利用可能になって来た。そのような大規模計算に基づく現代的な統計分析手法の代表に、ブートストラップ法(bootstrap
method)*があり、広範囲な分野において既に標準手法となりつつある。
___
* "bootstrap"は長靴(ブーツ)の一番上に付いている"つまみ"部分のこと(それを持ち上げて長靴を履く)。英語では"to
pull oneself up by one's bootstrap(自力でやってのける)"など、比喩的に「自力達成」の意味に使われる。ブートストラップ法の創始者
B.Efron によると、英語のこの比喩は、18世紀の「Munchausen男爵の冒険(R.E.Rapse作)」におけるエピソード『男爵は深い湖の底に沈んでしまった。すべてが終わったかのように見えた時、男爵はブーツのつまみで自分自身を持ち上げることを思いついた』に由来するとか。この手法では標本データが、(他の助けを借りず)自力で標本分布を導出してしまうことに掛けた表現。
ブートストラップ法の原理
ブートストラップ法は、非常に簡単な原理に基づいている。いま標本を小母集団と考えて、そこから同サイズの標本を復元抽出法によって無作為に取り出すことを考える。このように標本から再び(任意サイズの)標本を取り出すことを、一般に再標本抽出(resampling)と言う。
実際の標本(標本サイズ n)
(復元無作為抽出)
同サイズ n の標本(ブートストラップ標本)
目的とする統計量の計算
こうして得られた同サイズの標本(ブートストラップ標本)から、目的とする統計量を計算する。この再標本抽出と統計量の計算を多数回繰り返せば、Monte-Carlo法によるその統計量の確率変動分布(または必要とする分布指標値)が得られる*。
つまり、本来の母集団からの"自由な全組み合わせ"の標本抽出実験を行うには「母集団情報」が必要であるが、"限られた組み合わせ"の標本抽出実験であれば「小母集団」である「標本情報」のみを用いて
Monte-Carlo 実験を行うことが可能になる。
_____
* サイズ n の小母集団(実際の標本)から得られるブートストラップ標本の全組み合わせは、小母集団の成員がすべて相異なる値を持つ場合
2n-1 C n-1
通り(C は組合せ数)あるため、通常は膨大な数になる。例えば n=10 なら 約
9万2千 通り、n=20 なら 約 689億 通り、n=30 では 約 5京9千兆 通り となって、標本サイズ
n が増えるにしたがって指数的に増加する(n が 1 増えると 2 倍弱に増加)。現在のコンピュータはかなり高速であるが、それでも多くの場合、この全組み合わせを求めるには時間が掛かりすぎる。そのため、通常は
Monte-Carlo法 によってその一部を無作為抽出で求める推定方式が用いられる。
例:20人の男子学生の身長データ
以下の頻度分布図に示す20人の男子学生の身長データは、2002年度統計学受講者データ中の男子283人からの無作為標本であり、典型的な小標本データの散らばりを持つ。
図8-4 20人の男子学生の身長の分布
データ(20人)
平均 = 172.2、
標準偏差 = 5.7
参考:
母集団(283人)
平均 = 172.5、
標準偏差 = 5.1
以下では、これまでの母集団を想定した Monte-Carlo 実験手順を念頭に置いてブートストラップ法を見た方がわかりやすいため、この
20 人のデータの平均値を μ 、標準偏差を σ と表す。
上のサイズ 20 のデータから、同サイズ n = 20 の標本を復元抽出で無作為に取り出し、標本平均、標本分散、t統計量(μはデータの20人平均)を計算し記録する
Monte-Carlo実験を行う。図 8-5 は、6.5万回の実験から得られた各統計量のブートストラップ分布であり、大数の法則によってほぼ安定した分布形に収束している。
図8-5 20人の男子学生の身長データから得られた各統計量のBootstrap分布
a)
b)
c)
図8-5 a) 一般に標本平均の確率変動は、中心極限定理によって正規分布に近いことが予想される。図の黒い曲線は、平均
μ 標準偏差 σ/√n の正規分布密度であり、オレンジ色のブートストラップ法によって得られた確率変動とほとんど一致している。ブートストラップ分布はわずかに中心部が右に傾いているが(実際の標本=小母集団の分布が左歪みを持つ兆候)、標本平均の確率変動を正規分布と仮定しても、ほとんどの統計的推論において充分な精度を持っていることがわかる。
図8-5 b) 一般に標本分散の確率変動は、母集団分布形によって異なる。図の黒い曲線は、自由度
ν = n - 1 のカイ自乗変量 w に σ2/(n-1)
を掛けて縮尺変換した値の分布であり、母集団が正規分布の場合に対応している。オレンジ色のブートストラップ法によって得られた確率変動は、より右歪みの小さい形状を示す。したがって、もしもこのデータに対してカイ自乗分布に基づく推論を適用した場合、無視するにはやや大きな誤差が生じる可能性を持つ*。
図8-5 c) 一般に t統計量の確率変動は、母集団分布形によって異なる。図の黒い曲線は、自由度
ν = n - 1 の Student の t 分布の密度であり、母集団が正規分布の場合に対応している。オレンジ色のブートストラップ法によって得られた
t 統計量の確率変動は、この理論分布とほぼ一致している。したがって、データの分布(図8-4)や標本分散のブートストラップ分布において意識される「正規母集団仮定からの乖離」は、t
統計量の分布には顕著な影響を与えていない**。そのため、このデータに対して
Student の t 分布に基づく推論を適用しても、実際的には充分な精度を持っていることがわかる。
ブートストラップ法を用いた統計的推論については次章で扱う。
_____
* このデータの場合には母集団データがあるため、やや大きな歪みが(283人から20人を選んだ時の)偶然的な標本抽出変動に過ぎないか、それとも母集団の特徴が
20 人のデータに反映された結果なのか、を確認することは可能。
** t 統計量の分布は、母集団分布形にあまり敏感ではないことが、様々な研究から知られている。問題は「いま分析している対象において、Student
の t 分布と、どの程度の違いがあるか」が不明な点にあり、ブートストラップ分布によって、この度合いが(特定ケースに過ぎないとは言え)確認可能になる。
8 標本統計量の確率変動分布
