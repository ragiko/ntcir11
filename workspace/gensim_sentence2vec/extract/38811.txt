
Next: 二つの条件を全て満たす個数を数える: COUNTIFS
Up: 表計算
Previous: 演習
Contents 
二つの条件を全て満たす、どちらかを満たす個数を数える: SUMとIF
前節では、2つの条件を全て満たすもの、或はどちらかを満たすものについて「1」を、そうでない場合「0」を、IF文を用いて
出力させる方法を学びました。2つの条件を全て満たすもの、或はどちらかを満たすものの個数を数える場合、セル毎にIF文を
機能させ、「0」か「1」を出力し、最終的にそれを合計して個数を求めました。この作業をIFとSUMを同時に用いて、一度に行うことが
可能です。例えば、あるセルの領域で、任意の「条件1」を満たす場合の個数を求めたい場合、
=SUM(IF(条件1,1,0))
のようにします。
この条件が例えば、セルの領域、A1:C6までのセルのうち、数字が5以上
であるという条件である場合、
=SUM(IF(A1:C6>=5,1,0))
となります。しかし、このまま「Enter」keyを押すと
#VALUE!
となって、計算が出来ません。これは、IF文の条件式では、通常一つのセルしか参照できない
からです。上の例の場合、A1:C6までの配列を指定しています。
配列とは、数学の行列の様な
ある行と列からなる数字のグループです(図の参照 12.3.10)。
Figure 146:
配列
この様な場合は、
「Control」+「Shift」を押しながら「Enter」を押し、計算が配列を想定して行うものである事を
Excelに理解させなければなりません。
皆さんに作表してもらったデータで、このことを演習してみましょう。
ランクインした大学の内、大学の種類が「FO」であるものは何校ありますか?
SUMとIFを使って「Control」+「Shift」を押しながら「Enter」を押すのを
忘れずに、求めてみましょう。さて、この結果はCOUNTIFを用いたものと
同じになるでしょうか?
条件がひとつだけである上の例では、COUNTIFを用いる方がシンプルです。
しかし、COUNTIFは条件が一つしか与えられません。一方、SUMとIFを併用
する場合、用いる事が出来る条件数は限りがありません。また、次節で説明する
COUNTIFSは、配列に対して2つ以上の条件を課して、それら全てを満たす場合の
数をカウントしますが、2つ以上の条件のいずれかを満たす場合や、複雑な条件
の設定が関数中ではできません。ここでは、SUMとIFを用いて、やや複雑な条件設定を
クリアする場合の数を数えましょう。
例えば、大学の種類が、「FO」または「SP」である大学はランクインした大学中に
何校あるのかを計算する際には、二つの条件式を足し算記号で足し合わせて、条件式を
書きます。即ち、
Figure 147:
IFとSUMの同時使用
のように書く事になります。「FO」または「SP」である大学
の場合、「1」とし、それがSUMで合計されます。この場合も
配列をIF文で指定していますので、「Control」+「Shift」を押しながら「Enter」を押す
必要があります。
(コピーして使う事を想定していなければ、
図の様なマーク(図の参照 12.3.10)を範囲の指定時に使う必要はありません。)
さて、もう少し複雑な条件でSUMとIFの併用を考えてみましょう。
例えば、「条件1」または「条件2」を満たすもののうち、「条件3」を満たす
場合の数を数えるには、以下の様にする必要があります。
=SUM(IF( (条件3)*( (条件1)+(条件2) ), 1, 0 ))
ここで、条件1と3は足し算記号で組み合わされ、それらが全て大括弧で括られています。
さらに、その大括弧と条件3がかけ算記号で組み合わされています。前節と同様、IF文条件中の
かけ算記号()は「かつ:AND」、足し算記号(+)は、「または、OR」を表します。
この条件設定を用いて、大学の種類が「FO」または「CO」である、アメリカ「US」の大学数
をカウントするには、以下の様に書きます(図の参照 12.3.10)。
Figure 148:
IFとSUMの同時使用
ここで、D列にはランクインした各大学の国名が書かれてあり、また、AC列には、別に作成した国別の統計表の国名が記載されています。
AC2には、「US」が記載されていますので、条件3は、「D3:D37="US"」 と同一であることが分かります。
また、図の範囲指定は、行についてで絶対参照されていますので、これを国別統計表で下にコピーすれば(図の参照 12.3.10)、条件3のAC列の参照
が一個ずつ下にずれますので、大学の種類が「FO」または「CO」である大学数を国別に数える事が出来ます。
Figure 149:
IFとSUMの同時使用
Takeyoshi Nagai
2013-09-03
二つの条件を全て満たす、どちらかを満たす個数を数える: SUMとIF
