						jQuery(java script)で別ページから単語のリストを取り出し、自動的にその単語が出てきた時にリンクが挿入される様にしたいのですが問題点が…。
jQueryを用いて、ページに特定単語が出てきた時に自動でリンクが貼られる様にしたく、以下の様なスクリプトを書いたところ、とりあえず動作することは確認しました。
簡単に流れを説明すると、特定単語は別ページにあるのでgetメソッドを用い、dtタグ内の文字列とそのidを1セットとして配列に代入。
配列の例:[ "単語1" , "単語1のID" , "単語2" , "単語2のID" ,… ]
次に、配列内の文字列が呼び出し元ページに含まれているかを正規表現で特定し、含まれていたら単語を%で囲み、その後にreplaceメソッドによりaタグで囲んであげるという方法をとっています。
ちなみにidはリンク先URLとして活用しています。
%で囲んでいるのは、配列内に一部重複する文字列がある場合の対策です。
例えば配列内が["あいうえお","id001","あいう","id002"]という順に代入されてた場合、先に"あいうえお"で貼られたリンクが後から"あいう"としてもリンクされるのを防いでいます。
しかし、この方法では問題があることに気付きました。
例えば、先程の逆順で配列内が["あいう","id01","あいうえお","id02"]とした場合に(※順番を入れ替える等の策は都合により不可)、"あいうえお"という単語がある場合にも"あいう"としてのリンクしか貼られなくなってしまいます。
何か上手い解決法を思い付く方がいましたら、ご助言を宜しくお願いします。
字数の制約により、やや分かり難い文章となり申し訳ありません。
呼び出し元ページ内の記述 A.html:
<p id="autoLink">この中で自動リンクさせたい。あいうえお、あいう。</p>
特定単語の記されたページ B.html:
<dt id="id001">単語1</dt> <dt id="id002">単語2</dt>…
JavaScript:
term= [];
$.get("B.html",function(termData){
$(termData).find("dt").each(function(){
term.push($(this).html());
term.push($(this).attr("id"));
});
});
jQuery.fn.autolink = function() {
return this.each(function(){
var srcText = this.innerHTML;
for (var i=0; i<term.length; i+=2){
srcText = srcText.replace(eval("/([^\%])"+term[i]+"([^\%])/g"),'$1%'+ term[i] +'%$2');
}
for (var i=0; i<term.length; i+=2){
srcText = srcText.replace( eval("/\%"+term[i]+"\%/g") ,"<a href=B.html#"+term[i+1]+"'>"+dict[i]+"<\/a>");
}
this.innerHTML = srcText;
});
};
$(function(){
$("#autolink").autolink();
});
補足spared_turkeyさん、有難うございます。
が…当方の知識不足で分からぬままの点があります。
特定単語のあるB.htmlは単なる単語とIDだけが列挙されたものでは無い為、
ご提示頂いた例をそのままという訳にいかず、B.htmlの中で明確にdtで囲まれた単語とその属性(ID)値だけを
得る必要があるかと思います。その方法が具体的に思い付かず…
ご回答頂いたばかりで頼ってしまい申し訳ありませんが、宜しければご助言頂けますと幸いです。
jQuery(java script)で別ページから単語のリストを取り出し、自動的にそ... - Yahoo!知恵袋
