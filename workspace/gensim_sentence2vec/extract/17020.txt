表領域のアラートの管理
Oracle Databaseでは、使用可能な領域が少なくなると事前にアラートで通知されるため、表領域のディスク領域を管理するのに役立ちます。デフォルトで、警告およびクリティカルの2つのアラートしきい値が定義されています。警告のしきい値は、領域が残り少なくなり始める境界値です。クリティカルのしきい値は、即時に注意を喚起する必要のある深刻な境界値です。データベースは、両方のしきい値でアラートを発行します。
ローカル管理表領域とディクショナリ管理表領域の両方に対してアラートしきい値を指定するには、次の2つの方法があります。
パーセント・フルによる方法
警告のしきい値とクリティカルのしきい値の両方について、使用済領域が合計領域の一定割合以上になるとアラートが発行されます。
空き領域(KB単位)による方法
警告のしきい値とクリティカルのしきい値の両方について、空き領域が一定容量(KB)未満になるとアラートが発行されます。空き領域のしきい値は、表領域が大規模な場合に便利です。
ローカル管理表領域のアラートはサーバーで生成されます。ディクショナリ管理表領域の場合は、Oracle Enterprise Manager Cloud Control (Cloud Control)がこの機能を提供します。詳細は、「サーバー生成アラートを使用したデータベースの監視」を参照してください。
新しい表領域には、次のようにアラートしきい値が割り当てられます。
ローカル管理表領域: ローカル管理表領域を新規作成すると、データベースに定義されているデフォルトのしきい値がその表領域に割り当てられます。新しく作成されたデータベースには、警告のしきい値に85%使用済、クリティカルのしきい値に97%使用済のデフォルトが割り当てられます。新しいデータベースに対する空き領域のしきい値のデフォルトは、両方ともゼロ(無効)です。これらのデータベースのデフォルトは変更可能で、その手順については後で説明します。
ディクショナリ管理表領域: ディクショナリ管理表領域を新規作成すると、Cloud Controlのメトリック・カテゴリ「表領域の空き領域(MB)(ディクショナリ管理)」および「表領域使用率(%)(ディクショナリ管理)」の「その他すべて」にリストされているしきい値が割り当てられます。これらの値は、「メトリックとポリシー設定」ページで変更できます。
注意:
Oracle 9i以前からOracle Database 10g以降にアップグレードするデータベースでは、すべてのローカル管理表領域のアラートしきい値のデータベースのデフォルトは、0(ゼロ)に設定されます。この設定は、アラート・メカニズムを事実上使用禁止にして、新しく移行されたデータベースへの過剰なアラートを回避しています。
アラートしきい値の設定
各表領域には、パーセント・フルのしきい値のみ、空き領域のしきい値のみ、または同時に両方のしきい値タイプを設定できます。どちらのタイプのしきい値も、0(ゼロ)に設定すると無効になります。
理想的な警告のしきい値は、クリティカルのしきい値が発行される前に問題を解決できる時間を考慮して、早めにアラートを発行する設定です。クリティカルのしきい値は、ただちに処理してサービスの損失を回避できるよう十分早めにアラートを発行するように設定します。
ローカル管理表領域のアラートしきい値の設定方法
次のいずれかを実行します。
Cloud Controlの「表領域」ページを使用します。
表領域の領域使用量アラートしきい値の変更の詳細は、Cloud Controlのオンライン・ヘルプを参照してください。
DBMS_SERVER_ALERT.SET_THRESHOLDパッケージ・プロシージャをコールします。
詳細は、『Oracle Database PL/SQLパッケージおよびタイプ・リファレンス』を参照してください。
ディクショナリ管理表領域のアラートしきい値の設定方法
Cloud Controlの「表領域」ページを使用します。
表領域の領域使用量アラートしきい値の変更の詳細は、Cloud Controlのオンライン・ヘルプを参照してください。
例 - Cloud Controlを使用したアラートしきい値の設定
表領域に対する領域使用率がしきい値に達した場合、Cloud Controlはアラートを受け取ります。領域使用率のアラートは2種類あり、「警告」は、表領域の使用量が低い場合に、「クリティカル」は、表領域がほぼ一杯でアクションがすぐに必要な場合に発行されます。
警告アラートとクリティカル・アラートの両方に、次の方法でアラートしきい値を指定できます。
使用領域ごと(%)
使用されている領域が全領域の一定の割合以上になった場合、アラートが発行されます。
空き領域ごと(MB)
空き領域がMB単位を下回る場合、アラートが発行されます。
空き領域のしきい値は、表領域が大きい場合ほど有用です。たとえば、10TBの表領域で限界のアラートの割合を全体の99%に設定すると、100GBの空き領域が切った場合データベースによってアラートが発行されることになります。通常、空き領域が100GBになったということは重大な状態ではないため、アラートは有効とはいえません。この表領域の場合、空き領域が5GBを切った場合に限界のアラートを発行するような設定の方が、空き領域のしきい値が有効に使用されています。
表領域に対する警告および限界のアラートの両方に関して、使用されている領域のしきい値または空き領域のしきい値のいずれか、または両方を有効にできます。
表領域の領域使用量アラートしきい値を変更するには、次の手順を実行します。
データベース・ホームページに移動します。
「管理」メニューから、「記憶域」を選択し、「表領域」を選択します。
表領域ページが表示されます。
変更するしきい値を持つ表領域を選択し、「編集」をクリックします。
表領域の編集ページ、および一般サブページが表示されます。
ページ上部の「しきい値」タブをクリックし、しきい値サブページを表示します。
「使用済領域(%)」セクションで、次のいずれかを実行します。
デフォルトしきい値を許可します。
「しきい値の指定」を選択し、「警告(%)」のしきい値および「クリティカル(%)」のしきい値を入力します。
「しきい値の無効化」を選択し、すべてのしきい値を無効にします。
「空き領域(MB)」セクションで、次のいずれかを行います。
デフォルトしきい値を許可します。
「しきい値の指定」を選択し、「警告(MB)」のしきい値および「クリティカル(MB)」のしきい値を入力します。
「しきい値の無効化」を選択し、残りの空き領域のしきい値を無効にします。
「適用」をクリックします。
確認メッセージが表示されます。
例 - パッケージ・プロシージャを使用したアラートしきい値の設定
次の例は、USERS表領域について空き領域のしきい値を10MB(警告)および2MB(クリティカル)に設定し、パーセント・フルのしきい値を無効にします。USERS表領域はローカル管理の表領域です。
BEGIN
DBMS_SERVER_ALERT.SET_THRESHOLD(
metrics_id              => DBMS_SERVER_ALERT.TABLESPACE_BYT_FREE,
warning_operator        => DBMS_SERVER_ALERT.OPERATOR_LE,
warning_value           => '10240',
critical_operator       => DBMS_SERVER_ALERT.OPERATOR_LE,
critical_value          => '2048',
observation_period      => 1,
consecutive_occurrences => 1,
instance_name           => NULL,
object_type             => DBMS_SERVER_ALERT.OBJECT_TYPE_TABLESPACE,
object_name             => 'USERS');
DBMS_SERVER_ALERT.SET_THRESHOLD(
metrics_id              => DBMS_SERVER_ALERT.TABLESPACE_PCT_FULL,
warning_operator        => DBMS_SERVER_ALERT.OPERATOR_GT,
warning_value           => '0',
critical_operator       => DBMS_SERVER_ALERT.OPERATOR_GT,
critical_value          => '0',
observation_period      => 1,
consecutive_occurrences => 1,
instance_name           => NULL,
object_type             => DBMS_SERVER_ALERT.OBJECT_TYPE_TABLESPACE,
object_name             => 'USERS');
END;
/
スキーマ・オブジェクトの領域の管理
