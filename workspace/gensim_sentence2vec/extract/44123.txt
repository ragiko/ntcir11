フーリエ解析は、元々は微分方程式を解くために生まれました。しかし、現在では音や画像といった「マルチメディア」に関する分野で不可欠になっています。また、整数論の分野でも重要で、最近有名になった量子コンピュータで暗号解読が出来る「Shorのアルゴリズム」でも重要な位置を占めています。
このフーリエ解析、基本的な発想はすごく単純です。一言で言えば、「あらゆる波を Sin の和で表す」というものです。計算も、Sin/Cosと微分・積分を知っていれば十分理解可能です。ここでは、複素関数の知識は使わず、高校生でも理解できるポイントをまとめてみました。
(きぃたんさんにアドバイスいただいて、少し説明修正しました)
音って何でしょう。「何」といわれても困るかもしれませんが、音とは「空気を伝わる波」です。そして、波は「空気の震えてる度合い(振幅)」として数字で表すことが出来ます。この数字を電流としてスピーカーに流すと、音を再現することが出来ます。これが私たちが聞いているCDやパソコンの音楽の仕組みです。
これをもう少し数学的に考えてみましょう。
音のデータは時間が決まると値が定まるのだから、時間の関数f(t)と書くことが出来ます。二つの音を加えるのはf(t)+g(t)。カセットテープを二倍の早回しするのはf(2t)。あなたがCDを買うのは{f(t)|0(分)<t<74(分)}という関数を買っているのです。実感湧きますか?
音、といっても色々あります。話し声、音楽、水が流れる音、車のエンジン音、ジェット機の爆音などすべて音です。では、一番基本的な音は何でしょう。先に述べた通り音は波ですから、ここは一番基本的な波、Sin波を考えるのが自然でしょう。Sin波を音として聴くと、音叉の音が一番近いようです。
Sin波では、音の「高さ」「大きさ」を簡単に考えることができます。Sin波は周波数ωと振幅Aを用いてf(t)=A*sin(ωt-t0)と書くことができますが、ここでωが音の高さを表し、Aが音の大きさを表します。例えば,一般に音叉は「ラ」の音で、これは440Hzなのでf(t)=A*sin(440*t/(2π)-t0)と表すことができます。なお、振幅Aは叩いた強さや観測する場所によって変わります。
では、Sin波以外の音では「高さ」「大きさ」はどうなるのでしょうか?Sin波以外ちょっと複雑な波形でも、周期Tがあれば、この逆数から周波数を求めることができます。このとき、一周期の波形が音の音色を決めています。音の大きさも振幅で大体決めることができます。ここで出てきた「高さ」「大きさ」「音色」を、音の三要素と言います。(下図参照)
先程も述べましたが、二つの音が同時に鳴っている状態を表すには,単に二つの式を足すだけでOKです。例えば、ラ(440Hz)とミ(660Hz)の和音なら、下の図のようになります。
しかし、こうして波を足すと、もはや初めの「音の三要素」が見えなくなってしまいました。代わりに見えるのは、複雑な波形を持った一つの音です。この音の周波数は220Hzで、元の音のどちらとも一致しません。これは新しい音色の音なのでしょうか、それとも和音なのでしょうか?実際にこの音を聞いてみると、聴きようによっては一つの音にも和音にも聞こえます。
このように、先の「音の三要素」の説明だと、複数の音が鳴っている場合、波形を見ただけでは鳴っている音の数を判断できないため、音色と複数の音の和を区別することができません。
さらに、問題な事には、二つの音を足すタイミングをちょっとだけずらしてやると、様々な波形の音が出来てしまいます。例えば、先のラとミの和音なら、下のような波形も考えることが出来ます。
これらは聴くと同じに聴こえますが、波形はずいぶん違っています。二つの音を足すタイミングは無限に存在するので、こうした同じ音を表す波形も無限に存在することになり、分析にはとても不便です。
ここで発想の転換をはかってみます。「全ての周期を持つ音は、その周期の整数倍の周波数を持つSin波の足し合わせで表現できる」と考えてみます。周期が整数倍というのは、Sin(kt)に対しSin(2kt),Sin(3kt)...を考えるわけです。イメージ的には下の図を見て下さい。
すると、今までのように複数の波の和と音色を区別する必要がなくなります。ここで、音の要素になっている各Sin波の強さを比較したとき、強いものいくつかが「音の高さ」として聴こえ、それ以外の音は音色として聞こえているわけです。このように、周期関数を同じ周期を持つSin波の和で表現することを「フーリエ展開」と呼びます。
言葉で言うだけではなかなかわかりにくいと思うので、例を挙げてみます。さっき出した複雑な音は、実は下のような基本音とn倍音に分解できます。これを各成分ごとの強さで表したのを「離散スペクトル」と呼びます。
また、先に挙げたラとミの和音は、基本周期は220Hz(440と660の最大公約数)に対し440Hz(ラ)と660Hz(ミ)の音を足したものなので、スペクトルは下のようになります。
一般に、人間の耳は一番強く出ている倍音を音の高さとして、それに付随する細かな倍音成分は音色として認識します。なので、先の「複雑な波形」の方は一つの音に、「ラとミの和音」の方は別々の音に聞こえます。また、ラとミの和音のほうは、どのようなタイミングで足し合わせてもスペクトルは全部同一です。このことから、音色を分析するには一度フーリエ展開すると扱いがとても楽になることが分かります。
先程は「これはこうなる」という形でフーリエ展開の実例を挙げましたが、実はこうした展開は計算で簡単に求めることができます。ここでは、その計算法を挙げてみます。
音の関数をf(t)と書くと、これがSin波の和で表せる、というのは、
と書けます。ここで、p0は直流成分、pkは各Sin波の強さを、θkは各Sin波をずらして足してもいいことを表しています。ここで、計算の都合上θをばらしてみます。加法定理より
となるため、このak,bkを用いて先の式を書き直すと
となります。
さて、いよいよ各フーリエ係数を求めてみます。その前に、ちょっとした積分の復習を。SinやCosを一周期で積分すると0ですが、SinやCos同士を掛けて積分すると、以下のようになります。
これを見ると、Sin波二つを掛けて積分すると、位相と周波数がそろっているときに限り値が0でないことがわかります。これを使うと、先のak、bkを求めることができます。
まず、音をそのまま積分してみます。
SinやCosの成分は消え去って、a0が求まりました。次に、Cosを掛けて積分してみます。
次はakが求まりました。最後に、Sinを掛けて積分すると
と、見事bkが求まりました。
各成分ごとの強さ…という意味でckの表示に戻したいときは、先の
から導かれる関係、
ck2=ak2+bk2
を使って求められます。
まとめてみると、以下のような積分でak、bkを求めることができます。
フーリエ解析 : kei@sodan
