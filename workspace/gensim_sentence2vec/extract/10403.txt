 
セルに関数を入れたら[#N/A]って表示されてしまうんです!
エクセルのあるあるエラーの代表格の [#N/A] ですね。
このエラーが表示されるのは、関数の使い方に誤りがある時です。
参照すべき引数が間違っている、範囲の仕方が間違っている、等と要因は様々。
しかし、関数の使い方は間違っていないのに#N/Aエラーが表示されてしまうこともあります。
とはいえ大概数式や参照値のどこかに誤りがあるはずなので、それを探してみましょう!
今回は前回紹介した [【Excel】VLOOKUPの使い方、使う場面] を元に説明します(*゜゜*)
#N/A エラーの解消方法
前回紹介したVLOOKUP関数の使い方を例に説明していきます。
まずは画像をご覧下さい。
[C8]をオートフィルで[C17]までコピーしています。
VLOOKUP関数を使用してそれぞれの商品名の商品番号を右のテーブルから参照しています。
※ 詳細は[【Excel】VLOOKUPの使い方、使う場面] をご覧下さい
#N/Aエラーが出てしまう原因
なぜ#N/Aエラーが出てしまったのでしょうか?
数式バーを見てみましょう。
[ =VLOOKUP($B8,$I$5:$L$11,3,FALSE) ]
画像では[C8]がアクティブになっているので、この数式は[C8]のものです。
これといって特に何もおかしいところはありません。
むしろしっかりと検索値のB8や、テーブルの範囲を$で固定しているので
オートフィルにも影響をきたすことのない数式に仕上がっています。
画像では[C8]を起点に下方向へオートフィルを引っ張っていますが、
[C9] : [ =VLOOKUP($B9,$I$5:$L$11,3,FALSE) ]
[C10] : [ =VLOOKUP($B10,$I$5:$L$11,3,FALSE) ]
[C11] : [ =VLOOKUP($B11,$I$5:$L$11,3,FALSE) ]
…
といった具合に自動で数式がコピーされていきます。
お察しのいい方はお気づきかもしれませんね。
もう一度画像をご覧下さい。
検索値となる [B9], [B10], [B11]… が、空欄ではありませんか!
そうです、空欄となっているセルを参照してしまったが為に、
#N/Aエラーが表示されていたのですね～(´・ω・｀)
検索値に[りんご]や[もも]等を入力すると、
やはり入力した行の関数は正しく機能してくれました。
#N/Aエラーを表示させない方法
このままでも使用することはできますが、やはりエラーが出ているのは気持ち悪いものです。
「#N/Aエラーを消す」 というと少々語弊があるので、
ここでは「#N/Aエラーを表示させない」とします。
IF関数を使えば簡単に#N/Aエラーを非表示にさせることができます。
1. [C5] でIF関数を使用する
[C5]の数式をあらかじめコピーしておき、[C5]の内容を一度クリアします。
コピー: [ VLOOKUP($B5,$I$5:$L$11,3,FALSE) ]
[C5]をクリアしたら数式バーの左にある[fx]をクリックし、IF関数を探します。
※ 関数の分類: [論理] で探すとすぐに見つかります
2. IF関数に論理式・真の場合・偽の場合を入力し、OKをクリックする
IF関数の入力画面では次のように入力します。
論理式 : ISBLANK(B5)
真の場合 : “”  (ダブルクォーテーションを2つ)
偽の場合 :VLOOKUP($B5,$I$5:$L$11,3,FALSE)
論理式では指定したセルが空欄かどうかを調べてくれる ISBLANK 関数を使用しています。
[ISBLANK(B5)]としていますが、ISBLANK($B5)とすればオートフィル時に楽になります。
真の場合の [“”] は、キーボードでShiftを押しながら[2]を押せば出てきます。また、省略しても構いません。
偽の場合はあらかじめコピーしておいた数式から、= を抜いたものになります。
3. オートフィルで数式をコピーし、#N/Aエラーが消えたことを確認する
4. 単価にも同じようにIF関数を使用して完成させ、動作を確認する
バッチリです!
空欄も消えたし、商品名を入れればキチンとVLOOKUP関数も動作してくれます!
これで無事#N/Aエラーを消すことができたので完成ですね!
個人的メモ
IF関数を使うことでかなり色々なことができるようになります。
今回やったのは、「ISBLANK関数を使用して商品名のセルが空欄だったときは何も表示させず、何か入力されている場合はVLOOKUP関数を実行する」というものです。
真の場合で “” と入力していますが、これは「空の文字列」を意味します。
本来関数の中で文字を入力したい場合はダブルクォーテーションで文字を囲むという決まりがあります。
例えば関数を使用して「りんご」と入力したいなら、「“りんご”」と入力しなければなりません。
つまり、ダブルクォーテーションで囲まれた部分が文字列として認識されるので、「””」とすると、ただの空欄ではなく空の文字列として扱われるのです。
IF関数が使えるようになると、本当に仕事がはかどります。
せっかくなので、近いうちにIF関数についてご紹介していきたいと思います(*゜゜*)
【Excel】#N/Aエラーになってしまう
