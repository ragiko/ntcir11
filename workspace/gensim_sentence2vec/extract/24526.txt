
カスタム ボタンをホストする
ボタンのホスト先について
ボタンの XML ファイルのホストに使用するダウンロード先 URL をどこにするかは、その URL がボタン更新時のボタン固有の ID となるため、重要です。 同一の URL でダウンロードを繰り返しても、ツールバーでは古いボタンの置き換えのみが行われ、新しいボタンが追加されることはありません。 詳細については、カスタム ボタンの更新をご覧ください。
自作のボタンを Google ボタン ギャラリー に追加する
自作のボタンを Google のボタン ギャラリー  に追加することで、世界中の人々に自分の新しいボタンを知らせることができます。 そのためには、XML ファイルが既にどこかにホストされており (ボタン ギャラリー からファイルに直接リンクされます)、ボタンが Google の編集ガイドラインに準拠している必要があります。
ご自身のウェブ サイトのボタンを作成された場合は、サイトと同じドメインで XML ファイルをホストしてください。 Google のボタン ギャラリー にあるボタンは、ボタンがアクセスするドメインと同じドメインにホストされている場合、"公式" なものと認められます。 これによって、ユーザーはお客様のサイトへ導かれる公式なボタンを簡単に見つけることができます。
完了したらボタン ギャラリー の申請フォームに記入し、ボタンの詳細を Google までお知らせください。
サイトからボタンにリンクを貼る
インストール リンクを作成すると、ご自身のサイトでボタンの配布ができるようになります。 Google ツールバー 4 のユーザーがそのリンクをクリックすると、設定されたボタンをインストールできることを通知するメッセージが表示されます。 ユーザーが互換性のあるツールバーをインストールしていない場合は、Google ツールバーのダウンロードのページが表示されます。
開発者は次の URL シンタックスを使用して、インストール リンクを作成することができます。
http://toolbar.google.com/buttons/add?url=url
上記 url はカスタム ボタンの XML ファイルが存在する URL です。 たとえば、Slashdot.com ボタンをインストールするリンクは次のとおりです。
<a href="http://toolbar.google.com/buttons/add?url=http://www.slashdot.org/slashdot_button.xml">Add</a>
このリンクのラベルは Add です。 ユーザーがこのリンクをクリックすると、Slashdot.com のボタンがユーザーのツールバーにインストールされます。
上記の Google URL は、基本的にはツールバーのカスタム ボタンをインストールする URL です。 ユーザーが互換性のあるツールバーをインストールしていない場合は、Goolge ツールバーのダウンロードのページが表示されます。 Google ツールバーがインストールされると、カスタム ボタンは自動的に追加されます。
フィード トラフィックを管理する
フィードを含むウェブ トラフィックには問題が起こる可能性があります。  ボタンが誘導するフィードの人気が出て、トラフィックが増加することが予想される場合は、回線容量の少ないサーバーにリンクさせない方がよいでしょう。  更新のリクエストによって負荷がかかりすぎる場合があります。
カスタム ボタンにはフィード用の refresh-interval 属性があります。  ツールバーは、サーバーが HTTP ヘッダーに記述する "Expires" 時間に従います。  この設定は、ボタンの refresh-interval を上書きします。  サーバーに負荷がかかりすぎた場合は、この "Expires" 時間を延ばし、負荷がかからないようにします。  たとえば、ボタンを 1 時間ごとに更新するように設定してある場合、"Expires" 時間で更新が 1 日に 1 度行われるように設定すれば、トラフィックを大幅に減らすことができます。 
Expires 時間を 1 週間先に延長する PHP スクリプトは次のとおりです。
<?php
$expires = gmdate("D, d M Y H:i:s", time() + 3600 * 24 * 7) . " GMT";
Header("Expires: " . $expires);
?>
サーバーからの HTTP レスポンスの例:
HTTP/1.1 200 OK
Date: Thu, 05 Jan 2006 23:39:54 GMT
Server: Apache/2.0.47 (Red Hat Linux)
Accept-Ranges: bytes
X-Powered-By: PHP/4.3.2
Expires: Thu, 12 Jan 2006 23:39:54 GMT
Transfer-Encoding: chunked
Content-Type: text/html
備考
XML リファレンス 
カスタム ボタンの XML ファイルは次のような構造を持っています。
<?xml version="1.0" encoding="utf-8"?>
<custombuttons xmlns="http://toolbar.google.com/custombuttons/">
<button>
<!-- XML elements -->
</button>
</custombuttons>
次の XML 要素は <button> 要素の中で出現します。  (<update>以外の) すべての要素は、複数回出現してもかまいませんが、異なったロケールに割り当てられている必要があります。
<title> テキスト </title>
カスタム ボタンの一覧 ([設定] > [オプション] > [ボタン] > [カスタム ボタン]) に表示されている、またはオプションとしてボタンの横に表示される、カスタム検索ボタンのボタン名。 この値は、検索タイプで出現した場合、デフォルトのキーワードとして機能するため、他と重複しないものにします。
この要素は次の<search> 属性と同じ locale 属性をサポートします。 
<title> の例を参照してください。
<description> ツールのヒント </description> 
カスタム検索のツールのヒントのテキストは、ポインタを合わせることで表示されます。 ボタンをダウンロードした後にユーザーに表示される説明は次のとおりです。
この要素は次の<search> と同じ locale 属性をサポートします。 
<description> の例を参照してください。
<site> URL </site>
検索ボックスに新しいテキストが入力されていないときに誘導されるオプションの URL です。プロトコルはセキュリティのために http と https に限られています。 この URL では次の変数が拡張されます。{domain}, {url}, {url.noescape}, {url.host}、および {locale}
<site>要素は、次の<search>と同じmethod、およびlocale属性をサポートします。 
<site>の例を参照してください。
<search> url-template </search>
検索ボックスに検索クエリを入力してボタンをクリックするとアクセスし、検索を実行する URL  です。URL は http:、または https: ベースである必要があり、javascript: は使用できません。  テンプレートには、変数 {query} が必要ですが、他の URL テンプレートに含めることはできません。  この要素は必須ではなく、検索ボタンの一覧に含めない場合は省略してかまいません。  
検索要素は次の属性を指定します。
method="post"|"get"
デフォルトは "get" ですが、 "post" に設定して、URL エンコード形式のデータを送信するときに post を使用することもできます。 エンコーディング メソッドはアプリケーション/x-www-form-urlencode である必要があります。 検索が実行されると、疑問符 ? に続くすべてのテキストが postdata として送信されます。
locale="en"|"da"|"de"|"es"|"fi"|"fr"|"it"|"ja"|"ko"|"nl"|"no"|"pt-BR"|"ru"|"sv"|"zh-CN"|"zh-TW"
この要素が別の URL を提供するようにロケールを指定します。 locale="fr" のように、完全な ISO ロケール名を含めてください。  通常は、独自のロケール属性と別の URL をそれぞれ持っている複数の要素を指定します   (この属性に加えて、他の XML 要素を同時に使用する場合は、他のアイコンやテキストを指定することもできます)。ロケールの例、およびISO ロケール テーブルをご覧ください。
<search> の例を参照してください。 
<send> url-template </send>
検索ボックスに検索クエリが入力されておらず、ブラウザ内のテキストが選択されているときに誘導される、任意の URL 送信テンプレートには、変数 {selection} が必要ですが、他の URL テンプレートに含めることはできません。
<send> 要素は、上記の <search>  属性と同じく method、charset、および locale 属性をサポートします。 
<send> の例を参照してください。
<icon> base64 エンコード </icon>
Windows の .ico ファイルの実際の記述部分で、多くのサイトで "favicon.ico" ファイルとして使用している、XP スタイル 16×16 32 ビット RGBA 画像を推奨します。 これはバイナリ値であるため、base64 でエンコードする必要があります。 アイコンが存在しない場合は、デフォルトのアイコンが表示されます。  16×16 XP スタイルのアルファ ブレンドした .ico 画像が適していると言えますが、通常の ICO、JPG、BMP、GIF にも対応しています。サイズは任意でかまいませんが、16×16 にリサイズされます。 XP RGBA アイコンは Google ツールバーが動作する全ての OS で動作しますので、256 色や 16 色の予備を作成する必要はありません。.  PNG はサポートしていません。 
mode、およびtype 属性は必須ではありませんが、あれば XML エディタでの編集作業が楽になります。
mode="base64"
アイコンのエンコーディング
type="image/x-icon"
画像の種類
この要素は上記の <search> 属性と同じく locale 属性をサポートします。 
<icon> の例を参照してください。
<feed> URL </feed>
RSS 2.0、または Atom Feed 0.3/1.0 XML ファイルに URL を指定します。 この要素は、Firefox RSS ブックマークと同じような、RSS フィードのタイトル、詳細、リンクを備えたプルダウン メニューを開く機能を追加し、自動的に更新されます。  この要素は任意で、カスタム検索ではほとんど使用されることがありません。 {domain}、および {locale} 変数もフィードで使用します。 
この要素は次の属性を持っています。
menu="true"|"false"
false に設定して、フィードの入力内容のプルダウン メニューを非表示にする。 デフォルトは true です。
refresh-interval="secs"
フィードをリロードするまでの秒数。 デフォルトは、3600 秒 (1 時間) です。 ツールバーは値が 60 未満の場合でも 1 分に 1 回以上の更新は行いません。
refresh-onclick="true"|"false"
true に設定して、ユーザーがボタンをクリックするたびにリロードが行われるようにする。 デフォルトは false です。
google-service="true"|"false"
Google アカウントのサービスの場合に true に設定して、ユーザーが Google にログインしないと利用できないようにする。 ログインを検知すると更新が行われ、ログアウト時にメニュー アイテムがクリアされます。
この要素は上記の<search> 属性と同じく locale 属性をサポートします。 
<feed> の例を参照してください。
<feed-icon> base64 エンコード </feed-icon>
フィードに新しいアイテムがある場合に表示される予備のアイコンで、<icon> と同じ形式です。 ユーザーがボタンをクリックすると、アイコンは次回のフィード時まで通常のアイコンに戻ります。 フィード サーバーは Atom Feed または RSS 2.0 レスポンスで直接アイコンを指定し、その場合、<feed-icon>、または<icon>は 2 番目の優先事項となります。
この要素は上記の<search> 属性と同じく locale 属性をサポートします。 
(<feed-icon> の例はありませんが、こちらの <icon> の例に似たものとなります)
<feed-description> ツールのヒント </feed-description>: 
フィードに新しいアイテムがある場合にツールのヒントに表示される予備の説明です。  ユーザーがボタンをクリックすると、説明は次回のフィード時まで通常の説明に戻ります。
この要素は上記の<search>属性と同じく locale 属性をサポートします。 
(<feed-description>の例はありませんが、こちらの<description> 例に似たものとなります)
<update> URL </update>
このボタンをダウンロードした URL で、ユーザーが更新リンクをクリックしたとき、置き換え用の XML ファイルを入手する URL です ([設定] > [オプション] > [ボタン
] > [カスタム ボタン] > [ボタンの選択] > [編集] > [最新バージョンにアップデートする])。 この URL は Google 以外のウェブからインストーラをダウンロードした場合、実際にダウンロードした URL に置き換えられます。 この要素はカスタム ボタンでロケール属性を持たない唯一の要素です。 
詳細については、
<update> の例をご覧ください。
<option> 部分要素 </option>
ツールバーの設定のダイアログ ボックスで、ローカルに定義されたオプション文字列を簡単に指定することができます。  この値は {option1} 変数で返されます。  この要素は 3 つの部分要素を持ち、最初のものは必須です。
<title>
オプション名  ツールバーの設定ダイアログ ボックスにこの名前が表示されます。  この部分要素は必須です。
<description>
オプションの説明  この説明が表示されます。  それぞれのオプションには複数の説明を適用できます。  この部分要素は任意です。
<default>
{option1}タグのデフォルト値  この値はユーザーが値を指定しなかった場合に使用します。  この部分要素は任意です。
<option> の例.を参照してください。
エスケープ文字
XML ファイル (および HTML ファイル) の文字列は、次にあるようにエスケープする必要があります。
文字
Google ツールバー API - カスタム ボタンを作成する方法
