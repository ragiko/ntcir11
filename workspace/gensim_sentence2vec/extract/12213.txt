コンテンツをMKVで制作する利点のひとつは、異なる地域にいる視聴者があなたの作品を楽しめるように、複数の字幕トラックを含められることです。しかし、多言語字幕の追加に際しては不確実な要素が伴います。例えば、コンテンツの鑑賞に適したフォントを視聴者がインストールしているか、すべての視聴環境において字幕が正しい書式で表示されるか、あなたが含めたすべての言語の表示に対応していないデバイスでファイルを再生するとどうなるかなどです。
DivX PlusがMKVコンテナに提供する拡張機能であるWorld Fontsは、あらゆるプレーヤーが確実にフォントを読み込んで、すべての言語の字幕を表示できるように、適切なTrueTypeフォントをファイルに埋め込みます。特別な最適化手法によってフォントデータのサイズを大幅に削減することで、デスクトッププレーヤーだけでなく、DivX Plus Web Playerやメモリ容量に制約のあるハードウェアデバイスでもフォントを読み込めるようになります。
実際の動作を見る
Blender Foundationの作品であるSintelの予告編をエンコードし、日本語などの東アジア言語を含む4言語の字幕のそれぞれについて、World Fonts拡張機能が有効のものと無効のものを用意しました。World Fontsを含む字幕は、あなたのローカルシステムまたはプレーヤーがその言語をサポートしていなくても正しく表示されます。なお、DivX Web Player 2.0.2ではWorld Fontsの初期実装のみを提供しており、今後さらに最適化されます。
以下の字幕が利用可能です:
フランス語
フランス語(World Fonts有効)
中国語(現時点では正式サポートされていません)
中国語(World Fonts有効)
日本語(現時点では正式サポートされていません)
日本語(World Fonts有効)
ロシア語
ロシア語(World Fonts有効)
再生中のビデオを右クリックして字幕を選択してください。中国語と日本語は現時点ではDivX Plus Web Playerで正式サポートされていませんが、World Fontsが適用されていると正しく表示されることが確認できます。
ファイルをダウンロードして、DivX Plus Playerで再生することもできます。
動作の仕組み
World Fonts拡張機能によって、コンテンツ制作者は特定のTrueTypeフォントを独立したそれぞれの字幕トラックに関連付けることが可能になります。それぞれの字幕トラックを解析して表示に必要なすべての文字と記号を特定し、不要なデータを削除することで、フォントデータが最適化されます。そして、それぞれのフォントは.mkvファイルに埋め込まれ、その最適化対象となった字幕トラックに関連付けられます。ファイルサイズの削減によって、DivX Plus Web Playerやメモリ容量に制約のあるDivX対応デバイスでも、長時間にわたるバッファリングを要することなく多言語字幕を利用できます。
最適化の効果
ラテンアルファベットを使用するほとんどの西ヨーロッパ言語(英語、フランス語、ドイツ語、イタリア語、スペイン語など)の字幕を最適化すると、必要となるグリフは通常60から110になります。ちなみに、デスクトップソフトウェアで字幕を描画するのによく使われるフォントであるArialは、1,600以上のグリフを含んでいます。Arialを西ヨーロッパ言語の字幕のために最適化すると、通常86-92%のデータを節約できます。
典型的なフランス語の字幕トラックに最適化した西ヨーロッパフォント。
(クリックして拡大)
アジア言語ははるかに多くのグリフとフォントを使用するため、これらの言語に対応するフォントは巨大なサイズになることがあります。たとえば、Arphicの繁体中国語フォント”PL KaitiM”は14,000グリフを擁し10MB近い大きさです。多くのデバイスにおいて、このように大きなサイズのフォントを単純に読み込むことはできません。しかし、中国語や日本語などの言語の字幕トラックを表示するのに必要なグリフは、これらのごく一部だけです。
典型的な字幕トラックに最適化した簡体中国語フォント。
(クリックして拡大)
すべての言語をサポートする完全なUnicodeフォントは、さらに大きなものになります。たとえば、よく知られるArial Unicodeは、50,000を超えるグリフからなる22MB以上のデータです。これらのケースでは、多くの言語において、最適化によってデータの99%以上を節約できます。
.mkvファイルにWorld Fontsを追加する
.mkvファイルにWorld Fontsを追加するには、フォントの最適化を実行するユーティリティと、この拡張機能の要件を完全に満たすファイル書き込みプログラムを使用します。DivXでは、DivXMKVMuxサンプルツールにおいてリファレンス実装を提供しています。はじめに、DivXMKVMuxパッケージのダウンロードとインストールをしてください。
(クリックして拡大)
スタートメニューのDivX Plusプログラムグループの中にあるショートカットからコマンドコンソールを起動すると、DivXMKVMuxに簡単にアクセスできます。コンソールはインストールディレクトリで開始し、またインストールディレクトリは自動的にコンソールセッションのためのPATH環境変数に追加されるので、他のどのディレクトリからも単に”DivXMKVMux”と入力することができます。
以下のコマンドで、DivXMKVMuxの引数の完全なリストを参照できます:
DivXMKVMuxはきわめて柔軟であるため、ヘルプの出力は膨大になります。しかし、必要な構文は実際のところ非常に単純です。DivXMKVMuxを使用して.mkvファイルに最適化したフォントを追加する方法はいくつかあります。もしまだ.mkvファイルに字幕を追加していないなら、1ステップの簡単な操作で字幕トラックと最適化したフォントを追加できます。既存の.mkvファイルをremuxすることを意味する -r を使用し、それから字幕ファイルと関連付けるフォントファイルを –s で指定します。
DivXMKVMux -o MyOutput.mkv -r MyInput.mkv -s font:MyEnglishFont.ttf lang:eng name:English English.srt -s font:MyFrenchFont.ttf lang:fre name:French French.srt -s font:MyGermanFont.ttf lang:ger name:German German.srt
字幕トラックの名前の指定は任意ですが、正しい言語コードを指定しなければなりません。言語コードを指定しないと、いくつかのプレーヤーで字幕トラックが正しくリストされないことがあります。有効なアルファベット3文字の言語コードは、ISO 639.2コード表で確認できます。空白を含むファイル名は、ダブルクォーテーション(””)で括ることを忘れないようにしてください。
すでに字幕トラックを含む.mkvファイルを使用する場合は、DivXMKVMuxが解釈する順番の通りにトラック番号がリストされるよう、はじめに既存のトラックを記載してください:
DivX PlusのMKV拡張機能 (1) – World Fonts(最適化された多言語字幕) | DivX Japan Blog
