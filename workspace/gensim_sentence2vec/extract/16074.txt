
[[20040626035949]] 『パーセンテージへの変換』(cocomaya) >>BOT
[ 
初めての方へ | 
一覧(最新更新順) | 
| 
| 
全文検索 | 
過去ログ | 
HOME ]
『パーセンテージへの変換』(cocomaya)
エクセルファイルへ、入力した数値を%に変換したいのですが、何かいい方法があったら教えてください。
例えば、簡単な例を挙げると、
横行1縦列1に2、横行1縦列2に3、横行1縦列3に5とあります。横行1縦列4は合計で10です。
これをそれぞれ、0.2、0.3、0.5、1.0と変換したいのです。
簡単な方法は、空いているセルに 0.1 と入力しそれをコピーします。
変換したいセルを選択して、
形式を選択して貼り付け乗算にチェックOK
では?
(jindon)
下のA2:D2を数式によって表示できればよろしいでしょか?
A	B	C	D
1 2	3	5	10
2 0.2	0.3	0.5	1
[A2]=A1/$D$1
これをB2からD2へコピー&貼り付けしてください。(一部訂正しました)
(meisui)
説明がたりなかったようで申し訳ないです。
私が知りたいのは、
A	B	C	D
1 2	3	5	10
と入力されているものを、手動計算ではなく(標本が300近くあります)、合計(上図D1)を1とした場合のそれぞれ(上図A1-C1)の%を自動に、下図のように変換する方法です。
A	B	C	D
1 0.2	0.3	0.5	1
と変換する方法です。
A1:D1に「そのまま表示すること」が必要なんでしょうか?
入力したセルそのものに、ということであれば難しいですよね。
私の提示した方法では無理ですか?最も基本的な方法だと思いますが。
A2:D2には計算式が入ってるといういう意味ですけれど、
書き方が悪くて分かりづらかったでしょうか。
(meisui)
>標本が300近くあります
標本とおっしゃっているものごとに合計の入っている列がバラバラなので
上の方法では対応しきれない、
いちいち /$D$1 の部分を設定するのは大変だ、ということでしょうか?
300の標本ってどういう意味なのか理解できてないので追加で書いちゃいました。
(meisui)
meisuiさん、ご親切にありがとうございます。
300の標本とは、横行が300あり、それぞれ、異なる数値が入っているという意味です。
A	  B	C	D
1   2	  3	5	10
2   6      10    4        20
(中略)
300  3      5     2        10
簡単に書くと上のような感じです。
これを
A	  B	C	D
1   0.2	  0.3	0.5	1
2   0.3    0.5   0.2      1
(中略)
300  0.3    0.5   0.2      1
としたいわけです。「Dを1とした場合の%を簡単に求める方法」とでもいいましょうか。
meisuiさんのおっしゃるとおりだと、300回掛けるA〜C、カット&ペーストしなければならないという事でしょうか?
あと
[A2]=A1/$D$1は、どこに入れればよいでしょうか?上図のA2からD2を使うのでしょうか?
横レス失礼します。
それでしたら、作業セル(E1からH列)を使用して
E1=A1/$D1 を入力し、あとはE1を選択してコピー、E1からH300を選択して貼り付けで出来ると思います。
(川野鮎太郎)
衝突しました。(川野鮎太郎)さんとダブる内容もありますが
エクセルの基本機能には次のようなお約束があります。
・セルは複数の値をもつことができない。
・セルの内容は値か関数のどちらか片方だけである。
・セルへ入力された値を勝手に変更したりはしない。
あるセルに入力されている数値を他のセルの値によって
自動的に変更してしまうにはそのような仕組み、つまり
「VBAによるマクロプログラミング」が必要です。
一応マクロ以外の提案をしておきます。
他のセルで計算
A列からD列はそのまま入力用の列としておいて他の列で計算します。meisuiさんの提案は、cocomayaさんの例示したサンプルが少なすぎたために直下の行での計算を行うものになってしまったに過ぎません。シートには256列もあるのですから余分に使っても問題ないのではないですか? 計算前の数値が邪魔なのであれば、不要なときはその列を非表示にすればよいのです。
D列の値でA列からD列を除算
元の入力した値がまったく不要であり、もう余分な列は増やしたくないということであれば、D1:D300をコピー > A1:D300を範囲選択 > 「形式を選択して貼り付け」「値」「除算」にチェックして「OK」という方法ではいかがですか?
この学校でも「入力する・データを保存する部分」=「見せる・印刷する部分」
としているために苦労している相談が多いですね。
(KAMIYA)
>[A2]=A1/$D$1は、どこに入れればよいでしょうか?上図のA2からD2を使うのでしょうか?
すいません。やはり分かりづらかったようです。
[A2]=A1/$D$1は、A2セルに
=A1/$D$1 
と記述するという意味で書きました。
これをB2〜D2にコピー&貼り付けしますと、
B2 は =B1/$D$1 に、 C2 は =C1/$D$1 に D2 は =D1/$D$1 に なります。
これで理解いただけないと私には説明不可能・・・かな。
(meisui)
最初の問題提示に300行のデータという件がなかったために
結果として「作業行」による説明をしてしまい、分かりにくくしてしまいましたが
多くの方からご指摘があるように「作業列」を使って仕事しましょう。
この場合でしたらその方が分かりやすいです。
いやなら「作業シート」でも良いのです。
(実質的な変化ではないので今までの説明で納得いただけたら無視してください)
cocomayaさんが提示されたとおりの300行の元のデータはSheet1にあるとします。
Sheet2の A1セルに
=Sheet1!A1/Sheet1!$D1
と入力して、それを A1:D300 全部にコピーしてください。
勝手な提案しちゃいましたけど、やっぱり意味薄いかな〜〜〜?
皆さんの書き込みですでに問題が解決しているように祈ってます。
(meisui)
meisuiさん、川野鮎太郎さん、どうもありがとうございました。
どうにか、%への変換が完了しました。
そこで、次の問題が発生しています。
各列の平均を(=average)で得たのですが、これをカット&ペーストすると#REF!という表示が現れてしまいます。また、各数値をSPSSにカット&ペーストするつもりですが、これもうまくいかなさそうです。絶対参照やオートSUMで得た値はカット&ペーストできないのでしょうか?
>絶対参照やオートSUMで得た値はカット&ペーストできないのでしょうか?
そんなことは無いと思いますけど・・・。
#REF!が出るということは、参照元が無いということなので何かやり方が間違っているのではないでしょうか。
具体的に提示してもらったほうが、回答が得られやすいと思いますよ＾＾
(川野鮎太郎)
今、A1からD300にもとのデータ、E1からH300にそれらを%に変換したものがあります。
あとA301からD301、E301からH301には縦列の合計が入力されています。
まず、A1からD301はもういらないので、削除したところ、E1からH301が#REF!になってしまいます。
また、特定の横行をカット&ペーストしても同様です。
つまり、E1からH301のデータをこれから色々組み合わせたりしたいのですが、全く動かせない状態です。
(cocomaya)
先に申し上げたように、A1からD301が必要ないからと消してしまえば、E1からH301の
参照元がなくなってしまうために#REF!のエラーとなるわけです。
E1からH301のデータを使いたくて、A1からD301を消したい場合には一度E1からH301のデータを
数値化する必要があります。
E1からH301のセルを選択し、コピー−編集−形式を選択して貼り付け−数値で変換を行った後で、
A1からD301を削除してください。
(川野鮎太郎)
川野鮎太郎さん、ありがとうございます。
形式を選択して貼り付けは、新しいシートを開いてという事でしょうか?
また、数値で変換をする方法を教えていただけますか?
(cocomaya)
コピー−編集−形式を選択して貼り付け−値の間違いでしたm(_ _)m 
(川野鮎太郎)
『パーセンテージへの変換』(cocomaya) エクセル Excel [エクセルの学校]
