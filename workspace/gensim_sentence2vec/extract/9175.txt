操作方法の要約
Excelを用いて,右の表1のようなデータ(2列)から図1のような散布図を作成し,相関係数,回帰直線を求めるには
(1)
散布図の作成方法は［こちら］
(2)
図1の(2) 回帰直線 を表示するには:
散布図のマーカー(右図では青の点)の1つを右クリックし,「近似曲線の追加」「線形近似」
(3)
図1の(3)(4) 回帰直線,相関係数Rの2乗を表示するには:
1
グラフ中の「近似直線」を右クリック「グラフに数式を表示する」「グラフにRー2乗値を表示する」をチェックOK
(これらの式はテキストボックスなので,適当な場所に移動して見やすくすることができる.)==>データが更新されれば自動的に追随する.(データ範囲が変われば,範囲指定の変更は必要)
2
回帰直線の方程式 y=ax+b のa,bだけを求めたいときは
=SLOPE(yの配列の範囲,xの配列の範囲)a
=INTERCEPT(yの配列の範囲,xの配列の範囲)b (※引数の順序に注意)
(4) 相関係数を求め,無相関の検定をするには
(実際には相関がないものに回帰直線を求めてもだめなので相関係数を先に求める方がよい)
1
散布図を作成しなくても,「分析ツール」を利用すれば相関係数は求められる:「ツール」「分析ツール」「相関」「OK」入力元:入力範囲として表2の場合3列全体をドラッグ(範囲指定の際に,表2においてx,y,zというタイトルも含める場合,「先頭行をラベルとして使用」にチェック)OK
出力される表には,すべての組合せの相関係数が表示されるので,x−x組のように自分自身との相関係数は1となる.また,x−yの相関係数とy−xの相関係数は異なるが,右の表3においてはx-yの相関係数が0.807と表示されている.(R=0.807R2=0.6515)==>データが更新されても再度出力しないと結果は追随しない.
2 correlation :相関
==>散布図なしで,データ更新時に相関係数が追随するようにするには(ただし,データ範囲が変われば,範囲指定は必要)
関数CORREL(系列1の範囲,系列2の範囲)
または
関数PEARSON(系列1の範囲,系列2の範囲)
を利用することができる.(直接入力または挿入関数統計)
返される値は表3のうちの1つの値(0.807など)
3
標本相関係数をrとするとき母相関係数ρが0(無相関)でないための限界値は右のr表によって判断する.|r|がこの限界値以上ならば「相関あり」として回帰直線などを求める.
(5)
図1の(5)のような推定値の標準誤差,信頼区間を求めるには
=STEYX(系列1の範囲,系列2の範囲) ==> 標準誤差Seとなる.
図に示した灰色の線 (95%信頼区間の限界) は回帰直線±1.96Seの線で,この線はExcelグラフには表示されない.
(6)
図1の(6)のように与えられたx座標に対応する回帰直線のy座標を数値として求めるには
=TREND(既知のy,既知のx,新しいx,1)
または
=FORECAST(新しいx,既知のy,既知のx)
相関係数,回帰直線
