この記事は前後編の2回に分けてお届けしている。ソーシャルメディアの追跡に役立つサードパーティ製のツールを紹介した前回に引き続き、後編となる今回は、GoogleドキュメントからAPIを呼び出してデータを収集する方法を見てみよう。先に前編を読むソーシャルメディアAPIのいろはこの記事の基本姿勢は、データを収集するためにいくつかの「API」を呼び出す様子を見ていくというものだ。僕が知る限り、大概の一般人は「API」が何かなんて知らないか、この言葉を聞くだけでしり込みしてしまうかのいずれかだ。でも大丈夫。APIなんて、離れた場所にあるリソースから効率的に任意のデータを取り出す手段に過ぎないんだから。例として、FacebookのGraph APIでSEOmozの情報を調べる場合を見てみよう。この場合、次のURLをブラウザで開くだけでいいんだ。 http://graph.facebook.com/?ids=http://www.seomoz.orgすると、次のようなものが表示される。
Googleドキュメントでスプレッドシートを開き、スプレッドシートのメニューから［ツール］>［スクリプト エディタ...］を選ぶ。「未保存のスクリプト」として表示された内容を全部消して、あらかじめ用意したFBshares関数のコードを貼り付けて保存すると、スプレッドシート内で「FBshares」関数を利用できるようになる。
このプログラミングコードがどんなものか、わかりやすく言うとこんな感じだ。
入力引数が1つのFBsharesという新しい関数を使えるように定義せよ。
この関数が呼び出された場合、与えられたURLに対するFacebook Graph APIのコンテンツを読み出し、戻ってきたデータをJSONとして解析せよ。
そのJSONから「shares」という名前を持つデータをスプレッドシートのセルに入力せよ。
Googleスプレッドシートでこの設定が済んだら、セルに次のように打ち込んでみよう。=FBshares("http://www.seomoz.org")すると今新しく定義した関数によって、このURLがFacebookでどれだけ共有されているかが得られる。ここで理解すべき大事な点は、データがJSONであるとコンピュータに1度指示すれば、ドット表記を使って簡単にデータを読めるようになるということだ。では、何が起きているのかを示すために、もう少し複雑なスクリプトに挑戦してみよう。これは、この間the Oatmealに掲載された漫画についてRedditのAPIを呼び出して得られた結果だ(Redditは英語圏で人気のあるソーシャルリンク共有サービス)。
URLごとのソーシャルメディア反応をGoogleドキュメントで自動的にゲットする方法(後編) | Moz - SEOとインバウンドマーケティングの実践情報 | Web担当者Forum
