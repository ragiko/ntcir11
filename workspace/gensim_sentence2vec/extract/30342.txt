Auto Scaling は、ユーザーが定義したポリシー、スケジュール、およびアラームに従って、Amazon EC2 インスタンスを自動的に起動および終了します。Auto Scaling を使用すると、提示されるあらゆる負荷に合わせて調整できる Amazon EC2 インスタンス群を維持できます。Auto Scaling を使用して、グループ内の複数のインスタンスを一度に起動することもできます。 Auto Scaling はその名のとおり、変化する状況に自動的に対応します。必要なのは、そうした変化にどのように対応するかを指定することだけです。例えば、Auto Scaling に対して、1 つ以上の既存インスタンスの CPU 利用率が 60% を超えた場合に追加のインスタンスを起動するように指示できます。あるいは、トラフィックの減少が予想される週末にウェブサイトのインスタンスの半分を終了するように指定することも可能です。 Auto Scaling によって、アプリケーションが効率的に実行され続けるように、インスタンス群を最適なパフォーマンスで稼働させることができます。さらに、Auto Scaling グループは複数のアベイラビリティゾーンにわたって機能することができます。このため、1 つのアベイラビリティゾーンが利用できなくなると、異なるアベイラビリティゾーンのアプリケーションへトラフィックを自動的に再分散させます。Auto Scaling を使用することで、正常なインスタンスが常に 1 つ以上稼働している状態を確保できます。詳細については、Auto Scaling を参照してください。 この例では、多くのアプリケーションで Auto Scaling を使用するために配置する必要がある基本インフラストラクチャをセットアップします。以下を実行します。
このチュートリアルでは、Amazon EC2 アプリケーションを、ロードバランスを行い、インスタンスの最小数を 2、最大数を 2 に自動調整するように設定しています。最小値と最大値を同じ値に設定することで、1 つのインスタンスに障害が発生した場合にも、常に希望するインスタンス数を確保できます。実際のウェブサイトを作成する場合は、ベストプラクティスとして、いずれか 1 つのアベイラビリティーゾーンの喪失に耐えるように、複数のアベイラビリティーゾーン間に十分な数のインスタンスを起動することをお勧めします。さらに、Auto Scaling の機能を活用するためには、インスタンスの最大数を最小数より大きくなるように増やす必要があります。 インスタンスの最大数を指定すると、インスタンス群がどのくらい大きくなるかを制御できます。この例では、Auto Scaling は、負荷が増えるとインスタンスを 1 つ追加するよう設定されます。このトピックではポリシーを定義し、次のセクションではCloudWatch を作成して、NetworkOut の平均が 5 分間にわたり 6,000,000 バイトというしきい値を超えた際に、ポリシーにあるアクションを起こすようにします。 Auto Scaling と Amazon CloudWatch は連携して、作成されたポリシーに従って、インスタンスを起動または終了します。時間を節約するため、ここではポリシーを 1 つしか作成しませんが、負荷が減少したときにインスタンスを終了するポリシーなど、他のポリシーも作成できます。
Auto Scaling コマンドラインツールをまだインストールしていなければ、ここでインストールする必要があります。Auto Scaling コマンドラインツールをローカルコンピュータにインストールするには、「Auto Scaling コマンドラインツール」を参照してください。Auto Scaling ツールの設定の詳細については、Auto Scaling 開発者ガイド の「コマンド インターフェイスのインストール」を参照してください。
オートスケールとロードバランスのある Amazon EC2 アプリケーションを設定するにはコマンドプロンプトウィンドウを開きます。ローカルの Windows コンピュータで、[Start] をクリックします。Searchボックスに cmd と入力し、Enter キーを押します。 起動設定は、Auto Scaling グループ内で起動するインスタンスのテンプレートです。この例で起動設定を定義するためには、as-create-launch-config コマンドを使用します。以下のパラメータで起動設定を定義します。
image-id は AMI ID です。手順 6: カスタム AMI を作成する で作成したカスタム AMI ID を使用します。instance-type には、オペレーティングシステム、メモリ、ローカルストレージなど、起動するインスタンスに関する基本的な情報が格納されます。この例では、最初にインスタンスを起動したときに使用したのと同じインスタンスタイプを使用します。key はインスタンスへの接続に使用したキーペアです。最初にインスタンスを起動したときに作成したのと同じキーペアを使用します。group は、インスタンスのアクセスルールを定義したセキュリティグループです。最初にインスタンスを起動したときに作成したのと同じセキュリティグループを使用します。
手順 9: Auto Scaling を使用して Amazon EC2 インスタンスを起動する - AWS の使用開始
