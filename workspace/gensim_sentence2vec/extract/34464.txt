エクステントと動的拡張の回避
・動的拡張:オブジェクトに増分エクステントを割り当てること
・動的拡張は再帰SQL文を実行して空き領域を見つけるため、アプリケーションの実行に影響を及ぼす。
OLTP環境では、アプリケーション実行中に動的拡張が発生しないようにする。
〔エクステントの動的拡張を避ける方法〕
・オブジェクトの最大サイズを見積もり、すべてのデータが初期エクステントに入るように、
記憶領域パラメータを調整する。
・表の空き領域を監視し、閾値に近付いたら手動でエクステントを割り当てる。
・ローカル管理表領域を使用する。
ローカル管理表領域:データファイルヘッダにエクステントの割当てを管理するビットマップ情報を持って
ローカルに管理する領域
・エクステント拡張のための再帰オペレーションや、空きエクステントの結合などのオーバヘッドを削減できる、
・Oracle9iでは、ローカル管理表領域がデフォルト
・ローカル管理表領域を設定するには、CREATE TABLESPACE文でEXTENT MANAGEMENT LOCAL句を指定する。
大きなエクステントの利点と欠点
利点
・セグメントが動的に拡張されにくい
・1つのエクステントは連続領域なので、わずかにパフォーマンスが向上する
・エクステントマップに対する単一読み込みができる
・マルチブロックで読むときには、少ない読み込み回数で読み込める
欠点
・未使用領域が大きくなることもある
一般に、全表走査が多い場合は大きなエクステントに設定する。
全表走査とエクステントサイズ
全表走査では、部分的なマルチブロック読み込みを避けるため、
ブロック・サイズ
データベースのブロック:データを読み書きするI/Oの最小単位
標準ブロックサイズ
・データベース作成時にSYSTEM表領域に指定されるブロックサイズ
・DB_BLOCK_SIZEで指定する。
・OSブロックの倍数に設定する。
・データベースを再作成しない限り、変更できない。
非標準ブロックサイズ
・SYSTEM表領域以外の表領域は別のブロックサイズにできる。
・DB_nK_CACHE_SIZEによって、それぞれのデータブロックサイズに対応するキャッシュを設定する。
・CREATE TABLESPACE文のBLOCKSIZEオプションを使用して、表領域ごとにブロックサイズを指定できる。
ALTER TABLESPACE文による変更はできない。
・標準ブロックサイズと同じサイズにできない。
・標準ブロックサイズに対応するキャッシュ:KEEPバッファプール、RECYCLEバッファプール
・非標準ブロックサイズに対応するキャッシュ:DEFAULTバッファプール
OLTPと小さなブロックサイズ
OLTP環境では、索引を使用したデータの参照と更新が行われるため、小さなデータブロックが適している。
DSSと大きなブロックサイズ
DSS環境では、大規模なデータを対象とした読み込み処理が行われるため、大きなデータブロックが適している。
第7章 データ・ブロックの効率的な使用
