ピクセル単位でセルの高さと幅を指定する
記事「セルの縦と 横の比 」記事「セルの高さ と幅の設定 」でセルの高さと幅を設定しようとしてきました。 
思ったとおりに高さと幅が設定できないのでまたまた違う方法でアプローチしたいと思います。 
msdnの該当ページによるとどうも最終的にセルの高さと幅を決める単位はピクセルのようなのでピクセル単位でセルの高さと幅を指定したいと思います。 
RowHeigthとColumnWidthはそれぞれポイント単位と文字単位で指定するので直接ピクセル単位で指定はできません。 
かといってピクセルをポイントに変換する関数などは見当たらない。 
そこで、もう何回も使っているあの比率をくどくどと使っちゃいます。 
幅    11.8ポイント:100ピクセル高さ   75ポイント:100ピクセル 
つまり 
幅    0.118ポイント:1ピクセル高さ   0.75ポイント:1ピクセル 
この比率を使います。 
ようするに単なる掛け算で例えば、幅を30ピクセルにしたかったらまず 
30 * 0.118 = 3.54 ポイント 
のようにピクセルからポイント単位に変換してからColumnWidthに使う。そうするとこの様になります。 
Cells.ColumnWidth = 30 * 0.118 
汎用性を持たせるために以下のコードでは30のところを変数にしていろいろと設定できるようにしました。 
コードはこちら 
ピクセル単位でセルを正方形するコード:
Sub macro100211a()'ピクセル単位でセルを任意の正方形にする    Sheets.Add        Dim L As Integer    '一辺の長さ    L = 18    Cells.RowHeight = L * 0.75    Cells.ColumnWidth = L * 0.118    End Sub
実行後のセルはこの様になりました。 
上のコードではセル全部を正方形に変更しました。 
今度は高さと幅の両方を設定できるようにします。 
また、再利用性を考えて高さと幅を設定するプロシージャを独立させてそのプロシージャを他のプロシージャから呼び出すことにしました。 
下のコードでは macro100211b においてSetCellsHW プロシージャを呼び出して値を渡しています。MyHeightに高さ、MyWidthに幅を指定します。 
コードはこちらmacro100211b の方を実行してください。 
ピクセル単位でセルの高さと幅を指定するコード: 
Sub macro100211b()'ピクセル単位でセルの高さと幅を指定する    Sheets.Add        Call SetCellsHW(30, 50)    End SubSub SetCellsHW(MyHeight As Integer, MyWidth As Integer)'ピクセル単位でセルの高さと幅を指定する
Cells.RowHeight = MyHeight * 0.75    Cells.ColumnWidth = MyWidth * 0.118
End Sub
ピクセル単位でセルの高さと幅を指定する: やむえむのExcel VBAメモ
