先ほどの問題を解決するため距離順計算の厳密化を行った厳密アルゴリズムを実装しました
